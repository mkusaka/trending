<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Java Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-09-04T01:33:57Z</updated>
  <subtitle>Daily Trending of Java in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>irsdl/IIS-ShortName-Scanner</title>
    <updated>2024-09-04T01:33:57Z</updated>
    <id>tag:github.com,2024-09-04:/irsdl/IIS-ShortName-Scanner</id>
    <link href="https://github.com/irsdl/IIS-ShortName-Scanner" rel="alternate"></link>
    <summary type="html">&lt;p&gt;latest version of scanners for IIS short filename (8.3) disclosure vulnerability&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;IIS Short Name Scanner - 2012-2023 &amp;amp; Still Giving...&lt;/h1&gt; &#xA;&lt;p&gt;Latest presentation:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/irsdl/IIS-ShortName-Scanner/master/presentation/Steelcon-2023-Beyond_Microsoft_IIS_Short_File_Name_Disclosure.pdf&#34;&gt;Beyond Microsoft IIS Short File Name Disclosure&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Latest blog post:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://soroush.me/blog/2023/07/thirteen-years-on-advancing-the-understanding-of-iis-short-file-name-sfn-disclosure/&#34;&gt;https://soroush.me/blog/2023/07/thirteen-years-on-advancing-the-understanding-of-iis-short-file-name-sfn-disclosure/&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;I recommended everyone to try @bitquark&#39;s new tool in Go before trying this old tool: &lt;a href=&#34;https://github.com/bitquark/shortscan&#34;&gt;https://github.com/bitquark/shortscan&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;The latest version of scanner for IIS short file name (8.3) disclosure vulnerability by using the tilde (~) character. This issue has been discovered in 2010 but has been evolved a few times since.&lt;/p&gt; &#xA;&lt;p&gt;This is an old tool and the code is a spaghetti, but it is capable to tackle even the latest IIS (IIS 10 on Windows Server 2022 at the time of writing this)! It has recently been updated, so it can support sending custom HTTP methods without reflection hacks in Java. However, some awesome researchers have tried to reimplement this tool using other technologies such as in Go, and when they become mature, they probably work better than this.&lt;/p&gt; &#xA;&lt;h2&gt;Description&lt;/h2&gt; &#xA;&lt;p&gt;Microsoft IIS contains a flaw that may lead to an unauthorized information disclosure. The issue is triggered during the parsing of a request that contains a tilde character (~). This may allow a remote attacker to gain access to file and folder name information.&lt;/p&gt; &#xA;&lt;p&gt;This scanner was moved from &lt;a href=&#34;https://code.google.com/p/iis-shortname-scanner-poc/&#34;&gt;https://code.google.com/p/iis-shortname-scanner-poc/&lt;/a&gt; to GitHub for better support.&lt;/p&gt; &#xA;&lt;p&gt;Original research file: &lt;a href=&#34;http://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf&#34;&gt;http://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;It is possible to detect short names of files and directories which have an 8.3 equivalent in Windows by using some vectors in several versions of Microsoft IIS. For instance, it is possible to detect all short-names of &#34;.aspx&#34; files as they have 4 letters in their extensions.&lt;/p&gt; &#xA;&lt;p&gt;Note: new techniques have been introduced to the latest versions of this scanner, and it can now scan IIS10 when it is vulnerable.&lt;/p&gt; &#xA;&lt;p&gt;It is not easy to find the original file or folder names based on the short names. However, the following methods are recommended as examples:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;If you can guess the full extension (for instance .ASPX when the 8.3 extension is .ASP), always try the short name with the full extension.&lt;/li&gt; &#xA; &lt;li&gt;Sometimes short names are listed in Google which can be used to find the actual names&lt;/li&gt; &#xA; &lt;li&gt;Using text dictionary files is also recommended. If a name starts with another word, the second part should be guessed based on a dictionary file separately. For instance, ADDACC~1.ASP can be AddAccount.aspx, AddAccounts.aspx, AddAccurateMargine.aspx, etc&lt;/li&gt; &#xA; &lt;li&gt;Searching in the website contents and resources can also be useful to find the full name. This can be achieved for example by searching Site Map in the Burp Suite tool.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;The recent version has been compiled by using Open JDK 18 (the old jar files for other JDKs have been removed but can be found in the Git history).&lt;/p&gt; &#xA;&lt;p&gt;You will need to download files in the &lt;a href=&#34;https://github.com/irsdl/IIS-ShortName-Scanner/tree/master/release&#34;&gt;/release&lt;/a&gt; directory to use this old application!&lt;/p&gt; &#xA;&lt;p&gt;You can also compile this application yourself. Please submit any issues in GitHub for further investigation.&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;h3&gt;Command line options&lt;/h3&gt; &#xA;&lt;p&gt;USAGE 1 (To verify if the target is vulnerable with the default config file):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;java -jar iis_shortname_scanner.jar [URL]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;USAGE 2 (To find 8.3 file names with the default config file):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;java -jar iis_shortname_scanner.jar [ShowProgress] [ThreadNumbers] [URL]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;USAGE 3 (To verify if the target is vulnerable with a new config file):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;java -jar iis_shortname_scanner.jar [URL] [configFile]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;USAGE 4 (To find 8.3 file names with a new config file):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;java -jar iis_shortname_scanner.jar [ShowProgress] [ThreadNumbers] [URL] [configFile]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;USAGE 5 (To scan multiple targets using a linux box):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;./multi_targets.sh &amp;lt;scope file&amp;gt; &amp;lt;is_default_https (1=https)&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;DETAILS:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt; [ShowProgress]: 0= Show final results only - 1= Show final results step by step  - 2= Show Progress&#xA; [ThreadNumbers]: 0= No thread - Integer Number = Number of concurrent threads [be careful about IIS Denial of Service]&#xA; [URL]: A complete URL - starts with http/https protocol&#xA; [configFile]: path to a new config file which is based on config.xml&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Examples:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;- Example 0 (to see if the target is vulnerable):&#xA; java -jar iis_shortname_scanner.jar http://example.com/folder/&#xA;&#xA;- Example 1 (uses no thread - very slow):&#xA; java -jar iis_shortname_scanner.jar 2 0 http://example.com/folder/new%20folder/&#xA;&#xA;- Example 2 (uses 20 threads - recommended):&#xA; java -jar iis_shortname_scanner.jar 2 20 http://example.com/folder/new%20folder/&#xA;&#xA;- Example 3 (saves output in a text file):&#xA; java -jar iis_shortname_scanner.jar 0 20 http://example.com/folder/new%20folder/ &amp;gt; c:\results.txt&#xA;&#xA;- Example 4 (bypasses IIS basic authentication):&#xA; java -jar iis_shortname_scanner.jar 2 20 http://example.com/folder/AuthNeeded:$I30:$Index_Allocation/&#xA;&#xA;- Example 5 (using a new config file):&#xA; java -jar iis_shortname_scanner.jar 2 20 http://example.com/folder/ newconfig.xml &#xA; &#xA;- Example 6 (scanning multiple targets using a linux box):&#xA; ./multi_targets.sh scope.txt 1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Note 1: Edit config.xml file to change the scanner settings and add additional headers. Note 2: Sometimes it does not work for the first time, and you need to try again.&lt;/p&gt; &#xA;&lt;h2&gt;How Does It Work?&lt;/h2&gt; &#xA;&lt;p&gt;In the following examples, IIS responds with a different message when a file exists:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;http://target/folder/valid*~1.*/.aspx&#xA;http://target/folder/invalid*~1.*/.aspx&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;However, different IIS servers may respond differently, and for instance some of them may work with the following or other similar patterns:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;http://target/folder/valid*~1.*\.asp&#xA;http://target/folder/invalid*~1.*\.asp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Method of sending the request such as GET, POST, OPTIONS, DEBUG, ... is also important.&lt;/p&gt; &#xA;&lt;p&gt;I believe monitoring the requests by using a proxy is the best way of understating this issue and this scanner.&lt;/p&gt; &#xA;&lt;h2&gt;How To Fix This Issue&lt;/h2&gt; &#xA;&lt;p&gt;Microsoft will not patch this security issue. Their last response is as follows:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Thank you for contacting the Microsoft Security Response Center.  &#xA;&#xA;We appreciate your bringing this to our attention.  Our previous guidance stands: deploy IIS with 8.3 names disabled.  &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Therefore, it is recommended to deploy IIS with 8.3 names disabled by creating the following registry key on a Windows operating system:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;&#x9;Key:   HKLM\SYSTEM\CurrentControlSet\Control\FileSystem&#xA;&#x9;Name:  NtfsDisable8dot3NameCreation &#xA;&#x9;Value:        1 &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Note: The web folder needs to be recreated, as the change to the NtfsDisable8dot3NameCreation registry entry affects only files and directories that are created after the change, so the files that already exist are not affected.&lt;/p&gt; &#xA;&lt;h2&gt;Docker Usage&lt;/h2&gt; &#xA;&lt;p&gt;build the image:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker build . -t shortname&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;file mode:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run \&#xA;  -v $(realpath urls.txt):/app/urls.txt \&#xA;  -v $(realpath output_dir):/app/iis_shortname_results \&#xA;  shortname -f urls.txt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;single mode:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run shortname 2 20 http://example.com&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;overwrite config file:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run \&#xA;-v $(realpath config.xml):/app/config.xml \&#xA;shortname http://example.com&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;References&lt;/h2&gt; &#xA;&lt;p&gt;Research links:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://soroush.me/blog/2023/07/thirteen-years-on-advancing-the-understanding-of-iis-short-file-name-sfn-disclosure/&#34;&gt;https://soroush.me/blog/2023/07/thirteen-years-on-advancing-the-understanding-of-iis-short-file-name-sfn-disclosure/&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://soroush.secproject.com/blog/2014/08/iis-short-file-name-disclosure-is-back-is-your-server-vulnerable/&#34;&gt;https://soroush.secproject.com/blog/2014/08/iis-short-file-name-disclosure-is-back-is-your-server-vulnerable/&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;http://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf&#34;&gt;http://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf&lt;/a&gt; (old original research)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Website Reference:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;http://soroush.secproject.com/blog/2012/06/microsoft-iis-tilde-character-vulnerabilityfeature-short-filefolder-name-disclosure/&#34;&gt;http://soroush.secproject.com/blog/2012/06/microsoft-iis-tilde-character-vulnerabilityfeature-short-filefolder-name-disclosure/&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Video Links:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=KbZ-y7b7yDs&#34;&gt;https://www.youtube.com/watch?v=KbZ-y7b7yDs&lt;/a&gt; at SteelCon 2023&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=HrJW6Y9kHC4&#34;&gt;https://www.youtube.com/watch?v=HrJW6Y9kHC4&lt;/a&gt; by shubs (@infosec_au)&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;http://www.youtube.com/watch?v=XOd90yCXOP4&#34;&gt;http://www.youtube.com/watch?v=XOd90yCXOP4&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Other links:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;http://www.osvdb.org/83771&#34;&gt;http://www.osvdb.org/83771&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;http://www.exploit-db.com/exploits/19525/&#34;&gt;http://www.exploit-db.com/exploits/19525/&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;http://securitytracker.com/id?1027223&#34;&gt;http://securitytracker.com/id?1027223&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>