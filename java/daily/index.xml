<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Java Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-07-08T01:38:04Z</updated>
  <subtitle>Daily Trending of Java in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>c0olw/NacosRce</title>
    <updated>2023-07-08T01:38:04Z</updated>
    <id>tag:github.com,2023-07-08:/c0olw/NacosRce</id>
    <link href="https://github.com/c0olw/NacosRce" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Nacos JRaft Hessian 反序列化 RCE 加载字节码 注入内存马 不出网利用&lt;/p&gt;&lt;hr&gt;&lt;h2&gt;Nacos Hessian 反序列化漏洞利用工具 v0.5&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-latex&#34;&gt;&#xA;  _   _                     ____          &#xA; | \ | | __ _  ___ ___  ___|  _ \ ___ ___ &#xA; |  \| |/ _` |/ __/ _ \/ __| |_) / __/ _ \&#xA; | |\  | (_| | (_| (_) \__ \  _ &amp;lt; (_|  __/&#xA; |_| \_|\__,_|\___\___/|___/_| \_\___\___|&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;br&gt;Author: 刨洞安全 &amp;amp;&amp;amp; 凉风&lt;br&gt; &lt;br&gt;注意：工具仅供学习使用，请勿滥用，否则后果自负！&lt;/p&gt; &#xA;&lt;p&gt;&lt;br&gt;**食用方式 **&lt;br&gt;&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;自动注入内存马并执行命令 java -jar NacosRce.jar Url Jraft端口 &#34;Command&#34; &lt;br&gt;&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;java -jar NacosRce.jar http://192.168.90.1:8848/nacos  7848 &#34;whoami&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;只注入内存马&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;   java -jar NacosRce.jar http://192.168.90.1:8848/nacos 7848 memshell&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;br&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;&lt;br&gt;内存马说明： &lt;br&gt;一、冰蝎内存马： &lt;br&gt;1、需要设置请求头x-client-data:rebeyond &lt;br&gt;2、设置Referer:&lt;a href=&#34;https://www.google.com/&#34;&gt;https://www.google.com/&lt;/a&gt; &lt;br&gt;3、路径随意 &lt;br&gt;4、密码rebeyond &lt;img src=&#34;https://raw.githubusercontent.com/c0olw/NacosRce/main/img.png&#34; alt=&#34;img.png&#34;&gt; &lt;br&gt;二、哥斯拉内存马： &lt;br&gt;1、需要设置请求头x-client-data:godzilla &lt;br&gt;2、设置Referer:&lt;a href=&#34;https://www.google.com/&#34;&gt;https://www.google.com/&lt;/a&gt; &lt;br&gt;3、路径随意 &lt;br&gt;4、密码是pass 和 key &lt;br&gt;&lt;img src=&#34;https://raw.githubusercontent.com/c0olw/NacosRce/main/img_1.png&#34; alt=&#34;img_1.png&#34;&gt; &lt;br&gt;三、CMD内存马： &lt;br&gt;1、需要设置请求头x-client-data:cmd &lt;br&gt;2、设置Referer:&lt;a href=&#34;https://www.google.com/&#34;&gt;https://www.google.com/&lt;/a&gt; &lt;br&gt;3、请求头cmd:要执行的命令 &lt;br&gt;&lt;img src=&#34;https://raw.githubusercontent.com/c0olw/NacosRce/main/img_2.png&#34; alt=&#34;img_2.png&#34;&gt; v0.5版本实现了： &lt;br&gt;1、不出网漏洞利用 &lt;br&gt;2、可多次发起漏洞利用 &lt;br&gt;3、同时注入冰蝎/哥斯拉/CMD内存马 &lt;br&gt;4、内存马对nacos多版本进行了兼容 &lt;br&gt; &lt;br&gt;tips: &lt;br&gt;1、请用jdk1.8 &lt;br&gt;2、适用于 Nacos 2.x &amp;lt;= 2.2.2 &lt;br&gt;3、非集群的也能打哦 &lt;br&gt;4、此内存马重启nacos依然存活 &lt;br&gt; &lt;br&gt;关于Windows &lt;br&gt;如用下面的方式执行，注入内存马时会生成临时文件 C:\Windows\Temp\nacos_data_temp 和 C:\Windows\Temp\nacos_data_temp.class 文件&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;java -jar NacosRce.jar http://192.168.90.1:8848  7848 &#34;whoami&#34; windows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;br&gt;如果没有在最后加 windows，临时文件会在 /tmp/nacos_data_temp /tmp/nacos_data_temp.class，所以权限足够的话，不指定windows也能打成功 &lt;br&gt;windows 没打成功也许是因为没权限操作C盘或其他原因 &lt;br&gt; &lt;br&gt; &lt;br&gt;关于编译&lt;br&gt; 遇到依赖冲突无法编译的可以用以下方式 &lt;br&gt;&lt;img src=&#34;https://raw.githubusercontent.com/c0olw/NacosRce/main/img_4.png&#34; alt=&#34;img_4.png&#34;&gt;&lt;br&gt; &lt;br&gt;&lt;img src=&#34;https://raw.githubusercontent.com/c0olw/NacosRce/main/img_3.png&#34; alt=&#34;img_3.png&#34;&gt;&lt;br&gt;&lt;/p&gt; &#xA;&lt;p&gt;项目地址： &lt;a href=&#34;https://github.com/c0olw/NacosRce&#34;&gt;https://github.com/c0olw/NacosRce&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;推荐哥斯拉Nacos后渗透插件： &lt;a href=&#34;https://github.com/pap1rman/postnacos&#34;&gt;https://github.com/pap1rman/postnacos&lt;/a&gt; &lt;br&gt;参考文章 &lt;br&gt;&lt;a href=&#34;https://gv7.me/articles/2020/semi-automatic-mining-request-implements-multiple-middleware-echo/&#34;&gt;https://gv7.me/articles/2020/semi-automatic-mining-request-implements-multiple-middleware-echo/&lt;/a&gt; &lt;br&gt;&lt;a href=&#34;https://exp.ci/2023/06/14/Nacos-JRaft-Hessian-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90/&#34;&gt;https://exp.ci/2023/06/14/Nacos-JRaft-Hessian-反序列化分析/&lt;/a&gt; &lt;br&gt;&lt;a href=&#34;https://github.com/Y4er/ysoserial&#34;&gt;https://github.com/Y4er/ysoserial&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
</feed>