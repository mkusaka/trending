<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Shell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-04-12T02:34:47Z</updated>
  <subtitle>Daily Trending of Shell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>appleboy/scp-action</title>
    <updated>2023-04-12T02:34:47Z</updated>
    <id>tag:github.com,2023-04-12:/appleboy/scp-action</id>
    <link href="https://github.com/appleboy/scp-action" rel="alternate"></link>
    <summary type="html">&lt;p&gt;GitHub Action that copy files and artifacts via SSH.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;ðŸš€ SCP for GitHub Actions&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/features/actions&#34;&gt;GitHub Action&lt;/a&gt; for copying files and artifacts via SSH.&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/appleboy/scp-action/actions&#34;&gt;&lt;img src=&#34;https://github.com/appleboy/scp-action/workflows/scp%20files/badge.svg?sanitize=true&#34; alt=&#34;Actions Status&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;Important&lt;/strong&gt;: Only support &lt;strong&gt;Linux&lt;/strong&gt; &lt;a href=&#34;https://www.docker.com/&#34;&gt;docker&lt;/a&gt; container.&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;Copy files and artifacts via SSH:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;name: scp files&#xA;on: [push]&#xA;jobs:&#xA;&#xA;  build:&#xA;    name: Build&#xA;    runs-on: ubuntu-latest&#xA;    steps:&#xA;    - uses: actions/checkout@v0.1.4&#xA;    - name: copy file via ssh password&#xA;      uses: appleboy/scp-action@v0.1.4&#xA;      with:&#xA;        host: ${{ secrets.HOST }}&#xA;        username: ${{ secrets.USERNAME }}&#xA;        password: ${{ secrets.PASSWORD }}&#xA;        port: ${{ secrets.PORT }}&#xA;        source: &#34;tests/a.txt,tests/b.txt&#34;&#xA;        target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Input variables&lt;/h2&gt; &#xA;&lt;p&gt;See the &lt;a href=&#34;https://raw.githubusercontent.com/appleboy/scp-action/master/action.yml&#34;&gt;action.yml&lt;/a&gt; file for more detail information.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;host - scp remote host&lt;/li&gt; &#xA; &lt;li&gt;port - scp remote port, default is &lt;code&gt;22&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;username - scp username&lt;/li&gt; &#xA; &lt;li&gt;password - scp password&lt;/li&gt; &#xA; &lt;li&gt;passphrase - the passphrase is usually to encrypt the private key&lt;/li&gt; &#xA; &lt;li&gt;fingerprint - fingerprint SHA256 of the host public key, default is to skip verification&lt;/li&gt; &#xA; &lt;li&gt;timeout - timeout for ssh to remote host, default is &lt;code&gt;30s&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;command_timeout - timeout for scp command, default is &lt;code&gt;10m&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;key - content of ssh private key. ex raw content of ~/.ssh/id_rsa&lt;/li&gt; &#xA; &lt;li&gt;key_path - path of ssh private key&lt;/li&gt; &#xA; &lt;li&gt;target - target path on the server, must be a directory (&lt;strong&gt;required&lt;/strong&gt;)&lt;/li&gt; &#xA; &lt;li&gt;source - scp file list (&lt;strong&gt;required&lt;/strong&gt;)&lt;/li&gt; &#xA; &lt;li&gt;rm - remove target folder before upload data, default is &lt;code&gt;false&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;strip_components - remove the specified number of leading path elements.&lt;/li&gt; &#xA; &lt;li&gt;overwrite - use &lt;code&gt;--overwrite&lt;/code&gt; flag with tar, overwrite existing files when extracting&lt;/li&gt; &#xA; &lt;li&gt;tar_tmp_path - temporary path for tar file on the dest host&lt;/li&gt; &#xA; &lt;li&gt;tar_exec - path to tar executable on the dest host. default is &lt;code&gt;tar&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;tar_dereference - use &lt;code&gt;--dereference&lt;/code&gt; flag with tar, follow symlinks; archive and dump the files they point to&lt;/li&gt; &#xA; &lt;li&gt;use_insecure_cipher - include more ciphers with use_insecure_cipher (see &lt;a href=&#34;https://github.com/appleboy/scp-action/issues/15&#34;&gt;#15&lt;/a&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;SSH Proxy Setting:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;proxy_host - proxy host&lt;/li&gt; &#xA; &lt;li&gt;proxy_port - proxy port, default is &lt;code&gt;22&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;proxy_username - proxy username&lt;/li&gt; &#xA; &lt;li&gt;proxy_password - proxy password&lt;/li&gt; &#xA; &lt;li&gt;proxy_passphrase - the passphrase is usually to encrypt the private key&lt;/li&gt; &#xA; &lt;li&gt;proxy_timeout - timeout for ssh to proxy host, default is &lt;code&gt;30s&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;proxy_key - content of ssh proxy private key.&lt;/li&gt; &#xA; &lt;li&gt;proxy_key_path - path of ssh proxy private key&lt;/li&gt; &#xA; &lt;li&gt;proxy_fingerprint - fingerprint SHA256 of the host public key, default is to skip verification&lt;/li&gt; &#xA; &lt;li&gt;proxy_use_insecure_cipher - include more ciphers with use_insecure_cipher (see &lt;a href=&#34;https://github.com/appleboy/scp-action/issues/15&#34;&gt;#15&lt;/a&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Setting up a SSH Key&lt;/h2&gt; &#xA;&lt;p&gt;Make sure to follow the below steps while creating SSH Keys and using them. The best practice is create the SSH Keys on local machine not remote machine. Login with username specified in Github Secrets. Generate a RSA Key-Pair:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# rsa&#xA;ssh-keygen -t rsa -b 4096 -C &#34;your_email@example.com&#34;&#xA;&#xA;# ed25519&#xA;ssh-keygen -t ed25519 -a 200 -C &#34;your_email@example.com&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Add newly generated key into Authorized keys. Read more about authorized keys &lt;a href=&#34;https://www.ssh.com/ssh/authorized_keys/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# rsa&#xA;cat .ssh/id_rsa.pub | ssh b@B &#39;cat &amp;gt;&amp;gt; .ssh/authorized_keys&#39;&#xA;&#xA;# d25519&#xA;cat .ssh/id_ed25519.pub | ssh b@B &#39;cat &amp;gt;&amp;gt; .ssh/authorized_keys&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Copy Private Key content and paste in Github Secrets.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# rsa&#xA;clip &amp;lt; ~/.ssh/id_rsa&#xA;&#xA;# ed25519&#xA;clip &amp;lt; ~/.ssh/id_ed25519&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;See the detail information about &lt;a href=&#34;http://www.linuxproblem.org/art_9.html&#34;&gt;SSH login without password&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;A note&lt;/strong&gt; from one of our readers: Depending on your version of SSH you might also have to do the following changes:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Put the public key in &lt;code&gt;.ssh/authorized_keys2&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Change the permissions of &lt;code&gt;.ssh&lt;/code&gt; to 700&lt;/li&gt; &#xA; &lt;li&gt;Change the permissions of &lt;code&gt;.ssh/authorized_keys2&lt;/code&gt; to 640&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;If you are using OpenSSH&lt;/h3&gt; &#xA;&lt;p&gt;If you are currently using OpenSSH and are getting the following error:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;ssh: handshake failed: ssh: unable to authenticate, attempted methods [none publickey]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Make sure that your key algorithm of choice is supported. On Ubuntu 20.04 or later you must explicitly allow the use of the ssh-rsa algorithm. Add the following line to your OpenSSH daemon file (which is either &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; or a drop-in file under &lt;code&gt;/etc/ssh/sshd_config.d/&lt;/code&gt;):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;CASignatureAlgorithms +ssh-rsa&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Alternatively, &lt;code&gt;ed25519&lt;/code&gt; keys are accepted by default in OpenSSH. You could use this instead of rsa if needed:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;ssh-keygen -t ed25519 -a 200 -C &#34;your_email@example.com&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Example&lt;/h2&gt; &#xA;&lt;p&gt;Copy file via a SSH password:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;- name: copy file via ssh password&#xA;  uses: appleboy/scp-action@v0.1.4&#xA;  with:&#xA;    host: example.com&#xA;    username: foo&#xA;    password: bar&#xA;    port: 22&#xA;    source: &#34;tests/a.txt,tests/b.txt&#34;&#xA;    target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Copy file via a SSH key:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;- name: copy file via ssh key&#xA;  uses: appleboy/scp-action@v0.1.4&#xA;  with:&#xA;    host: ${{ secrets.HOST }}&#xA;    username: ${{ secrets.USERNAME }}&#xA;    port: ${{ secrets.PORT }}&#xA;    key: ${{ secrets.KEY }}&#xA;    source: &#34;tests/a.txt,tests/b.txt&#34;&#xA;    target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example configuration for ignore list:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;- name: copy file via ssh key&#xA;  uses: appleboy/scp-action@v0.1.4&#xA;  with:&#xA;    host: ${{ secrets.HOST }}&#xA;    username: ${{ secrets.USERNAME }}&#xA;    port: ${{ secrets.PORT }}&#xA;    key: ${{ secrets.KEY }}&#xA;    source: &#34;tests/*.txt,!tests/a.txt&#34;&#xA;    target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example configuration for multiple servers:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;  uses: appleboy/scp-action@v0.1.4&#xA;  with:&#xA;-   host: &#34;example.com&#34;&#xA;+   host: &#34;foo.com,bar.com&#34;&#xA;    username: foo&#xA;    password: bar&#xA;    port: 22&#xA;    source: &#34;tests/a.txt,tests/b.txt&#34;&#xA;    target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example configuration for exclude custom files:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;  uses: appleboy/scp-action@v0.1.4&#xA;  with:&#xA;    host: &#34;example.com&#34;&#xA;    username: foo&#xA;    password: bar&#xA;    port: 22&#xA;-   source: &#34;tests/*.txt&#34;&#xA;+   source: &#34;tests/*.txt,!tests/a.txt,!tests/b.txt&#34;&#xA;    target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Upload artifact files to remote server:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;  deploy:&#xA;    name: deploy artifact&#xA;    runs-on: ubuntu-latest&#xA;    steps:&#xA;    - name: checkout&#xA;      uses: actions/checkout@v3&#xA;&#xA;    - run: echo hello &amp;gt; world.txt&#xA;&#xA;    - uses: actions/upload-artifact@v3&#xA;      with:&#xA;        name: my-artifact&#xA;        path: world.txt&#xA;&#xA;    - uses: actions/download-artifact@v2&#xA;      with:&#xA;        name: my-artifact&#xA;        path: distfiles&#xA;&#xA;    - name: copy file to server&#xA;      uses: appleboy/scp-action@v0.1.4&#xA;      with:&#xA;        host: ${{ secrets.HOST }}&#xA;        username: ${{ secrets.USERNAME }}&#xA;        key: ${{ secrets.KEY }}&#xA;        port: ${{ secrets.PORT }}&#xA;        source: distfiles/*&#xA;        target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Remove the specified number of leading path elements:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;- name: remove the specified number of leading path elements&#xA;  uses: appleboy/scp-action@v0.1.4&#xA;  with:&#xA;    host: ${{ secrets.HOST }}&#xA;    username: ${{ secrets.USERNAME }}&#xA;    key: ${{ secrets.KEY }}&#xA;    port: ${{ secrets.PORT }}&#xA;    source: &#34;tests/a.txt,tests/b.txt&#34;&#xA;    target: your_server_target_folder_path&#xA;    strip_components: 1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Only copy files that are newer than the corresponding destination files:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;  changes:&#xA;    name: test changed-files&#xA;    runs-on: ubuntu-latest&#xA;    steps:&#xA;    - name: checkout&#xA;      uses: actions/checkout@v3&#xA;&#xA;    - name: Get changed files&#xA;      id: changed-files&#xA;      uses: tj-actions/changed-files@v35&#xA;      with:&#xA;        since_last_remote_commit: true&#xA;        separator: &#34;,&#34;&#xA;&#xA;    - name: copy file to server&#xA;      uses: appleboy/scp-action@v0.1.4&#xA;      with:&#xA;        host: ${{ secrets.HOST }}&#xA;        username: ${{ secrets.USERNAME }}&#xA;        key: ${{ secrets.KEY }}&#xA;        port: ${{ secrets.PORT }}&#xA;        source: ${{ steps.changed-files.outputs.all_changed_files }}&#xA;        target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Old target structure:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;foobar&#xA;  â””â”€â”€ tests&#xA;    â”œâ”€â”€ a.txt&#xA;    â””â”€â”€ b.txt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;New target structure:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;foobar&#xA;  â”œâ”€â”€ a.txt&#xA;  â””â”€â”€ b.txt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Protecting a Private Key. The purpose of the passphrase is usually to encrypt the private key. This makes the key file by itself useless to an attacker. It is not uncommon for files to leak from backups or decommissioned hardware, and hackers commonly exfiltrate files from compromised systems.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;  - name: ssh key with passphrase&#xA;    uses: appleboy/scp-action@v0.1.4&#xA;    with:&#xA;      host: ${{ secrets.HOST }}&#xA;      username: ${{ secrets.USERNAME }}&#xA;      key: ${{ secrets.SSH2 }}&#xA;+     passphrase: ${{ secrets.PASSPHRASE }}&#xA;      port: ${{ secrets.PORT }}&#xA;      source: &#34;tests/a.txt,tests/b.txt&#34;&#xA;      target: your_server_target_folder_path&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>