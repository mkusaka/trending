<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Dart Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-01-03T01:31:55Z</updated>
  <subtitle>Daily Trending of Dart in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>alexmercerind/media_kit</title>
    <updated>2023-01-03T01:31:55Z</updated>
    <id>tag:github.com,2023-01-03:/alexmercerind/media_kit</id>
    <link href="https://github.com/alexmercerind/media_kit" rel="alternate"></link>
    <summary type="html">&lt;p&gt;[WIP] A complete ðŸŽ¬ video &amp; ðŸŽµ audio library for Flutter &amp; Dart.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;&lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;package:media_kit&lt;/a&gt;&lt;/h1&gt; &#xA;&lt;p&gt;A complete video &amp;amp; audio library for Flutter &amp;amp; Dart.&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;&lt;strong&gt;Sponsored with ðŸ’– by&lt;/strong&gt; &lt;br&gt; &lt;a href=&#34;https://getstream.io/chat/sdk/flutter/?utm_source=alexmercerind_dart&amp;amp;utm_medium=Github_Repo_Content_Ad&amp;amp;utm_content=Developer&amp;amp;utm_campaign=alexmercerind_December2022_FlutterSDK_klmh22&#34; target=&#34;_blank&#34;&gt; &#xA;  &lt;picture&gt;&lt;/picture&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;a href=&#34;https://getstream.io/chat/sdk/flutter/?utm_source=alexmercerind_dart&amp;amp;utm_medium=Github_Repo_Content_Ad&amp;amp;utm_content=Developer&amp;amp;utm_campaign=alexmercerind_December2022_FlutterSDK_klmh22&#34; target=&#34;_blank&#34;&gt; &lt;source media=&#34;(prefers-color-scheme: dark)&#34; srcset=&#34;https://user-images.githubusercontent.com/28951144/204903234-4a64b63c-2fc2-4eef-be44-d287d27021e5.svg&#34;&gt; &lt;source media=&#34;(prefers-color-scheme: light)&#34; srcset=&#34;https://user-images.githubusercontent.com/28951144/204903022-bbaa49ca-74c2-4a8f-a05d-af8314bfd2cc.svg&#34;&gt; &lt;img alt=&#34;Stream Chat&#34; width=&#34;350&#34; height=&#34;auto&#34; src=&#34;https://user-images.githubusercontent.com/28951144/204903022-bbaa49ca-74c2-4a8f-a05d-af8314bfd2cc.svg?sanitize=true&#34;&gt;  &lt;/a&gt; &#xA;&lt;br&gt; &#xA;&lt;h5&gt; Rapidly ship in-app messaging with Stream&#39;s highly reliable chat infrastructure and feature-rich SDKs, including Flutter! &lt;/h5&gt; &#xA;&lt;h4&gt; &lt;a href=&#34;https://getstream.io/chat/sdk/flutter/?utm_source=alexmercerind_dart&amp;amp;utm_medium=Github_Repo_Content_Ad&amp;amp;utm_content=Developer&amp;amp;utm_campaign=alexmercerind_December2022_FlutterSDK_klmh22&#34; target=&#34;_blank&#34;&gt; Try the Flutter Chat tutorial &lt;/a&gt; &lt;/h4&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/28951144/209100988-6f85f563-20e0-4e35-893a-ae099c7e03e4.mp4&#34;&gt;https://user-images.githubusercontent.com/28951144/209100988-6f85f563-20e0-4e35-893a-ae099c7e03e4.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;Add in your &lt;code&gt;pubspec.yaml&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;dependencies:&#xA;  media_kit: ^0.0.1&#xA;  # For audio support.&#xA;  media_kit_core_audio: ^0.0.1&#xA;  # For video support.&#xA;  media_kit_core_video: ^0.0.1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Only one of &lt;a href=&#34;https://pub.dev/packages/media_kit_core_video&#34;&gt;&lt;code&gt;package:media_kit_core_video&lt;/code&gt;&lt;/a&gt; or &lt;a href=&#34;https://pub.dev/packages/media_kit_core_audio&#34;&gt;&lt;code&gt;package:media_kit_core_audio&lt;/code&gt;&lt;/a&gt; is required.&lt;/p&gt; &#xA;&lt;h2&gt;Platforms&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; checked disabled&gt; Windows&lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; Linux&lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; macOS&lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; Android&lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; iOS&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Docs&lt;/h2&gt; &#xA;&lt;h3&gt;Brief Start&lt;/h3&gt; &#xA;&lt;p&gt;Basic example.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-dart&#34;&gt;import &#39;package:media_kit/media_kit.dart&#39;;&#xA;&#xA;/// Create a new [Player] instance.&#xA;final player = Player();&#xA;&#xA;...&#xA;/// Open some [Media] for playback.&#xA;await player.open(&#xA;  Playlist(&#xA;    [&#xA;      Media(&#39;file:///C:/Users/Hitesh/Music/Sample.MP3&#39;),&#xA;      Media(&#39;file:///C:/Users/Hitesh/Video/Sample.MKV&#39;),&#xA;      Media(&#39;https://www.example.com/sample.mp4&#39;),&#xA;      Media(&#39;rtsp://www.example.com/live&#39;),&#xA;    ],&#xA;  ),&#xA;);&#xA;&#xA;...&#xA;/// Modify speed, pitch, volume or shuffle state.&#xA;player.rate = 1.0;&#xA;player.pitch = 1.2;&#xA;player.volume = 50.0;&#xA;player.shuffle = false;&#xA;&#xA;...&#xA;/// Play / Pause&#xA;player.play();&#xA;player.pause();&#xA;player.playOrPause();&#xA;&#xA;...&#xA;/// Release allocated resources back to the system.&#xA;player.dispose();&#xA;&#xA;...&#xA;/// Subscribe to events.&#xA;player.streams.playlist.listen((event) {&#xA;  /// Trigger UI updates etc.&#xA;  print(event);&#xA;});&#xA;player.streams.playlist.listen((event) {&#xA;  /// Trigger UI updates etc.&#xA;  print(event);&#xA;});&#xA;player.streams.position.listen((event) {&#xA;  /// Trigger UI updates etc.&#xA;  print(event);&#xA;});&#xA;player.streams.duration.listen((event) {&#xA;  /// Trigger UI updates etc.&#xA;  print(event);&#xA;});&#xA;player.streams.audioBitrate.listen((event) {&#xA;  /// Trigger UI updates etc.&#xA;  if (event != null) {&#xA;    print(&#39;${event ~/ 1000} KB/s&#39;);&#xA;  }&#xA;});&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Rendering Video&lt;/h3&gt; &#xA;&lt;p&gt;Performant &amp;amp; H/W accelerated, automatically fallbacks to S/W rendering if system does not support it.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-dart&#34;&gt;import &#39;package:media_kit/media_kit.dart&#39;;&#xA;import &#39;package:media_kit_core_video/media_kit_core_video.dart&#39;;&#xA;&#xA;class MyScreen extends StatefulWidget {&#xA;  const MyScreen({Key? key}) : super(key: key);&#xA;  @override&#xA;  State&amp;lt;MyScreen&amp;gt; createState() =&amp;gt; _MyScreenState();&#xA;}&#xA;&#xA;class MyScreenState extends State&amp;lt;MyScreen&amp;gt; {&#xA;  // Create a [Player] instance from `package:media_kit`.&#xA;  final Player player = Player();&#xA;  // Reference to the [VideoController] instance from `package:media_kit_core_video`.&#xA;  VideoController? controller;&#xA;&#xA;  @override&#xA;  void initState() {&#xA;    super.initState();&#xA;    WidgetsBinding.instance.addPostFrameCallback((_) async {&#xA;      // Create a [VideoController] instance from `package:media_kit_core_video`.&#xA;      // Pass the [handle] of the [Player] from `package:media_kit` to the [VideoController] constructor.&#xA;      controller = await VideoController.create(player.handle);&#xA;      setState(() {});&#xA;    });&#xA;  }&#xA;&#xA;  @override&#xA;  Widget build(BuildContext context) {&#xA;    return Video(&#xA;      /// Pass the [controller] to display the video output.&#xA;      controller: controller,&#xA;    );&#xA;  }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For performance reasons (especially in S/W rendering), if you wish to restrain the size of each video frame, you can pass width &amp;amp; height parameters to the &lt;code&gt;VideoController.create&lt;/code&gt; method.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-dart&#34;&gt;controller = await VideoController.create(&#xA;  player.handle,&#xA;  width: 1920,&#xA;  height: 1080,&#xA;);&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Detailed Guide&lt;/h3&gt; &#xA;&lt;p&gt;&lt;em&gt;TODO: documentation&lt;/em&gt;&lt;/p&gt; &#xA;&lt;p&gt;Try out &lt;a href=&#34;https://github.com/harmonoid/media_kit/raw/master/media_kit_test/lib/main.dart&#34;&gt;the test application&lt;/a&gt; for more API usage examples.&lt;/p&gt; &#xA;&lt;h2&gt;Goals&lt;/h2&gt; &#xA;&lt;p&gt;The primary goal of &lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;package:media_kit&lt;/a&gt; is to become a &lt;strong&gt;strong, stable, feature-proof &amp;amp; modular&lt;/strong&gt; media playback library for Flutter. The idea is to support both &lt;strong&gt;audio &amp;amp; video playback&lt;/strong&gt;.&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;package:media_kit&lt;/a&gt; makes rendering &lt;a href=&#34;https://github.com/alexmercerind/dart_vlc/issues/345&#34;&gt;&lt;strong&gt;hardware accelerated video playback&lt;/strong&gt;&lt;/a&gt; possible in Flutter.&lt;/p&gt; &#xA;&lt;p&gt;Since, targetting multiple features at once &amp;amp; bundling redundant native libraries can result in increased bundle size of the application, you can manually select the native libraries you want to bundle, depending upon your use-case. Currently, the scope of work is limited to Windows &amp;amp; Linux. The code is architectured to support multiple platforms &amp;amp; features. Support for more platforms will be added in future.&lt;/p&gt; &#xA;&lt;h2&gt;Support&lt;/h2&gt; &#xA;&lt;p&gt;If you find &lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;package:media_kit&lt;/a&gt; package(s) useful, please consider sponsoring me.&lt;/p&gt; &#xA;&lt;p&gt;Since this is first of a kind project, it takes a lot of time to experiment &amp;amp; develop. It&#39;s a very tedious process to write code, document, maintain &amp;amp; provide support for free. Your support can ensure the quality of the package your project depends upon. I will feel rewarded for my hard-work &amp;amp; research.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/sponsors/alexmercerind&#34;&gt;GitHub Sponsors&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://paypal.me/alexmercerind&#34;&gt;PayPal&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/sponsors/alexmercerind&#34;&gt;&lt;img src=&#34;https://github.githubassets.com/images/modules/site/sponsors/sponsors-mona.svg?sanitize=true&#34; width=&#34;240&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Thanks!&lt;/p&gt; &#xA;&lt;h2&gt;Architecture&lt;/h2&gt; &#xA;&lt;h3&gt;package:media_kit&lt;/h3&gt; &#xA;&lt;p&gt;&lt;em&gt;Click on the zoom button on top-right or pinch inside.&lt;/em&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-mermaid&#34;&gt;%%{&#xA;  init: {&#xA;    &#39;themeVariables&#39;: {&#xA;      &#39;fontFamily&#39;: &#39;BlinkMacSystemFont, Segoe UI, Noto Sans, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji&#39;&#xA;    }&#xA;  }&#xA;}%%&#xA;classDiagram&#xA;&#xA;  Player *-- PlatformPlayer&#xA;  PlatformPlayer &amp;lt;|-- libmpv_Player&#xA;  PlatformPlayer &amp;lt;|-- xyz_Player&#xA;  PlatformPlayer *-- PlayerState&#xA;  PlatformPlayer *-- PlayerStreams&#xA;  PlatformPlayer o-- PlayerConfiguration&#xA;&#xA;  libmpv_Player &amp;lt;.. NativeLibrary&#xA;&#xA;  class Media {&#xA;    +String uri&#xA;    +dynamic extras&#xA;  }&#xA;&#xA;  class Playlist {&#xA;    +List&amp;lt;Media&amp;gt; medias&#xA;    +index index&#xA;  }&#xA;&#xA;  class PlayerConfiguration {&#xA;    + bool texture&#xA;    + bool osc&#xA;    + String vo&#xA;    + String title&#xA;    ... other platform-specific configurable values&#xA;  }&#xA;&#xA;  class PlayerStreams {&#xA;    +Stream&amp;lt;Playlist&amp;gt; playlist&#xA;    +Stream&amp;lt;bool&amp;gt; isPlaying&#xA;    +Stream&amp;lt;bool&amp;gt; isCompleted&#xA;    +Stream&amp;lt;Duration&amp;gt; position&#xA;    +Stream&amp;lt;Duration&amp;gt; duration&#xA;    +Stream&amp;lt;double&amp;gt; volume&#xA;    +Stream&amp;lt;double&amp;gt; rate&#xA;    +Stream&amp;lt;double&amp;gt; pitch&#xA;    +Stream&amp;lt;bool&amp;gt; isBuffering&#xA;    +Stream&amp;lt;AudioParams&amp;gt; audioParams&#xA;    +Stream&amp;lt;double&amp;gt; audioBitrate&#xA;    +Stream&amp;lt;PlayerError&amp;gt; error&#xA;  }&#xA;&#xA;  class PlayerState {&#xA;    +Playlist playlist&#xA;    +bool isPlaying&#xA;    +bool isCompleted&#xA;    +Duration position&#xA;    +Duration duration&#xA;    +double volume&#xA;    +double rate&#xA;    +double pitch&#xA;    +bool isBuffering&#xA;    +AudioParams audioParams&#xA;    +double audioBitrate&#xA;    +PlayerError error&#xA;  }&#xA;&#xA;  class Player {&#xA;    +PlatformPlayer? platform&#xA;&#xA;    +Â«getÂ» PlayerState state&#xA;    +Â«getÂ» PlayerStreams streams&#xA;&#xA;    +Â«setÂ» volume: double*&#xA;    +Â«setÂ» rate: double*&#xA;    +Â«setÂ» pitch: double*&#xA;    +Â«setÂ» shuffle: bool*&#xA;    +Â«getÂ» handle: Future&amp;lt;int&amp;gt;&#xA;&#xA;    +open(playlist)&#xA;    +play()&#xA;    +pause()&#xA;    +playOrPause()&#xA;    +add(media)&#xA;    +remove(index)&#xA;    +next()&#xA;    +previous()&#xA;    +jump(index)&#xA;    +move(from, to)&#xA;    +seek(duration)&#xA;    +setPlaylistMode(playlistMode)&#xA;    +dispose()&#xA;  }&#xA;&#xA;  class PlatformPlayer {&#xA;    +PlayerState state&#xA;    +PlayerStreams streams&#xA;    +PlayerConfiguration configuration&#xA;&#xA;    +open(playlist)*&#xA;    +play()*&#xA;    +pause()*&#xA;    +playOrPause()*&#xA;    +add(media)*&#xA;    +remove(index)*&#xA;    +next()*&#xA;    +previous()*&#xA;    +jump(index)*&#xA;    +move(from, to)*&#xA;    +seek(duration)*&#xA;    +setPlaylistMode(playlistMode)*&#xA;    +dispose()*&#xA;&#xA;    +Â«setÂ» volume: double*&#xA;    +Â«setÂ» rate: double*&#xA;    +Â«setÂ» pitch: double*&#xA;    +Â«setÂ» shuffle: bool*&#xA;    +Â«getÂ» handle: Future&amp;lt;int&amp;gt;*&#xA;&#xA;    #StreamController&amp;lt;Playlist&amp;gt; playlistController&#xA;    #StreamController&amp;lt;bool&amp;gt; isPlayingController&#xA;    #StreamController&amp;lt;bool&amp;gt; isCompletedController&#xA;    #StreamController&amp;lt;Duration&amp;gt; positionController&#xA;    #StreamController&amp;lt;Duration&amp;gt; durationController&#xA;    #StreamController&amp;lt;double&amp;gt; volumeController&#xA;    #StreamController&amp;lt;double&amp;gt; rateController&#xA;    #StreamController&amp;lt;double&amp;gt; pitchController&#xA;    #StreamController&amp;lt;bool&amp;gt; isBufferingController&#xA;    #StreamController&amp;lt;PlayerError&amp;gt; errorController&#xA;    #StreamController&amp;lt;AudioParams&amp;gt; audioParamsController&#xA;    #StreamController&amp;lt;double?&amp;gt; audioBitrateController&#xA;  }&#xA;&#xA;  class libmpv_Player {&#xA;    +open(playlist)&#xA;    +play()&#xA;    +pause()&#xA;    +playOrPause()&#xA;    +add(media)&#xA;    +remove(index)&#xA;    +next()&#xA;    +previous()&#xA;    +jump(index)&#xA;    +move(from, to)&#xA;    +seek(duration)&#xA;    +setPlaylistMode(playlistMode)&#xA;    +Â«setÂ» volume: double&#xA;    +Â«setÂ» rate: double&#xA;    +Â«setÂ» pitch: double&#xA;    +Â«setÂ» shuffle: bool&#xA;    +Â«getÂ» handle: Future&amp;lt;int&amp;gt;&#xA;    +dispose()&#xA;  }&#xA;&#xA;  class NativeLibrary {&#xA;    +find()$ String?&#xA;  }&#xA;&#xA;  class xyz_Player {&#xA;    +open(playlist)&#xA;    +play()&#xA;    +pause()&#xA;    +playOrPause()&#xA;    +add(media)&#xA;    +remove(index)&#xA;    +next()&#xA;    +previous()&#xA;    +jump(index)&#xA;    +move(from, to)&#xA;    +seek(duration)&#xA;    +setPlaylistMode(playlistMode)&#xA;    +Â«setÂ» volume: double&#xA;    +Â«setÂ» rate: double&#xA;    +Â«setÂ» pitch: double&#xA;    +Â«setÂ» shuffle: bool&#xA;    +Â«getÂ» handle: Future&amp;lt;int&amp;gt;&#xA;    +dispose()&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;package:media_kit_core_audio&lt;/h3&gt; &#xA;&lt;p&gt;N/A&lt;/p&gt; &#xA;&lt;h3&gt;package:media_kit_core_video&lt;/h3&gt; &#xA;&lt;p&gt;&lt;em&gt;Click on the zoom button on top-right or pinch inside.&lt;/em&gt;&lt;/p&gt; &#xA;&lt;h4&gt;Windows&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-mermaid&#34;&gt;%%{&#xA;  init: {&#xA;    &#39;themeVariables&#39;: {&#xA;      &#39;fontFamily&#39;: &#39;BlinkMacSystemFont, Segoe UI, Noto Sans, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji&#39;&#xA;    }&#xA;  }&#xA;}%%&#xA;classDiagram&#xA;&#xA;  MediaKitCoreVideoPlugin &#34;1&#34; *-- &#34;1&#34; VideoOutputManager: Create VideoOutput(s) with VideoOutputManager for handle passed through platform channel&#xA;  VideoOutputManager &#34;1&#34; *-- &#34;*&#34; VideoOutput&#xA;  VideoOutput &#34;1&#34; *-- &#34;1&#34; ANGLESurfaceManager: Only for H/W accelerated rendering.&#xA;&#xA;  class MediaKitCoreVideoPlugin {&#xA;    -flutter::PluginRegistrarWindows registrar_&#xA;    -std::unique_ptr&amp;lt;MethodChannel&amp;gt; channel_&#xA;    -std::unique_ptr&amp;lt;VideoOutputManager&amp;gt; video_output_manager_&#xA;    -HandleMethodCall(method_call, result);&#xA;  }&#xA;&#xA;  class VideoOutputManager {&#xA;    +Create(handle: int, width: optional&amp;lt;int&amp;gt;, height: optional&amp;lt;int&amp;gt;)&#xA;    +Dispose(handle: int)&#xA;&#xA;    -flutter::PluginRegistrarWindows registrar_&#xA;    -std::unique_ptr&amp;lt;MethodChannel&amp;gt; channel_&#xA;    -std::unordered_map&amp;lt;int64_t, std::unique_ptr&amp;lt;VideoOutput&amp;gt;&amp;gt; video_outputs_&#xA;  }&#xA;&#xA;  class VideoOutput {&#xA;    +Â«getÂ» texture_id: int64_t&#xA;    -mpv_handle* handle&#xA;    -mpv_render_context* context&#xA;    -std::optional&amp;lt;int64_t&amp;gt; width&#xA;    -std::optional&amp;lt;int64_t&amp;gt; height&#xA;    -int64_t texture_id_&#xA;    -flutter::PluginRegistrarWindows registrar_&#xA;    -std::unique_ptr&amp;lt;flutter::TextureVariant&amp;gt; texture_variant_&#xA;    -std::unique_ptr&amp;lt;ANGLESurfaceManager&amp;gt; surface_manager_ HW&#xA;    -std::unique_ptr&amp;lt;FlutterDesktopGpuSurfaceDescriptor&amp;gt; texture_ HW&#xA;    -std::unique_ptr&amp;lt;uint8_t[]&amp;gt; pixel_buffer_ SW&#xA;    -std::unique_ptr&amp;lt;FlutterDesktopPixelBuffer&amp;gt; pixel_buffer_texture_ SW&#xA;    -std::mutex mutex_&#xA;    -std::function texture_update_callback_&#xA;&#xA;    +SetTextureUpdateCallback(callback: std::function&amp;lt;void(int64_t, int64_t, int64_t)&amp;gt;)&#xA;    -Render()&#xA;    -CheckAndResize()&#xA;    -Resize(required_width: int64_t, required_height: int64_t)&#xA;    -GetVideoWidth(): int64_t&#xA;    -GetVideoHeight(): int64_t&#xA;  }&#xA;&#xA;  class ANGLESurfaceManager {&#xA;    +Â«getÂ» width: int32_t&#xA;    +Â«getÂ» height: int32_t&#xA;    +Â«getÂ» handle: HANDLE&#xA;&#xA;    +HandleResize(width: int64_t, height: int64_t)&#xA;    +SwapBuffers()&#xA;    +MakeCurrent(value: bool)&#xA;    -Initialize()&#xA;    -InitializeD3D11()&#xA;    -InitializeD3D9()&#xA;    -CleanUp(release_context: bool)&#xA;    -CreateAndBindEGLSurface()&#xA;    -ShowFailureMessage(message: wchar_t[])&#xA;&#xA;    -IDXGIAdapter* adapter_&#xA;    -int32_t width_&#xA;    -int32_t height_&#xA;    -ID3D11Device* d3d_11_device_&#xA;    -ID3D11DeviceContext* d3d_11_device_context_&#xA;    -Microsoft::WRL::ComPtr&amp;lt;ID3D11Texture2D&amp;gt;&#xA;    -Microsoft::WRL::ComPtr&amp;lt;IDXGISwapChain&amp;gt;&#xA;    -IDirect3D9Ex* d3d_9_ex_&#xA;    -IDirect3DDevice9Ex* d3d_9_device_ex_&#xA;    -IDirect3DTexture9* d3d_9_texture_&#xA;    -HANDLE handle_&#xA;    -EGLSurface surface_&#xA;    -EGLDisplay display_&#xA;    -EGLContext context_&#xA;    -EGLConfig config_&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Implementation&lt;/h2&gt; &#xA;&lt;h3&gt;package:media_kit&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;package:media_kit&lt;/a&gt; is entirely written in Dart. It uses dart:ffi to invoke native C API of libmpv through it&#39;s shared libraries. All the callback management, event-&lt;code&gt;Stream&lt;/code&gt;s, other methods to control playback of audio/video are implemented in Dart with the help of FFI. Event management i.e. &lt;code&gt;position&lt;/code&gt;, &lt;code&gt;duration&lt;/code&gt;, &lt;code&gt;bitrate&lt;/code&gt;, &lt;code&gt;audioParams&lt;/code&gt; &lt;code&gt;Stream&lt;/code&gt;s are important to render changes in the UI.&lt;/p&gt; &#xA;&lt;p&gt;A &lt;a href=&#34;https://github.com/dart-lang/sdk/issues/37022&#34;&gt;big limitation with FFI in Dart SDK&lt;/a&gt; has been that it does not support async callbacks from another thread. Learn more about this at: &lt;a href=&#34;https://github.com/dart-lang/sdk/issues/37022&#34;&gt;dart/sdk#37022&lt;/a&gt;. Following situation will explain better:&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;If you pass a function pointer from Dart to C code, you can invoke it fine. But, as soon as you invoke it from some other thread on the native side, Dart VM will instantly crash. This feature is important because most events take place on a background thread.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;However, I could easily do this within Dart because &lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; offers an &#34;event polling&#34;-like way to listen to events. I got awesome idea to spawn a background &lt;a href=&#34;https://api.flutter.dev/flutter/dart-isolate/Isolate-class.html&#34;&gt;&lt;code&gt;Isolate&lt;/code&gt;&lt;/a&gt;, where I run the event-loop. I get the memory address of each event and forward it outside the &lt;a href=&#34;https://api.flutter.dev/flutter/dart-isolate/Isolate-class.html&#34;&gt;&lt;code&gt;Isolate&lt;/code&gt;&lt;/a&gt; with the help of &lt;a href=&#34;https://api.dart.dev/stable/2.18.6/dart-isolate/ReceivePort-class.html&#34;&gt;&lt;code&gt;ReceivePort&lt;/code&gt;&lt;/a&gt;, where I finally interpret it using more FFI code. I have explained this in detail within &lt;a href=&#34;https://github.com/alexmercerind/media_kit/raw/master/media_kit/lib/src/libmpv/core/initializer.dart&#34;&gt;in-code comments of initializer.dart, I had to do a lot more trickery to get this to work&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This solved the issue of events &amp;amp; audio playback within 100% Dart using FFI.&lt;/p&gt; &#xA;&lt;p&gt;However, no such &#34;event-polling&#34; like API is possible for video rendering. It won&#39;t be performant to constantly do polling of video frames off a thread &amp;amp; forward frames back to primary thread for rendering. &lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; does not have any such API anyway. So, I created new package &lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;&lt;code&gt;package:media_kit_core_video&lt;/code&gt;&lt;/a&gt; for specifically offering platform-specific video playback implementation which internally handles Flutter&#39;s Texture Registry API &amp;amp; libmpv&#39;s OpenGL rendering API. This package only consumes the &lt;code&gt;mpv_handle*&lt;/code&gt; (which can be shared as primitive &lt;code&gt;int&lt;/code&gt; value easily) of the instance (created with &lt;a href=&#34;https://github.com/alexmercerind/media_kit&#34;&gt;package:media_kit&lt;/a&gt; through FFI) to setup a new viewport. Detailed implementation is discussed below.&lt;/p&gt; &#xA;&lt;h3&gt;package:media_kit_core_audio&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; from &lt;a href=&#34;https://mpv.io/&#34;&gt;mpv Media Player&lt;/a&gt; is used for leveraging audio playback. A minimal variant with stripped down features &amp;amp; only audio support is bundled for usage through dart:ffi.&lt;/p&gt; &#xA;&lt;h3&gt;package:media_kit_core_video&lt;/h3&gt; &#xA;&lt;h4&gt;Windows&lt;/h4&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; from &lt;a href=&#34;https://mpv.io/&#34;&gt;mpv Media Player&lt;/a&gt; is used for leveraging video playback.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; gives access to C API for rendering hardware-accelerated video output using OpenGL. See: &lt;a href=&#34;https://github.com/mpv-player/mpv/raw/master/libmpv/render.h&#34;&gt;render.h&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://github.com/mpv-player/mpv/raw/master/libmpv/render_gl.h&#34;&gt;render_gl.h&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Flutter recently added ability for Windows to &lt;a href=&#34;https://github.com/flutter/engine/pull/26840&#34;&gt;render Direct3D &lt;code&gt;ID3D11Texture2D&lt;/code&gt; textures&lt;/a&gt;.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The two APIs above are hardware accelerated i.e. GPU backed buffers are used. &lt;strong&gt;This is performant approach, easily capable for rendering 4K 60 FPS videos&lt;/strong&gt;, rest depends on the hardware. Since &lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; API is OpenGL based &amp;amp; the Texture API in Flutter is Direct3D based, &lt;a href=&#34;https://github.com/google/angle&#34;&gt;ANGLE (Almost Native Graphics Layer Engine)&lt;/a&gt; is used for interop, which automatically translates the OpenGL ES calls into Direct3D.&lt;/p&gt; &#xA;&lt;p&gt;This hardware accelerated video output requires DirectX 11 or higher. Most Windows systems with either integrated or discrete GPUs should support this already. On systems where Direct3D fails to load due to missing graphics drivers or unsupported feature-level or DirectX version etc. a fallback pixel-buffer based software renderer is used. This means that video is rendered by CPU &amp;amp; every frame is copied back to the RAM. This will cause some redundant load on the CPU, result in decreased battery life &amp;amp; may not play higher resolution videos properly. However, it works.&lt;/p&gt; &#xA;&lt;p&gt;You can visit my &lt;a href=&#34;https://github.com/alexmercerind/flutter-windows-ANGLE-OpenGL-Direct3D-Interop&#34;&gt;experimentation repository&lt;/a&gt; to see a minimal example showing OpenGL ES rendering inside Flutter Windows.&lt;/p&gt; &#xA;&lt;h4&gt;Linux&lt;/h4&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mpv-player/mpv/tree/master/libmpv&#34;&gt;libmpv&lt;/a&gt; from &lt;a href=&#34;https://mpv.io/&#34;&gt;mpv Media Player&lt;/a&gt; is used for leveraging video playback. System shared libraries from distribution specific user-installed packages are used by-default. On Ubuntu / Debian based systems, you can install these using:&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; This package also bundles specific shared libraries &amp;amp; dependencies.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo apt install mpv libmpv-dev&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;On Flutter Linux, &lt;a href=&#34;https://github.com/flutter/engine/pull/24916&#34;&gt;both OpenGL (hardware accelerated) &amp;amp; Pixel Buffer (software) APIs&lt;/a&gt; are available for rendering on Texture widget.&lt;/p&gt; &#xA;&lt;h2&gt;Outcomes&lt;/h2&gt; &#xA;&lt;p&gt;4K video playback on entry-level AMD Ryzen 3 2200U processor with Radeon Vega 3 Mobile Graphics.&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTES:&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;See process specific CPU &amp;amp; GPU usage (media_kit_test.exe). Overall CPU usage is high due to screen recording.&lt;/li&gt; &#xA; &lt;li&gt;Memory usage is higher because of higher resolution 4K video. General usage will be lower.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/28951144/208765832-416313c9-97d4-44d0-a902-e577f3c4f3f6.mp4&#34;&gt;https://user-images.githubusercontent.com/28951144/208765832-416313c9-97d4-44d0-a902-e577f3c4f3f6.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;Copyright Â© 2022, Hitesh Kumar Saini &amp;lt;&lt;a href=&#34;mailto:saini123hitesh@gmail.com&#34;&gt;saini123hitesh@gmail.com&lt;/a&gt;&amp;gt;&lt;/p&gt; &#xA;&lt;p&gt;This project &amp;amp; the work under this repository is governed by MIT license that can be found in the &lt;a href=&#34;https://raw.githubusercontent.com/alexmercerind/media_kit/master/LICENSE&#34;&gt;LICENSE&lt;/a&gt; file.&lt;/p&gt;</summary>
  </entry>
</feed>