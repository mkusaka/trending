<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub JavaScript Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-07-02T01:38:39Z</updated>
  <subtitle>Daily Trending of JavaScript in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>homanp/superagent</title>
    <updated>2023-07-02T01:38:39Z</updated>
    <id>tag:github.com,2023-07-02:/homanp/superagent</id>
    <link href="https://github.com/homanp/superagent" rel="alternate"></link>
    <summary type="html">&lt;p&gt;ğŸ¥· Superagent - Build, deploy, and manage LLM-powered agents&lt;/p&gt;&lt;hr&gt;&lt;div align=&#34;center&#34;&gt; &#xA; &lt;h1&gt;Superagent ğŸ¥·&lt;/h1&gt; &#xA; &lt;p&gt;&lt;strong&gt;Build, deploy, and manage LLM-powered agents&lt;/strong&gt; &lt;a href=&#34;https://Superagent.sh&#34;&gt;Superagent.sh&lt;/a&gt;&lt;/p&gt; &#xA; &lt;p&gt; &lt;img alt=&#34;GitHub Contributors&#34; src=&#34;https://img.shields.io/github/contributors/homanp/Superagent&#34;&gt; &lt;img alt=&#34;GitHub Last Commit&#34; src=&#34;https://img.shields.io/github/last-commit/homanp/Superagent&#34;&gt; &lt;img alt=&#34;&#34; src=&#34;https://img.shields.io/github/repo-size/homanp/Superagent&#34;&gt; &lt;img alt=&#34;GitHub Issues&#34; src=&#34;https://img.shields.io/github/issues/homanp/Superagent&#34;&gt; &lt;img alt=&#34;GitHub Pull Requests&#34; src=&#34;https://img.shields.io/github/issues-pr/homanp/Superagent&#34;&gt; &lt;img alt=&#34;Github License&#34; src=&#34;https://img.shields.io/badge/License-MIT-yellow.svg?sanitize=true&#34;&gt; &lt;img alt=&#34;Discord&#34; src=&#34;https://img.shields.io/discord/1110910277110743103?label=Discord&amp;amp;logo=discord&amp;amp;logoColor=white&amp;amp;style=plastic&amp;amp;color=d7b023)%5D(https://discord.gg/e8j7mgjDUK&#34;&gt; &lt;/p&gt; &#xA; &lt;br&gt; &#xA; &lt;img alt=&#34;Superagent UI&#34; src=&#34;https://raw.githubusercontent.com/homanp/superagent/main/ui/public/superagent.png&#34;&gt; &#xA;&lt;/div&gt; &#xA;&lt;h2&gt;ğŸ§ What is this?&lt;/h2&gt; &#xA;&lt;p&gt;Superagent is a powerful tool that simplifies the configuration and deployment of LLM (Large Language Model) Agents to production. It provides a range of features and functionalities to make it easier for developers to build, manage and deploy AI agents to production including features such as built in memory and document retrieval via vector dbs, powerful tools, webhooks, cron jobs etc.&lt;/p&gt; &#xA;&lt;h2&gt;ğŸ¥· Superagent Cloud&lt;/h2&gt; &#xA;&lt;p&gt;If you are looking for a plug-n-play way getting started be sure to checkout &lt;a href=&#34;https://Superagent.sh&#34;&gt;Superagent.sh&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;ğŸ” Documentation&lt;/h2&gt; &#xA;&lt;p&gt;Checkout the &lt;a href=&#34;https://docs.Superagent.sh/&#34;&gt;full documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;ğŸš§ Roadmap&lt;/h2&gt; &#xA;&lt;p&gt;You can follow the &lt;a href=&#34;https://github.com/users/homanp/projects/4&#34;&gt;roadmap here&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;ğŸ› ï¸ Getting Started&lt;/h2&gt; &#xA;&lt;p&gt;To get started with Superagent, follow these steps:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;Clone the Superagent repository into a public GitHub repository or fork it from &lt;a href=&#34;https://github.com/homanp/Superagent/fork&#34;&gt;https://github.com/homanp/Superagent/fork&lt;/a&gt;. If you plan to distribute the code, keep the source code public.&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git clone https://github.com/homanp/Superagent.git&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;To run the script, simply execute it using:&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;bash setup.sh&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;See the setup instructions for the UI in the &lt;code&gt;ui&lt;/code&gt; folder.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;ğŸ’¡ Examples&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Runing Superagent with &lt;a href=&#34;https://github.com/homanp/nextjs-Superagent&#34;&gt;NextJS&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;ğŸ‘¨ğŸ½â€ğŸ’» SDKs&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/homanp/superagent-js&#34;&gt;Javascript&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/homanp/superagent-py&#34;&gt;Python&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;ğŸ«¶ Contributions&lt;/h2&gt; &#xA;&lt;p&gt;Superagent is an open-source project, and contributions are welcome. If you would like to contribute, you can create new features, fix bugs, or improve the infrastructure. Please refer to the &lt;a href=&#34;https://github.com/homanp/Superagent/raw/main/.github/CONTRIBUTING.md&#34;&gt;CONTRIBUTING.md&lt;/a&gt; file in the repository for more information on how to contribute.&lt;/p&gt; &#xA;&lt;p&gt;We appreciate your contributions and aim to make it easy for anyone to create and run LLM Agents in production using Superagent.&lt;/p&gt; &#xA;&lt;h2&gt;â­ Partners&lt;/h2&gt; &#xA;&lt;p&gt;A big thanks to all partners that support the development of &lt;strong&gt;Superagent&lt;/strong&gt;!&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;ğŸŒ¿ &lt;a href=&#34;https://buildwithfern.com/&#34;&gt;Fern&lt;/a&gt;&lt;/strong&gt;: Fern helps create SDKs and client libraries from OpenAPI specs. Superagent uses Fern for all of the client libraries and SDKs we provide. A big shout out for the support!&lt;/p&gt; &#xA;&lt;h2&gt;ğŸ™ Support&lt;/h2&gt; &#xA;&lt;p&gt;We appreciate all the support you can give us, either with contributions, feedback, bug reports or feature requests. Drop a star and share Superagent to the world!&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>kudoai/chatgpt.js</title>
    <updated>2023-07-02T01:38:39Z</updated>
    <id>tag:github.com,2023-07-02:/kudoai/chatgpt.js</id>
    <link href="https://github.com/kudoai/chatgpt.js" rel="alternate"></link>
    <summary type="html">&lt;p&gt;ğŸ¤– A powerful client-side JavaScript library for ChatGPT&lt;/p&gt;&lt;hr&gt;&lt;div align=&#34;center&#34;&gt; &#xA; &lt;div align=&#34;right&#34;&gt; &#xA;  &lt;h6&gt;English | &lt;a href=&#34;https://raw.githubusercontent.com/kudoai/chatgpt.js/main/zh-cn#readme&#34;&gt;ç®€ä½“ä¸­æ–‡&lt;/a&gt;&lt;/h6&gt; &#xA; &lt;/div&gt; &#xA; &lt;h3&gt; &#xA;  &lt;picture&gt; &#xA;   &lt;source media=&#34;(prefers-color-scheme: dark)&#34; srcset=&#34;https://raw.githubusercontent.com/kudoai/chatgpt.js/main/media/images/chatgpt.js-logo-dark-mode-5995x619.png&#34;&gt; &#xA;   &lt;img width=&#34;700&#34; src=&#34;https://raw.githubusercontent.com/kudoai/chatgpt.js/main/media/images/chatgpt.js-logo-light-mode-5995x619.png&#34;&gt; &#xA;  &lt;/picture&gt; &lt;br&gt;&lt;br&gt; &lt;p&gt;ğŸ¤– A powerful client-side JavaScript library for ChatGPT &lt;br&gt;&lt;br&gt;&lt;/p&gt; &lt;/h3&gt;&#xA;&lt;/div&gt;  &#xA;&lt;div align=&#34;center&#34;&gt; &#xA; &lt;p&gt;&lt;a href=&#34;https://github.com/kudoai/chatgpt.js/raw/main/LICENSE.md&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/License-MIT-green.svg?labelColor=464646&amp;amp;style=flat-square&#34; alt=&#34;&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/kudoai/chatgpt.js/commits/main&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/commit-activity/m/kudoai/chatgpt.js?label=Commits&amp;amp;labelColor=464646&amp;amp;style=flat-square&#34; alt=&#34;&#34;&gt;&lt;/a&gt; &lt;img src=&#34;https://img.shields.io/github/size/kudoai/chatgpt.js/dist/chatgpt-1.10.6.min.js?label=Minified%20Size&amp;amp;labelColor=464646&amp;amp;color=ff69b4&amp;amp;style=flat-square&#34; alt=&#34;&#34;&gt; &lt;a href=&#34;https://www.codefactor.io/repository/github/kudoai/chatgpt.js&#34;&gt;&lt;img src=&#34;https://img.shields.io/codefactor/grade/github/kudoai/chatgpt.js?labelColor=464646&amp;amp;label=Code+Quality&amp;amp;style=flat-square&#34; alt=&#34;&#34;&gt;&lt;/a&gt; &lt;img src=&#34;https://img.shields.io/jsdelivr/gh/hm/chatgptjs/chatgpt.js?labelColor=464646&amp;amp;color=ff6427&amp;amp;label=jsDelivr+Hits&amp;amp;style=flat-square&#34; alt=&#34;&#34;&gt;&lt;/p&gt; &#xA;&lt;/div&gt; &#xA;&lt;h2&gt;About&lt;/h2&gt; &#xA;&lt;p&gt;&lt;strong&gt;chatgpt.js&lt;/strong&gt; is a powerful JavaScript library that allows for super easy interaction w/ the ChatGPT DOM.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Feature-rich&lt;/li&gt; &#xA; &lt;li&gt;Object-oriented&lt;/li&gt; &#xA; &lt;li&gt;Easy-to-use&lt;/li&gt; &#xA; &lt;li&gt;Lightweight (yet optimally performant)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;img type=&#34;separator&#34; height=&#34;8px&#34; width=&#34;100%&#34; src=&#34;https://raw.githubusercontent.com/andreasbm/readme/master/assets/lines/aqua.png&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Importing the library&lt;/h2&gt; &#xA;&lt;h3&gt;ES6:&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;(async () =&amp;gt; {&#xA;    await import(&#39;https://code.chatgptjs.org/chatgpt-latest.min.js&#39;);    &#xA;    // Your code here...&#xA;})();&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;ES5:&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;var xhr = new XMLHttpRequest()&#xA;xhr.open(&#39;GET&#39;, &#39;https://code.chatgptjs.org/chatgpt-latest.min.js&#39;)&#xA;xhr.onload = function() {&#xA;    if (xhr.status === 200) {&#xA;        var chatgptJS = document.createElement(&#39;script&#39;)&#xA;        chatgptJS.textContent = xhr.responseText&#xA;        document.head.appendChild(chatgptJS)&#xA;        yourCode() // runs your code&#xA;    }&#xA;}&#xA;xhr.send()&#xA;&#xA;function yourCode() {&#xA;    // Your code here...&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;&lt;img style=&#34;margin: 0 2px -0.065rem 0&#34; height=&#34;17&#34; src=&#34;https://i.imgur.com/SATGr8j.png&#34;&gt;&lt;img style=&#34;margin: 0 2px -0.035rem 1px&#34; height=&#34;17.5&#34; src=&#34;https://i.imgur.com/wcCg3al.png&#34;&gt; Greasemonkey:&lt;/h3&gt; &#xA;&lt;p&gt;Userscript repositories like Greasy Fork maintain a whitelist of pre-approved CDNs (such as commit-specific references from &lt;code&gt;cdn.jsdelivr.net&lt;/code&gt;) so the import URL is substantially lengthier to preserve publishability to these sites:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;...&#xA;// @require https://cdn.jsdelivr.net/gh/kudoai/chatgpt.js@4fdaa0ede3dd0847e20722568ddce38b7a00f49a/dist/chatgpt-1.10.6.min.js&#xA;// ==/UserScript==&#xA;&#xA;// Your code here...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you don&#39;t plan on publishing to these repos, the simpler &lt;code&gt;https://code.chatgptjs.org/chatgpt-latest.min.js&lt;/code&gt; can be used instead to import the latest minified release.&lt;/p&gt; &#xA;&lt;h3&gt;&lt;img style=&#34;margin: 0 2px -1px 0&#34; height=&#34;16&#34; src=&#34;https://www.google.com/chrome/static/images/favicons/apple-icon-60x60.png&#34;&gt; Chrome:&lt;/h3&gt; &#xA;&lt;p&gt;Since Google will &lt;a href=&#34;https://developer.chrome.com/docs/extensions/migrating/mv2-sunset/&#34;&gt;eventually phase out&lt;/a&gt; Manifest V2, remote code will no longer be allowed, so importing chatgpt.js locally is ideal:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;Save &lt;a href=&#34;https://raw.githubusercontent.com/kudoai/chatgpt.js/main/chatgpt.js&#34;&gt;https://raw.githubusercontent.com/kudoai/chatgpt.js/main/chatgpt.js&lt;/a&gt; to a subdirectory (&lt;code&gt;lib&lt;/code&gt; in this example)&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Add ES6 export statement to end of &lt;code&gt;lib/chatgpt.js&lt;/code&gt;&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;...&#xA;export { chatgpt }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol start=&#34;3&#34;&gt; &#xA; &lt;li&gt;In project&#39;s (V3) &lt;code&gt;manifest.json&lt;/code&gt;, add &lt;code&gt;lib/chatgpt.js&lt;/code&gt; as a web accessible resource&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;    &#34;web_accessible_resources&#34;: [{&#xA;        &#34;matches&#34;: [&#34;&amp;lt;all_urls&amp;gt;&#34;],&#xA;        &#34;resources&#34;: [&#34;lib/chatgpt.js&#34;]&#xA;    }],&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol start=&#34;4&#34;&gt; &#xA; &lt;li&gt;In scripts that need &lt;code&gt;chatgpt.js&lt;/code&gt; (foreground/background alike), import it like so:&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;(async () =&amp;gt; {&#xA;    const { chatgpt } = await import(chrome.runtime.getURL(&#39;lib/chatgpt.js&#39;));&#xA;    // Your code here...&#xA;})();&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img type=&#34;separator&#34; height=&#34;8px&#34; width=&#34;100%&#34; src=&#34;https://raw.githubusercontent.com/andreasbm/readme/master/assets/lines/aqua.png&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;&lt;strong&gt;chatgpt.js&lt;/strong&gt; was written w/ ultra flexibility in mind.&lt;/p&gt; &#xA;&lt;p&gt;For example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;chatgpt.getLastResponse()&#xA;chatgpt.getLastReply()&#xA;chatgpt.get(&#39;reply&#39;, &#39;last&#39;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Each call equally fetches the last response. If you think it works, it probabily will... so just type it! (Who has time for docs?)&lt;/p&gt; &#xA;&lt;p&gt;If it didn&#39;t, simply submit an &lt;a href=&#34;https://github.com/kudoai/chatgpt.js/issues&#34;&gt;issue&lt;/a&gt; or &lt;a href=&#34;https://github.com/kudoai/chatgpt.js/pulls&#34;&gt;PR&lt;/a&gt; and it will be integrated, ezpz!&lt;/p&gt; &#xA;&lt;p&gt;&lt;img type=&#34;separator&#34; height=&#34;8px&#34; width=&#34;100%&#34; src=&#34;https://raw.githubusercontent.com/andreasbm/readme/master/assets/lines/aqua.png&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Made with chatgpt.js&lt;/h2&gt; &#xA;&lt;h3&gt;&#xA; &lt;picture&gt;&#xA;  &lt;source media=&#34;(prefers-color-scheme: dark)&#34; srcset=&#34;https://i.imgur.com/RduASbD.png&#34;&gt;&#xA;  &lt;img width=&#34;16&#34; src=&#34;https://raw.githubusercontent.com/adamlui/chatgpt-addons/main/media/icons/openai-favicon64.png&#34;&gt;&#xA; &lt;/picture&gt; &lt;a href=&#34;https://chatgptevo.com/autoclear&#34;&gt;Autoclear ChatGPT History&lt;/a&gt; &lt;a href=&#34;https://github.com/awesome-scripts/awesome-userscripts#privacy&#34;&gt;&lt;img src=&#34;https://awesome.re/mentioned-badge.svg?sanitize=true&#34; style=&#34;margin:0 0 -2px 5px&#34;&gt;&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;p&gt;Auto-clear your ChatGPT query history for maximum privacy. &lt;br&gt;&lt;a href=&#34;https://greasyfork.org/scripts/460805-auto-clear-chatgpt-history&#34;&gt;Install&lt;/a&gt; / &lt;a href=&#34;https://github.com/adamlui/autoclear-chatgpt-history#readme&#34;&gt;Readme&lt;/a&gt; / &lt;a href=&#34;https://github.com/adamlui/autoclear-chatgpt-history/discussions&#34;&gt;Discuss&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;&lt;img width=&#34;16&#34; src=&#34;https://i.imgur.com/1yjmK3W.png&#34;&gt; &lt;a href=&#34;https://github.com/madkarmaa/automatic-chatgpt-dan&#34;&gt;Automatic ChatGPT DAN&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;p&gt;Automatically send DAN prompts to ChatGPT. &lt;br&gt;&lt;a href=&#34;https://github.com/madkarmaa/automatic-chatgpt-dan#%EF%B8%8F-installation&#34;&gt;Install&lt;/a&gt; / &lt;a href=&#34;https://github.com/madkarmaa/automatic-chatgpt-dan#readme&#34;&gt;Readme&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;&lt;img src=&#34;https://media.bravegpt.com/images/bravegpt-icon48.png&#34; width=&#34;18&#34;&gt; &lt;a href=&#34;https://bravegpt.com&#34;&gt;BraveGPT&lt;/a&gt; &lt;a href=&#34;https://www.producthunt.com/posts/bravegpt?utm_source=badge-featured&amp;amp;utm_medium=badge&amp;amp;utm_souce=badge-bravegpt&#34; target=&#34;_blank&#34;&gt;&lt;img src=&#34;https://api.producthunt.com/widgets/embed-image/v1/featured.svg?post_id=385630&amp;amp;theme=light&#34; style=&#34;width: 112px; height: 24px; margin:0 0 -4px 5px;&#34; width=&#34;112&#34; height=&#34;24&#34;&gt;&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;p&gt;Display ChatGPT answers in Brave Search sidebar (powered by GPT-4!) &lt;br&gt;&lt;a href=&#34;https://greasyfork.org/scripts/462440-bravegpt&#34;&gt;Install&lt;/a&gt; / &lt;a href=&#34;https://github.bravegpt.com/#readme&#34;&gt;Readme&lt;/a&gt; / &lt;a href=&#34;https://github.bravegpt.com/discussions&#34;&gt;Discuss&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;&#xA; &lt;picture&gt;&#xA;  &lt;source media=&#34;(prefers-color-scheme: dark)&#34; srcset=&#34;https://i.imgur.com/RduASbD.png&#34;&gt;&#xA;  &lt;img width=&#34;16&#34; src=&#34;https://raw.githubusercontent.com/adamlui/chatgpt-userscripts/main/media/icons/openai-favicon64.png&#34;&gt;&#xA; &lt;/picture&gt; &lt;a href=&#34;https://chatgptevo.com/autocontinue/github&#34;&gt;ChatGPT Auto-Continue â©&lt;/a&gt; &lt;a href=&#34;https://github.com/awesome-scripts/awesome-userscripts#chatgpt&#34;&gt;&lt;img src=&#34;https://awesome.re/mentioned-badge.svg?sanitize=true&#34; style=&#34;margin:0 0 -3px 3px&#34;&gt;&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;p&gt;Automatically continue generating multiple ChatGPT responses.&lt;br&gt; &lt;a href=&#34;https://greasyfork.org/scripts/466789-chatgpt-auto-continue&#34;&gt;Install&lt;/a&gt; / &lt;a href=&#34;https://github.com/adamlui/chatgpt-auto-continue#readme&#34;&gt;Readme&lt;/a&gt; / &lt;a href=&#34;https://chatgptevo.com/autocontinue/discussions&#34;&gt;Discuss&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;&#xA; &lt;picture&gt;&#xA;  &lt;source media=&#34;(prefers-color-scheme: dark)&#34; srcset=&#34;https://i.imgur.com/RduASbD.png&#34;&gt;&#xA;  &lt;img width=&#34;16&#34; src=&#34;https://raw.githubusercontent.com/adamlui/chatgpt-addons/main/media/icons/openai-favicon64.png&#34;&gt;&#xA; &lt;/picture&gt; &lt;a href=&#34;https://chatgptevo.com/autorefresh&#34;&gt;ChatGPT Auto Refresh â†»&lt;/a&gt; &lt;a href=&#34;https://github.com/awesome-scripts/awesome-userscripts#chatgpt&#34;&gt;&lt;img src=&#34;https://awesome.re/mentioned-badge.svg?sanitize=true&#34; style=&#34;margin:0 0 -2px 5px&#34;&gt;&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;p&gt;Keeps ChatGPT sessions fresh to eliminate network errors + Cloudflare checks. &lt;br&gt;&lt;a href=&#34;https://greasyfork.org/scripts/462422-chatgpt-auto-refresh&#34;&gt;Install&lt;/a&gt; / &lt;a href=&#34;https://github.com/adamlui/chatgpt-auto-refresh#readme&#34;&gt;Readme&lt;/a&gt; / &lt;a href=&#34;https://github.com/adamlui/chatgpt-auto-refresh/discussions&#34;&gt;Discuss&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;&lt;img src=&#34;https://media.duckduckgpt.com/images/ddgpt-icon48.png&#34; width=&#34;17&#34;&gt; &lt;a href=&#34;https://duckduckgpt.com&#34;&gt;DuckDuckGPT&lt;/a&gt; &lt;a href=&#34;https://www.producthunt.com/posts/duckduckgpt?utm_source=badge-featured&amp;amp;utm_medium=badge&amp;amp;utm_souce=badge-duckduckgpt&#34; target=&#34;_blank&#34;&gt;&lt;img src=&#34;https://api.producthunt.com/widgets/embed-image/v1/featured.svg?post_id=379261&amp;amp;theme=light&#34; style=&#34;width: 112px; height: 24px; margin:0 0 -4px 5px;&#34; width=&#34;112&#34; height=&#34;24&#34;&gt;&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;p&gt;Display ChatGPT answers in DuckDuckGo sidebar (powered by GPT-4!) &lt;br&gt;&lt;a href=&#34;https://greasyfork.org/scripts/459849-duckduckgpt&#34;&gt;Install&lt;/a&gt; / &lt;a href=&#34;https://github.duckduckgpt.com/#readme&#34;&gt;Readme&lt;/a&gt; / &lt;a href=&#34;https://github.duckduckgpt.com/discussions&#34;&gt;Discuss&lt;/a&gt;&lt;/p&gt; &#xA;&lt;br&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://chatgptinfinity.com&#34; target=&#34;_blank&#34;&gt;&lt;img width=&#34;555&#34; src=&#34;https://raw.githubusercontent.com/adamlui/chatgpt-infinity/main/chrome/media/images/tiles/marquee-promo-tile-1400x560.png&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;br&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://chatgptwidescreen.com&#34; target=&#34;_blank&#34;&gt;&lt;img width=&#34;555&#34; src=&#34;https://raw.githubusercontent.com/adamlui/chatgpt-widescreen/main/chrome/media/images/tiles/marquee-promo-tile-1400x560.png&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;br&gt; &#xA;&lt;p&gt;If you&#39;ve made something w/ chatgpt.js you want to share, email &lt;a href=&#34;mailto:showcase@chatgptjs.org&#34;&gt;showcase@chatgptjs.org&lt;/a&gt; or just open a &lt;a href=&#34;https://github.com/kudoai/chatgpt.js/pulls&#34;&gt;pull request&lt;/a&gt;!&lt;/p&gt; &#xA;&lt;p&gt;&lt;img type=&#34;separator&#34; height=&#34;8px&#34; width=&#34;100%&#34; src=&#34;https://raw.githubusercontent.com/andreasbm/readme/master/assets/lines/aqua.png&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Contributors&lt;/h2&gt; &#xA;&lt;p&gt;This library exists thanks to code, translations, issues &amp;amp; ideas from the following contributors:&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/adamlui&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/10906554?first-contrib=2023.03.15&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@adamlui&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/mefengl&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/71683364?first-contrib=2023.03.16-get-functions&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@mefengl&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/Zin6969&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/131989355?first-contrib=2023.04.30-doc-translations&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@Zin6969&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/madruga8&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/30551844?first-contrib=2023.05.02-getlastresponse-bug-report&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@madruga8&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/XiaoYingYo&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/54934866?first-contrib=2023.05.01-clearchats-discard-fix&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@XiaoYingYo&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/AliAlSarre&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/129722778?first-contrib=2023.05.24-css-readability&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@AliAlSarre&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/madkarmaa&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/100418457?first-contrib=2023.06.02-send-function-bug-report&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@madkarmaa&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/wamoyo&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/1170326?first-contrib=2023.06.10-html-parser-idea&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@wamoyo&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/meiraleal&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/u/33952?first-contrib=2023.06.10-html-parser-idea&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;@meiraleal&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/dependabot&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://avatars.githubusercontent.com/in/29110&amp;amp;h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;Dependabot&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://chat.openai.com&#34;&gt;&lt;img src=&#34;https://images.weserv.nl/?url=https://i.imgur.com/tNyIPmG.jpg?h=50&amp;amp;w=50&amp;amp;mask=circle&amp;amp;maxage=7d&#34; alt=&#34;&#34; title=&#34;ChatGPT&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;br&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/kudoai/chatgpt.js/tree/main/dist&#34;&gt;&lt;strong&gt;Releases&lt;/strong&gt;&lt;/a&gt; / &lt;a href=&#34;https://github.com/kudoai/chatgpt.js/discussions&#34;&gt;Discuss&lt;/a&gt; / &lt;a href=&#34;https://raw.githubusercontent.com/kudoai/chatgpt.js/main/#---------a-powerful-client-side-javascript-library-for-chatgpt&#34;&gt;Back to top â†‘&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>mengjian-github/copilot-analysis</title>
    <updated>2023-07-02T01:38:39Z</updated>
    <id>tag:github.com,2023-07-02:/mengjian-github/copilot-analysis</id>
    <link href="https://github.com/mengjian-github/copilot-analysis" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;èŠ±äº†å¤§åŠä¸ªæœˆï¼Œæˆ‘ç»ˆäºé€†å‘åˆ†æäº†Github Copilot&lt;/h1&gt; &#xA;&lt;h2&gt;èƒŒæ™¯&lt;/h2&gt; &#xA;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼ŒGithub Copilotæ˜¯ä¸€ç§åŸºäºæœºå™¨å­¦ä¹ çš„ä»£ç è‡ªåŠ¨è¡¥å…¨å·¥å…·ã€‚å®ƒä½¿ç”¨äº†æ¥è‡ªGitHubçš„å¤§é‡ä»£ç ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œå¹¶ä½¿ç”¨OpenAIçš„è¯­è¨€æ¨¡å‹æ¥ç”Ÿæˆä»£ç ã€‚Copilotè¿˜å¯ä»¥å­¦ä¹ ç”¨æˆ·çš„ç¼–ç ä¹ æƒ¯ï¼Œå¹¶æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­å‡ºæ­£ç¡®çš„ä»£ç ç‰‡æ®µã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨å®é™…ä½¿ç”¨ä¸­å‘ç°å¤§éƒ¨ä»½æç¤ºè¿˜æ˜¯éå¸¸å¥½ç”¨çš„ï¼Œèƒ½å¤Ÿè¾ƒä¸ºå‡†ç¡®çš„æ¨æµ‹å‡ºç”¨æˆ·æ„å›¾ï¼Œç”šè‡³æ˜¯åŸºäºé¡¹ç›®å…¶ä»–æ–‡ä»¶çš„ä¸Šä¸‹æ–‡è¿›è¡Œæ¨ç†ã€‚æ¯”è¾ƒå¥½å¥‡è¿™é‡Œæ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Œäºæ˜¯æ¢ç´¢äº†è¿™ä¸ªVSCodeæ’ä»¶çš„è¯¦ç»†å®ç°ã€‚&lt;/p&gt; &#xA;&lt;h2&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt; &#xA;&lt;p&gt;ç”±äºCopilotå¹¶æ²¡æœ‰å¼€æºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åšä¸€äº›é€†å‘çš„å‡†å¤‡ã€‚&lt;/p&gt; &#xA;&lt;p&gt;é¦–å…ˆï¼Œæ‰¾åˆ°VSCodeæ’ä»¶çš„å®‰è£…ç›®å½•ï¼Œæ‹¿åˆ°&lt;code&gt;extension.js&lt;/code&gt;ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/8966f2a1-c7ee-457d-a233-b53d18d4f80f.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;åœ¨macä¸‹æ’ä»¶ç›®å½•åœ¨&lt;code&gt;~/.vscode&lt;/code&gt;ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°ä¸€ä¸ªç»è¿‡å‹ç¼©æ··æ·†çš„æ–‡ä»¶ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/1c2b9452-87f1-45d3-8ba7-4b2fc1a69a56.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;1. åˆ†å‰²&lt;code&gt;webpack_modules&lt;/code&gt;&lt;/h3&gt; &#xA;&lt;p&gt;é’ˆå¯¹æ•´ä¸ªwebpackå‹ç¼©æ··æ·†çš„jsï¼Œæˆ‘ä»¬é¦–å…ˆè¦å°†ä¸åŒçš„bundleè¯†åˆ«å‡ºæ¥ï¼Œåˆ†å‰²æˆå•ä¸ªæ–‡ä»¶ï¼Œä»¥ä¾¿äºåç»­çš„åˆ†æã€‚&lt;/p&gt; &#xA;&lt;p&gt;ç”±äºå‹ç¼©åçš„ä»£ç å­˜åœ¨å¾ˆå¤šä¸ç¡®å®šæ€§ï¼Œä¸€å¼€å§‹æ‰“ç®—å°è¯•é€šè¿‡æ­£åˆ™æå–ï¼Œä½†æ— è®ºå¦‚ä½•éƒ½æœ‰å„ç§è¾¹ç•Œæƒ…å†µå¯¼è‡´æå–ä¸æ­£ç¡®ï¼Œæœ€ç®€å•çš„æ–¹æ³•è¿˜æ˜¯é€šè¿‡ASTæ¥æå–ã€‚&lt;/p&gt; &#xA;&lt;p&gt;é¦–å…ˆï¼Œé€šè¿‡babel-parserå°†æºç è§£æä¸ºASTï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;const ast = parser.parse(source);&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ç„¶åï¼Œé€šè¿‡babel-traverseéå†æ•´ä¸ªASTï¼Œæ‰¾åˆ°modulesçš„å˜é‡ï¼Œå–å‡ºé‡Œé¢çš„å€¼ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function parseModules() {&#xA;  traverse(ast, {&#xA;    enter(path) {&#xA;      if (&#xA;        path.node.type === &#34;VariableDeclarator&#34; &amp;amp;&amp;amp;&#xA;        path.node.id.name === &#34;__webpack_modules__&#34;&#xA;      ) {&#xA;        const modules = path.node.init.properties;&#xA;        for (const module of modules) {&#xA;          const moduleId = module.key.value;&#xA;          const moduleAst = module.value;&#xA;          const moduleSource = generate(moduleAst).code;&#xA;&#xA;          try {&#xA;            const ast = transformRequire(prettier(clearfyParams(moduleId, moduleSource)));&#xA;&#xA;            const mainBody = ast.program.body[0].expression.body.body;&#xA;            const moduleCode = generate(types.Program(mainBody)).code;&#xA;            fs.writeFileSync(&#xA;              &#34;./prettier/modules/&#34; + moduleId + &#34;.js&#34;,&#xA;              moduleCode,&#xA;              &#34;utf8&#34;&#xA;            );&#xA;          } catch (e) {&#xA;            console.log(e);&#xA;          }&#xA;        }&#xA;      }&#xA;    },&#xA;  });&#xA;}&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æœ€åï¼Œå°†å¤„ç†è¿‡åçš„asté€šè¿‡babel-generatorå’Œbabel-typesé‡æ–°ç”Ÿæˆæ–°çš„astå†™å…¥æ–‡ä»¶ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä»¥æ¨¡å—idå‘½åçš„ç‹¬ç«‹bundleï¼Œåœ¨æˆ‘çš„è¿™ä¸€ç‰ˆä¸­ï¼Œè§£æå‡ºæ¥çš„copilotçš„bundleå·²ç»éå¸¸å¤šäº†ï¼Œè¾¾åˆ°752ä¸ªã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/3a674c5a-0b99-4706-a5cb-b58316767cf1.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;2. è¯†åˆ«æ¨¡å—ä¾èµ–&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬è§£æå‡ºæ¥çš„bundleï¼Œç¬¬ä¸€å±‚å‡½æ•°å¤§æ¦‚æ˜¯è¿™æ ·ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/8ab939a1-0421-4870-ac58-76807ffe91e9.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;å¯¹äºwebpackæ¥è¯´ï¼Œè¿™å‡ ä¸ªå‚æ•°æ˜¯å›ºå®šçš„ï¼Œåˆ†åˆ«æ˜¯&lt;code&gt;module&lt;/code&gt;ã€&lt;code&gt;exports&lt;/code&gt;ã€&lt;code&gt;require&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼˜å…ˆæŠŠè¿™å‡ ä¸ªå‚æ•°è¯†åˆ«å‡ºæ¥ï¼Œè¿›è¡Œä½œç”¨åŸŸçš„æ›¿æ¢ï¼Œè¿™æ ·æ‰å¯ä»¥çœ‹å‡ºæ¨¡å—é—´çš„ä¾èµ–å…³ç³»ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function clearfyParams(moduleId, moduleSource) {&#xA;  if (moduleSource.trim().startsWith(&#34;function&#34;)) {&#xA;    // change `function(e, t, n) {` to `(e, t, n) =&amp;gt; {`&#xA;    moduleSource = moduleSource.replace(&#34;function&#34;, &#34;&#34;);&#xA;    moduleSource = moduleSource.replace(&#34;)&#34;, &#34;) =&amp;gt;&#34;);&#xA;  }&#xA;&#xA;  const moduleAst = parser.parse(moduleSource);&#xA;  let flag = false;&#xA;&#xA;  traverse(moduleAst, {&#xA;    ArrowFunctionExpression(path) {&#xA;      if (flag) return;&#xA;      const params = path.node.params;&#xA;      params.forEach((param) =&amp;gt; {&#xA;        if (param.name === &#34;e&#34; || param.name === &#34;t&#34; || param.name === &#34;n&#34;) {&#xA;          path.scope.rename(&#xA;            param.name,&#xA;            {&#xA;              e: &#34;module&#34;,&#xA;              t: &#34;exports&#34;,&#xA;              n: &#34;require&#34;,&#xA;            }[param.name]&#xA;          );&#xA;        }&#xA;      });&#xA;      flag = true;&#xA;    },&#xA;  });&#xA;  return moduleAst;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ç±»ä¼¼è¿™æ ·çš„æœ‰requireå’Œexportsçš„ä»£ç ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;var r = require(12781).Stream;&#xA;var i = require(73837);&#xA;function o() {&#xA;  this.source = null;&#xA;  this.dataSize = 0;&#xA;  this.maxDataSize = 1048576;&#xA;  this.pauseStream = !0;&#xA;  this._maxDataSizeExceeded = !1;&#xA;  this._released = !1;&#xA;  this._bufferedEvents = [];&#xA;}&#xA;module.exports = o;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;3. ä¼˜åŒ–å‹ç¼©åçš„è¯­æ³•&lt;/h3&gt; &#xA;&lt;p&gt;JSä»£ç ç»è¿‡å‹ç¼©åï¼Œä¼šäº§ç”Ÿå¤§é‡çš„é€—å·è¿ç®—ç¬¦ã€çŸ­è·¯å†™æ³•ã€ä¸‰å…ƒè¡¨è¾¾å¼ã€æ‹¬å·é—­åŒ…ç­‰ç­‰ï¼Œéå¸¸é˜»ç¢é˜…è¯»ï¼Œè¿™é‡Œå‚è€ƒäº†&lt;a href=&#34;https://github.com/thakkarparth007/copilot-explorer&#34;&gt;https://github.com/thakkarparth007/copilot-explorer&lt;/a&gt; è¿™ä¸ªé¡¹ç›®æ‰€åšçš„ä¸€äº›é€†å‘å·¥ä½œï¼Œå¯¹è¯­æ³•è¿›è¡Œäº†ä¸€ç³»åˆ—å¤„ç†ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function prettier(ast) {&#xA;  const moduleTransformer = {&#xA;    // e.g., `(0, r.getConfig)(e, r.ConfigKey.DebugOverrideProxyUrl);`&#xA;    // gets transformed to r.getConfig(e, r.ConfigKey.DebugOverrideProxyUrl);&#xA;    CallExpression(path) {&#xA;      if (path.node.callee.type != &#34;SequenceExpression&#34;) {&#xA;        return;&#xA;      }&#xA;      if (&#xA;        path.node.callee.expressions.length == 2 &amp;amp;&amp;amp;&#xA;        path.node.callee.expressions[0].type == &#34;NumericLiteral&#34;&#xA;      ) {&#xA;        path.node.callee = path.node.callee.expressions[1];&#xA;      }&#xA;    },&#xA;    ExpressionStatement(path) {&#xA;      if (path.node.expression.type == &#34;SequenceExpression&#34;) {&#xA;        const exprs = path.node.expression.expressions;&#xA;        let exprStmts = exprs.map((e) =&amp;gt; {&#xA;          return types.expressionStatement(e);&#xA;        });&#xA;        path.replaceWithMultiple(exprStmts);&#xA;        return;&#xA;      }&#xA;      if (path.node.expression.type == &#34;AssignmentExpression&#34;) {&#xA;        // handle cases like: `a = (expr1, expr2, expr3)`&#xA;        // convert to: `expr1; expr2; a = expr3;`&#xA;        if (path.node.expression.right.type == &#34;SequenceExpression&#34;) {&#xA;          const exprs = path.node.expression.right.expressions;&#xA;          let exprStmts = exprs.map((e) =&amp;gt; {&#xA;            return types.expressionStatement(e);&#xA;          });&#xA;          let lastExpr = exprStmts.pop();&#xA;          path.node.expression.right = lastExpr.expression;&#xA;          exprStmts.push(path.node);&#xA;          path.replaceWithMultiple(exprStmts);&#xA;          return;&#xA;        }&#xA;&#xA;        // handle cases like: `exports.GoodExplainableName = a;` where `a` is a function or a class&#xA;        // rename `a` to `GoodExplainableName` everywhere in the module&#xA;        if (&#xA;          path.node.expression.left.type == &#34;MemberExpression&#34; &amp;amp;&amp;amp;&#xA;          path.node.expression.left.object.type == &#34;Identifier&#34; &amp;amp;&amp;amp;&#xA;          path.node.expression.left.object.name == &#34;exports&#34; &amp;amp;&amp;amp;&#xA;          path.node.expression.left.property.type == &#34;Identifier&#34; &amp;amp;&amp;amp;&#xA;          path.node.expression.left.property.name != &#34;default&#34; &amp;amp;&amp;amp;&#xA;          path.node.expression.right.type == &#34;Identifier&#34; &amp;amp;&amp;amp;&#xA;          path.node.expression.right.name.length == 1&#xA;        ) {&#xA;          path.scope.rename(&#xA;            path.node.expression.right.name,&#xA;            path.node.expression.left.property.name&#xA;          );&#xA;          return;&#xA;        }&#xA;      }&#xA;      if (path.node.expression.type == &#34;ConditionalExpression&#34;) {&#xA;        // handle cases like: `&amp;lt;test&amp;gt; ? c : d;`&#xA;        // convert to: `if (&amp;lt;test&amp;gt;) { c; } else { d; }`&#xA;        const test = path.node.expression.test;&#xA;        const consequent = path.node.expression.consequent;&#xA;        const alternate = path.node.expression.alternate;&#xA;&#xA;        const ifStmt = types.ifStatement(&#xA;          test,&#xA;          types.blockStatement([types.expressionStatement(consequent)]),&#xA;          types.blockStatement([types.expressionStatement(alternate)])&#xA;        );&#xA;        path.replaceWith(ifStmt);&#xA;        return;&#xA;      }&#xA;      if (path.node.expression.type == &#34;LogicalExpression&#34;) {&#xA;        // handle cases like: `a &amp;amp;&amp;amp; b;`&#xA;        // convert to: `if (a) { b; }`&#xA;        const test = path.node.expression.left;&#xA;        const consequent = path.node.expression.right;&#xA;&#xA;        const ifStmt = types.ifStatement(&#xA;          test,&#xA;          types.blockStatement([types.expressionStatement(consequent)]),&#xA;          null&#xA;        );&#xA;        path.replaceWith(ifStmt);&#xA;        return;&#xA;      }&#xA;    },&#xA;    IfStatement(path) {&#xA;      if (!path.node.test || path.node.test.type != &#34;SequenceExpression&#34;) {&#xA;        return;&#xA;      }&#xA;      const exprs = path.node.test.expressions;&#xA;      let exprStmts = exprs.map((e) =&amp;gt; {&#xA;        return types.expressionStatement(e);&#xA;      });&#xA;      let lastExpr = exprStmts.pop();&#xA;      path.node.test = lastExpr.expression;&#xA;      exprStmts.push(path.node);&#xA;      path.replaceWithMultiple(exprStmts);&#xA;    },&#xA;    ReturnStatement(path) {&#xA;      if (&#xA;        !path.node.argument ||&#xA;        path.node.argument.type != &#34;SequenceExpression&#34;&#xA;      ) {&#xA;        return;&#xA;      }&#xA;      const exprs = path.node.argument.expressions;&#xA;      let exprStmts = exprs.map((e) =&amp;gt; {&#xA;        return types.expressionStatement(e);&#xA;      });&#xA;      let lastExpr = exprStmts.pop();&#xA;      let returnStmt = types.returnStatement(lastExpr.expression);&#xA;      exprStmts.push(returnStmt);&#xA;      path.replaceWithMultiple(exprStmts);&#xA;    },&#xA;    VariableDeclaration(path) {&#xA;      // change `const a = 1, b = 2;` to `const a = 1; const b = 2;`&#xA;      if (path.node.declarations.length &amp;gt; 1) {&#xA;        let newDecls = path.node.declarations.map((d) =&amp;gt; {&#xA;          return types.variableDeclaration(path.node.kind, [d]);&#xA;        });&#xA;        path.replaceWithMultiple(newDecls);&#xA;      }&#xA;    },&#xA;  };&#xA;  traverse(ast, moduleTransformer);&#xA;  return ast;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;4. requireçš„æ¨¡å—idå–å&lt;/h3&gt; &#xA;&lt;p&gt;ç”±äºå‹ç¼©ä¹‹åçš„ä»£ç ï¼Œrequireä¾èµ–åªæœ‰moduleidï¼Œå·²ç»å¤±å»äº†åŸæ¥çš„æ–‡ä»¶åç§°ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ˜ å°„ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥å€ŸåŠ©GPTï¼‰æ¨æ–­ä¸€ä¸‹ä¸åŒæ–‡ä»¶çš„åç§°ï¼Œç»´æŠ¤ä¸€ä¸ªmapæ–‡ä»¶ï¼Œç„¶ååœ¨asté‡Œå°†æ¨¡å—idæ›¿æ¢ä¸ºæœ‰è¯­ä¹‰çš„æ¨¡å—åï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function transformRequire(ast) {&#xA;  const moduleTransformer = {&#xA;    VariableDeclaration(path) {&#xA;        if (path.node.declarations[0].init &amp;amp;&amp;amp; path.node.declarations[0].init.type === &#34;CallExpression&#34;) {&#xA;            if (path.node.declarations[0].init.callee.name === &#34;require&#34;) {&#xA;                const moduleId = path.node.declarations[0].init.arguments[0].value;&#xA;                if (NameMap[moduleId]) {&#xA;                    const { name, path: modulePath} = NameMap[moduleId];&#xA;&#xA;                    path.node.declarations[0].init.arguments[0].value = &#39;&#34;&#39;+modulePath+&#39;&#34;&#39;;&#xA;                    path.scope.rename(path.node.declarations[0].id.name, name);&#xA;                }&#xA;              }&#xA;        }&#xA;      &#xA;    },&#xA;  };&#xA;  traverse(ast, moduleTransformer);&#xA;  return ast;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è‡³æ­¤ï¼Œæˆ‘ä»¬é€†å‘ç›¸å…³çš„å‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ã€‚&lt;/p&gt; &#xA;&lt;h2&gt;å…¥å£åˆ†æ&lt;/h2&gt; &#xA;&lt;p&gt;è™½ç„¶å‰é¢æˆ‘ä»¬å·²ç»ä¸ºé€†å‘åšäº†å¤§é‡çš„å·¥ä½œï¼Œä½†å®é™…ä¸Šï¼Œé€†å‘JSä»£ç è¿˜æ˜¯ä¸€ä¸ªä½“åŠ›æ´»ï¼Œåœ¨æœ‰é™çš„ç²¾åŠ›ä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿåªèƒ½æ‰‹åŠ¨å°†ä¸€äº›ä¸Šä¸‹æ–‡å‹ç¼©å˜é‡è¿›è¡Œæ¨æ–­æ›¿æ¢ï¼Œå°½å¯èƒ½è¿˜åŸä¸€äº›æ ¸å¿ƒæ–‡ä»¶çš„ä»£ç ã€‚&lt;/p&gt; &#xA;&lt;p&gt;å…¥å£å¯ä»¥å¾ˆè½»æ˜“æ‰¾åˆ°å®ƒçš„æ¨¡å—idæ˜¯91238ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/3e853967-0df6-4443-b95c-c7e9594ed381.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;ç»è¿‡ä¸€ç³»åˆ—çš„æ‰‹åŠ¨ä¼˜åŒ–æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´è¿˜åŸè¿™ä¸ªå…¥å£æ–‡ä»¶çš„åŸå§‹æ ·è²Œï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/e9823fac-23da-474c-86ce-296bd0e9cc55.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;åœ¨VSCodeçš„activeå‡½æ•°ä¸­ï¼Œcopilotåšäº†å¤§é‡åˆå§‹åŒ–ç›¸å…³çš„å·¥ä½œï¼Œä»¥åŠå°†å„ä¸ªæ¨¡å—çš„ç¤ºä¾‹æ³¨å†Œåˆ°contextä¸­ï¼Œåç»­å–å®ä¾‹å°±ä»contextä¸Šä¸‹æ–‡æ¥å–ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æˆ‘ä»¬çš„æ ¸å¿ƒè¿˜æ˜¯æƒ³æ¢ç´¢copilotçš„ä»£ç è¡¥å…¨èƒ½åŠ›ï¼Œå…¥å£æ–‡ä»¶çš„ç»†èŠ‚åœ¨è¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚&lt;/p&gt; &#xA;&lt;h2&gt;ä»£ç æç¤ºå…¥å£é€»è¾‘&lt;/h2&gt; &#xA;&lt;p&gt;ä»£ç æç¤ºé€»è¾‘æ˜¯åœ¨&lt;code&gt;registerGhostText&lt;/code&gt;ä¸­æ³¨å†Œçš„ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/7a5b9151-3050-4daa-a46c-be52ce524450.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;åœ¨vscodeä¸­ï¼Œä¸»è¦é€šè¿‡&lt;code&gt;InlineCompletionItemProvider&lt;/code&gt;æ¥å®ç°ç¼–è¾‘å™¨ä¸­çš„ä»£ç è¡¥å…¨èƒ½åŠ›ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æ•´ä¸ªå®ç°çš„å…¥å£é€»è¾‘ç»è¿‡è¿˜åŸåå¤§è‡´å¦‚ä¸‹ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/fad4aa2b-ac0e-4fef-b2f9-881592a8aad6.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;æ•´ä½“è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œå®ƒå¤§è‡´åšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;å¦‚æœç”¨æˆ·å…³é—­äº†&lt;code&gt;InlineSuggestEnable&lt;/code&gt;ã€æˆ–è€…documentä¸åœ¨å¤„ç†ç™½åå•å†…ï¼Œæˆ–è€…ç”¨æˆ·å–æ¶ˆäº†è¾“å…¥ï¼Œéƒ½ä¼šæå‰returnï¼Œä¸è¿›è¡Œä»£ç æç¤ºã€‚&lt;/li&gt; &#xA; &lt;li&gt;è°ƒç”¨&lt;code&gt;getGhostText&lt;/code&gt;æ–¹æ³•æ‹¿åˆ°textsï¼Œè¿™ä¸ªå¤§æ¦‚å°±æ˜¯æœ€ç»ˆä¼šè¿”å›ç»™ç”¨æˆ·çš„ä»£ç æç¤ºæ–‡æœ¬ã€‚&lt;/li&gt; &#xA; &lt;li&gt;è°ƒç”¨&lt;code&gt;completionsFromGhostTextResults&lt;/code&gt;ï¼Œæ‹¿åˆ°æœ€ç»ˆçš„completionsã€‚è¿™ä¸ªå‡½æ•°æ¯”è¾ƒç®€å•ï¼Œä¸»è¦å¯¹æ–‡æœ¬è¿›è¡Œäº†ä¸€äº›æ ¼å¼åŒ–çš„å¤„ç†ï¼Œæ¯”å¦‚å¤„ç†Tabç©ºæ ¼çš„é—®é¢˜ï¼Œä»¥åŠæ ¹æ®å…‰æ ‡å½“å‰çš„ä½ç½®è®¡ç®—å‡ºä»£ç æç¤ºåº”å½“æ˜¾ç¤ºåœ¨ç¼–è¾‘å™¨ä¸­çš„åæ ‡èŒƒå›´ã€‚&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;getGhostTextæ ¸å¿ƒé€»è¾‘&lt;/h2&gt; &#xA;&lt;p&gt;getGhostTextæ˜¯è·å–æç¤ºä»£ç çš„æ ¸å¿ƒæ–¹æ³•ï¼Œæ•´ä½“ä»£ç è¾ƒå¤šï¼Œæˆ‘ä»¬å°†å…¶æ‹†åˆ†ä¸€ä¸‹ï¼š&lt;/p&gt; &#xA;&lt;h3&gt;1. æå–Prompt&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;const prompt = await extractprompt.extractPrompt(ctx, document, position);&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æå–promptæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„æ“ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å•ç‹¬æ‹†ä¸€å°èŠ‚è¯¦ç»†åˆ†æã€‚&lt;/p&gt; &#xA;&lt;h3&gt;2. è¾¹ç•Œåˆ¤æ–­&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;if (&#34;copilotNotAvailable&#34; === prompt.type) {&#xA;    exports.ghostTextLogger.debug(&#xA;      ctx,&#xA;      &#34;Copilot not available, due to the .copilotignore settings&#34;&#xA;    );&#xA;    return {&#xA;      type: &#34;abortedBeforeIssued&#34;,&#xA;      reason: &#34;Copilot not available due to the .copilotignore settings&#34;,&#xA;    };&#xA;  }&#xA;  if (&#34;contextTooShort&#34; === prompt.type) {&#xA;    exports.ghostTextLogger.debug(ctx, &#34;Breaking, not enough context&#34;);&#xA;    return {&#xA;      type: &#34;abortedBeforeIssued&#34;,&#xA;      reason: &#34;Not enough context&#34;,&#xA;    };&#xA;  }&#xA;  if (token?.isCancellationRequested) {&#xA;    exports.ghostTextLogger.info(ctx, &#34;Cancelled after extractPrompt&#34;);&#xA;    return {&#xA;      type: &#34;abortedBeforeIssued&#34;,&#xA;      reason: &#34;Cancelled after extractPrompt&#34;,&#xA;    };&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™é‡Œçš„è¾¹ç•ŒèŒƒå›´ä¸»è¦æ˜¯ä¸‰ç§æƒ…å†µï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;åŒ…å«åœ¨.copilotignoreé‡Œçš„æ–‡ä»¶&lt;/li&gt; &#xA; &lt;li&gt;ä¸Šä¸‹æ–‡å¤ªå°‘äº†&lt;/li&gt; &#xA; &lt;li&gt;ç”¨æˆ·å·²ç»å–æ¶ˆäº†&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;3. äºŒçº§ç¼“å­˜&lt;/h3&gt; &#xA;&lt;p&gt;åœ¨copilotå†…éƒ¨åšäº†ä¸¤å±‚ç¼“å­˜å¤„ç†ï¼Œç¬¬ä¸€å±‚ç¼“å­˜æ˜¯ä¿å­˜äº†ä¸Šä¸€æ¬¡çš„&lt;code&gt;prefix&lt;/code&gt;å’Œ&lt;code&gt;suffix&lt;/code&gt;ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function updateGlobalCacheKey(prefix, suffix, promptKey) {&#xA;  prefixCache = prefix;&#xA;  suffixCache = suffix;&#xA;  promptKeyCache = promptKey;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™é‡Œçš„&lt;code&gt;promptKey&lt;/code&gt;æ˜¯æ ¹æ®&lt;code&gt;prefix&lt;/code&gt;å’Œ&lt;code&gt;suffix&lt;/code&gt;çš„å†…å®¹è®¡ç®—å¾—åˆ°ã€‚åœ¨copilotå‘åå°å‘èµ·è¯·æ±‚å‰ï¼Œå¦‚æœåˆ¤æ–­è¿™æ¬¡è¯·æ±‚çš„prefixå’Œsuffixè¿˜æ˜¯å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œåˆ™ä¼šè¯»å–ç¼“å­˜çš„å†…å®¹ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/91ea686c-7696-452f-a18b-927b96243cac.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;ç´§æ¥ç€ï¼Œå¦‚æœä¸Šä¸€å±‚çš„ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œcopilotè¿˜ä¼šè®¡ç®—äºŒçº§ç¼“å­˜ï¼Œä¼šè®¡ç®—å½“å‰çš„promptåœ¨ä¸åœ¨ç¼“å­˜èŒƒå›´å†…ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/d7ff3141-d12c-4b10-89f1-c217cbe32681.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;åœ¨è¿™é‡Œï¼Œcopiloté‡‡å–çš„ç¼“å­˜æ˜¯LRUç¼“å­˜ç­–ç•¥ï¼Œprompté»˜è®¤ä¼šç¼“å­˜100æ¡ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.completionCache = new s.LRUCacheMap(100);&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è€ŒkeyForPromptå‡½æ•°å°±æ˜¯ä¸€ä¸ªå¯¹prefixå’Œsuffixçš„hashï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.keyForPrompt = function (e) {&#xA;  return r.SHA256(e.prefix + e.suffix).toString();&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;4. çœŸæ­£å‘èµ·è¯·æ±‚&lt;/h3&gt; &#xA;&lt;p&gt;åˆ°äº†çœŸæ­£åˆ°å‘åå°å‘é€promptè¯·æ±‚çš„æ—¶å€™ï¼Œcopilotè¿˜æ˜¯åšäº†ä¸¤ä»¶æ¯”è¾ƒç»†è‡´çš„äº‹æƒ…ï¼š&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;è®¾ç½®&lt;code&gt;Debounce&lt;/code&gt;æ—¶å»¶&lt;/li&gt; &#xA; &lt;li&gt;åˆ¤æ–­&lt;code&gt;contexualFilterScore&lt;/code&gt;æ˜¯å¦è¾¾åˆ°é˜ˆå€¼&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;é¦–å…ˆï¼Œä¸ºäº†é¿å…é¢‘ç¹å‘åå°å‘é€è¯·æ±‚ï¼Œcopilotåšäº†debounceï¼Œè¦çŸ¥é“æ¨¡å‹è®¡ç®—æ˜¯ååˆ†æ¶ˆè€—ç®—åŠ›çš„ï¼Œå› æ­¤åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå¿…é¡»è¦åšdebounceã€‚copilotçš„è¿™ä¸ªdebounceä¹Ÿä¸æ˜¯ä¸€èˆ¬çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„å®ç°ç»†èŠ‚ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.getDebounceLimit = async function (e, t) {&#xA;  let n;&#xA;  if ((await e.get(r.Features).debouncePredict()) &amp;amp;&amp;amp; t.measurements.contextualFilterScore) {&#xA;    const e = t.measurements.contextualFilterScore;&#xA;    const r = .3475;&#xA;    const i = 7;&#xA;    n = 25 + 250 / (1 + Math.pow(e / r, i));&#xA;  } else n = await e.get(r.Features).debounceMs();&#xA;  return n &amp;gt; 0 ? n : 75;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;copilotæœ‰ä¸€ä¸ªé¢„æµ‹å¼€å…³ï¼Œå¦‚æœè¿™ä¸ªé¢„æµ‹å¼€å…³æ‰“å¼€ï¼Œä¼šæ ¹æ®å½“å‰çš„å†…å®¹ç›¸å…³æ€§è¯„åˆ†é¢„æµ‹å½“å‰çš„debounceæ—¶å»¶ï¼Œè¿™ä¸ªå¤„ç†å°±æ¯”è¾ƒé«˜çº§äº†ã€‚å½“ç„¶åœ¨å¼€å…³æ²¡æ‰“å¼€çš„æƒ…å†µä¸‹é»˜è®¤å€¼ä¸º75msã€‚&lt;/p&gt; &#xA;&lt;p&gt;å…¶æ¬¡å°±æ˜¯&lt;code&gt;contexualFilterScore&lt;/code&gt; äº†ï¼Œè¿™ä¸ªå€¼ä»£è¡¨çš„æ˜¯ä¸Šä¸‹æ–‡çš„è¯„åˆ†ï¼Œcopilotä¼šè®°å½•ä¹‹å‰å‡ æ¬¡ä¸Šä¸‹æ–‡æœ‰æ²¡æœ‰é‡‡çº³çš„ç»“æœï¼Œè²Œä¼¼æ˜¯é€šè¿‡ä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’æ¥é¢„æµ‹å½“å‰çš„ä¸Šä¸‹æ–‡è¢«é‡‡çº³çš„å¯èƒ½æ€§ï¼Œå¦‚æœå°äºä¸€å®šçš„é˜ˆå€¼ï¼Œåˆ™ä¸ä¼šå†ç»™ç”¨æˆ·è¿›è¡Œæç¤ºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/c175e519-bb25-4781-a9a3-3ca46628e407.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;å½“å‰ç‰ˆæœ¬çš„é˜ˆå€¼åº”è¯¥æ˜¯35%ã€‚è¿™ä¸ª&lt;code&gt;contextualFilterEnable&lt;/code&gt;å¼€å…³é»˜è®¤æ˜¯æ‰“å¼€çš„ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æœ€åï¼Œå°±æ˜¯å‘åå°çœŸæ­£å‘èµ·è¯·æ±‚äº†ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/18128a56-2953-4871-ac50-fa4367b24c5f.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;5. æµç¨‹æ€»ç»“&lt;/h3&gt; &#xA;&lt;p&gt;ç”»ä¸ªå›¾æ€»ç»“ä¸€ä¸‹copilotå‘åå°å‘èµ·è¯·æ±‚ä¹‹å‰åšçš„äº‹æƒ…ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/7653b58f-20d4-405e-bd88-744a6c622999.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Extractæ ¸å¿ƒé€»è¾‘&lt;/h2&gt; &#xA;&lt;p&gt;Extracté¦–å±‚é€»è¾‘å…¶å®å¹¶ä¸å¤æ‚ï¼Œæœ€ç»ˆè¿”å›äº†promptå¯¹è±¡ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/6913fceb-3f73-4381-a906-1d6ccde0a896.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;ä¸Šå›¾ä¸­ç”¨çº¢æ¡†æ ‡å‡ºçš„å­—æ®µæ¥æºäºé…ç½®ï¼Œå…¶ä»–çš„å­—æ®µæ¥è‡ªäº&lt;code&gt;getPrompt&lt;/code&gt;æ–¹æ³•çš„è¿”å›ï¼ŒgetPromptæ˜¯è·å–promptçš„æ ¸å¿ƒé€»è¾‘ï¼Œè¿™å—æˆ‘ä»¬æ¥ä¸‹æ¥å•ç‹¬å±•å¼€è®¨è®ºï¼Œå…ˆæ¥çœ‹çœ‹é…ç½®çš„é—®é¢˜ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨copilotï¼ˆVSCodeï¼‰ä½“ç³»ä¸­ï¼Œæœ‰å¾ˆå¤šé…ç½®æ˜¯å¯¹æ¥äº†å¾®è½¯çš„ABå®éªŒå¹³å°çš„ï¼Œå¯ä»¥åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°è¿™æ ·çš„æ¨¡å—ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;async fetchExperiments(e, t) {&#xA;      const n = e.get(r.Fetcher);&#xA;      let o;&#xA;      try {&#xA;        o = await n.fetch(&#34;https://default.exp-tas.com/vscode/ab&#34;, {&#xA;          method: &#34;GET&#34;,&#xA;          headers: t&#xA;        });&#xA;      } catch (t) {&#xA;        return i.ExpConfig.createFallbackConfig(e, `Error fetching ExP config: ${t}`);&#xA;      }&#xA;      if (!o.ok) return i.ExpConfig.createFallbackConfig(e, `ExP responded with ${o.status}`);&#xA;      const s = await o.json(),&#xA;        a = s.Configs.find(e =&amp;gt; &#34;vscode&#34; === e.Id) ?? {&#xA;          Id: &#34;vscode&#34;,&#xA;          Parameters: {}&#xA;        },&#xA;        c = Object.entries(a.Parameters).map(([e, t]) =&amp;gt; e + (t ? &#34;&#34; : &#34;cf&#34;));&#xA;      return new i.ExpConfig(a.Parameters, s.AssignmentContext, c.join(&#34;;&#34;));&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™ä¸ªå°±æ˜¯æ‹‰å–äº†abå®éªŒçš„å¹³å°ï¼Œå¾ˆå¤šç‰¹æ€§å¼€å…³éƒ½æ˜¯é€šè¿‡é…ç½®ä¸‹å‘ï¼Œcopilotçš„ç›¸å…³é…ç½®ä¹Ÿä¸ä¾‹å¤–ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™äº›é…ç½®åœ¨å¹³å°æ²¡æœ‰æŒ‡å®šçš„æ—¶å€™ï¼Œéƒ½æ˜¯ä»¥å®ƒçš„é»˜è®¤å€¼ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ç»è¿‡æˆ‘å®é™…æŠ“åŒ…ï¼Œå‘ç°æˆ‘çš„Copilotæ’ä»¶é…ç½®å¥½åƒæ²¡æœ‰ç»è¿‡é…ç½®å¹³å°å•ç‹¬æŒ‡å®šï¼Œå› æ­¤æ•´ä¸ªå­—æ®µåº”è¯¥å–çš„é»˜è®¤å€¼ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;suffixPercent&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º15.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;fimSuffixLengthThreshold&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º0&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;maxPromptCompletionTokens&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º2048&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;neighboringTabsOption&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºeager&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;neighboringSnippetTypes&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºNeighboringSnippets&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;numberOfSnippets&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º4&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;snippetPercent&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º0&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;suffixStartMode&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºCursorTrimStart&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;tokenizerNameï¼Œ&lt;/code&gt; é»˜è®¤å€¼ä¸ºcushman002&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;indentationMinLength&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºundefined&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;indentationMaxLength&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºundefined&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;cursorContextFix&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºfalse&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;è¿™äº›ä¼šä½œä¸ºPromptçš„åŸºç¡€é…ç½®å­—æ®µä¼ ç»™getPromptæ–¹æ³•ã€‚&lt;/p&gt; &#xA;&lt;h2&gt;getPromptæ ¸å¿ƒé€»è¾‘&lt;/h2&gt; &#xA;&lt;h3&gt;ä¸€äº›é¢å¤–çš„é…ç½®å­—æ®µ&lt;/h3&gt; &#xA;&lt;p&gt;åœ¨getPrompté€»è¾‘é‡Œï¼Œé¦–å…ˆæ‰©å……äº†ä¸€ç³»åˆ—é…ç½®å­—æ®µï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;languageMarker&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºTop&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;pathMarker&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºTop&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;localImportContext&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºDeclarations&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;snippetPosition&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºTopOfText&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;lineEnding&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸ºConvertToUnix&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;suffixMatchThreshold&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º0&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;suffixMatchCriteria&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º&lt;code&gt;Levenshtein&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;cursorSnippetsPickingStrategy&lt;/code&gt;ï¼Œé»˜è®¤å€¼ä¸º&lt;code&gt;CursorJaccard&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;promptçš„ç»„æˆ&lt;/h3&gt; &#xA;&lt;p&gt;åœ¨Copilotä¸­ï¼Œpromptæ˜¯ç”±å¤šç§ç±»å‹ç»„åˆè€Œæˆï¼Œå¯ä»¥åœ¨PromptElementKindä¸­æ‰¾åˆ°ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;BeforeCursor&lt;/code&gt;ï¼Œæ˜¯å…‰æ ‡å‰çš„å†…å®¹&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;AfterCursor&lt;/code&gt;ï¼Œæ˜¯å…‰æ ‡åçš„å†…å®¹&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;SimilarFile&lt;/code&gt;ï¼Œä¸å½“å‰æ–‡ä»¶ç›¸ä¼¼åº¦è¾ƒé«˜çš„å†…å®¹&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;ImportedFile&lt;/code&gt;ï¼šimportä¾èµ–&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;LanguageMarkder&lt;/code&gt;ï¼Œæ–‡ä»¶å¼€å¤´çš„æ ‡è®°è¯­æ³•&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;PathMarker&lt;/code&gt;ï¼Œæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;PromptElementçš„ä¼˜å…ˆçº§&lt;/h3&gt; &#xA;&lt;p&gt;Copilotå®ç°äº†ä¸€ä¸ªä¼˜å…ˆçº§çš„è¾…åŠ©ç±»ï¼Œç”¨æ¥è®¾ç½®ä¸åŒç±»å‹çš„Elementä¼˜å…ˆçº§ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;class Priorities {&#xA;  constructor() {&#xA;    this.registeredPriorities = [0, 1];&#xA;  }&#xA;  register(e) {&#xA;    if (e &amp;gt; Priorities.TOP || e &amp;lt; Priorities.BOTTOM) throw new Error(&#34;Priority must be between 0 and 1&#34;);&#xA;    this.registeredPriorities.push(e);&#xA;    return e;&#xA;  }&#xA;  justAbove(...e) {&#xA;    const t = Math.max(...e);&#xA;    const n = Math.min(...this.registeredPriorities.filter(e =&amp;gt; e &amp;gt; t));&#xA;    return this.register((n + t) / 2);&#xA;  }&#xA;  justBelow(...e) {&#xA;    const t = Math.min(...e);&#xA;    const n = Math.max(...this.registeredPriorities.filter(e =&amp;gt; e &amp;lt; t));&#xA;    return this.register((n + t) / 2);&#xA;  }&#xA;  between(e, t) {&#xA;    if (this.registeredPriorities.some(n =&amp;gt; n &amp;gt; e &amp;amp;&amp;amp; n &amp;lt; t) || !this.registeredPriorities.includes(e) || !this.registeredPriorities.includes(t)) throw new Error(&#34;Priorities must be adjacent in the list of priorities&#34;);&#xA;    return this.register((e + t) / 2);&#xA;  }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å¯ä»¥çœ‹åˆ°justAboveå’ŒjustBelowï¼Œå°±æ˜¯ç”Ÿæˆä¸€ä¸ªæ¯”ä¼ å…¥ä¼˜å…ˆçº§ç•¥é«˜æˆ–ç•¥ä½çš„ä¼˜å…ˆçº§ï¼Œä¿è¯è¿™ä¸ªä¼˜å…ˆçº§åœ¨ç›®å‰çš„æƒ…å†µä¸‹åªæ¯”ä¼ å…¥çš„ä¼˜å…ˆçº§é«˜æˆ–ä½ä¸€ç‚¹ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨Copilotä¸­ï¼Œä¸åŒç±»å‹çš„ä¼˜å…ˆçº§æ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;const beforeCursorPriority = priorities.justBelow(p.Priorities.TOP);&#xA;  const languageMarkerPriority =&#xA;    promptOpts.languageMarker === h.Always&#xA;      ? priorities.justBelow(p.Priorities.TOP)&#xA;      : priorities.justBelow(beforeCursorPriority);&#xA;  const pathMarkerPriority =&#xA;    promptOpts.pathMarker === f.Always ? priorities.justBelow(p.Priorities.TOP) : priorities.justBelow(beforeCursorPriority);&#xA;  const importedFilePriority = priorities.justBelow(beforeCursorPriority);&#xA;  const lowSnippetPriority = priorities.justBelow(importedFilePriority);&#xA;  const highSnippetPriority = priorities.justAbove(beforeCursorPriority);&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™é‡Œå¯ä»¥ç®€å•æ¨æ–­ä¸€ä¸‹ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;beforeCursorPriority&lt;/code&gt;ï¼Œä¸º0.5&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;languageMarkerPriority&lt;/code&gt;ï¼Œä¸º0.25&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;pathMarkderPriority&lt;/code&gt;ï¼Œä¸º0.375&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;importedFilePriority&lt;/code&gt;ï¼Œä¸º0.4375&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;lowSnippetPriority&lt;/code&gt;ï¼Œä¸º0.40625&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;highSnippetPriority&lt;/code&gt;ï¼Œä¸º0.75&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;æ‰€ä»¥åœ¨é»˜è®¤çš„åœºæ™¯ä¸‹ï¼Œè¿™å‡ ç§ç±»å‹çš„ä¼˜å…ˆçº§æ’åºä¸ºï¼š&lt;code&gt;highSnippetPriority&lt;/code&gt; &amp;gt; &lt;code&gt;beforeCursorPriority&lt;/code&gt; &amp;gt; &lt;code&gt;importedFilePriority&lt;/code&gt; &amp;gt; &lt;code&gt;lowSnippetPriority&lt;/code&gt; &amp;gt; &lt;code&gt;pathMarkderPriority&lt;/code&gt; &amp;gt; &lt;code&gt;languageMarkerPriority&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h3&gt;PromptElementä¸»è¦å†…å®¹&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;languageMarkerå’ŒpathMarker&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;languageMarkerå’ŒpathMarkeræ˜¯æœ€å…ˆè¢«æ”¾è¿›promptWishListä¸­çš„ï¼Œç»è¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“åœ¨é…ç½®ä¸­ï¼ŒlanguageMarkerå’ŒpathMarkeréƒ½æ˜¯æœ‰é»˜è®¤å€¼çš„ï¼Œå› æ­¤ä¸‹é¢çš„åˆ¤æ–­åˆ†æ”¯ä¸€å®šä¼šèµ°åˆ°ï¼š&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;  if (promptOpts.languageMarker !== h.NoMarker) {&#xA;      const e = newLineEnded(r.getLanguageMarker(resourceInfo));&#xA;      languageMarkerId = promptWishlist.append(e, p.PromptElementKind.LanguageMarker, languageMarkerPriority);&#xA;    }&#xA;    if (promptOpts.pathMarker !== f.NoMarker) {&#xA;      const e = newLineEnded(r.getPathMarker(resourceInfo));&#xA;      if (e.length &amp;gt; 0) {&#xA;        pathMarkerId = promptWishlist.append(e, p.PromptElementKind.PathMarker, pathMarkerPriority);&#xA;      }&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;è¿™ä¸¤ä¸ªå‡½æ•°å®ç°ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹getLanguageMarkerï¼š&#xA;&#xA;```jsx&#xA;exports.getLanguageMarker = function (e) {&#xA;  const {&#xA;    languageId: t&#xA;  } = e;&#xA;  return -1 !== n.indexOf(t) || hasLanguageMarker(e) ? &#34;&#34; : t in r ? r[t] : comment(`Language: ${t}`, t);&#xA;};&#xA;```&#xA;&#xA;è¿™é‡Œé¦–å…ˆç¡®è®¤äº†languageIdï¼Œä¸åœ¨ignoreListå½“ä¸­ï¼Œåœ¨copilotä¸­ï¼Œæœ‰ä¸¤ç§è¯­è¨€æ˜¯è¢«æ’é™¤åœ¨å¤–çš„ï¼š&#xA;&#xA;```jsx&#xA;const n = [&#34;php&#34;, &#34;plaintext&#34;];&#xA;```&#xA;&#xA;å…¶æ¬¡å†çœ‹ä¸€ä¸‹è¯­è¨€æœ¬èº«æ˜¯å¦æœ‰æ ‡è®°è¯­æ³•ï¼Œåœ¨è¿™ä¸ªMapä¸­ï¼ˆHTMLã€Pythonã€Rubyã€Shellã€YAMLï¼‰ï¼š&#xA;&#xA;```jsx&#xA;const r = {&#xA;  html: &#34;&amp;lt;!DOCTYPE html&amp;gt;&#34;,&#xA;  python: &#34;#!/usr/bin/env python3&#34;,&#xA;  ruby: &#34;#!/usr/bin/env ruby&#34;,&#xA;  shellscript: &#34;#!/bin/sh&#34;,&#xA;  yaml: &#34;# YAML data&#34;&#xA;};&#xA;```&#xA;&#xA;å…¶ä½™çš„æƒ…å†µå°±è¿”å›ä¸€è¡Œæ³¨é‡Šï¼Œç±»ä¼¼è¿™æ ·ï¼š&#xA;&#xA;```jsx&#xA;// Language: ${languageId}&#xA;```&#xA;&#xA;getPathMarkeré€»è¾‘æ›´ç®€å•äº›ï¼Œåªæ˜¯ä¸€è¡Œæ³¨é‡Šï¼Œæ ‡æ˜æ–‡ä»¶è·¯å¾„ï¼ˆæš‚æ—¶æä¸æ¸…æ¥šè¿™ä¸ªä¿¡æ¯ç»™æ¨¡å‹æœ‰ä»€ä¹ˆç”¨ï¼Œå¯èƒ½è·¯å¾„é‡Œé¢åŒ…å«äº†ç›®å½•ç»“æ„ä¿¡æ¯å’Œæ–‡ä»¶åå¸®åŠ©æ¨¡å‹æ›´å¥½è¿›è¡Œæ¨æ–­ï¼Ÿï¼‰ï¼š&#xA;&#xA;```jsx&#xA;exports.getPathMarker = function (e) {&#xA;  return e.relativePath ? comment(`Path: ${e.relativePath}`, e.languageId) : &#34;&#34;;&#xA;};&#xA;```&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol start=&#34;2&#34;&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;localImportContext&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;localImportContextçš„å®ç°è¦å¤æ‚ä¸€ç‚¹ï¼Œé€šè¿‡ä¸Šé¢çš„é…ç½®æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¹Ÿæ˜¯é»˜è®¤æœ‰å€¼çš„ï¼Œä¼šè¿›åˆ°ä¸‹é¢è¿™ä¸ªåˆ†æ”¯å½“ä¸­ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;if (promptOpts.localImportContext !== y.NoContext)&#xA;    for (const e of await i.extractLocalImportContext(resourceInfo, promptOpts.fs))&#xA;      promptWishlist.append(newLineEnded(e), p.PromptElementKind.ImportedFile, importedFilePriority);&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;extractLocalImportContextæ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™é‡Œé¢çš„å®ç°ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;const reg = /^\s*import\s*(type|)\s*\{[^}]*\}\s*from\s*[&#39;&#34;]\./gm;&#xA;  exports.extractLocalImportContext = async function (resourceInfo, fs) {&#xA;    let {&#xA;      source: source,&#xA;      uri: uri,&#xA;      languageId: languageId&#xA;    } = resourceInfo;&#xA;    return fs &amp;amp;&amp;amp; &#34;typescript&#34; === languageId ? async function (source, uri, fs) {&#xA;      let language = &#34;typescript&#34;;&#xA;      let result = [];&#xA;      const importEndIndex = function (source) {&#xA;        let match;&#xA;        let lastIndex = -1;&#xA;        reg.lastIndex = -1;&#xA;        do {&#xA;            match = reg.exec(source);&#xA;          if (match) {&#xA;            lastIndex = reg.lastIndex + match.length;&#xA;          }&#xA;        } while (match);&#xA;        if (-1 === lastIndex) return -1;&#xA;        const nextNewLine = source.indexOf(&#34;\n&#34;, lastIndex);&#xA;        return -1 !== nextNewLine ? nextNewLine : source.length;&#xA;      }(source);&#xA;      if (-1 === importEndIndex) return result;&#xA;      source = source.substring(0, importEndIndex);&#xA;      let ast = await i.parseTreeSitter(language, source);&#xA;      try {&#xA;        for (let node of function (node) {&#xA;          let t = [];&#xA;          for (let childNode of node.namedChildren) if (&#34;import_statement&#34; === childNode.type) {&#xA;            t.push(childNode);&#xA;          }&#xA;          return t;&#xA;        }(ast.rootNode)) {&#xA;          let filePath = getTSFilePath(uri, node);&#xA;          if (!filePath) continue;&#xA;          let namedImports = parseNamedImport(node);&#xA;          if (0 === namedImports.length) continue;&#xA;          let exports = await getExports(filePath, language, fs);&#xA;          for (let e of namedImports) if (exports.has(e.name)) {&#xA;            result.push(...exports.get(e.name));&#xA;          }&#xA;        }&#xA;      } finally {&#xA;        ast.delete();&#xA;      }&#xA;      return result;&#xA;    }(source, uri, fs) : [];&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;é¦–å…ˆæˆ‘ä»¬å¯ä»¥å…³æ³¨åˆ°çš„æ˜¯ï¼Œè¿™ä¸ªå‡½æ•°å…ˆåˆ¤æ–­äº†Typescriptçš„è¯­è¨€ï¼Œä¹Ÿå°±æ„å‘³ç€å½“å‰ç‰ˆæœ¬çš„Copilotï¼Œåªå¯¹tsæ–‡ä»¶çš„importä¾èµ–åšäº†å¤„ç†ã€‚&lt;/p&gt; &lt;p&gt;è¿™ä¸ªå‡½æ•°ä¹‹æ‰€ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œå°±æ˜¯è¿™é‡Œè¦æ‹¿åˆ°importè¯­å¥çš„è¯­æ³•æ ‘ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œcopilotæ˜¯ä½¿ç”¨äº†wasmçš„æ–¹å¼ï¼Œé€šè¿‡tree-sitteræ¥è§£æè¯­æ³•æ ‘çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚&lt;/p&gt; &lt;p&gt;æœ€åï¼Œcopilotæå–å‡ºæ‰€æœ‰çš„importï¼Œå¹¶ä¸”è¿”å›äº†æ‰€æœ‰named importå¯¹åº”çš„exportä»£ç ï¼Œä¹Ÿå°±æ˜¯æœ€ç»ˆç´¢å¼•åˆ°äº†ä¾èµ–æ–‡ä»¶ï¼Œå°†ç”¨åˆ°çš„exportéƒ½ä½œä¸ºä¸Šä¸‹æ–‡extractå‡ºæ¥ã€‚&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;snippets&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;snippetsçš„å¤„ç†æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œåœ¨Copilotä¸­ï¼Œé¦–å…ˆæ‹¿åˆ°äº†ä¸€ä¸ªsnippetsï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;const snippets = [&#xA;    ...retrievalSnippets,&#xA;    ...(promptOpts.neighboringTabs === a.NeighboringTabsOption.None || 0 === neighborDocs.length&#xA;      ? []&#xA;      : await a.getNeighborSnippets(&#xA;          resourceInfo,&#xA;          neighborDocs,&#xA;          promptOpts.neighboringSnippetTypes,&#xA;          promptOpts.neighboringTabs,&#xA;          promptOpts.cursorContextFix,&#xA;          promptOpts.indentationMinLength,&#xA;          promptOpts.indentationMaxLength,&#xA;          promptOpts.snippetSelection,&#xA;          promptOpts.snippetSelectionK,&#xA;          lineCursorHistory,&#xA;          promptOpts.cursorSnippetsPickingStrategy&#xA;        )),&#xA;  ];&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;åœ¨é»˜è®¤çš„åœºæ™¯ä¸‹ï¼Œ&lt;code&gt;retrievalSnippets&lt;/code&gt;æ˜¯ç©ºçš„ï¼Œè€Œ&lt;code&gt;neighboringTabs&lt;/code&gt;åœ¨æˆ‘ä»¬å‰é¢çš„åˆ†æä¸­æ˜¯&lt;code&gt;eager&lt;/code&gt;ï¼Œæ‰€ä»¥ä¼šé€šè¿‡&lt;code&gt;getNeighborSnippets&lt;/code&gt;å»æ‹¿åˆ°è¿™ä¸ªæ•°ç»„ã€‚&lt;/p&gt; &lt;p&gt;æ³¨æ„è¿™é‡Œä¼ å…¥äº†&lt;code&gt;neighborDocs&lt;/code&gt;ï¼Œè¿™ä¸ªæ˜¯åœ¨extractçš„å…¥å£å°±ä¼ è¿‡æ¥çš„ï¼Œå¯¹åº”çš„ä»£ç æ˜¯ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;let neighborDocs = [];&#xA;      let neighborSource = new Map();&#xA;      try {&#xA;        const t = await u.NeighborSource.getNeighborFiles(ctx, uri, repoUserData);&#xA;        neighborDocs = t.docs;&#xA;        neighborSource = t.neighborSource;&#xA;      } catch (t) {&#xA;        telemetry.telemetryException(ctx, t, &#34;prompt.getPromptForSource.exception&#34;);&#xA;      }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œæ‹¿åˆ°çš„fileTypeæ˜¯&lt;code&gt;OpenTabs&lt;/code&gt;ï¼Œæ‰€ä»¥ä¼šé»˜è®¤é€šè¿‡VSCodeæ‹¿åˆ°ç›®å‰æ‰“å¼€çš„tabä¸­ï¼ŒåŒ…å«åŒç±»å‹è¯­è¨€æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹(æŒ‰è®¿é—®æ—¶é—´æ’åº)ï¼Œå¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.OpenTabFiles = class {&#xA;  constructor(e, t) {&#xA;    this.docManager = e;&#xA;    this.neighboringLanguageType = t;&#xA;  }&#xA;  async truncateDocs(e, t, n, r) {&#xA;    const o = [];&#xA;    let s = 0;&#xA;    for (const a of e) if (!(s + a.getText().length &amp;gt; i.NeighborSource.MAX_NEIGHBOR_AGGREGATE_LENGTH) &amp;amp;&amp;amp; (&#34;file&#34; == a.uri.scheme &amp;amp;&amp;amp; a.fileName !== t &amp;amp;&amp;amp; i.considerNeighborFile(n, a.languageId, this.neighboringLanguageType) &amp;amp;&amp;amp; (o.push({&#xA;      uri: a.uri.toString(),&#xA;      relativePath: await this.docManager.getRelativePath(a),&#xA;      languageId: a.languageId,&#xA;      source: a.getText()&#xA;    }), s += a.getText().length), o.length &amp;gt;= r)) break;&#xA;    return o;&#xA;  }&#xA;  async getNeighborFiles(e, t, n, o) {&#xA;    let s = [];&#xA;    const a = new Map();&#xA;    s = await this.truncateDocs(utils2.sortByAccessTimes(this.docManager.textDocuments), e.fsPath, n, o);&#xA;    a.set(i.NeighboringFileType.OpenTabs, s.map(e =&amp;gt; e.uri));&#xA;    return {&#xA;      docs: s,&#xA;      neighborSource: a&#xA;    };&#xA;  }&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;æ¥ç€æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹&lt;code&gt;getNeighborSnippets&lt;/code&gt;çš„å®ç°ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.getNeighborSnippets = async function (&#xA;  resourceInfo,&#xA;  neighborDocs,&#xA;  neighboringSnippetTypes,&#xA;  neighboringTabs,&#xA;  cursorContextFix,&#xA;  indentationMinLength,&#xA;  indentationMaxLength,&#xA;  snippetSelection,&#xA;  snippetSelectionK,&#xA;  lineCursorHistory,&#xA;  cursorSnippetsPickingStrategy&#xA;) {&#xA;  const options = {&#xA;    ...exports.neighborOptionToSelection[neighboringTabs],&#xA;  };&#xA;  const y = (function (&#xA;    resourceInfo,&#xA;    neighboringSnippetTypes,&#xA;    options,&#xA;    cursorContextFix,&#xA;    indentationMinLength,&#xA;    indentationMaxLength,&#xA;    lineCursorHistory,&#xA;    cursorSnippetsPickingStrategy = i.CursorSnippetsPickingStrategy&#xA;      .CursorJaccard&#xA;  ) {&#xA;    let d;&#xA;    if (neighboringSnippetTypes === s.NeighboringSnippets) {&#xA;      d =&#xA;        void 0 !== indentationMinLength &amp;amp;&amp;amp; void 0 !== indentationMaxLength&#xA;          ? o.IndentationBasedJaccardMatcher.FACTORY(&#xA;              indentationMinLength,&#xA;              indentationMaxLength,&#xA;              cursorContextFix&#xA;            )&#xA;          : o.FixedWindowSizeJaccardMatcher.FACTORY(&#xA;              options.snippetLength,&#xA;              cursorContextFix&#xA;            );&#xA;    } else {&#xA;      if (neighboringSnippetTypes === s.NeighboringFunctions) {&#xA;        d = o.FunctionJaccardMatcher.FACTORY(&#xA;          options.snippetLength,&#xA;          cursorContextFix,&#xA;          indentationMinLength,&#xA;          indentationMaxLength&#xA;        );&#xA;      } else {&#xA;        r.ok(&#xA;          void 0 !== lineCursorHistory,&#xA;          &#34;lineCursorHistory should not be undefined&#34;&#xA;        );&#xA;        d = i.CursorHistoryMatcher.FACTORY(&#xA;          options.snippetLength,&#xA;          lineCursorHistory,&#xA;          cursorSnippetsPickingStrategy,&#xA;          cursorContextFix&#xA;        );&#xA;      }&#xA;    }&#xA;    return d.to(resourceInfo);&#xA;  })(&#xA;    resourceInfo,&#xA;    neighboringSnippetTypes,&#xA;    options,&#xA;    cursorContextFix,&#xA;    indentationMinLength,&#xA;    indentationMaxLength,&#xA;    lineCursorHistory,&#xA;    cursorSnippetsPickingStrategy&#xA;  );&#xA;  return 0 === options.numberOfSnippets&#xA;    ? []&#xA;    : (&#xA;        await neighborDocs&#xA;          .filter((e) =&amp;gt; e.source.length &amp;lt; 1e4 &amp;amp;&amp;amp; e.source.length &amp;gt; 0)&#xA;          .slice(0, 20)&#xA;          .reduce(&#xA;            async (e, t) =&amp;gt;&#xA;              (&#xA;                await e&#xA;              ).concat(&#xA;                (&#xA;                  await y.findMatches(t, snippetSelection, snippetSelectionK)&#xA;                ).map((e) =&amp;gt; ({&#xA;                  relativePath: t.relativePath,&#xA;                  ...e,&#xA;                }))&#xA;              ),&#xA;            Promise.resolve([])&#xA;          )&#xA;      )&#xA;        .filter((e) =&amp;gt; e.score &amp;amp;&amp;amp; e.snippet &amp;amp;&amp;amp; e.score &amp;gt; options.threshold)&#xA;        .sort((e, t) =&amp;gt; e.score - t.score)&#xA;        .slice(-options.numberOfSnippets);&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;neighboringSnippetTypesé»˜è®¤ä¸ºNeighboringSnippetsï¼Œæ‰€ä»¥ä¼šèµ°åˆ°&lt;code&gt;FixedWindowSizeJaccardMatcher&lt;/code&gt;çš„é€»è¾‘é‡Œ&lt;/li&gt; &#xA;   &lt;li&gt;è¿”å›å€¼æ˜¯æ ¹æ®neighborDocsçš„å†…å®¹ï¼Œè¿‡æ»¤æ‰è¿‡å°å’Œè¿‡å¤§æ–‡ä»¶ï¼Œç»è¿‡findMatchersæ‹¿åˆ°çš„ç»“æœ&lt;/li&gt; &#xA;   &lt;li&gt;æœ€åè¿‡æ»¤æ‰scoreè¾ƒä½çš„ï¼Œä¸è¿‡thresholdé»˜è®¤ä¸º0ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥ä¿ç•™äº†æ‰€æœ‰çš„å†…å®¹&lt;/li&gt; &#xA;   &lt;li&gt;æ ¹æ®scoreè¿›è¡Œæ’åºï¼Œé€‰å–è¾ƒå¤§çš„4æ¡ï¼ˆnumberOfSnippetsé»˜è®¤ä¸º4ï¼‰&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;p&gt;ç´§æ¥ç€æˆ‘ä»¬å°±æ¥çœ‹çœ‹&lt;code&gt;FixedWindowSizeJaccardMatcher&lt;/code&gt;çš„é€»è¾‘ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;class FixedWindowSizeJaccardMatcher extends i.WindowedMatcher {&#xA;    constructor(resourceInfo, snippetLength, cursorContextFix) {&#xA;      super(resourceInfo, cursorContextFix);&#xA;      this.windowLength = snippetLength;&#xA;      this.cursorContextFix = cursorContextFix;&#xA;    }&#xA;    id() {&#xA;      return &#34;fixed:&#34; + this.windowLength;&#xA;    }&#xA;    getWindowsDelineations(e) {&#xA;      return o.getBasicWindowDelineations(this.windowLength, e);&#xA;    }&#xA;    trimDocument(e) {&#xA;      return e.source.slice(0, e.offset).split(&#34;\n&#34;).slice(-this.windowLength).join(&#34;\n&#34;);&#xA;    }&#xA;    _getCursorContextInfo(e) {&#xA;      return r.getCursorContext(e, {&#xA;        maxLineCount: this.windowLength,&#xA;        cursorContextFix: this.cursorContextFix&#xA;      });&#xA;    }&#xA;    similarityScore(e, t) {&#xA;      return computeScore(e, t);&#xA;    }&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;è¿™é‡Œçš„&lt;code&gt;snippetLength&lt;/code&gt; åœ¨eagerçš„æƒ…å†µä¸‹é»˜è®¤ä¸º60ï¼Œä¹Ÿå°±æ„å‘³ç€snippetæœ€å¤šä¸è¶…è¿‡60è¡Œã€‚&lt;/p&gt; &lt;p&gt;è¿™ä¸ªç±»ç»§æ‰¿äº†&lt;code&gt;WindowedMatcher&lt;/code&gt;ï¼ŒfindMatcheså°±åœ¨WindowedMatcheré‡Œï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;async findMatches(e, t = i.SnippetSelectionOption.BestMatch, n) {&#xA;      if (t == i.SnippetSelectionOption.BestMatch) {&#xA;        const t = await this.findBestMatch(e);&#xA;        return t ? [t] : [];&#xA;      }&#xA;      return t == i.SnippetSelectionOption.TopK &amp;amp;&amp;amp; (await this.findTopKMatches(e, n)) || [];&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;åœ¨è¿™é‡Œç¬¬äºŒä¸ªå‚æ•°å…¶å®é»˜è®¤æ˜¯undefinedï¼Œæ‰€ä»¥é»˜è®¤èµ°åˆ°BestMatchçš„åˆ†æ”¯ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;async findBestMatch(e) {&#xA;      if (0 === e.source.length || 0 === this.referenceTokens.size) return;&#xA;      const t = e.source.split(&#34;\n&#34;);&#xA;      const n = this.retrieveAllSnippets(e, s.Descending);&#xA;      return 0 !== n.length &amp;amp;&amp;amp; 0 !== n[0].score ? {&#xA;        snippet: t.slice(n[0].startLine, n[0].endLine).join(&#34;\n&#34;),&#xA;        semantics: o.SnippetSemantics.Snippet,&#xA;        provider: o.SnippetProvider.NeighboringTabs,&#xA;        ...n[0]&#xA;      } : void 0;&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å¯ä»¥çœ‹åˆ°æ‰€è°“BestMatchï¼Œå°±æ˜¯å–å‡º&lt;code&gt;retrieveAllSnippets&lt;/code&gt; çš„ç¬¬0æ¡ç»“æœä½œä¸ºsnippetè¿”å›ã€‚&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;retrieveAllSnippets(e, t = s.Descending) {&#xA;      const n = [];&#xA;      if (0 === e.source.length || 0 === this.referenceTokens.size) return n;&#xA;      const sourceArr = e.source.split(&#34;\n&#34;);&#xA;      const key = this.id() + &#34;:&#34; + e.source;&#xA;      const result = c.get(key) ?? [];&#xA;      const noCache = 0 == result.length;&#xA;      const tokens = noCache ? sourceArr.map(this.tokenizer.tokenize, this.tokenizer) : [];&#xA;      for (const [index, [startLine, endLine]] of this.getWindowsDelineations(sourceArr).entries()) {&#xA;        if (noCache) {&#xA;          const e = new Set();&#xA;          tokens.slice(startLine, endLine).forEach(t =&amp;gt; t.forEach(e.add, e));&#xA;          result.push(e);&#xA;        }&#xA;        const r = result[index];&#xA;        const s = this.similarityScore(r, this.referenceTokens);&#xA;        n.push({&#xA;          score: s,&#xA;          startLine: startLine,&#xA;          endLine: endLine&#xA;        });&#xA;      }&#xA;      if (noCache) {&#xA;        c.put(key, result);&#xA;      }&#xA;      return this.sortScoredSnippets(n, t);&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;è¿™æ®µä»£ç çš„æ ¸å¿ƒæ˜¯æ ¹æ®çª—å£è®¡ç®—å‡ºä¸åŒçš„ä»£ç ç‰‡æ®µä¸å½“å‰æ–‡ä»¶çš„ç›¸ä¼¼åº¦ï¼Œå¹¶è¿”å›æ’åºåçš„ç‰‡æ®µåˆ—è¡¨ã€‚&lt;/p&gt; &lt;p&gt;é¦–å…ˆè¿™é‡Œåšäº†ä¸ªç¼“å­˜å¤„ç†ï¼Œç”¨æ¥ç¼“å­˜å·²ç»è®¡ç®—è¿‡ç›¸ä¼¼åº¦çš„ä»£ç ï¼›&lt;/p&gt; &lt;p&gt;ç„¶åæˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸‹è¿™é‡Œçš„å‡ ä¸ªé€»è¾‘ï¼š&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;ç»è¿‡tokenizeè·å–åˆ°å½“å‰ä»£ç ç‰‡æ®µæ¯ä¸€è¡Œçš„token&lt;/li&gt; &#xA;   &lt;li&gt;é€šè¿‡getWindowsDelineationså°†ä»£ç åˆ†å‰²æˆä¸åŒçš„å°çª—å£ï¼ˆæ­¥é•¿ä¸º1ï¼‰&lt;/li&gt; &#xA;   &lt;li&gt;æ¯ä¸ªçª—å£çš„tokenå’Œå½“å‰æ–‡ä»¶ï¼ˆreferenceDocï¼‰çš„tokenåšä¸€æ¬¡ç›¸ä¼¼åº¦è®¡ç®—ï¼ˆ&lt;code&gt;Jaccard&lt;/code&gt;ç›¸ä¼¼åº¦ï¼‰&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;p&gt;è¿™ä¸‰ä¸ªç‚¹éƒ½éå¸¸å…³é”®ï¼Œæˆ‘ä»¬å±•å¼€æ¥åˆ†æä¸‹ï¼š&lt;/p&gt; &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt; &lt;p&gt;&lt;strong&gt;tokenizeè®¡ç®—æ¯ä¸€è¡Œçš„token&lt;/strong&gt;&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;const p = new Set([&#34;we&#34;, &#34;our&#34;, &#34;you&#34;, &#34;it&#34;, &#34;its&#34;, &#34;they&#34;, &#34;them&#34;, &#34;their&#34;, &#34;this&#34;, &#34;that&#34;, &#34;these&#34;, &#34;those&#34;, &#34;is&#34;, &#34;are&#34;, &#34;was&#34;, &#34;were&#34;, &#34;be&#34;, &#34;been&#34;, &#34;being&#34;, &#34;have&#34;, &#34;has&#34;, &#34;had&#34;, &#34;having&#34;, &#34;do&#34;, &#34;does&#34;, &#34;did&#34;, &#34;doing&#34;, &#34;can&#34;, &#34;don&#34;, &#34;t&#34;, &#34;s&#34;, &#34;will&#34;, &#34;would&#34;, &#34;should&#34;, &#34;what&#34;, &#34;which&#34;, &#34;who&#34;, &#34;when&#34;, &#34;where&#34;, &#34;why&#34;, &#34;how&#34;, &#34;a&#34;, &#34;an&#34;, &#34;the&#34;, &#34;and&#34;, &#34;or&#34;, &#34;not&#34;, &#34;no&#34;, &#34;but&#34;, &#34;because&#34;, &#34;as&#34;, &#34;until&#34;, &#34;again&#34;, &#34;further&#34;, &#34;then&#34;, &#34;once&#34;, &#34;here&#34;, &#34;there&#34;, &#34;all&#34;, &#34;any&#34;, &#34;both&#34;, &#34;each&#34;, &#34;few&#34;, &#34;more&#34;, &#34;most&#34;, &#34;other&#34;, &#34;some&#34;, &#34;such&#34;, &#34;above&#34;, &#34;below&#34;, &#34;to&#34;, &#34;during&#34;, &#34;before&#34;, &#34;after&#34;, &#34;of&#34;, &#34;at&#34;, &#34;by&#34;, &#34;about&#34;, &#34;between&#34;, &#34;into&#34;, &#34;through&#34;, &#34;from&#34;, &#34;up&#34;, &#34;down&#34;, &#34;in&#34;, &#34;out&#34;, &#34;on&#34;, &#34;off&#34;, &#34;over&#34;, &#34;under&#34;, &#34;only&#34;, &#34;own&#34;, &#34;same&#34;, &#34;so&#34;, &#34;than&#34;, &#34;too&#34;, &#34;very&#34;, &#34;just&#34;, &#34;now&#34;]);&#xA;const d = new Set([&#34;if&#34;, &#34;then&#34;, &#34;else&#34;, &#34;for&#34;, &#34;while&#34;, &#34;with&#34;, &#34;def&#34;, &#34;function&#34;, &#34;return&#34;, &#34;TODO&#34;, &#34;import&#34;, &#34;try&#34;, &#34;catch&#34;, &#34;raise&#34;, &#34;finally&#34;, &#34;repeat&#34;, &#34;switch&#34;, &#34;case&#34;, &#34;match&#34;, &#34;assert&#34;, &#34;continue&#34;, &#34;break&#34;, &#34;const&#34;, &#34;class&#34;, &#34;enum&#34;, &#34;struct&#34;, &#34;static&#34;, &#34;new&#34;, &#34;super&#34;, &#34;this&#34;, &#34;var&#34;, ...p]);&#xA;&#xA;tokenize(e) {&#xA;  return new Set(splitIntoWords(e).filter(e =&amp;gt; !this.stopsForLanguage.has(e)));&#xA;}&#xA;&#xA;function splitIntoWords(e) {&#xA;  return e.split(/[^a-zA-Z0-9]/).filter(e =&amp;gt; e.length &amp;gt; 0);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å¯ä»¥çœ‹åˆ°å¤„ç†tokenså…¶å®å°±æ˜¯åˆ†è¯çš„è¿‡ç¨‹ï¼Œæ¯”æ™®é€šå•è¯åˆ†å‰²å¤šäº†ä¸€æ­¥ï¼Œå°±æ˜¯è¿‡æ»¤å¸¸è§çš„å…³é”®è¯ï¼Œè¿™äº›å…³é”®è¯ä¸å½±å“ç›¸ä¼¼åº¦çš„è®¡ç®—ï¼ˆæ¯”å¦‚ifã€forè¿™ç§ï¼‰ã€‚&lt;/p&gt; &lt;/li&gt; &#xA;   &lt;li&gt; &lt;p&gt;&lt;strong&gt;getWindowsDelineationsåˆ†å‰²çª—å£&lt;/strong&gt;&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.getBasicWindowDelineations = function (e, t) {&#xA;  const n = [];&#xA;  const r = t.length;&#xA;  if (0 == r) return [];&#xA;  if (r &amp;lt; e) return [[0, r]];&#xA;  for (let t = 0; t &amp;lt; r - e + 1; t++) n.push([t, t + e]);&#xA;  return n;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;&lt;code&gt;getWindowsDelineations&lt;/code&gt; æœ¬èº«é€»è¾‘å¹¶ä¸å¤æ‚ï¼Œå°±æ˜¯æ ¹æ®ä¼ å…¥çš„windowSizeè¿”å›ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œè¿™ä¸ªäºŒç»´æ•°ç»„çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªèµ·å§‹è¡Œæ•°å’Œç»ˆæ­¢è¡Œæ•°ï¼Œå®ƒè¿”å›çš„æ˜¯æ­¥é•¿ä¸º1ï¼Œåœ¨æ–‡ä»¶é‡Œé¢windowSizeé•¿åº¦å†…çš„æ‰€æœ‰å¯èƒ½åŒºé—´ã€‚&lt;/p&gt; &lt;p&gt;å¾—åˆ°è¿™äº›åŒºé—´åï¼Œä¼šè·Ÿå½“å‰çš„å†…å®¹ï¼ˆåŒæ ·windowSizeï¼‰è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ï¼Œé€‰æ‹©å‡ºç›¸ä¼¼åº¦æœ€é«˜çš„åŒºé—´å†…å®¹è¿”å›ï¼Œè¿™ä¸ªå†…å®¹å°±æ˜¯æœ€ç»ˆçš„snippetã€‚&lt;/p&gt; &lt;p&gt;å…¶ä¸­ï¼Œè·å–å½“å‰å†…å®¹çš„æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;get referenceTokens() {&#xA;  if (void 0 === this._referenceTokens) {&#xA;    this._referenceTokens = this.tokenizer.tokenize(this._getCursorContextInfo(this.referenceDoc).context);&#xA;  }&#xA;  return this._referenceTokens;&#xA;}&#xA;&#xA;exports.getCursorContext = function e(doc, opts = {}) {&#xA;    const opts = function (e) {&#xA;      return {&#xA;        ...i,&#xA;        ...e&#xA;      };&#xA;    }(opts);&#xA;    const s = r.getTokenizer(opts.tokenizerName);&#xA;    &#xA;    if (void 0 === opts.maxTokenLength &amp;amp;&amp;amp; void 0 !== opts.maxLineCount) {&#xA;      const e = doc.source.slice(0, doc.offset).split(&#34;\n&#34;).slice(-opts.maxLineCount);&#xA;      const n = e.join(&#34;\n&#34;);&#xA;      return {&#xA;        context: n,&#xA;        lineCount: e.length,&#xA;        tokenLength: s.tokenLength(n),&#xA;        tokenizerName: opts.tokenizerName&#xA;      };&#xA;    }&#xA;&#x9;&#x9;// ...&#xA;  };&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå–çš„æ˜¯å½“å‰å…‰æ ‡å‰æ‰€æœ‰å†…å®¹åœ¨çª—å£å¤§å°çš„æˆªæ–­ï¼Œè¿™ä¸ªä¼štokenåˆ†è¯ä¹‹åä¸å¯¹åº”çš„ç›¸å…³æ–‡ä»¶tokenè¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ã€‚&lt;/p&gt; &lt;/li&gt; &#xA;   &lt;li&gt; &lt;p&gt;&lt;strong&gt;ç›¸ä¼¼åº¦è®¡ç®—ï¼ˆ&lt;code&gt;Jaccard&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;Copiloté€šè¿‡ä¸€ä¸ªéå¸¸ç®€å•çš„**&lt;code&gt;Jaccard&lt;/code&gt;** ç›¸ä¼¼åº¦è®¡ç®—æ–¹æ³•ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function computeScore(e, t) {&#xA;    const n = new Set();&#xA;    e.forEach(e =&amp;gt; {&#xA;      if (t.has(e)) {&#xA;        n.add(e);&#xA;      }&#xA;    });&#xA;    return n.size / (e.size + t.size - n.size);&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å®é™…ä¸Šï¼ŒJaccardç›¸ä¼¼åº¦è®¡ç®—å…¬å¼ä¸ºï¼š&lt;/p&gt; &lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/c038f44c-7dce-4a3a-9de8-2dc4dc518b4b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„é›†åˆè¿ç®—ï¼Œåˆ©ç”¨äº¤é›†å æ¯”æ¥æ±‚ç›¸ä¼¼åº¦ï¼ŒCopilotåˆ©ç”¨ä¸¤ä¸ªåˆ†è¯é›†åˆæ¥å¿«é€Ÿè®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦ã€‚&lt;/p&gt; &lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;p&gt;æœ€åï¼Œcopilotè°ƒç”¨äº†processSnippetsForWishlistï¼Œå°†snippetåŠ å…¥åˆ°wishListå½“ä¸­ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function $() {&#xA;    const maxSnippetLength = Math.round((promptOpts.snippetPercent / 100) * promptOpts.maxPromptLength);&#xA;    c.processSnippetsForWishlist(&#xA;      snippets,&#xA;      resourceInfo.languageId,&#xA;      tokenizer,&#xA;      promptOpts.snippetProviderOptions,&#xA;      {&#xA;        priorities: priorities,&#xA;        low: lowSnippetPriority,&#xA;        high: highSnippetPriority,&#xA;      },&#xA;      promptOpts.numberOfSnippets,&#xA;      maxSnippetLength&#xA;    ).forEach((e) =&amp;gt; {&#xA;      let t = p.PromptElementKind.SimilarFile;&#xA;      if (e.provider === c.SnippetProvider.Retrieval) {&#xA;        t = p.PromptElementKind.RetrievalSnippet;&#xA;      } else {&#xA;        if (e.provider == c.SnippetProvider.SymbolDef) {&#xA;          t = p.PromptElementKind.SymbolDefinition;&#xA;        }&#xA;      }&#xA;      promptWishlist.append(e.announcedSnippet, t, e.priority, e.tokens, e.normalizedScore);&#xA;    });&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;ä»å‰é¢æˆ‘ä»¬å¯ä»¥å¾—çŸ¥snippetPercenté»˜è®¤ä¸º0ï¼Œæ‰€ä»¥è¿™é‡ŒmaxSnippetLengthä¹Ÿä¸º0.&lt;/p&gt; &lt;p&gt;æˆ‘ä»¬æ·±å…¥çœ‹ä¸€ä¸‹processSnippetsForWishListçš„å®ç°ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;exports.processSnippetsForWishlist = function (snippets, languageId, tokenizer, snippetProviderOptions, priorities, numberOfSnippets, maxSnippetLength) {&#xA;    const {&#xA;      reserved: reserved,&#xA;      candidates: candidates&#xA;    } = selectSnippets(snippets, numberOfSnippets, snippetProviderOptions);&#xA;    let d = 0;&#xA;    let h = [];&#xA;    let highPriorities = priorities.high;&#xA;    let lowPriorities = priorities.low;&#xA;    function g(snippet, r) {&#xA;      const o = announceSnippet(snippet, languageId);&#xA;      const c = tokenizer.tokenLength(o);&#xA;      let l;&#xA;      if (r + c &amp;lt;= maxSnippetLength) {&#xA;        l = highPriorities;&#xA;        highPriorities = priorities.priorities.justBelow(l);&#xA;      } else {&#xA;        l = lowPriorities;&#xA;        lowPriorities = priorities.priorities.justBelow(l);&#xA;      }&#xA;      h.push({&#xA;        announcedSnippet: o,&#xA;        provider: snippet.provider,&#xA;        providerScore: snippet.providerScore,&#xA;        normalizedScore: snippet.normalizedScore,&#xA;        priority: l,&#xA;        tokens: c,&#xA;        relativePath: snippet.relativePath&#xA;      });&#xA;      return r + c;&#xA;    }&#xA;    for (const snippet of [...reserved, ...candidates]) {&#xA;      if (h.length &amp;gt;= numberOfSnippets) break;&#xA;      d = g(snippete, d);&#xA;    }&#xA;    l(h);&#xA;    h.reverse();&#xA;    return h;&#xA;  };&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™é‡ŒmaxSnippetLengthå½±å“çš„æ˜¯Priorityï¼Œåœ¨è¿™é‡Œé»˜è®¤æƒ…å†µä¸‹å°±æ˜¯lowPriorityäº†ã€‚&lt;/p&gt; &lt;p&gt;è¿™é‡Œçš„å¤„ç†å…¶å®æœ¬è´¨ä¸Šæ˜¯å¯¹scoreè¿›è¡Œæ­£åˆ™åŒ–ï¼Œé‡æ’åºï¼Œç„¶åè¿”å›announcedSnippetï¼Œè¿™ä¸ªannounceSnippetå°±æ˜¯æœ€åè¢«åŠ å…¥åˆ°Promptæ–‡æœ¬é‡Œçš„å†…å®¹ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;function announceSnippet(e, t) {&#xA;    const n = s[e.semantics];&#xA;    let i = (e.relativePath ? `Compare this ${n} from ${e.relativePath}:` : `Compare this ${n}:`) + &#34;\n&#34; + e.snippet;&#xA;    if (i.endsWith(&#34;\n&#34;)) {&#xA;      i += &#34;\n&#34;;&#xA;    }&#xA;    return r.commentBlockAsSingles(i, t);&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™é‡Œï¼Œç›¸å…³æ–‡ä»¶çš„snippetä¼šåŒ…è£¹åœ¨æ³¨é‡Šé‡Œï¼Œå¹¶åœ¨å¤´éƒ¨åŠ ä¸Šä¸€è¡Œ&lt;code&gt;Compare this â€¦&lt;/code&gt;çš„æ–‡æ¡ˆï¼Œæä¾›ç»™æ¨¡å‹ã€‚&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;beforeCursor&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;beforeCursorçš„ä»£ç æ¯”è¾ƒç®€å•ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;promptWishlist.appendLineForLine(source.substring(0, offset), p.PromptElementKind.BeforeCursor, beforeCursorPriority).forEach((e) =&amp;gt;&#xA;      V.push(e)&#xA;    );&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;æ³¨æ„è¿™é‡Œç”¨äº†appendLineForLineï¼Œè€Œä¸æ˜¯appendï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹appendLineForLineçš„å®ç°ï¼š&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;appendLineForLine(text, kind, priority) {&#xA;    const lineArr = (lines = this.convertLineEndings(text)).split(&#34;\n&#34;);&#xA;    for (let i = 0; i &amp;lt; lineArr.length - 1; i++) lineArr[i] += &#34;\n&#34;;&#xA;    const lines = [];&#xA;    lineArr.forEach((line) =&amp;gt; {&#xA;      if (&#34;\n&#34; === line &amp;amp;&amp;amp; lines.length &amp;gt; 0 &amp;amp;&amp;amp; !lines[lines.length - 1].endsWith(&#34;\n\n&#34;)) {&#xA;        lines[lines.length - 1] += &#34;\n&#34;;&#xA;      } else {&#xA;        lines.push(line);&#xA;      }&#xA;    });&#xA;    const result = [];&#xA;    lines.forEach((text, index) =&amp;gt; {&#xA;      if (&#34;&#34; !== text) {&#xA;        result.push(this.append(text, kind, priority));&#xA;        if (index &amp;gt; 0) {&#xA;          this.content[this.content.length - 2].requires = [&#xA;            this.content[this.content.length - 1],&#xA;          ];&#xA;        }&#xA;      }&#xA;    });&#xA;    return result;&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;å®é™…ä¸Šè¿™æ®µä»£ç çš„ä½œç”¨å°±æ˜¯å°†å…‰æ ‡å‰çš„å†…å®¹æŒ‰è¡Œappendï¼Œè¿™æ ·åœ¨tokenæœ‰é™çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤ŸæŒ‰è¡Œä¿ç•™æœ€å¤§çš„ä¸Šä¸‹æ–‡ã€‚&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h3&gt;wishListçš„fullfillæ•´åˆå¤„ç†&lt;/h3&gt; &#xA;&lt;p&gt;åœ¨æ¥ä¸‹æ¥å°±æ˜¯ä¸€ç³»åˆ—ä¾èµ–å…³ç³»çš„å¤„ç†ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;if (h.Top === promptOpts.languageMarker &amp;amp;&amp;amp; V.length &amp;gt; 0 &amp;amp;&amp;amp; void 0 !== languageMarkerId) {&#xA;    promptWishlist.require(languageMarkerId, V[0]);&#xA;  }&#xA;  if (f.Top === promptOpts.pathMarker &amp;amp;&amp;amp; V.length &amp;gt; 0 &amp;amp;&amp;amp; void 0 !== pathMarkerId) {&#xA;    if (languageMarkerId) {&#xA;      promptWishlist.require(pathMarkerId, languageMarkerId);&#xA;    } else {&#xA;      promptWishlist.require(pathMarkerId, V[0]);&#xA;    }&#xA;  }&#xA;  if (void 0 !== languageMarkerId &amp;amp;&amp;amp; void 0 !== pathMarkerId) {&#xA;    promptWishlist.exclude(pathMarkerId, languageMarkerId);&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™é‡Œå…¶å®æˆ‘ä¸å¤ªç†è§£çš„ä¸€ç‚¹æ˜¯ï¼ŒpathMarkerå’ŒlanguageMarkeråœ¨è¿™ä¸ªé€»è¾‘é‡Œäº’æ–¥äº†ï¼Œåœ¨æˆ‘ä»¬ä¸Šé¢åˆ†æå¯ä»¥çœ‹åˆ°pathMarkerçš„ä¼˜å…ˆçº§æ¯”languageMarkerä¼˜å…ˆçº§é«˜ï¼Œè¿™é‡ŒåŠ äº†ä¸€ä¸ªexcludeï¼Œä¹Ÿå°±æ„å‘³ç€languageMarkeræ°¸è¿œä¸å¯èƒ½å‡ºç°äº†ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æœ€åï¼Œå¦‚æœæ˜¯suffixPercentä¸º0çš„æƒ…å†µä¸‹ï¼Œä»£ç åˆ°è¿™é‡Œå°±ç›´æ¥ç»“æŸäº†ï¼Œè°ƒç”¨fullfillæ–¹æ³•è¿”å›æœ€ç»ˆçš„ç»“æœï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;if (0 === promptOpts.suffixPercent || q.length &amp;lt;= promptOpts.fimSuffixLengthThreshold)&#xA;    return promptWishlist.fulfill(promptOpts.maxPromptLength);&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å½“ç„¶ï¼Œç»è¿‡æˆ‘ä»¬ä¸Šé¢çš„åˆ†æsuffixPercentåœ¨å½“å‰ç‰ˆæœ¬çš„é»˜è®¤å€¼æ˜¯15ï¼Œä¸ä¸º0ï¼Œä¼šèµ°åˆ°suffixçš„é€»è¾‘ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ä¸è¿‡æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹fullfillçš„å¤„ç†ï¼Œsuffixé€»è¾‘æˆ‘ä»¬å°±ä¸åˆ†æäº†:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;fulfill(maxPromptLength) {&#xA;    const promptChoices = new PromptChoices();&#xA;    const promptBackground = new PromptBackground();&#xA;    const elements = this.content.map((e, t) =&amp;gt; ({&#xA;      element: e,&#xA;      index: t,&#xA;    }));&#xA;    elements.sort((e, t) =&amp;gt;&#xA;      e.element.priority === t.element.priority&#xA;        ? t.index - e.index&#xA;        : t.element.priority - e.element.priority&#xA;    );&#xA;    const requires = new Set();&#xA;    const excludes = new Set();&#xA;    let lastElement;&#xA;    const results = [];&#xA;    let promptLength = maxPromptLength;&#xA;    elements.forEach((e) =&amp;gt; {&#xA;      const element = e.element;&#xA;      const index = e.index;&#xA;      if (&#xA;        promptLength &amp;gt;= 0 &amp;amp;&amp;amp;&#xA;        (promptLength &amp;gt; 0 || void 0 === lastElement) &amp;amp;&amp;amp;&#xA;        element.requires.every((e) =&amp;gt; requires.has(e.id)) &amp;amp;&amp;amp;&#xA;        !excludes.has(r.id)&#xA;      ) {&#xA;        let tokens = element.tokens;&#xA;        const nextElement = (function (e, t) {&#xA;          let n;&#xA;          let r = 1 / 0;&#xA;          for (const i of e)&#xA;            if (i.index &amp;gt; t &amp;amp;&amp;amp; i.index &amp;lt; r) {&#xA;              n = i;&#xA;              r = i.index;&#xA;            }&#xA;          return n;&#xA;        })(results, index)?.element;&#xA;        if (element.text.endsWith(&#34;\n\n&#34;) &amp;amp;&amp;amp; nextElement &amp;amp;&amp;amp; !nextElement.text.match(/^\s/)) {&#xA;          tokens++;&#xA;        }&#xA;        if (promptLength &amp;gt;= tokens) {&#xA;            promptLength -= tokens;&#xA;            requires.add(r.id);&#xA;          element.excludes.forEach((e) =&amp;gt; excludes.add(e.id));&#xA;          promptChoices.markUsed(element);&#xA;          promptBackground.markUsed(element);&#xA;          results.push(e);&#xA;        } else {&#xA;          if (void 0 === lastElement) {&#xA;            lastElement = e;&#xA;          } else {&#xA;            promptChoices.markUnused(e.element);&#xA;            promptBackground.markUnused(e.element);&#xA;          }&#xA;        }&#xA;      } else {&#xA;        promptChoices.markUnused(element);&#xA;        promptBackground.markUnused(element);&#xA;      }&#xA;    });&#xA;    results.sort((e, t) =&amp;gt; e.index - t.index);&#xA;    let prefix = results.reduce((e, t) =&amp;gt; e + t.element.text, &#34;&#34;);&#xA;    let prefixLength = this.tokenizer.tokenLength(prefix);&#xA;    for (; prefixLength &amp;gt; maxPromptLength; ) {&#xA;      u.sort((e, t) =&amp;gt;&#xA;        t.element.priority === e.element.priority&#xA;          ? t.index - e.index&#xA;          : t.element.priority - e.element.priority&#xA;      );&#xA;      const e = u.pop();&#xA;      if (e) {&#xA;        promptChoices.undoMarkUsed(e.element);&#xA;        promptChoices.markUnused(e.element);&#xA;        promptBackground.undoMarkUsed(e.element);&#xA;        promptBackground.markUnused(e.element);&#xA;        if (void 0 !== lastElement) {&#xA;          promptChoices.markUnused(lastElement.element);&#xA;          promptBackground.markUnused(lastElement.element);&#xA;        }&#xA;        lastElement = void 0;&#xA;      }&#xA;      u.sort((e, t) =&amp;gt; e.index - t.index);&#xA;      prefix = u.reduce((e, t) =&amp;gt; e + t.element.text, &#34;&#34;);&#xA;      prefixLength = this.tokenizer.tokenLength(prefix);&#xA;    }&#xA;    const f = [...u];&#xA;    if (void 0 !== lastElement) {&#xA;      f.push(lastElement);&#xA;      f.sort((e, t) =&amp;gt; e.index - t.index);&#xA;      const prefix = f.reduce((e, t) =&amp;gt; e + t.element.text, &#34;&#34;);&#xA;      const prefixLength = this.tokenizer.tokenLength(prefix);&#xA;      if (prefixLength &amp;lt;= maxPromptLength) {&#xA;        promptChoices.markUsed(l.element);&#xA;        promptBackground.markUsed(l.element);&#xA;        const promptElementRanges = new PromptElementRanges(f);&#xA;        return {&#xA;          prefix: prefix,&#xA;          suffix: &#34;&#34;,&#xA;          prefixLength: prefixLength,&#xA;          suffixLength: 0,&#xA;          promptChoices: promptChoices,&#xA;          promptBackground: promptBackground,&#xA;          promptElementRanges: promptElementRanges,&#xA;        };&#xA;      }&#xA;      promptChoices.markUnused(l.element);&#xA;      promptBackground.markUnused(l.element);&#xA;    }&#xA;    const m = new PromptElementRanges(u);&#xA;    return {&#xA;      prefix: prefix,&#xA;      suffix: &#34;&#34;,&#xA;      prefixLength: prefixLength,&#xA;      suffixLength: 0,&#xA;      promptChoices: promptChoices,&#xA;      promptBackground: promptBackground,&#xA;      promptElementRanges: m,&#xA;    };&#xA;  }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™ä¸ªfullfillé€»è¾‘æ ¸å¿ƒæœ‰ä¸¤ç‚¹ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;é¦–å…ˆæŒ‰ç…§Priorityæ’åºï¼ˆPriorityç›¸åŒæŒ‰indexï¼‰ï¼Œå¤„ç†æ–‡æœ¬å†…å®¹ï¼Œè¿™å°±æ„å‘³ç€ï¼Œåœ¨æœ‰é™çš„Tokenä¸‹ï¼ŒPriorityè¶Šé«˜çš„æ–‡æœ¬è¶Šèƒ½è¢«ä¿éšœã€‚&lt;/li&gt; &#xA; &lt;li&gt;è¾“å‡ºçš„æ—¶å€™ï¼Œæ˜¯æŒ‰ç…§indexæ’åºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´Priorityåªç”¨ä½œå¤„ç†æ–‡æœ¬çš„ä¼˜å…ˆçº§ï¼Œæœ€ç»ˆç»„åˆçš„prefixæ–‡æœ¬çš„é¡ºåºæ˜¯æŒ‰ç…§æ’å…¥wishListçš„å…ˆåé¡ºåºçš„ã€‚&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬æ ¹æ®å‰é¢çš„åˆ†æï¼Œå¯ä»¥çœ‹åˆ°æ–‡æœ¬ä¼˜å…ˆçº§æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;languageMarker&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;pathMarkder&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;importedFile&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Snippet&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;beforeCursor&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;è€Œå¤„ç†ä¼˜å…ˆçº§æ˜¯è¿™æ ·çš„ï¼ˆä¼˜å…ˆä¿è¯çš„å†…å®¹ï¼‰ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;beforeCursor&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;importedFile&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Snippet&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;pathMarkder&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;languageMarker&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Promptç»„æˆçš„å›¾ç¤º&lt;/h3&gt; &#xA;&lt;p&gt;promptä»ä»£ç ä¸Šçœ‹æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬æ•´ä½“æŠŠprefixçš„ç»„æˆç”»ä¸€ä¸‹åšä¸ªæ€»ç»“ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/390d7bd0-4fa5-457d-bb0e-9c929aa72ae2.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;æŠ“åŒ…å®éªŒä¸€ä¸‹&lt;/h2&gt; &#xA;&lt;p&gt;æˆ‘ä»¬æ‰¾ä¸ªTSæ–‡ä»¶æ¥è¯•è¯•ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/fc5484f9-4d01-4d20-a056-68bbb5256902.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨Copilotå‘èµ·çš„è¯·æ±‚ä¸­ï¼ŒpromptåŒ…å«äº†Path Markerå’ŒBeforeCursorä¸¤ä¸ªéƒ¨åˆ†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ç»å¤§å¤šæ•°çš„é¢ä¸´åœºæ™¯ã€‚&lt;/p&gt; &#xA;&lt;p&gt;å¦‚æœä»£ç ç›¸å…³æ€§å¤Ÿé«˜ï¼Œå¯ä»¥çœ‹åˆ°snippetçš„éƒ¨åˆ†ï¼Œæ¯”å¦‚æˆ‘ä»¬æ‹·è´äº†ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/119e8984-ea31-4b10-89ea-b8773b80b0c9.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;è¿™ä¸ªæ—¶å€™å°±ä¼šç”Ÿæˆå¯¹åº”çš„snippetï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://files.mdnice.com/user/13429/f3748c7d-a605-41d1-bcac-9c16f5e334be.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;å°ç»“&lt;/h2&gt; &#xA;&lt;p&gt;ä»Copilotä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°å€¼å¾—å­¦ä¹ çš„å‡ ä¸ªæ ¸å¿ƒæ€æƒ³ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;å¯¹äºç¼–è¾‘å™¨è¾“å…¥çš„è¾¹ç•Œåˆ¤æ–­ï¼ŒåŒ…æ‹¬å¤ªå°‘ã€å¤ªå¤šã€å–æ¶ˆç­‰ç­‰å¾ˆå¤šåœºæ™¯é½å…¨çš„è€ƒè™‘&lt;/li&gt; &#xA; &lt;li&gt;ç¼“å­˜æ€æƒ³ï¼Œåˆ©ç”¨å¤šçº§ç¼“å­˜ç­–ç•¥ä¿æŠ¤åå°ï¼Œæ¨¡å‹è¿ç®—æœ¬èº«å°±æ˜¯ä¸€ä»¶æ˜‚è´µçš„äº‹æƒ…&lt;/li&gt; &#xA; &lt;li&gt;promptçš„è®¾è®¡ï¼Œä¸ä»…ä»…åŒ…å«äº†ä¸Šä¸‹æ–‡ä»£ç ï¼Œåœ¨æ–‡ä»¶è§£æã€ç¼–è¾‘å™¨æ‰“å¼€çš„ç›¸å…³ä»£ç ä¸Šè¿˜åšäº†å¾ˆå¤š&lt;/li&gt; &#xA; &lt;li&gt;åˆ©ç”¨ç®€å•çš„Jaccardç®—æ³•è®¡ç®—åˆ†è¯åçš„æ–‡æœ¬ç›¸ä¼¼åº¦ï¼Œèƒ½å¤Ÿå¿«é€Ÿå†³ç­–å‡ºå½“å‰ä¸Šä¸‹æ–‡ç›¸å…³çš„snippet&lt;/li&gt; &#xA; &lt;li&gt;å®éªŒç‰¹æ€§ï¼Œåœ¨Copilotä¸­ï¼Œå¤§é‡çš„å‚æ•°ã€ä¼˜å…ˆçº§ã€è®¾ç½®å­—æ®µéƒ½æ˜¯é€šè¿‡å®éªŒæ¥æ§åˆ¶çš„ï¼Œæœ‰ä¸€å¥—å®Œæ•´çš„ç›‘æ§ä¸ŠæŠ¥ä½“ç³»ï¼Œå¸®åŠ©Copilotå»è°ƒæ•´è¿™äº›å‚æ•°ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„æ•ˆæœ&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Copilotçš„é€»è¾‘æ¯”æˆ‘æƒ³è±¡ä¸­è¦å¤æ‚è®¸å¤šï¼Œé€†å‘åˆ†æéš¾åº¦å°±æ›´é«˜äº†ã€‚è€—è´¹äº†å¾ˆå¤šæ—¶é—´åœ¨è§£æå·¥ä½œä¸Šï¼Œæœ¬æ–‡ç›¸å…³çš„å·¥å…·é“¾å’Œä»£ç éƒ½å·²ä¸Šä¼ Githubï¼Œå¸Œæœ›èƒ½å¤Ÿç»™ä¸€äº›æœ‰éœ€è¦çš„åŒå­¦æä¾›å¸®åŠ©ï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mengjian-github/copilot-analysis&#34;&gt;https://github.com/mengjian-github/copilot-analysis&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
</feed>