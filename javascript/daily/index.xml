<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub JavaScript Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-10-11T01:31:35Z</updated>
  <subtitle>Daily Trending of JavaScript in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>revoltchat/self-hosted</title>
    <updated>2024-10-11T01:31:35Z</updated>
    <id>tag:github.com,2024-10-11:/revoltchat/self-hosted</id>
    <link href="https://github.com/revoltchat/self-hosted" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Deploy Revolt using Docker.&lt;/p&gt;&lt;hr&gt;&lt;div align=&#34;center&#34;&gt; &#xA; &lt;h1&gt; Revolt Self-Hosted &lt;p&gt;&lt;a href=&#34;https://github.com/revoltchat/self-hosted/stargazers&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/stars/revoltchat/self-hosted?style=flat-square&amp;amp;logoColor=white&#34; alt=&#34;Stars&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/revoltchat/self-hosted/network/members&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/forks/revoltchat/self-hosted?style=flat-square&amp;amp;logoColor=white&#34; alt=&#34;Forks&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/revoltchat/self-hosted/pulls&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/issues-pr/revoltchat/self-hosted?style=flat-square&amp;amp;logoColor=white&#34; alt=&#34;Pull Requests&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/revoltchat/self-hosted/issues&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/issues/revoltchat/self-hosted?style=flat-square&amp;amp;logoColor=white&#34; alt=&#34;Issues&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/revoltchat/self-hosted/graphs/contributors&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/contributors/revoltchat/self-hosted?style=flat-square&amp;amp;logoColor=white&#34; alt=&#34;Contributors&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/revoltchat/self-hosted/raw/main/LICENSE&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/license/revoltchat/self-hosted?style=flat-square&amp;amp;logoColor=white&#34; alt=&#34;License&#34;&gt;&lt;/a&gt;&lt;/p&gt; &lt;/h1&gt; Self-hosting Revolt using Docker &#xA;&lt;/div&gt; &#xA;&lt;br&gt; &#xA;&lt;p&gt;This repository contains configurations and instructions that can be used for deploying Revolt.&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!NOTE] Please consult &lt;em&gt;&lt;a href=&#34;https://developers.revolt.chat/faq.html#admonition-what-can-i-do-with-revolt-and-how-do-i-self-host&#34;&gt;What can I do with Revolt and how do I self-host?&lt;/a&gt;&lt;/em&gt; on our developer site for information about licensing and brand use.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!NOTE] amd64 builds are only available for &lt;code&gt;backend&lt;/code&gt; and &lt;code&gt;bonfire&lt;/code&gt; images currently, more to come.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h2&gt;Quick Start&lt;/h2&gt; &#xA;&lt;p&gt;This repository provides reasonable defaults, so you can immediately get started with it on your local machine.&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!WARNING] This is not fit for production usage; see below for the full guide.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git clone https://github.com/revoltchat/self-hosted revolt&#xA;cd revolt&#xA;cp .env.example .env&#xA;docker compose up&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Now navigate to &lt;a href=&#34;http://local.revolt.chat&#34;&gt;http://local.revolt.chat&lt;/a&gt; in your browser.&lt;/p&gt; &#xA;&lt;h2&gt;Production Setup&lt;/h2&gt; &#xA;&lt;p&gt;Prerequisites before continuing:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://git-scm.com&#34;&gt;Git&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://www.docker.com&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Clone this repository.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git clone https://github.com/revoltchat/self-hosted revolt&#xA;cd revolt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Copy &lt;code&gt;.env&lt;/code&gt; and download &lt;code&gt;Revolt.toml&lt;/code&gt;, then modify them according to your requirements.&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!WARNING] The default configurations are intended exclusively for testing and will only work locally. If you wish to deploy to a remote server, you &lt;strong&gt;must&lt;/strong&gt; edit the URLs in &lt;code&gt;.env&lt;/code&gt; and &lt;code&gt;Revolt.toml&lt;/code&gt;. Please reference the section below on &lt;a href=&#34;https://raw.githubusercontent.com/revoltchat/self-hosted/master/#custom-domain&#34;&gt;configuring a custom domain&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cp .env.example .env&#xA;wget -O Revolt.toml https://raw.githubusercontent.com/revoltchat/backend/main/crates/core/config/Revolt.toml&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then start Revolt:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose up&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Updating&lt;/h2&gt; &#xA;&lt;p&gt;Before updating, ensure you consult the notices at the top of this README to check if there are any important changes to be aware of.&lt;/p&gt; &#xA;&lt;p&gt;Pull the latest version of this repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git pull&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then pull all the latest images:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose pull&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then restart the services:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose up&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Additional Notes&lt;/h2&gt; &#xA;&lt;h3&gt;Custom domain&lt;/h3&gt; &#xA;&lt;p&gt;To configure a custom domain, you will need to replace all instances of &lt;code&gt;local.revolt.chat&lt;/code&gt; in the &lt;code&gt;Revolt.toml&lt;/code&gt; and &lt;code&gt;.env&lt;/code&gt; files, like so:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;# .env&#xA;- REVOLT_APP_URL=http://local.revolt.chat&#xA;+ REVOLT_APP_URL=http://my.domain&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;# Revolt.toml&#xA;- app = &#34;http://local.revolt.chat&#34;&#xA;+ app = &#34;http://my.domain&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You will also want to change the protocols to enable HTTPS:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;# .env&#xA;- REVOLT_APP_URL=http://my.domain&#xA;+ REVOLT_APP_URL=https://my.domain&#xA;&#xA;- REVOLT_EXTERNAL_WS_URL=ws://my.domain/ws&#xA;+ REVOLT_EXTERNAL_WS_URL=wss://my.domain/ws&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;# Revolt.toml&#xA;- app = &#34;http://local.revolt.chat&#34;&#xA;+ app = &#34;https://my.domain&#34;&#xA;&#xA;- events = &#34;ws://my.domain/ws&#34;&#xA;+ events = &#34;wss://my.domain/ws&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In the case of &lt;code&gt;HOSTNAME&lt;/code&gt;, you must strip the protocol prefix:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;# .env&#xA;- HOSTNAME=https://my.domain&#xA;+ HOSTNAME=my.domain&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Putting Revolt behind another reverse proxy (or on a non-standard port)&lt;/h3&gt; &#xA;&lt;p&gt;Override the port definitions on &lt;code&gt;caddy&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yml&#34;&gt;# compose.yml&#xA;services:&#xA;  caddy:&#xA;    ports:&#xA;      - &#34;1234:80&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!WARNING] This file is not Git ignored. It may be sufficient to use an override file, but that will not remove port 80 / 443 allocations.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;Update the hostname used by the web server:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt;# .env&#xA;- HOSTNAME=http://local.revolt.chat&#xA;+ HOSTNAME=:80&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You can now reverse proxy to &lt;a href=&#34;http://localhost:1234&#34;&gt;http://localhost:1234&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Insecurely expose database&lt;/h3&gt; &#xA;&lt;p&gt;You can insecurely expose the database by adding a port definition:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yml&#34;&gt;# compose.override.yml&#xA;services:&#xA;  database:&#xA;    ports:&#xA;      - &#34;27017:27017&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Mongo compatibility&lt;/h3&gt; &#xA;&lt;p&gt;Older processors may not support the latest MongoDB version, you may pin to MongoDB 4.4 as such:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yml&#34;&gt;# compose.override.yml&#xA;services:&#xA;  database:&#xA;    image: mongo:4.4&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Making your instance invite-only&lt;/h3&gt; &#xA;&lt;p&gt;Enable invite-only mode by setting &lt;code&gt;REVOLT_INVITE_ONLY&lt;/code&gt; in &lt;code&gt;.env&lt;/code&gt; to &lt;code&gt;1&lt;/code&gt; and &lt;code&gt;invite_only&lt;/code&gt; in &lt;code&gt;Revolt.toml&lt;/code&gt; to &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Create an invite:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# drop into mongo shell&#xA;docker compose exec database mongosh&#xA;&#xA;# create the invite&#xA;use revolt&#xA;db.invites.insertOne({ _id: &#34;enter_an_invite_code_here&#34; })&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Notices&lt;/h2&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!IMPORTANT] If you deployed Revolt before &lt;a href=&#34;https://github.com/minio/docs/issues/624#issuecomment-1296608406&#34;&gt;2022-10-29&lt;/a&gt;, you may have to tag the &lt;code&gt;minio&lt;/code&gt; image release if it&#39;s configured in &#34;fs&#34; mode.&lt;/p&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-yml&#34;&gt;image: minio/minio:RELEASE.2022-10-24T18-35-07Z&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!IMPORTANT] If you deployed Revolt before &lt;a href=&#34;https://github.com/revoltchat/backend/commit/32542a822e3de0fc8cc7b29af46c54a9284ee2de&#34;&gt;2023-04-21&lt;/a&gt;, you may have to flush your Redis database.&lt;/p&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# for stock Redis and older KeyDB images:&#xA;docker compose exec redis redis-cli&#xA;# ...or for newer KeyDB images:&#xA;docker compose exec redis keydb-cli&#xA;&#xA;# then run:&#xA;FLUSHDB&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!IMPORTANT] As of 30th September 2024, Autumn has undergone a major refactor which requires a manual migration.&lt;/p&gt; &#xA; &lt;p&gt;To begin, add a temporary container that we can work from:&lt;/p&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-yml&#34;&gt;# compose.override.yml&#xA;services:&#xA;  migration:&#xA;    image: node:21&#xA;    volumes:&#xA;      - ./migrations:/cwd&#xA;    command: &#34;bash -c &#39;while true; do sleep 86400; done&#39;&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA; &lt;p&gt;Then switch to the shell:&lt;/p&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose up -d database migration&#xA;docker compose exec migration bash&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA; &lt;p&gt;Now we can run the migration:&lt;/p&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cd /cwd&#xA;npm i mongodb&#xA;node ./20240929-autumn-rewrite.mjs&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;/blockquote&gt;</summary>
  </entry>
</feed>