<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Python Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-08-18T01:34:57Z</updated>
  <subtitle>Daily Trending of Python in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>EleutherAI/lm-evaluation-harness</title>
    <updated>2023-08-18T01:34:57Z</updated>
    <id>tag:github.com,2023-08-18:/EleutherAI/lm-evaluation-harness</id>
    <link href="https://github.com/EleutherAI/lm-evaluation-harness" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A framework for few-shot evaluation of autoregressive language models.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Language Model Evaluation Harness&lt;/h1&gt; &#xA;&lt;h2&gt;We&#39;re Refactoring LM-Eval!&lt;/h2&gt; &#xA;&lt;p&gt;(as of 6/15/23) We have a revamp of the Evaluation Harness library internals staged on the &lt;a href=&#34;https://github.com/EleutherAI/lm-evaluation-harness/tree/big-refactor&#34;&gt;big-refactor&lt;/a&gt; branch! It is far along in progress, but before we start to move the &lt;code&gt;master&lt;/code&gt; branch of the repository over to this new design with a new version release, we&#39;d like to ensure that it&#39;s been tested by outside users and there are no glaring bugs.&lt;/p&gt; &#xA;&lt;p&gt;Weâ€™d like your help to test it out! you can help by:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Trying out your current workloads on the big-refactor branch, and seeing if anything breaks or is counterintuitive,&lt;/li&gt; &#xA; &lt;li&gt;Porting tasks supported in the previous version of the harness to the new YAML configuration format. Please check out our &lt;a href=&#34;https://github.com/EleutherAI/lm-evaluation-harness/raw/big-refactor/docs/new_task_guide.md&#34;&gt;task implementation guide&lt;/a&gt; for more information.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;If you choose to port a task not yet completed according to &lt;a href=&#34;https://github.com/EleutherAI/lm-evaluation-harness/raw/big-refactor/lm_eval/tasks/README.md&#34;&gt;our checklist&lt;/a&gt;, then you can contribute it by opening a PR containing [Refactor] in the name with:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;A shell command to run the task in the &lt;code&gt;master&lt;/code&gt; branch, and what the score is&lt;/li&gt; &#xA; &lt;li&gt;A shell command to run the task in your PR branch to &lt;code&gt;big-refactor&lt;/code&gt;, and what the resulting score is, to show that we achieve equality between the two implementations.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Lastly, we&#39;ll no longer be accepting new feature requests beyond those that are already open to the master branch as we carry out this switch to the new version over the next week, though we will be accepting bugfixes to &lt;code&gt;master&lt;/code&gt; branch and PRs to &lt;code&gt;big-refactor&lt;/code&gt;. Feel free to reach out in the #lm-thunderdome channel of the EAI discord for more information.&lt;/p&gt; &#xA;&lt;h2&gt;Overview&lt;/h2&gt; &#xA;&lt;p&gt;This project provides a unified framework to test generative language models on a large number of different evaluation tasks.&lt;/p&gt; &#xA;&lt;p&gt;Features:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;200+ tasks implemented. See the &lt;a href=&#34;https://raw.githubusercontent.com/EleutherAI/lm-evaluation-harness/master/docs/task_table.md&#34;&gt;task-table&lt;/a&gt; for a complete list.&lt;/li&gt; &#xA; &lt;li&gt;Support for models loaded via &lt;a href=&#34;https://github.com/huggingface/transformers/&#34;&gt;transformers&lt;/a&gt; (including quantization via &lt;a href=&#34;https://github.com/PanQiWei/AutoGPTQ&#34;&gt;AutoGPTQ&lt;/a&gt;), &lt;a href=&#34;https://github.com/EleutherAI/gpt-neox&#34;&gt;GPT-NeoX&lt;/a&gt;, and &lt;a href=&#34;https://github.com/microsoft/Megatron-DeepSpeed/&#34;&gt;Megatron-DeepSpeed&lt;/a&gt;, with a flexible tokenization-agnostic interface.&lt;/li&gt; &#xA; &lt;li&gt;Support for commercial APIs including &lt;a href=&#34;https://openai.com&#34;&gt;OpenAI&lt;/a&gt;, &lt;a href=&#34;https://goose.ai&#34;&gt;goose.ai&lt;/a&gt;, and &lt;a href=&#34;https://textsynth.com/&#34;&gt;TextSynth&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Support for evaluation on adapters (e.g. LoRa) supported in &lt;a href=&#34;https://github.com/huggingface/peft&#34;&gt;HuggingFace&#39;s PEFT library&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Evaluating with publicly available prompts ensures reproducibility and comparability between papers.&lt;/li&gt; &#xA; &lt;li&gt;Task versioning to ensure reproducibility when tasks are updated.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Install&lt;/h2&gt; &#xA;&lt;p&gt;To install &lt;code&gt;lm-eval&lt;/code&gt; from the github repository main branch, run:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git clone https://github.com/EleutherAI/lm-evaluation-harness&#xA;cd lm-evaluation-harness&#xA;pip install -e .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To install additional multilingual tokenization and text segmentation packages, you must install the package with the &lt;code&gt;multilingual&lt;/code&gt; extra:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;pip install -e &#34;.[multilingual]&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To support loading GPTQ quantized models, install the package with the &lt;code&gt;auto-gptq&lt;/code&gt; extra:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;pip install -e &#34;.[auto-gptq]&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Basic Usage&lt;/h2&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: When reporting results from eval harness, please include the task versions (shown in &lt;code&gt;results[&#34;versions&#34;]&lt;/code&gt;) for reproducibility. This allows bug fixes to tasks while also ensuring that previously reported scores are reproducible. See the &lt;a href=&#34;https://raw.githubusercontent.com/EleutherAI/lm-evaluation-harness/master/#task-versioning&#34;&gt;Task Versioning&lt;/a&gt; section for more info.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h3&gt;Hugging Face &lt;code&gt;transformers&lt;/code&gt;&lt;/h3&gt; &#xA;&lt;p&gt;To evaluate a model hosted on the &lt;a href=&#34;https://huggingface.co/models&#34;&gt;HuggingFace Hub&lt;/a&gt; (e.g. GPT-J-6B) on &lt;code&gt;hellaswag&lt;/code&gt; you can use the following command:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python main.py \&#xA;    --model hf-causal \&#xA;    --model_args pretrained=EleutherAI/gpt-j-6B \&#xA;    --tasks hellaswag \&#xA;    --device cuda:0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Additional arguments can be provided to the model constructor using the &lt;code&gt;--model_args&lt;/code&gt; flag. Most notably, this supports the common practice of using the &lt;code&gt;revisions&lt;/code&gt; feature on the Hub to store partially trained checkpoints, or to specify the datatype for running a model:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python main.py \&#xA;    --model hf-causal \&#xA;    --model_args pretrained=EleutherAI/pythia-160m,revision=step100000,dtype=&#34;float&#34; \&#xA;    --tasks lambada_openai,hellaswag \&#xA;    --device cuda:0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To evaluate models that are loaded via &lt;code&gt;AutoSeq2SeqLM&lt;/code&gt; in Huggingface, you instead use &lt;code&gt;hf-seq2seq&lt;/code&gt;. &lt;em&gt;To evaluate (causal) models across multiple GPUs, use &lt;code&gt;--model hf-causal-experimental&lt;/code&gt;&lt;/em&gt;&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;: Choosing the wrong model may result in erroneous outputs despite not erroring.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h3&gt;Commercial APIs&lt;/h3&gt; &#xA;&lt;p&gt;Our library also supports language models served via the OpenAI API:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export OPENAI_API_SECRET_KEY=YOUR_KEY_HERE&#xA;python main.py \&#xA;    --model gpt3 \&#xA;    --model_args engine=davinci \&#xA;    --tasks lambada_openai,hellaswag&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;While this functionality is only officially maintained for the official OpenAI API, it tends to also work for other hosting services that use the same API such as &lt;a href=&#34;https://raw.githubusercontent.com/EleutherAI/lm-evaluation-harness/master/goose.ai&#34;&gt;goose.ai&lt;/a&gt; with minor modification. We also have an implementation for the &lt;a href=&#34;https://textsynth.com/index.html&#34;&gt;TextSynth&lt;/a&gt; API, using &lt;code&gt;--model textsynth&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;To verify the data integrity of the tasks you&#39;re performing in addition to running the tasks themselves, you can use the &lt;code&gt;--check_integrity&lt;/code&gt; flag:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python main.py \&#xA;    --model gpt3 \&#xA;    --model_args engine=davinci \&#xA;    --tasks lambada_openai,hellaswag \&#xA;    --check_integrity&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Other Frameworks&lt;/h3&gt; &#xA;&lt;p&gt;A number of other libraries contain scripts for calling the eval harness through their library. These include &lt;a href=&#34;https://github.com/EleutherAI/gpt-neox/raw/main/eval_tasks/eval_adapter.py&#34;&gt;GPT-NeoX&lt;/a&gt;, &lt;a href=&#34;https://github.com/microsoft/Megatron-DeepSpeed/raw/main/examples/MoE/readme_evalharness.md&#34;&gt;Megatron-DeepSpeed&lt;/a&gt;, and &lt;a href=&#34;https://github.com/kingoflolz/mesh-transformer-jax/raw/master/eval_harness.py&#34;&gt;mesh-transformer-jax&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;ðŸ’¡ &lt;strong&gt;Tip&lt;/strong&gt;: You can inspect what the LM inputs look like by running the following command:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python write_out.py \&#xA;    --tasks all_tasks \&#xA;    --num_fewshot 5 \&#xA;    --num_examples 10 \&#xA;    --output_base_path /path/to/output/folder&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This will write out one text file for each task.&lt;/p&gt; &#xA;&lt;h2&gt;Advanced Usage&lt;/h2&gt; &#xA;&lt;p&gt;For models loaded with the HuggingFace &lt;code&gt;transformers&lt;/code&gt; library, any arguments provided via &lt;code&gt;--model_args&lt;/code&gt; get passed to the relevant constructor directly. This means that anything you can do with &lt;code&gt;AutoModel&lt;/code&gt; can be done with our library. For example, you can pass a local path via &lt;code&gt;pretrained=&lt;/code&gt; or use models finetuned with &lt;a href=&#34;https://github.com/huggingface/peft&#34;&gt;PEFT&lt;/a&gt; by taking the call you would run to evaluate the base model and add &lt;code&gt;,peft=PATH&lt;/code&gt; to the &lt;code&gt;model_args&lt;/code&gt; argument:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python main.py \&#xA;    --model hf-causal-experimental \&#xA;    --model_args pretrained=EleutherAI/gpt-j-6b,peft=nomic-ai/gpt4all-j-lora \&#xA;    --tasks openbookqa,arc_easy,winogrande,hellaswag,arc_challenge,piqa,boolq \&#xA;    --device cuda:0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;GPTQ quantized models can be loaded by specifying their file names in &lt;code&gt;,quantized=NAME&lt;/code&gt; (or &lt;code&gt;,quantized=True&lt;/code&gt; for default names) in the &lt;code&gt;model_args&lt;/code&gt; argument:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python main.py \&#xA;    --model hf-causal-experimental \&#xA;    --model_args pretrained=model-name-or-path,quantized=model.safetensors,gptq_use_triton=True \&#xA;    --tasks hellaswag&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;We support wildcards in task names, for example you can run all of the machine-translated lambada tasks via &lt;code&gt;--task lambada_openai_mt_*&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;We currently only support one prompt per task, which we strive to make the &#34;standard&#34; as defined by the benchmark&#39;s authors. If you would like to study how varying prompts causes changes in the evaluation score, check out the &lt;a href=&#34;https://github.com/bigscience-workshop/lm-evaluation-harness&#34;&gt;BigScience fork&lt;/a&gt; of this repo. We are currently working on upstreaming this capability to &lt;code&gt;main&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Implementing new tasks&lt;/h2&gt; &#xA;&lt;p&gt;To implement a new task in the eval harness, see &lt;a href=&#34;https://raw.githubusercontent.com/EleutherAI/lm-evaluation-harness/master/docs/task_guide.md&#34;&gt;this guide&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Task Versioning&lt;/h2&gt; &#xA;&lt;p&gt;To help improve reproducibility, all tasks have a &lt;code&gt;VERSION&lt;/code&gt; field. When run from the command line, this is reported in a column in the table, or in the &#34;version&#34; field in the evaluator return dict. The purpose of the version is so that if the task definition changes (i.e to fix a bug), then we can know exactly which metrics were computed using the old buggy implementation to avoid unfair comparisons. To enforce this, there are unit tests that make sure the behavior of all tests remains the same as when they were first implemented. Task versions start at 0, and each time a breaking change is made, the version is incremented by one.&lt;/p&gt; &#xA;&lt;p&gt;When reporting eval harness results, please also report the version of each task. This can be done either with a separate column in the table, or by reporting the task name with the version appended as such: taskname-v0.&lt;/p&gt; &#xA;&lt;h2&gt;Test Set Decontamination&lt;/h2&gt; &#xA;&lt;p&gt;To address concerns about train / test contamination, we provide utilities for comparing results on a benchmark using only the data points not found in the model training set. Unfortunately, outside of models trained on the Pile and C4, its very rare that people who train models disclose the contents of the training data. However this utility can be useful to evaluate models you have trained on private data, provided you are willing to pre-compute the necessary indices. We provide computed indices for 13-gram exact match deduplication against the Pile, and plan to add additional precomputed dataset indices in the future (including C4 and min-hash LSH deduplication).&lt;/p&gt; &#xA;&lt;p&gt;For details on text decontamination, see the &lt;a href=&#34;https://raw.githubusercontent.com/EleutherAI/lm-evaluation-harness/master/docs/decontamination.md&#34;&gt;decontamination guide&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Note that the directory provided to the &lt;code&gt;--decontamination_ngrams_path&lt;/code&gt; argument should contain the ngram files and info.json. See the above guide for ngram generation for the pile, this could be adapted for other training sets.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;python main.py \&#xA;    --model gpt2 \&#xA;    --tasks sciq \&#xA;    --decontamination_ngrams_path path/containing/training/set/ngrams \&#xA;    --device cuda:0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Cite as&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code&gt;@software{eval-harness,&#xA;  author       = {Gao, Leo and&#xA;                  Tow, Jonathan and&#xA;                  Biderman, Stella and&#xA;                  Black, Sid and&#xA;                  DiPofi, Anthony and&#xA;                  Foster, Charles and&#xA;                  Golding, Laurence and&#xA;                  Hsu, Jeffrey and&#xA;                  McDonell, Kyle and&#xA;                  Muennighoff, Niklas and&#xA;                  Phang, Jason and&#xA;                  Reynolds, Laria and&#xA;                  Tang, Eric and&#xA;                  Thite, Anish and&#xA;                  Wang, Ben and&#xA;                  Wang, Kevin and&#xA;                  Zou, Andy},&#xA;  title        = {A framework for few-shot language model evaluation},&#xA;  month        = sep,&#xA;  year         = 2021,&#xA;  publisher    = {Zenodo},&#xA;  version      = {v0.0.1},&#xA;  doi          = {10.5281/zenodo.5371628},&#xA;  url          = {https://doi.org/10.5281/zenodo.5371628}&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>