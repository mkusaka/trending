<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Lua Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2022-06-19T01:46:23Z</updated>
  <subtitle>Daily Trending of Lua in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>pkulchenko/fullmoon</title>
    <updated>2022-06-19T01:46:23Z</updated>
    <id>tag:github.com,2022-06-19:/pkulchenko/fullmoon</id>
    <link href="https://github.com/pkulchenko/fullmoon" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Fast and minimalistic Redbean-based Lua web framework in one file.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Fullmoon&lt;/h1&gt; &#xA;&lt;p&gt;Fullmoon is a &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#benchmark&#34;&gt;fast&lt;/a&gt; and minimalistic web framework based on &lt;a href=&#34;https://redbean.dev/&#34;&gt;Redbean&lt;/a&gt; -- a portable, single-file distributable web server.&lt;/p&gt; &#xA;&lt;p&gt;Everything needed for development and distribution comes in a single file with no external dependencies and after packaging with Redbean runs on Windows, Linux, or macOS. The following is a complete example of a Fullmoon application:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;local fm = require &#34;fullmoon&#34;&#xA;fm.setTemplate(&#34;hello&#34;, &#34;Hello, {%&amp;amp; name %}&#34;)&#xA;fm.setRoute(&#34;/hello/:name&#34;, function(r)&#xA;    return fm.serveContent(&#34;hello&#34;, {name = r.params.name})&#xA;  end)&#xA;fm.run()&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;After it is &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#installation&#34;&gt;packaged with Redbean&lt;/a&gt;, it can be launched using &lt;code&gt;./redbean.com&lt;/code&gt;, which starts a server that returns &#34;Hello, world&#34; to an HTTP(S) request sent to &lt;a href=&#34;http://localhost:8080/hello/world&#34;&gt;http://localhost:8080/hello/world&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Contents&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#why-fullmoon&#34;&gt;Why Fullmoon&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#what-redbean-provides&#34;&gt;What Redbean provides&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#what-fullmoon-adds&#34;&gt;What Fullmoon adds&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#installation&#34;&gt;Installation&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#usage&#34;&gt;Usage&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#quick-reference&#34;&gt;Quick reference&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#examples&#34;&gt;Examples&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#showcase-example&#34;&gt;Showcase example&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#techempower-benchmark-example&#34;&gt;TechEmpower benchmark example&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#htmx-board-example&#34;&gt;htmx board example&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#htmx-sse-example&#34;&gt;htmx SSE example&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#documentation&#34;&gt;Documentation&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#routes&#34;&gt;Routes&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#basic-routes&#34;&gt;Basic routes&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#routes-with-parameters&#34;&gt;Routes with parameters&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#optional-parameters&#34;&gt;Optional parameters&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#custom-parameters&#34;&gt;Custom parameters&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#query-and-form-parameters&#34;&gt;Query and Form parameters&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#multiple-routes&#34;&gt;Multiple routes&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#named-routes&#34;&gt;Named routes&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#external-routes&#34;&gt;External routes&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#internal-routes&#34;&gt;Internal routes&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#conditions&#34;&gt;Conditions&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#handling-of-http-methods&#34;&gt;Handling of HTTP methods&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#conditional-routes&#34;&gt;Conditional routes&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#custom-validators&#34;&gt;Custom validators&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#responding-on-failed-conditions&#34;&gt;Responding on failed conditions&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#actions&#34;&gt;Actions&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#requests&#34;&gt;Requests&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#headers&#34;&gt;Headers&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#cookies&#34;&gt;Cookies&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#session&#34;&gt;Session&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#utility-functions&#34;&gt;Utility functions&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#templates&#34;&gt;Templates&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#configuring-templates&#34;&gt;Configuring templates&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-template-outputs&#34;&gt;Serving template outputs&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#passing-parameters-to-templates&#34;&gt;Passing parameters to templates&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#including-templates-in-other-templates&#34;&gt;Including templates in other templates&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#processing-layouts&#34;&gt;Processing layouts&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#responses&#34;&gt;Responses&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-response&#34;&gt;Serving response&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-redirect&#34;&gt;Serving redirect&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-static-asset&#34;&gt;Serving static asset&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-error&#34;&gt;Serving error&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-directory-index&#34;&gt;Serving directory index&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#serving-path-(internal-redirect)&#34;&gt;Serving path (internal redirect)&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#running-application&#34;&gt;Running application&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#cookie-options&#34;&gt;Cookie options&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#session-options&#34;&gt;Session options&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#logging&#34;&gt;Logging&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#benchmark&#34;&gt;Benchmark&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#status&#34;&gt;Status&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#author&#34;&gt;Author&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#license&#34;&gt;License&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Why Fullmoon&lt;/h2&gt; &#xA;&lt;p&gt;Redbean is a single-file distributable cross-platform web server with unique and powerful qualities. While there are several Lua-based web frameworks (&lt;a href=&#34;https://leafo.net/lapis/&#34;&gt;Lapis&lt;/a&gt;, &lt;a href=&#34;https://github.com/sumory/lor&#34;&gt;Lor&lt;/a&gt;, &lt;a href=&#34;https://github.com/sailorproject/sailor&#34;&gt;Sailor&lt;/a&gt;, &lt;a href=&#34;https://github.com/EvandroLG/pegasus.lua&#34;&gt;Pegasus&lt;/a&gt;, and others), none of them integrate with Redbean (although there is an experimental framework &lt;a href=&#34;https://git.sr.ht/~shakna/anpan&#34;&gt;anpan&lt;/a&gt;).&lt;/p&gt; &#xA;&lt;p&gt;Fullmoon is a lightweight and minimalistic web framework that is written from the perspective of showcasing all the capabilities that Redbean provides by extending and augmenting them in the simplest and the most efficient way. It runs fast and comes with batteries included (routes, templates, JSON generation and more).&lt;/p&gt; &#xA;&lt;p&gt;Fullmoon follows the Lua philosophy and provides a minimal set of tools to combine as needed and use as the basis to build upon.&lt;/p&gt; &#xA;&lt;h3&gt;What Redbean provides&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Single file deployment and distribution (Linux, Windows, and macOS)&lt;/li&gt; &#xA; &lt;li&gt;Integrated SSL support (using MbedTLS) including SSL virtual hosting&lt;/li&gt; &#xA; &lt;li&gt;Integrated crypto hashing (SHA1, SHA224/256/384/512, and BLAKE2B256)&lt;/li&gt; &#xA; &lt;li&gt;Efficient serving of static and gzip encoded assets&lt;/li&gt; &#xA; &lt;li&gt;Integrated password-hashing (using Argon2)&lt;/li&gt; &#xA; &lt;li&gt;unix.* module for Unix system interfaces&lt;/li&gt; &#xA; &lt;li&gt;HTTP/HTTPS client for external requests&lt;/li&gt; &#xA; &lt;li&gt;Ships with Lua 5.4 and SQLite 3.35&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;What Fullmoon adds&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Lightweight package (~1000 LOC) with no external dependencies&lt;/li&gt; &#xA; &lt;li&gt;Simple and flexible routing with variables and custom filters&lt;/li&gt; &#xA; &lt;li&gt;Template engine with JSON support and efficient memory utilization&lt;/li&gt; &#xA; &lt;li&gt;Optimized execution with pre-compiled routes and lazy loaded methods&lt;/li&gt; &#xA; &lt;li&gt;Response streaming and Server-Sent Events support&lt;/li&gt; &#xA; &lt;li&gt;Cookie/header/session generation and processing&lt;/li&gt; &#xA; &lt;li&gt;Parametrized URL rewrites and re-routing&lt;/li&gt; &#xA; &lt;li&gt;Custom 404 and other status pages&lt;/li&gt; &#xA; &lt;li&gt;Access to all Redbean features&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;h3&gt;Step 1: Get the latest Redbean (v2.0+)&lt;/h3&gt; &#xA;&lt;p&gt;Download a copy of Redbean by running the following commands (skip the second one if running these commands on Windows):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;curl -o redbean.com https://justine.lol/redbean/redbean-latest.com&#xA;chmod +x redbean.com&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Another option is to build Redbean from source by following instructions for the &lt;a href=&#34;https://redbean.dev/#source&#34;&gt;source build&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Note that using response streaming and Server-Sent Events requires using &lt;a href=&#34;https://redbean.dev/&#34;&gt;Redbean v2.0 or later&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Step 2: Prepare Fullmoon code&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Copy &lt;code&gt;fullmoon.lua&lt;/code&gt; to &lt;code&gt;.lua/&lt;/code&gt; folder&lt;/li&gt; &#xA; &lt;li&gt;Save the application code to a file named &lt;code&gt;.init.lua&lt;/code&gt; (for example, the Lua code shown in the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#fullmoon&#34;&gt;description&lt;/a&gt;).&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Another option is to place the application code into a separate file (for example, &lt;code&gt;.lua/myapp.lua&lt;/code&gt;) and add &lt;code&gt;require &#34;myapp&#34;&lt;/code&gt; to &lt;code&gt;.init.lua&lt;/code&gt;. This is how &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#examples&#34;&gt;all included examples&lt;/a&gt; are presented.&lt;/p&gt; &#xA;&lt;h3&gt;Step 3: Package Fullmoon code with Redbean&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;zip redbean.com .init.lua .lua/fullmoon.lua&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If the application code is stored in a separate Lua file, as described above, make sure to place it inside the &lt;code&gt;.lua/&lt;/code&gt; folder and zip that file as well.&lt;/p&gt; &#xA;&lt;h3&gt;Step 4: Run the server&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;./redbean.com&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If this command is executed on Linux and throws an error about not finding interpreter, it should be fixed by running the following command (although note that it may not survive a system restart):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;sudo sh -c &#34;echo &#39;:APE:M::MZqFpD::/bin/sh:&#39; &amp;gt;/proc/sys/fs/binfmt_misc/register&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If this command produces puzzling errors on WSL or WINE when using Redbean 2.x, they may be fixed by disabling binfmt_misc:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;sudo sh -c &#39;echo -1 &amp;gt;/proc/sys/fs/binfmt_misc/status&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Step 5: Check the result&lt;/h3&gt; &#xA;&lt;p&gt;Launch a browser pointing at &lt;a href=&#34;http://127.0.0.1:8080/hello/world&#34;&gt;http://127.0.0.1:8080/hello/world&lt;/a&gt; and it should return &#34;Hello, world&#34; (assuming the application is using the code shown in the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#fullmoon&#34;&gt;introduction&lt;/a&gt; or the one in the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#usage&#34;&gt;usage&lt;/a&gt; section).&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;The simplest example needs to (1) load the module, (2) configure one route, and (3) run the application:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;local fm = require &#34;fullmoon&#34; -- (1)&#xA;fm.setRoute(&#34;/hello&#34;, function(r) return &#34;Hello, world&#34; end) -- (2)&#xA;fm.run() -- (3)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This application responds to any request for &lt;code&gt;/hello&lt;/code&gt; URL with returning &#34;Hello, world&#34; content (and 200 HTTP status) and responds with returning 404 status for all other requests.&lt;/p&gt; &#xA;&lt;h2&gt;Quick reference&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;code&gt;setRoute(route[, action])&lt;/code&gt;: registers a route. If &lt;code&gt;route&lt;/code&gt; is a string, then it is used as a route &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#basic-routes&#34;&gt;expression&lt;/a&gt; to compare the request path against. If it is a table, then its elements are strings that are used as &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#multiple-routes&#34;&gt;routes&lt;/a&gt; and its hash values are &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#conditional-routes&#34;&gt;conditions&lt;/a&gt; that the routes are checked against. If the second parameter is a &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#actions&#34;&gt;function&lt;/a&gt;, then it is executed if all conditions are satisfied. If it is a string, then it is used as a route expression and the request is processed as if it is sent at the specified route (acts as an &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#internal-routes&#34;&gt;internal redirect&lt;/a&gt;). If any condition is not satisifed, then the next route is checked. The route expression can have multiple &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#routes-with-parameters&#34;&gt;parameters&lt;/a&gt; and &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#optional-parameters&#34;&gt;optional parts&lt;/a&gt;. The action handler accepts a &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#requests&#34;&gt;request table&lt;/a&gt; that provides access to request and route parameters, as well as &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#headers&#34;&gt;headers&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#cookies&#34;&gt;cookies&lt;/a&gt;, and &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#session&#34;&gt;session&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;code&gt;setTemplate(name, template)&lt;/code&gt;: registers a template with the specified name. If &lt;code&gt;template&lt;/code&gt; is a string, then it&#39;s compiled into a template handler. If it is a function, it is stored and called when rendering of the template is requested. If it&#39;s a table, then its first element is a template or a function and the rest are used as options. For example, specifying &lt;code&gt;ContentType&lt;/code&gt; as one of the options sets the &lt;code&gt;Content-Type&lt;/code&gt; header for the generated content. Two templates (&lt;code&gt;500&lt;/code&gt; and &lt;code&gt;json&lt;/code&gt;) are provided by default and can be overwritten.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;code&gt;serveResponse(status[, headers][, body])&lt;/code&gt;: sends an HTTP response using provided &lt;code&gt;status&lt;/code&gt;, &lt;code&gt;headers&lt;/code&gt;, and &lt;code&gt;body&lt;/code&gt; values. &lt;code&gt;headers&lt;/code&gt; is an optional table populated with HTTP header name/value pairs. If provided, this set of headers &lt;em&gt;removes all other headers&lt;/em&gt; set earlier during handling of the same request. Header names are &lt;em&gt;case-insensitive&lt;/em&gt;, but provided aliases for header names with dashes are &lt;em&gt;case-sensitive&lt;/em&gt;: &lt;code&gt;{ContentType = &#34;foo&#34;}&lt;/code&gt; is an alternative form for &lt;code&gt;{[&#34;Content-Type&#34;] = &#34;foo&#34;}&lt;/code&gt;. &lt;code&gt;body&lt;/code&gt; is an optional string.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;code&gt;serveContent(name, parameters)&lt;/code&gt;: renders a template using provided parameters. &lt;code&gt;name&lt;/code&gt; is a string that names the template (as set by a &lt;code&gt;setTemplate&lt;/code&gt; call) and &lt;code&gt;parameters&lt;/code&gt; is a table with template parameters (referenced as variables in the template).&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;code&gt;run([options])&lt;/code&gt;: runs the server using configured routes. By default the server listens on localhost and port 8080. These values can be changed by setting &lt;code&gt;addr&lt;/code&gt; and &lt;code&gt;port&lt;/code&gt; values in the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#running-application&#34;&gt;&lt;code&gt;options&lt;/code&gt; table&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Examples&lt;/h2&gt; &#xA;&lt;p&gt;Running examples requires including a &lt;code&gt;require&lt;/code&gt; statement in the &lt;code&gt;.init.lua&lt;/code&gt; file, which loads the module with each example code, so for the showcase example implemented in &lt;code&gt;showcase.lua&lt;/code&gt;, &lt;code&gt;.init.lua&lt;/code&gt; includes the following:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;-- this is the content of .init.lua&#xA;require &#34;showcase&#34;&#xA;-- this loads `showcase` module from `.lua/showcase.lua` file,&#xA;-- which also loads its `fullmoon` depenency from `.lua/fullmoon.lua`&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Showcase example&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/examples/showcase.lua&#34;&gt;showcase example&lt;/a&gt; demonstrates several Fullmoon features:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;serving static assets (using &lt;code&gt;serveAsset&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;setting http to https redirect&lt;/li&gt; &#xA; &lt;li&gt;setting 404 template&lt;/li&gt; &#xA; &lt;li&gt;configuring internal redirect&lt;/li&gt; &#xA; &lt;li&gt;configuring external redirect (using &lt;code&gt;serveRedirect&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;filtering for loopback ip client addresses&lt;/li&gt; &#xA; &lt;li&gt;filtering based on parameter values using regex&lt;/li&gt; &#xA; &lt;li&gt;serving json&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The following files need to be added to redbean executable/archive:&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;.init.lua -- require &#34;showcase&#34;&#xA;.lua/fullmoon.lua&#xA;.lua/showcase.lua&#xA;&lt;/pre&gt; &#xA;&lt;h3&gt;TechEmpower benchmark example&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/examples/techbench.lua&#34;&gt;TechEmpower example&lt;/a&gt; implements various test types for the &lt;a href=&#34;https://www.techempower.com/benchmarks/&#34;&gt;web framework benchmarks&lt;/a&gt; using Fullmoon and an in-memory sqlite database.&lt;/p&gt; &#xA;&lt;p&gt;This example demonstrates several Fullmoon/redbean features:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;routing for various endpoints&lt;/li&gt; &#xA; &lt;li&gt;serving text and json content&lt;/li&gt; &#xA; &lt;li&gt;filtering for specific HTTP methods&lt;/li&gt; &#xA; &lt;li&gt;using templates with embedded Lua code&lt;/li&gt; &#xA; &lt;li&gt;using select/insert statements with included SQLite engine&lt;/li&gt; &#xA; &lt;li&gt;executing prepared SQL statements&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The following files need to be added to redbean executable/archive:&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;.init.lua -- require &#34;techbench&#34;&#xA;.lua/fullmoon.lua&#xA;.lua/techbench.lua&#xA;&lt;/pre&gt; &#xA;&lt;h3&gt;htmx board example&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/examples/htmxboard/htmxboard.lua&#34;&gt;htmx board example&lt;/a&gt; demonstrates a simple application that generates HTML fragments delivered to the client using &lt;a href=&#34;https://htmx.org/&#34;&gt;htmx library&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This example demonstrates several Fullmoon/redbean features:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;handling of GET, POST, PUT, and DELETE HTTP methods&lt;/li&gt; &#xA; &lt;li&gt;serving of dynamic HTML fragments and static assets&lt;/li&gt; &#xA; &lt;li&gt;processing of required and optional parameters&lt;/li&gt; &#xA; &lt;li&gt;loading of templates from a directory&lt;/li&gt; &#xA; &lt;li&gt;using 10+ templates of two different types&lt;/li&gt; &#xA; &lt;li&gt;including templates into other templates and passing parameters to templates&lt;/li&gt; &#xA; &lt;li&gt;serving of internal state for debugging purposes as a local-only resource&lt;/li&gt; &#xA; &lt;li&gt;using &#34;fallthrough&#34; routes to imitate &#34;before&#34; hook&lt;/li&gt; &#xA; &lt;li&gt;using internal redirects&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The following files need to be added to redbean executable/archive:&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;.init.lua -- require &#34;htmxboard&#34;&#xA;.lua/fullmoon.lua&#xA;.lua/htmxboard.lua&#xA;assets/stypes.css&#xA;tmpl/* -- all files from examples/htmxboard/tmpl folder&#xA;&lt;/pre&gt; &#xA;&lt;p&gt;Note 1: since all the data is stored in memory, &lt;strong&gt;this example is executed in the uniprocess mode.&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;Note 2: this examples retrieves htmx, hyperscript, and sortable libraries from external resources, but these libraries can be also stored as local assets, thus providing a completely self-sufficient portable distribution package.&lt;/p&gt; &#xA;&lt;h3&gt;htmx SSE example&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/examples/htmxsse.lua&#34;&gt;htmx SSE example&lt;/a&gt; demostrates a way to generate server-sent events (SSE) that can be streamed to a client (which shows results using &lt;a href=&#34;https://htmx.org/&#34;&gt;htmx library&lt;/a&gt; and its SSE extension).&lt;/p&gt; &#xA;&lt;p&gt;This example demonstrates several Fullmoon/redbean features:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;usage of &#34;sse&#34; template to generate SSE content&lt;/li&gt; &#xA; &lt;li&gt;streaming of responses (using &lt;code&gt;streamContent&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;logging of messages&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The following files need to be added to redbean executable/archive:&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;.init.lua -- require &#34;htmxsse&#34;&#xA;.lua/fullmoon.lua&#xA;.lua/htmxsse.lua&#xA;&lt;/pre&gt; &#xA;&lt;h2&gt;Documentation&lt;/h2&gt; &#xA;&lt;p&gt;Each Fullmoon application follows the same basic flow with five main components:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#running-application&#34;&gt;configures and runs&lt;/a&gt; a redbean server, which&lt;/li&gt; &#xA; &lt;li&gt;filters each request based on specified &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#conditions&#34;&gt;conditions&lt;/a&gt;, and&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#routes&#34;&gt;routes&lt;/a&gt; it to an &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#actions&#34;&gt;action handler&lt;/a&gt;, that&lt;/li&gt; &#xA; &lt;li&gt;generates content (using provided &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#templates&#34;&gt;template engine&lt;/a&gt;), and&lt;/li&gt; &#xA; &lt;li&gt;serves a &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#responses&#34;&gt;response&lt;/a&gt;.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Let&#39;s look at each of the components starting from the request routing.&lt;/p&gt; &#xA;&lt;h3&gt;Routes&lt;/h3&gt; &#xA;&lt;p&gt;Fullmoon handles each HTTP request using the same process:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;takes the path URL and matches it against each route URL in the order in which routes are registered&lt;/li&gt; &#xA; &lt;li&gt;verifies conditions for those routes that match&lt;/li&gt; &#xA; &lt;li&gt;calls a specified action handler (passing a request table) for those routes that satisfy all conditions&lt;/li&gt; &#xA; &lt;li&gt;serves the response if anything other than &lt;code&gt;false&lt;/code&gt; or &lt;code&gt;nil&lt;/code&gt; returned from the action handler (and continues the process otherwise)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;In general, route definitions bind request URLs (and a set of conditions) to action handlers (which are regular Lua function). All conditions are checked in a random order for each URL that matches the route definition. As soon as any condition fails, the route processing is aborted and the next route is checked &lt;em&gt;with one exception&lt;/em&gt;: any condition can set the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#responding-on-failed-conditions&#34;&gt;&lt;code&gt;otherwise&lt;/code&gt; value&lt;/a&gt;, which triggers a response with the specified status.&lt;/p&gt; &#xA;&lt;p&gt;If no route matches the request, then the default 404 processing is triggered, which can be customized by registering a custom 404 template (&lt;code&gt;fm.setTemplate(&#34;404&#34;, &#34;My 404 page...&#34;)&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;h4&gt;Basic routes&lt;/h4&gt; &#xA;&lt;p&gt;Each route takes a path that matches exactly, so the route &lt;code&gt;&#34;/hello&#34;&lt;/code&gt; matches requests for &lt;code&gt;/hello&lt;/code&gt; and doesn&#39;t match &lt;code&gt;/hell&lt;/code&gt;, &lt;code&gt;/hello-world&lt;/code&gt;, or &lt;code&gt;/hello/world&lt;/code&gt;. To match a path where &lt;code&gt;/hello&lt;/code&gt; is only a part of it, &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#optional-parameters&#34;&gt;optional parameters and splat can be used&lt;/a&gt;).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/hello&#34;, function(r) return &#34;Hello, World!&#34; end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This application responds with &#34;Hello, World!&#34; for all requests directed at the &lt;code&gt;/hello&lt;/code&gt; path and returns 404 for all other requests.&lt;/p&gt; &#xA;&lt;h4&gt;Routes with parameters&lt;/h4&gt; &#xA;&lt;p&gt;In addition to fixed routes, any path may include placeholders for parameters, which are identified by a &lt;code&gt;:&lt;/code&gt; followed immediately by the parameter name:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/hello/:name&#34;,&#xA;  function(r) return &#34;Hello, &#34;..(r.params.name) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Each parameter matches one or more characters except &lt;code&gt;/&lt;/code&gt;, so the route &lt;code&gt;&#34;/hello/:name&#34;&lt;/code&gt; matches &lt;code&gt;/hello/alice&lt;/code&gt;, &lt;code&gt;/hello/bob&lt;/code&gt;, &lt;code&gt;/hello/123&lt;/code&gt; and does not match &lt;code&gt;/hello/bob/and/alice&lt;/code&gt; (because of the non-matched forward slashes) or &lt;code&gt;/hello/&lt;/code&gt; (because the length of the to-be-matched fragment is zero).&lt;/p&gt; &#xA;&lt;p&gt;Parameter names can only include alphanumeric characters and &lt;code&gt;_&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Parameters can be accessed using the request table and its &lt;code&gt;params&lt;/code&gt; table, such that &lt;code&gt;r.params.name&lt;/code&gt; can be used to get the value of the &lt;code&gt;name&lt;/code&gt; parameter from the earlier example.&lt;/p&gt; &#xA;&lt;p&gt;There is another kind of parameter called splat that is written as &lt;code&gt;*&lt;/code&gt; and matches zero or more characters, &lt;em&gt;including&lt;/em&gt; a forward slash (&lt;code&gt;/&lt;/code&gt;). The splat is also stored in the &lt;code&gt;params&lt;/code&gt; table under the &lt;code&gt;splat&lt;/code&gt; name. For example, the route &lt;code&gt;&#34;/download/*&#34;&lt;/code&gt; matches &lt;code&gt;/download/my/file.zip&lt;/code&gt; and the splat gets the value of &lt;code&gt;my/file.zip&lt;/code&gt;. If multiple splats are needed in the same route, then splats can be assigned names similar to other parameters: &lt;code&gt;/download/*path/*fname.zip&lt;/code&gt; (although the same result can be achieved using &lt;code&gt;/download/*path/:fname.zip&lt;/code&gt;, as the first splat captures all path parts except the filename).&lt;/p&gt; &#xA;&lt;p&gt;All parameters (including the splat) can appear in any part of the path and can be surrounded by other text, which needs to be matched exactly. This means that the route &lt;code&gt;&#34;/download/*/:name.:ext&#34;&lt;/code&gt; matches &lt;code&gt;/download/my/path/file.zip&lt;/code&gt; and &lt;code&gt;params.name&lt;/code&gt; gets &lt;code&gt;file&lt;/code&gt;, &lt;code&gt;params.ext&lt;/code&gt; gets &lt;code&gt;zip&lt;/code&gt; and &lt;code&gt;params.splat&lt;/code&gt; gets &lt;code&gt;my/path&lt;/code&gt; values.&lt;/p&gt; &#xA;&lt;h4&gt;Optional parameters&lt;/h4&gt; &#xA;&lt;p&gt;Any specified route fragment or parameter can be declared as optional by wrapping it into parentheses:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/hello(/:name)&#34;,&#xA;  function(r) return &#34;Hello, &#34;..(r.params.name or &#34;World!&#34;) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In the example above, both &lt;code&gt;/hello&lt;/code&gt; and &lt;code&gt;/hello/Bob&lt;/code&gt; are accepted, but not &lt;code&gt;/hello/&lt;/code&gt;, as the trailing slash is part of the optional fragment and &lt;code&gt;:name&lt;/code&gt; still expects one or more characters.&lt;/p&gt; &#xA;&lt;p&gt;Any unmatched optional parameter gets &lt;code&gt;false&lt;/code&gt; as its value, so in the case above &#34;Hello, World!&#34; gets returned for the &lt;code&gt;/hello&lt;/code&gt; request URL.&lt;/p&gt; &#xA;&lt;p&gt;More than one optional parameter can be specified and optional fragments can be nested, so both &lt;code&gt;&#34;/posts(/:pid/comments(/:cid))&#34;&lt;/code&gt; and &lt;code&gt;&#34;/posts(/:pid)/comments(/:cid)&#34;&lt;/code&gt; are valid route values.&lt;/p&gt; &#xA;&lt;h4&gt;Custom parameters&lt;/h4&gt; &#xA;&lt;p&gt;The default value for the parameters is all characters (except &lt;code&gt;/&lt;/code&gt;) of length one or more. To specify a different set of valid characters, it can be added at the end of the variable name; for example, using &lt;code&gt;:id[%d]&lt;/code&gt; instead of &lt;code&gt;:id&lt;/code&gt; changes the parameter to match only digits.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/hello(/:id[%d])&#34;,&#xA;  function(r) return &#34;Hello, &#34;..(r.params.id or &#34;World!&#34;) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The following Lua character classes are supported: &lt;code&gt;%w&lt;/code&gt;, &lt;code&gt;%d&lt;/code&gt;, &lt;code&gt;%a&lt;/code&gt;, &lt;code&gt;%l&lt;/code&gt;, &lt;code&gt;%u&lt;/code&gt;, and &lt;code&gt;%x&lt;/code&gt;; any punctuation character (including &lt;code&gt;%&lt;/code&gt; and &lt;code&gt;]&lt;/code&gt;) can also be escaped with &lt;code&gt;%&lt;/code&gt;. Negative classes (written in Lua as &lt;code&gt;%W&lt;/code&gt;) are &lt;em&gt;not supported&lt;/em&gt;, but not-in-set syntax is supported, so &lt;code&gt;[^%d]&lt;/code&gt; matches a parameter that doesn&#39;t include any digits.&lt;/p&gt; &#xA;&lt;p&gt;Note that the number of repetitions can&#39;t be changed (so &lt;code&gt;:id[%d]*&lt;/code&gt; is not a valid way to accept zero-or-more digits), as only sets are allowed and the values still accept one or more characters. If more flexibility in describing acceptable formats is needed, then &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#custom-valdators&#34;&gt;custom validators&lt;/a&gt; can be used to extend the matching logic.&lt;/p&gt; &#xA;&lt;h4&gt;Query and Form parameters&lt;/h4&gt; &#xA;&lt;p&gt;Query and form parameters can be accessed in the same way as the path parameters using the &lt;code&gt;params&lt;/code&gt; table in the &lt;code&gt;request&lt;/code&gt; table that is passed to each action handler. Note that if there is a conflict between parameter and query/form names, then &lt;strong&gt;parameter names take precedence&lt;/strong&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Multiple routes&lt;/h4&gt; &#xA;&lt;p&gt;Despite all earlier examples showing a single route, it&#39;s rarely the case in real applications; when multiple routes are present, they are always &lt;strong&gt;evaluated in the order in which they are registered&lt;/strong&gt;.&lt;/p&gt; &#xA;&lt;p&gt;One &lt;code&gt;setRoute&lt;/code&gt; call can also set multiple routes when they have the same set of conditions and share the same action handler:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute({&#34;/route1&#34;, &#34;/route2&#34;}, handler)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This is equivalent to two calls setting each route individually:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/route1&#34;, handler)&#xA;fm.setRoute(&#34;/route2&#34;, handler)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Given that routes are evaluated in the order in which they are set, more selective routes need to be set first, otherwise they may not get a chance to be evaluated:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/user/bob&#34;, handlerBob)&#xA;fm.setRoute(&#34;/user/:name&#34;, handlerName)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If the routes are set in the opposite order, &lt;code&gt;/user/bob&lt;/code&gt; may never be checked as long as the &lt;code&gt;&#34;/user/:name&#34;&lt;/code&gt; action handler returns some non-&lt;code&gt;false&lt;/code&gt; result.&lt;/p&gt; &#xA;&lt;h4&gt;Named routes&lt;/h4&gt; &#xA;&lt;p&gt;Each route can be provided with an optional name, which is useful in referencing that route when its URL needs to be generated based on specific parameter values. Provided &lt;code&gt;makePath&lt;/code&gt; function accepts either a route name or a route URL itself as well as the parameter table and returns a path with populated parameter placeholders:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/user/:name&#34;, handlerName)&#xA;fm.setRoute({&#34;/post/:id&#34;, routeName = &#34;post&#34;}, handlerPost)&#xA;&#xA;fm.makePath(&#34;/user/:name&#34;, {name = &#34;Bob&#34;}) --&amp;gt; /user/Bob&#xA;fm.makePath(&#34;/post/:id&#34;, {id = 123}) --&amp;gt; /post/123&#xA;fm.makePath(&#34;post&#34;, {id = 123}) --&amp;gt; /post/123, same as the previous one&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If two routes use the same name, then the name is associated with the one that was registered last, but both routes are still present.&lt;/p&gt; &#xA;&lt;p&gt;The route name can also be used with external/static routes that are only used for URL generation.&lt;/p&gt; &#xA;&lt;h4&gt;External routes&lt;/h4&gt; &#xA;&lt;p&gt;If the route is only used for path generation, then it doesn&#39;t even need to have a route handler:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute({&#34;https://youtu.be/:videoid&#34;, routeName = &#34;youtube&#34;})&#xA;fm.makePath(&#34;youtube&#34;, {videoid = &#34;abc&#34;}) --&amp;gt; https://youtu.be/abc&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;A route without any action handler is skiped during the route matching process.&lt;/p&gt; &#xA;&lt;h4&gt;Internal routes&lt;/h4&gt; &#xA;&lt;p&gt;Internal routes allow redirecting of one set of URLs to a different one. The target URL can point to a static resource or a &lt;code&gt;.lua&lt;/code&gt; script. For example, if requests for one location need to be redirected to another, the following configuration redirects requests for any resources under &lt;code&gt;/blog/&lt;/code&gt; URL to those under &lt;code&gt;/new-blog/&lt;/code&gt; URL as long as the target resource exists:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/blog/*&#34;, &#34;/new-blog/*&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This route accepts a request for &lt;code&gt;/blog/post1&lt;/code&gt; and serves &lt;code&gt;/new-blog/post1&lt;/code&gt; as its reponse, as long as &lt;code&gt;/new-blog/post1&lt;/code&gt; asset exists. &lt;strong&gt;If the asset doesn&#39;t exist, then the next route is checked.&lt;/strong&gt; Similarly, using &lt;code&gt;fm.setRoute(&#34;/static/*&#34;, &#34;/*&#34;)&lt;/code&gt; causes requests for &lt;code&gt;/static/help.txt&lt;/code&gt; to be served resource &lt;code&gt;/help.txt&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Both URLs can include parameters that will be filled in if resolved:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/blog/:file&#34;, &#34;/new-blog/:file.html&#34;) --&amp;lt;&amp;lt;-- serve &#34;nice&#34; URLs&#xA;fm.setRoute(&#34;/new-blog/:file.html&#34;, fm.serveAsset) --&amp;lt;&amp;lt;-- serve original URLs&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This example resolves &#34;nice&#34; URLs serving their &#34;html&#34; versions. Note that this &lt;strong&gt;doesn&#39;t trigger the client-side redirect by returning (&lt;code&gt;3xx&lt;/code&gt;) status code&lt;/strong&gt;, but instead handles the re-routing internally. Also note that &lt;strong&gt;the second rule is needed to serve the &#34;original&#34; URLs,&lt;/strong&gt; as they are not handled by the first rule, because if the request is for &lt;code&gt;/blog/mylink.html&lt;/code&gt;, then the redirected URL is &lt;code&gt;/new-blog/mylink.html.html&lt;/code&gt;, which is not likely exist, so the route is skipped and the next one is checked. If handling of path separators is required as well, then &lt;code&gt;*path&lt;/code&gt; can be used instead of &lt;code&gt;:file&lt;/code&gt;, as &lt;code&gt;*&lt;/code&gt; allows path separators.&lt;/p&gt; &#xA;&lt;h3&gt;Conditions&lt;/h3&gt; &#xA;&lt;p&gt;If an application needs to execute different functions depending on specific values of request attributes (for example, a method), this library provides two main options: (1) check for the attribute value an action handler (for example, using &lt;code&gt;request.method == &#34;GET&#34;&lt;/code&gt; check) and (2) add a condition that filters out requests such that only requests using the specified attribute value reach the action handler. This section describes the second option in more detail.&lt;/p&gt; &#xA;&lt;h4&gt;Handling of HTTP methods&lt;/h4&gt; &#xA;&lt;p&gt;Each registered route by default responds to all HTTP methods (GET, PUT, POST, etc.), but it&#39;s possible to configure each route to only respond to specific HTTP methods:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(fm.GET&#34;/hello(/:name)&#34;,&#xA;  function(r) return &#34;Hello, &#34;..(r.params.name or &#34;World!&#34;) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In this case, the syntax &lt;code&gt;fm.GET&#34;/hello(/:name)&#34;&lt;/code&gt; configures the route to only accept &lt;code&gt;GET&lt;/code&gt; requests. This syntax is equivalent to passing a table with the route and any additional filtering conditions:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute({&#34;/hello(/:name)&#34;, method = &#34;GET&#34;},&#xA;  function(r) return &#34;Hello, &#34;..(r.params.name or &#34;World!&#34;) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If more than one method needs to be specified, then a table with a list of methods can be passed instead of one string value:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute({&#34;/hello(/:name)&#34;, method = {&#34;GET&#34;, &#34;POST&#34;}},&#xA;  function(r) return &#34;Hello, &#34;..(r.params.name or &#34;World!&#34;) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Every route that allows a &lt;code&gt;GET&lt;/code&gt; request also (implicitly) allows a &lt;code&gt;HEAD&lt;/code&gt; request and that request is handled by returning all headers without sending the body itself. If for some reason this implicit handling is not desirable, then adding &lt;code&gt;HEAD = false&lt;/code&gt; to the method table disables it (as in &lt;code&gt;method = {&#34;GET&#34;, &#34;POST&#34;, HEAD = false}&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;p&gt;Note that requests with non-matching methods don&#39;t get rejected, but rather &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#actions&#34;&gt;fall through&lt;/a&gt; to be checked by other routes and trigger the 404 status returned if they don&#39;t get matched (with one &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#responding-on-failed-conditions&#34;&gt;exception&lt;/a&gt;).&lt;/p&gt; &#xA;&lt;h4&gt;Conditional routes&lt;/h4&gt; &#xA;&lt;p&gt;In addition to &lt;code&gt;method&lt;/code&gt;, other conditions can be applied using &lt;code&gt;host&lt;/code&gt;, &lt;code&gt;clientAddr&lt;/code&gt;, &lt;code&gt;serverAddr&lt;/code&gt;, &lt;code&gt;scheme&lt;/code&gt;, request headers, and parameters. For example, specifying &lt;code&gt;name = &#34;Bob&#34;&lt;/code&gt; as one of the conditions ensures the value of the &lt;code&gt;name&lt;/code&gt; parameter to be &#34;Bob&#34; for the action handler to be called.&lt;/p&gt; &#xA;&lt;p&gt;Any request header can be checked using the header name as the key, so &lt;code&gt;ContentType = &#34;multipart/form-data&#34;&lt;/code&gt; is satisfied if the value of the &lt;code&gt;Content-Type&lt;/code&gt; header is &lt;code&gt;multipart/form-data&lt;/code&gt;. Note that the header value may include other elements (a boundary or a charset as part of the &lt;code&gt;Content-Type&lt;/code&gt; value) and only the actual media type is compared.&lt;/p&gt; &#xA;&lt;p&gt;Since names for headers, parameters and properties can overlap, they are checked in the following order:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;request headers that consist of multiple words, like &lt;code&gt;ContentType&lt;/code&gt;,&lt;/li&gt; &#xA; &lt;li&gt;request parameters,&lt;/li&gt; &#xA; &lt;li&gt;request properties (&lt;code&gt;method&lt;/code&gt;, &lt;code&gt;port&lt;/code&gt;, &lt;code&gt;host&lt;/code&gt;, etc.), and&lt;/li&gt; &#xA; &lt;li&gt;request headers again.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;Host&lt;/code&gt; header is also checked first (despite being a single word), so referencing &lt;code&gt;Host&lt;/code&gt; filters based on the header &lt;code&gt;Host&lt;/code&gt;, while referencing &lt;code&gt;host&lt;/code&gt; filters based on the property &lt;code&gt;host&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Custom validators&lt;/h4&gt; &#xA;&lt;p&gt;String values are not the only values that can be used in conditional routes. If more than one value is acceptable, passing a table allows to provide a list of acceptable values. For example, if &lt;code&gt;Bob&lt;/code&gt; and &lt;code&gt;Alice&lt;/code&gt; are acceptable values, then &lt;code&gt;name = {Bob = true, Alice = true}&lt;/code&gt; expresses this as a condition.&lt;/p&gt; &#xA;&lt;p&gt;Two special values passed in a table allow to apply a &lt;em&gt;regex&lt;/em&gt; or a &lt;em&gt;pattern&lt;/em&gt; validation:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;regex&lt;/code&gt;: accepts a string that has a regular expression. For example, &lt;code&gt;name = {regex = &#34;^(Bob|Alice)$&#34;}&lt;/code&gt; has the same result as the hash check shown earlier in this section&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;pattern&lt;/code&gt;: accepts a string with a Lua patern expression. For example, &lt;code&gt;name = {pattern = &#34;^%u%l+$&#34;}&lt;/code&gt; accepts values that start with an uppercase character followed by one or more lowercase characters.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;These two checks can be combined with the table existence check: &lt;code&gt;name = {Bob = true, regex = &#34;^Alice$&#34;}&lt;/code&gt; accepts both &lt;code&gt;Bob&lt;/code&gt; and &lt;code&gt;Alice&lt;/code&gt; values. If the first table-existence check fails, then the results of the &lt;code&gt;regex&lt;/code&gt; or &lt;code&gt;pattern&lt;/code&gt; expression is returned.&lt;/p&gt; &#xA;&lt;p&gt;The last type of a custom validator is a function. The provided function receives the value to validate and its result is evaluated as &lt;code&gt;false&lt;/code&gt; or &lt;code&gt;true&lt;/code&gt;. For example, passing &lt;code&gt;id = tonumber&lt;/code&gt; ensures that the &lt;code&gt;id&lt;/code&gt; value is a number. As another example, &lt;code&gt;clientAddr = fm.isLoopbackIp&lt;/code&gt; ensures that the client address is a loopback ip address.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute({&#34;/local-only&#34;, clientAddr = fm.isLoopbackIp},&#xA;  function(r) return &#34;Local content&#34; end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;As the validator function can be generated dynamically, this works too:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;local function isLessThan(n)&#xA;  return function(l) return tonumber(l) &amp;lt; n end&#xA;end&#xA;fm.setRoute(fm.POST{&#34;/upload&#34;, ContentLength = isLessThan(100000)},&#xA;  function(r) ...handle the upload... end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;It&#39;s important to keep in mind that the validator function actually returns a function that is called during a request to apply the check. In the previous example, the returned function accepts a header value and compares it with the limit passed during its creation.&lt;/p&gt; &#xA;&lt;h4&gt;Responding on failed conditions&lt;/h4&gt; &#xA;&lt;p&gt;In some cases, failing to satisfy a condition is a sufficient reason to returns some response back to the client without checking other routes. In a case like this, setting &lt;code&gt;otherwise&lt;/code&gt; value to a number or a function returns either a response with the specified status or the result of the function:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;local function isLessThan(n)&#xA;  return function(l) return tonumber(l) &amp;lt; n end&#xA;end&#xA;fm.setRoute(fm.POST{&#34;/upload&#34;, ContentLength = isLessThan(100000),&#xA;    otherwise = 413}, function(r) ...handle the upload... end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In this example the routing engine matches the route and then validates the two conditions comparing the method value with &lt;code&gt;POST&lt;/code&gt; and the value of the &lt;code&gt;Content-Length&lt;/code&gt; header with the result of the &lt;code&gt;isLessThen&lt;/code&gt; function. If one of the conditions doesn&#39;t match, the status specified by the &lt;code&gt;otherwise&lt;/code&gt; value is returned with the rest of the response.&lt;/p&gt; &#xA;&lt;p&gt;If the returned status needs to only apply to the &lt;code&gt;ContentLength&lt;/code&gt; check, then the &lt;code&gt;otherwise&lt;/code&gt; value along with the validator function can be moved to a table associated with the &lt;code&gt;ContentLength&lt;/code&gt; check:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(fm.POST{&#34;/upload&#34;,&#xA;    ContentLength = {isLessThan(100000), otherwise = 413}&#xA;  }, function(r) ...handle the upload... end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The difference between the last two examples is that in this example only the &lt;code&gt;ContentLength&lt;/code&gt; check failure triggers the 413 response (and all other methods fall through to other routes), while in the previous one both &lt;code&gt;method&lt;/code&gt; and &lt;code&gt;ContentLength&lt;/code&gt; check failures trigger the same 413 response.&lt;/p&gt; &#xA;&lt;p&gt;Note that when the checked value is &lt;code&gt;nil&lt;/code&gt;, the check against a table is deemed to be valid and the route is accepted. For example, a check for an optional parameter made against a string (&lt;code&gt;name = &#34;Bo&#34;&lt;/code&gt;) fails if the value of &lt;code&gt;params.name&lt;/code&gt; is &lt;code&gt;nil&lt;/code&gt;, but passes if the same check is made against a table (&lt;code&gt;name = {Bo=true, Mo=true}&lt;/code&gt;), including regex/pattern checks. If this is not desirable, then a custom validator function can explicitly check for the correct value.&lt;/p&gt; &#xA;&lt;p&gt;Consider the following example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute({&#34;/hello(/:name)&#34;,&#xA;    method = {&#34;GET&#34;, &#34;POST&#34;, otherwise = 405}},&#xA;  function(r) return &#34;Hello, &#34;..(r.params.name or &#34;World!&#34;) end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In this case, if this endpoint is accessed with the &lt;code&gt;PUT&lt;/code&gt; method, then instead of checking other routes (because the &lt;code&gt;method&lt;/code&gt; condition is not satisfied), the 405 status is returned, as configured with the specified &lt;code&gt;otherwise&lt;/code&gt; value. &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#handling-of-http-methods&#34;&gt;As already mentioned&lt;/a&gt;, this route accepts a &lt;code&gt;HEAD&lt;/code&gt; request too (even when not listed), as a &lt;code&gt;GET&lt;/code&gt; request is accepted.&lt;/p&gt; &#xA;&lt;p&gt;When the 405 (Bad method) status is returned and the &lt;code&gt;Allow&lt;/code&gt; header is not set, it is set to the list of methods allowed by the route. In the case above it is set to &lt;code&gt;GET, POST, HEAD, OPTIONS&lt;/code&gt; values, as those are the methods allowed by this configuration. If the &lt;code&gt;otherwise&lt;/code&gt; value is a function (rather than a number), then returning a proper result and setting the &lt;code&gt;Allow&lt;/code&gt; header is the responsibility of this function.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;otherwise&lt;/code&gt; value can also be set to a function, which provides more flexibility than just setting a status value. For example, setting &lt;code&gt;otherwise = fm.serveResponse(413, &#34;Payload Too Large&#34;)&lt;/code&gt; triggers a response with the specified status and message.&lt;/p&gt; &#xA;&lt;h3&gt;Actions&lt;/h3&gt; &#xA;&lt;p&gt;An action handler receives all incoming HTTP requests filtered for a particular route. Each of the examples shown so far includes an action handler, which is passed as a second parameter to the &lt;code&gt;setRoute&lt;/code&gt; method.&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;Multiple action handlers can be executed in the course of handling one request and as soon as one handler returns a result that is evaluated as a non-&lt;code&gt;false&lt;/code&gt; value, the route handling process ends.&lt;/strong&gt; Returning &lt;code&gt;false&lt;/code&gt; or &lt;code&gt;nil&lt;/code&gt; from an action handler continues the processing, which allows implementing some common processing that applies to multiple routes (similar to what is done using &#34;before&#34; filters in other frameworks):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;local uroute = &#34;/user/:id&#34;&#xA;fm.setRoute({uroute..&#34;/*&#34;, method = {&#34;GET&#34;, &#34;POST&#34;, otherwise = 405}},&#xA;    function(r)&#xA;      -- retrieve user information based on r.params.id&#xA;      -- and store in r.user (as one of the options);&#xA;      -- return error if user is not found&#xA;      return false -- continue handling&#xA;  end)&#xA;fm.setRoute(fm.GET(uroute..&#34;/view&#34;), function(r) ... end)&#xA;fm.setRoute(fm.GET(uroute..&#34;/edit&#34;), function(r) ... end)&#xA;fm.setRoute(fm.POST(uroute..&#34;/edit&#34;), function(r) ... end)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In this example, the first route can generate three outcomes:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;if the route is not matched, then other routes set later are checked&lt;/li&gt; &#xA; &lt;li&gt;if the route is matched, but the condition (the &lt;code&gt;method&lt;/code&gt; check) is not matched, then 405 status is returned&lt;/li&gt; &#xA; &lt;li&gt;if the route is matched and the action handler is executed, it either retrieves the user and returns &lt;code&gt;false&lt;/code&gt;, which continues processing with other routes, or fails to retrieve the user and returns an error.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;In general, an action handler can return any of the following values:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;true&lt;/code&gt;: this stops any further processing, sets the headers that have been specified so far, and returns the generated or set response body.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;false&lt;/code&gt; or &lt;code&gt;nil&lt;/code&gt;: this stops the processing of the current route and proceeds to the next one.&lt;/li&gt; &#xA; &lt;li&gt;any string value: this sends a response with 200 as the status and the returned string as its body. The &lt;code&gt;Content-Type&lt;/code&gt; is set based on the body content (using a primitive heuristic) if not set explicitly.&lt;/li&gt; &#xA; &lt;li&gt;any &lt;code&gt;serve*&lt;/code&gt; method: this executes the requested method and returns an empty string or &lt;code&gt;true&lt;/code&gt; to signal the end of the processing.&lt;/li&gt; &#xA; &lt;li&gt;any other returned value is ignored and interpreted as if &lt;code&gt;true&lt;/code&gt; is returned (and a warning is logged).&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Requests&lt;/h3&gt; &#xA;&lt;p&gt;Each &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#actions&#34;&gt;action handler&lt;/a&gt; accepts a request table that includes the following attributes:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;method&lt;/code&gt;: request HTTP method (GET, POST, and others).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;host&lt;/code&gt;: request host (if provided) or the bind address.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;serverAddr&lt;/code&gt;: address to which listening server socket is bound.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;remoteAddr&lt;/code&gt;: client ip4 address encoded as a number. This takes into consideration reverse proxy scenarios. Use &lt;code&gt;formatIp&lt;/code&gt; function to convert to a string representing the address.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;scheme&lt;/code&gt;: request URL scheme (if any).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;path&lt;/code&gt;: request URL path that is guaranteed to begin with &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;authority&lt;/code&gt;: request URL with scheme, host, and port present.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;url&lt;/code&gt;: request URL as an ASCII string with illegal characters percent encoded.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;body&lt;/code&gt;: request message body (if present) or an empty string.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;date&lt;/code&gt;: request date as a Unix timestamp.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;time&lt;/code&gt;: current time as a Unix timestamp with 0.0001s precision.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The request table also has several &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/utility-functions&#34;&gt;utility functions&lt;/a&gt;, as well as &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#headers&#34;&gt;headers&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#cookies&#34;&gt;cookies&lt;/a&gt;, and &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#session&#34;&gt;session&lt;/a&gt; tables that allow retrieving request headers, cookies, and session and setting of headers and cookies that are included with the response.&lt;/p&gt; &#xA;&lt;p&gt;The same request table is given as a parameter to all (matched) action handlers, so it can be used as a mechanism to pass values between those action handlers, as any value assigned as a field in one handler is available in all other action handlers.&lt;/p&gt; &#xA;&lt;h4&gt;Headers&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;code&gt;headers&lt;/code&gt; table provides access to the request headers. For example, &lt;code&gt;r.headers[&#34;Content-Type&#34;]&lt;/code&gt; returns the value of the &lt;code&gt;Content-Type&lt;/code&gt; header. This form of header access is case-insensitive. A shorter form is also available (&lt;code&gt;r.headers.ContentType&lt;/code&gt;), but only for registered headers and &lt;em&gt;is&lt;/em&gt; case-sensitive with the capitalization preserved.&lt;/p&gt; &#xA;&lt;p&gt;The request headers can also be set using the same syntax. For example, &lt;code&gt;r.headers.MyHeader = &#34;value&#34;&lt;/code&gt; sets &lt;code&gt;MyHeader: value&lt;/code&gt; response header. As the headers are set at the end of the action handler processing, headers set earlier can also be removed by assigning a &lt;code&gt;nil&lt;/code&gt; value.&lt;/p&gt; &#xA;&lt;p&gt;Repeatable headers can also be assigned with values separated by commas: &lt;code&gt;r.headers.Allow = &#34;GET, POST&#34;&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Cookies&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;code&gt;cookies&lt;/code&gt; table provides access to the request cookies. For example, &lt;code&gt;r.cookies.token&lt;/code&gt; returns the value of the &lt;code&gt;token&lt;/code&gt; cookie.&lt;/p&gt; &#xA;&lt;p&gt;The cookies can also be set using the same syntax. For example, &lt;code&gt;r.cookies.token = &#34;new value&#34;&lt;/code&gt; sets &lt;code&gt;token&lt;/code&gt; cookie to &lt;code&gt;new value&lt;/code&gt;. If the cookie needs to have its attributes set as well, then the value and the attributes need to be passed as a table: &lt;code&gt;r.cookies.token = {&#34;new value&#34;, secure = true, httponly = true}&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;The following cookie attributes are supported:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;expires&lt;/code&gt;: sets the maximum lifetime of the cookie as an HTTP-date timestamp. Can be specified as a date in the RFC1123 (string) format or as a UNIX timestamp (number of seconds).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;maxage&lt;/code&gt;: sets number of seconds until the cookie expires. A zero or negative number will expire the cookie immediately. If both &lt;code&gt;expires&lt;/code&gt; and &lt;code&gt;maxage&lt;/code&gt; are set, &lt;code&gt;maxage&lt;/code&gt; has precedence.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;domain&lt;/code&gt;: sets the host to which the cookie will be sent.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;path&lt;/code&gt;: sets the path that must be present in the request URL, or the client will not send the Cookie header.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;secure&lt;/code&gt;: (bool) requests the cookie to be only send to the server when a request is made with the https: scheme.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;httponly&lt;/code&gt;: (bool) forbids JavaScript from accessing the cookie.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;samesite&lt;/code&gt;: (&lt;code&gt;Strict&lt;/code&gt;, &lt;code&gt;Lax&lt;/code&gt;, or &lt;code&gt;None&lt;/code&gt;) controls whether a cookie is sent with cross-origin requests, providing some protection against cross-site request forgery attacks.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Note that &lt;code&gt;httponly&lt;/code&gt; and &lt;code&gt;samesite=&#34;Strict&#34;&lt;/code&gt; are set by default; a different set of defaults can be provided using &lt;code&gt;cookieOptions&lt;/code&gt; passed to the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#running-application&#34;&gt;run method&lt;/a&gt;. Any attributes set with a table &lt;strong&gt;will overwrite the default&lt;/strong&gt;, so if &lt;code&gt;Secure&lt;/code&gt; needs to be enabled, make sure to also pass &lt;code&gt;httponly&lt;/code&gt; and &lt;code&gt;samesite&lt;/code&gt; options.&lt;/p&gt; &#xA;&lt;p&gt;To delete a cookie, set its value to &lt;code&gt;false&lt;/code&gt;: for example, &lt;code&gt;r.cookies.token = false&lt;/code&gt; deletes the value of the &lt;code&gt;token&lt;/code&gt; cookie.&lt;/p&gt; &#xA;&lt;h4&gt;Session&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;code&gt;session&lt;/code&gt; table provides access to the session table that can be used to set or retrieve session values. For example, &lt;code&gt;r.session.counter&lt;/code&gt; returns the &lt;code&gt;counter&lt;/code&gt; value set previously. The session values can also be set using the same syntax. For example, &lt;code&gt;r.session.counter = 2&lt;/code&gt; sets the &lt;code&gt;counter&lt;/code&gt; value to &lt;code&gt;2&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;The session allows storing of nested values and other Lua values. If the session needs to be removed, it can be set to an empty table or a &lt;code&gt;nil&lt;/code&gt; value. Each session is signed with an application secret, which is assigned a random string by default and can be changed by &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#session-options&#34;&gt;setting session options&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Utility functions&lt;/h4&gt; &#xA;&lt;p&gt;The following functions are available as both request functions (as fields in the request table) and as library functions:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;makePath(route[, parameters])&lt;/code&gt;: creates a path from either a route name or a path string by populating its parameters using values from the parameters table (when provided). The path doesn&#39;t need to be just a path component of a URL and can be a full URL as well. &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#optional-parameters&#34;&gt;Optional parts&lt;/a&gt; are removed if they include parameters that are not provided.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;makeUrl([url,] options)&lt;/code&gt;: creates a URL using the provided value and a set of URL parameters provided in the &lt;code&gt;options&lt;/code&gt; table: scheme, user, pass, host, port, path, and fragment. The &lt;code&gt;url&lt;/code&gt; parameter is optional; the current request URL is used if &lt;code&gt;url&lt;/code&gt; is not specified. Any of the options can be provided or removed (using &lt;code&gt;false&lt;/code&gt; as the value). For example, &lt;code&gt;makeUrl({scheme=&#34;https&#34;})&lt;/code&gt; sets the scheme for the current URL to &lt;code&gt;https&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;escapeHtml(string)&lt;/code&gt;: escapes HTML entities (&lt;code&gt;&amp;amp;&amp;gt;&amp;lt;&#34;&#39;&lt;/code&gt;) by replacing them with their HTML entity counterparts (&lt;code&gt;&amp;amp;amp;&amp;amp;gt;&amp;amp;lt;&amp;amp;quot;&amp;amp;#39;&lt;/code&gt;).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;escapePath(path)&lt;/code&gt;: applies URL encoding (&lt;code&gt;%XX&lt;/code&gt;) escaping path unsafe characters (anything other than &lt;code&gt;-.~_@:!$&amp;amp;&#39;()*+,;=0-9A-Za-z/&lt;/code&gt;).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;formatHttpDateTime(seconds)&lt;/code&gt;: converts UNIX timestamp (in seconds) to an RFC1123 string (&lt;code&gt;Mon, 21 Feb 2022 15:37:13 GMT&lt;/code&gt;).&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Templates&lt;/h3&gt; &#xA;&lt;h4&gt;Configuring templates&lt;/h4&gt; &#xA;&lt;h4&gt;Serving template outputs&lt;/h4&gt; &#xA;&lt;h4&gt;Passing parameters to templates&lt;/h4&gt; &#xA;&lt;h4&gt;Including templates in other templates&lt;/h4&gt; &#xA;&lt;h4&gt;Processing layouts&lt;/h4&gt; &#xA;&lt;h3&gt;Responses&lt;/h3&gt; &#xA;&lt;p&gt;Each action handler generates some sort of response to send back to the client. In addition to &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#actions&#34;&gt;strings&lt;/a&gt;, the application can return the following results:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;general responses (&lt;code&gt;serveResponse&lt;/code&gt;),&lt;/li&gt; &#xA; &lt;li&gt;templates (&lt;code&gt;serveContent&lt;/code&gt;),&lt;/li&gt; &#xA; &lt;li&gt;redirects (&lt;code&gt;serveRedirect&lt;/code&gt;),&lt;/li&gt; &#xA; &lt;li&gt;static assets (&lt;code&gt;serveAsset&lt;/code&gt;),&lt;/li&gt; &#xA; &lt;li&gt;errors (&lt;code&gt;serveError&lt;/code&gt;),&lt;/li&gt; &#xA; &lt;li&gt;directory index (&lt;code&gt;serveIndex&lt;/code&gt;), and&lt;/li&gt; &#xA; &lt;li&gt;internal redirects/resources (&lt;code&gt;servePath&lt;/code&gt;).&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Each of these methods can be used as the return value from an action handler. &lt;code&gt;serveAsset&lt;/code&gt;, &lt;code&gt;servePath&lt;/code&gt;, and &lt;code&gt;serveIndex&lt;/code&gt; methods can also be used as action handlers directly:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(&#34;/static/*&#34;, fm.serveAsset)&#xA;fm.setRoute(&#34;/blog/&#34;, fm.serveIndex(&#34;/new-blog/&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The first route configures all existing assets to be served from &lt;code&gt;/static/*&lt;/code&gt; location; the second route configures &lt;code&gt;/blog/&lt;/code&gt; URL to return the index (&lt;code&gt;index.lua&lt;/code&gt; or &lt;code&gt;index.html&lt;/code&gt; resource) from &lt;code&gt;/new-blog/&lt;/code&gt; folder.&lt;/p&gt; &#xA;&lt;h4&gt;Serving response&lt;/h4&gt; &#xA;&lt;p&gt;&lt;code&gt;serveResponse(status[, headers][, body])&lt;/code&gt;: sends an HTTP response using provided &lt;code&gt;status&lt;/code&gt;, &lt;code&gt;headers&lt;/code&gt;, and &lt;code&gt;body&lt;/code&gt; values. &lt;code&gt;headers&lt;/code&gt; is an optional table populated with HTTP header name/value pairs. If provided, this set of headers &lt;em&gt;removes all other headers&lt;/em&gt; set earlier during the handling of the same request. Similar to the headers set using the &lt;code&gt;request.headers&lt;/code&gt; field, the names are &lt;em&gt;case-insensitive&lt;/em&gt;, but provided aliases for header names with dashes are &lt;em&gt;case-sensitive&lt;/em&gt;: &lt;code&gt;{ContentType = &#34;foo&#34;}&lt;/code&gt; is an alternative form for &lt;code&gt;{[&#34;Content-Type&#34;] = &#34;foo&#34;}&lt;/code&gt;. &lt;code&gt;body&lt;/code&gt; is an optional string.&lt;/p&gt; &#xA;&lt;p&gt;Consider the following example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;return fm.serveResponse(413, &#34;Payload Too Large&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This returns the status value &lt;code&gt;413&lt;/code&gt; and sets the body of the returned message to &lt;code&gt;Payload Too Large&lt;/code&gt; (with the header table not specified).&lt;/p&gt; &#xA;&lt;p&gt;If only the status value needs to be set, the library provides a short form using the &lt;code&gt;serve###&lt;/code&gt; syntax:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;return fm.serve413&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;It can also be used as the action handler itself:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.setRoute(fm.PUT&#34;/status&#34;, fm.serve402)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Serving content&lt;/h4&gt; &#xA;&lt;p&gt;&lt;code&gt;serveContent(name, parameters)&lt;/code&gt; renders a template using provided parameters. &lt;code&gt;name&lt;/code&gt; is a string that names the template (as set by a &lt;code&gt;setTemplate&lt;/code&gt; call) and &lt;code&gt;parameters&lt;/code&gt; is a table with template parameters (referenced as variables in the template).&lt;/p&gt; &#xA;&lt;h4&gt;Serving redirect&lt;/h4&gt; &#xA;&lt;h4&gt;Serving static asset&lt;/h4&gt; &#xA;&lt;h4&gt;Serving error&lt;/h4&gt; &#xA;&lt;h4&gt;Serving directory index&lt;/h4&gt; &#xA;&lt;h4&gt;Serving path (internal redirect)&lt;/h4&gt; &#xA;&lt;h3&gt;Running application&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;code&gt;run&lt;/code&gt; method executes the configured application. By default the server is launched listening on localhost and port 8080. Both of these values can be changed by passing &lt;code&gt;addr&lt;/code&gt; and &lt;code&gt;port&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;fm.run({addr = &#34;localhost&#34;, port = 8080})&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The following options are supported; the default values are shown in parentheses and options marked with &lt;code&gt;mult&lt;/code&gt; can set multiple values by passing a table:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;addr&lt;/code&gt;: sets the address to listen on (mult)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;brand&lt;/code&gt;: sets the &lt;code&gt;Server&lt;/code&gt; header value (&lt;code&gt;&#34;redbean/v# fullmoon/v#&#34;&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;cache&lt;/code&gt;: configures &lt;code&gt;Cache-Control&lt;/code&gt; and &lt;code&gt;Expires&lt;/code&gt; headers (in seconds) for all static assets served. A negative value disables the headers. Zero value means no cache.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;certificate&lt;/code&gt;: sets the TLS certificate value (mult)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;directory&lt;/code&gt;: sets local directory to serve assets from in addition to serving them from the archive within the executable itself (mult)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;headers&lt;/code&gt;: sets default headers added to each response by passing a table with HTTP header name/value pairs&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;logMessages&lt;/code&gt;: enables logging of response headers&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;logBodies&lt;/code&gt;: enables logging of request bodies (POST/PUT/etc.)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;logPath&lt;/code&gt;: sets the log file path on the local file system&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;pidPath&lt;/code&gt;: sets the pid file path on the local file system&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;port&lt;/code&gt;: sets the port number to listen on (8080)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;privateKey&lt;/code&gt;: sets the TLS private key value (mult)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;sslTicketLifetime&lt;/code&gt;: sets the duration (in seconds) of the ssl ticket (86400)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The &lt;code&gt;key&lt;/code&gt; and &lt;code&gt;certificate&lt;/code&gt; string values can be populated using the &lt;code&gt;getAsset&lt;/code&gt; method that can access both assets packaged within the webserver archive and those stored in the file system.&lt;/p&gt; &#xA;&lt;p&gt;There are also default cookie and session options that can be assigned using &lt;code&gt;cookieOptions&lt;/code&gt; and &lt;code&gt;sessionOptions&lt;/code&gt; tables described below.&lt;/p&gt; &#xA;&lt;h4&gt;Cookie options&lt;/h4&gt; &#xA;&lt;p&gt;&lt;code&gt;cookieOptions&lt;/code&gt; sets default options for all &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#cookies&#34;&gt;cookie values&lt;/a&gt; assigned using &lt;code&gt;request.cookie.name = value&lt;/code&gt; syntax (&lt;code&gt;{httponly=true, samesite=&#34;Strict&#34;}&lt;/code&gt;). It is still possible to overwrite default values using table assignment: &lt;code&gt;request.cookie.name = {value, secure=false}&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Session options&lt;/h4&gt; &#xA;&lt;p&gt;&lt;code&gt;sessionOptions&lt;/code&gt; sets default options for the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#session&#34;&gt;session&lt;/a&gt; value assigned using &lt;code&gt;request.session.attribute = value&lt;/code&gt; syntax (&lt;code&gt;{name = &#34;fullmoon_session&#34;, hash = &#34;SHA256&#34;, secret = true}&lt;/code&gt;). If the &lt;code&gt;secret&lt;/code&gt; value is set to &lt;code&gt;true&lt;/code&gt;, then a random key is assigned; setting the value to &lt;code&gt;false&lt;/code&gt; or an empty string applies hashing without a secret key.&lt;/p&gt; &#xA;&lt;h3&gt;Logging&lt;/h3&gt; &#xA;&lt;h2&gt;Benchmark&lt;/h2&gt; &#xA;&lt;p&gt;The results shown are from runs in the same environment and on the same hardware as the &lt;a href=&#34;https://redbean.dev/#benchmark&#34;&gt;published redbean benchmark&lt;/a&gt; (thanks to &lt;a href=&#34;https://github.com/jart/&#34;&gt;@jart&lt;/a&gt; for executing the tests!). Even though these tests are using pre-1.5 version of redbean and 0.10 version of Fullmoon, the current versions of redbean/Fullmoon are expected to deliver similar performance.&lt;/p&gt; &#xA;&lt;p&gt;The tests are using exactly the same code that is shown in the &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/#fullmoon&#34;&gt;introduction&lt;/a&gt; with one small change: using &lt;code&gt;{%= name %}&lt;/code&gt; instead of &lt;code&gt;{%&amp;amp; name %}&lt;/code&gt; in the template, which skips HTML escaping. This code demonstrates routing, parameter handling and template processing.&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;$ wrk -t 12 -c 120 http://127.0.0.1:8080/user/paul&#xA;Running 10s test @ http://127.0.0.1:8080/user/paul&#xA;  12 threads and 120 connections&#xA;  Thread Stats   Avg      Stdev     Max   +/- Stdev&#xA;    Latency   312.06us    4.39ms 207.16ms   99.85%&#xA;    Req/Sec    32.48k     6.69k   71.37k    82.25%&#xA;  3913229 requests in 10.10s, 783.71MB read&#xA;Requests/sec: &lt;strong&gt;387477.76&lt;/strong&gt;&#xA;Transfer/sec:     77.60MB&#xA;&lt;/pre&gt; &#xA;&lt;p&gt;The following test is using the same configuration, but redbean is compiled with &lt;code&gt;MODE=optlinux&lt;/code&gt; option:&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;$ wrk -t 12 -c 120 http://127.0.0.1:8080/user/paul&#xA;Running 10s test @ http://127.0.0.1:8080/user/paul&#xA;  12 threads and 120 connections&#xA;  Thread Stats   Avg      Stdev     Max   +/- Stdev&#xA;    Latency   346.31us    5.13ms 207.31ms   99.81%&#xA;    Req/Sec    36.18k     6.70k   90.47k    80.92%&#xA;  4359909 requests in 10.10s, 0.85GB read&#xA;Requests/sec: &lt;strong&gt;431684.80&lt;/strong&gt;&#xA;Transfer/sec:     86.45MB&#xA;&lt;/pre&gt; &#xA;&lt;p&gt;The following two tests demonstrate the latency of the request handling by Fullmoon and by redbean serving a static asset (no concurrency):&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;$ wrk -t 1 -c 1 http://127.0.0.1:8080/user/paul&#xA;Running 10s test @ http://127.0.0.1:8080/user/paul&#xA;  1 threads and 1 connections&#xA;  Thread Stats   Avg      Stdev     Max   +/- Stdev&#xA;    Latency    &lt;strong&gt;15.75us    7.64us 272.00us&lt;/strong&gt;   93.32%&#xA;    Req/Sec    65.54k   589.15    66.58k    74.26%&#xA;  658897 requests in 10.10s, 131.96MB read&#xA;Requests/sec:  65241.45&#xA;Transfer/sec:     13.07MB&#xA;&lt;/pre&gt; &#xA;&lt;p&gt;The following are the results from redbean itself on static compressed assets:&lt;/p&gt; &#xA;&lt;pre&gt;&#xA;$ wrk -H &#39;Accept-Encoding: gzip&#39; -t 1 -c 1 htt://10.10.10.124:8080/tool/net/demo/index.html&#xA;Running 10s test @ htt://10.10.10.124:8080/tool/net/demo/index.html&#xA;  1 threads and 1 connections&#xA;  Thread Stats   Avg      Stdev     Max   +/- Stdev&#xA;    Latency     &lt;strong&gt;7.40us    1.95us 252.00us&lt;/strong&gt;   97.05%&#xA;    Req/Sec   129.66k     3.20k  135.98k    64.36%&#xA;  1302424 requests in 10.10s, 1.01GB read&#xA;Requests/sec: 128963.75&#xA;Transfer/sec:    102.70MB&#xA;&lt;/pre&gt; &#xA;&lt;h2&gt;Status&lt;/h2&gt; &#xA;&lt;p&gt;Highly experimental with everything being subject to change.&lt;/p&gt; &#xA;&lt;h2&gt;Author&lt;/h2&gt; &#xA;&lt;p&gt;Paul Kulchenko (&lt;a href=&#34;mailto:paul@zerobrane.com&#34;&gt;paul@zerobrane.com&lt;/a&gt;)&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://raw.githubusercontent.com/pkulchenko/fullmoon/master/LICENSE&#34;&gt;LICENSE&lt;/a&gt;.&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>LunarVim/nvim-basic-ide</title>
    <updated>2022-06-19T01:46:23Z</updated>
    <id>tag:github.com,2022-06-19:/LunarVim/nvim-basic-ide</id>
    <link href="https://github.com/LunarVim/nvim-basic-ide" rel="alternate"></link>
    <summary type="html">&lt;p&gt;This is my attempt at a basic stable starting point for a Neovim IDE.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;A Basic Stable IDE config for Neovim&lt;/h1&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Why does this repo exist?&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;This config attempts to provide a rock solid fully featured starting point for someone new to Neovim, or just tired of maintaining the basic IDE components of their config.&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;What makes it &#34;rock solid&#34;?&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;All of the included plugins are pinned to a version that ensures they are compatible and will not update potentially introducing errors into your config. For every Neovim release I will update this repo along with the community to keep it up to date with the newest versions.&lt;/p&gt; &#xA;&lt;p&gt;As I mentioned, this config is meant as a starting point for people new to Neovim who want a familiar IDE experience. The config has a very simple structure that makes it easy to add new plugins.&lt;/p&gt; &#xA;&lt;h2&gt;Install Neovim 0.7&lt;/h2&gt; &#xA;&lt;p&gt;You can install Neovim with your package manager e.g. brew, apt, pacman etc.. but remember that when you update your packages Neovim may be upgraded to a newer version.&lt;/p&gt; &#xA;&lt;p&gt;If you would like to make sure Neovim only updates when you want it to than I recommend installing from source:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git clone https://github.com/neovim/neovim.git&#xA;cd neovim&#xA;git checkout release-0.7&#xA;make CMAKE_BUILD_TYPE=Release&#xA;sudo make install&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Install the config&lt;/h2&gt; &#xA;&lt;p&gt;Make sure to remove or move your current &lt;code&gt;nvim&lt;/code&gt; directory&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git clone https://github.com/LunarVim/nvim-basic-ide.git ~/.config/nvim&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Run &lt;code&gt;nvim&lt;/code&gt; and wait for the plugins to be installed&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; (You will notice treesitter pulling in a bunch of parsers the next time you open Neovim)&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; Checkout this file for some predefined keymaps: &lt;a href=&#34;https://github.com/LunarVim/nvim-basic-ide/raw/master/lua/user/keymaps.lua&#34;&gt;keymaps&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Get healthy&lt;/h2&gt; &#xA;&lt;p&gt;Open &lt;code&gt;nvim&lt;/code&gt; and enter the following:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;:checkhealth&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You&#39;ll probably notice you don&#39;t have support for copy/paste also that python and node haven&#39;t been setup&lt;/p&gt; &#xA;&lt;p&gt;So let&#39;s fix that&lt;/p&gt; &#xA;&lt;p&gt;First we&#39;ll fix copy/paste&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;On mac &lt;code&gt;pbcopy&lt;/code&gt; should be builtin&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;On Ubuntu&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;sudo apt install xsel # for X11&#xA;sudo apt install wl-clipboard # for wayland&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Next we need to install python support (node is optional)&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;Neovim python support&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;pip install pynvim&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Neovim node support&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;npm i -g neovim&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;We will also need &lt;code&gt;ripgrep&lt;/code&gt; for Telescope to work:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;Ripgrep&lt;/p&gt; &lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;sudo apt install ripgrep&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; make sure you have &lt;a href=&#34;https://nodejs.org/en/&#34;&gt;node&lt;/a&gt; installed, I recommend a node manager like &lt;a href=&#34;https://github.com/Schniz/fnm&#34;&gt;fnm&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Fonts&lt;/h2&gt; &#xA;&lt;p&gt;I recommend using the following repo to get a &#34;Nerd Font&#34; (Font that supports icons)&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/ronniedroid/getnf&#34;&gt;getnf&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Configuration&lt;/h2&gt; &#xA;&lt;h3&gt;LSP&lt;/h3&gt; &#xA;&lt;p&gt;To add a new LSP&lt;/p&gt; &#xA;&lt;p&gt;First Enter:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;:LspInstallInfo&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;and press &lt;code&gt;i&lt;/code&gt; on the Language Server you wish to install&lt;/p&gt; &#xA;&lt;p&gt;Next you will need to add the server to this list: &lt;a href=&#34;https://github.com/LunarVim/nvim-basic-ide/raw/8b9ec3bffe8c8577042baf07c75408532a733fea/lua/user/lsp/lsp-installer.lua#L6&#34;&gt;servers&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Formatters and linters&lt;/h3&gt; &#xA;&lt;p&gt;Make sure the formatter or linter is installed and add it to this setup function: &lt;a href=&#34;https://github.com/LunarVim/nvim-basic-ide/raw/8b9ec3bffe8c8577042baf07c75408532a733fea/lua/user/lsp/null-ls.lua#L13&#34;&gt;null-ls&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; Some are already setup as examples, remove them if you want&lt;/p&gt; &#xA;&lt;h3&gt;Plugins&lt;/h3&gt; &#xA;&lt;p&gt;You can install new plugins here: &lt;a href=&#34;https://github.com/LunarVim/nvim-basic-ide/raw/8b9ec3bffe8c8577042baf07c75408532a733fea/lua/user/plugins.lua#L42&#34;&gt;plugins&lt;/a&gt;&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;h2&gt;Plugins&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/wbthomason/packer.nvim&#34;&gt;packer&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/nvim-lua/plenary.nvim&#34;&gt;plenary&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/windwp/nvim-autopairs&#34;&gt;nvim-autopairs&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/numToStr/Comment.nvim&#34;&gt;Comment.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/JoosepAlviste/nvim-ts-context-commentstring&#34;&gt;nvim-ts-context-commentstring&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/kyazdani42/nvim-web-devicons&#34;&gt;nvim-web-devicons&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/kyazdani42/nvim-tree.lua&#34;&gt;nvim-tree.lua&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/akinsho/bufferline.nvim&#34;&gt;bufferline.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/moll/vim-bbye&#34;&gt;vim-bbye&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/nvim-lualine/lualine.nvim&#34;&gt;lualine.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/akinsho/toggleterm.nvim&#34;&gt;toggleterm.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/ahmedkhalf/project.nvim&#34;&gt;project.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/lewis6991/impatient.nvim&#34;&gt;impatient.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/lukas-reineke/indent-blankline.nvim&#34;&gt;indent-blankline.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/goolord/alpha-nvim&#34;&gt;alpha-nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/folke/tokyonight.nvim&#34;&gt;tokyonight.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/LunarVim/darkplus.nvim&#34;&gt;darkplus.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/hrsh7th/nvim-cmp&#34;&gt;nvim-cmp&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/hrsh7th/cmp-buffer&#34;&gt;cmp-buffer&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/hrsh7th/cmp-path&#34;&gt;cmp-path&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/saadparwaiz1/cmp_luasnip&#34;&gt;cmp_luasnip&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/hrsh7th/cmp-nvim-lsp&#34;&gt;cmp-nvim-lsp&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/hrsh7th/cmp-nvim-lua&#34;&gt;cmp-nvim-lua&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/L3MON4D3/LuaSnip&#34;&gt;LuaSnip&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/rafamadriz/friendly-snippets&#34;&gt;friendly-snippets&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/neovim/nvim-lspconfig&#34;&gt;nvim-lspconfig&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/williamboman/nvim-lsp-installer&#34;&gt;nvim-lsp-installer&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/jose-elias-alvarez/null-ls.nvim&#34;&gt;null-ls.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/RRethy/vim-illuminate&#34;&gt;vim-illuminate&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/nvim-telescope/telescope.nvim&#34;&gt;telescope.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/nvim-treesitter/nvim-treesitter&#34;&gt;nvim-treesitter&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/lewis6991/gitsigns.nvim&#34;&gt;gitsigns.nvim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/mfussenegger/nvim-dap&#34;&gt;nvim-dap&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/rcarriga/nvim-dap-ui&#34;&gt;nvim-dap-ui&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/ravenxrz/DAPInstall.nvim&#34;&gt;DAPInstall.nvim&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;hr&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;The computing scientist&#39;s main challenge is not to get confused by the complexities of his own making.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;- Edsger W. Dijkstra&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>ziontee113/syntax-tree-surfer</title>
    <updated>2022-06-19T01:46:23Z</updated>
    <id>tag:github.com,2022-06-19:/ziontee113/syntax-tree-surfer</id>
    <link href="https://github.com/ziontee113/syntax-tree-surfer" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A plugin for Neovim that helps you surf through your document and move elements around using the nvim-treesitter API.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;🌳 syntax-tree-surfer 🌳🌊&lt;/h1&gt; &#xA;&lt;h3&gt;Syntax Tree Surfer is a plugin for Neovim that helps you surf through your document and move elements around using the nvim-treesitter API.&lt;/h3&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/102876811/163170119-89369c35-a061-4058-aaeb-1706ea6fa4cf.jpg&#34; alt=&#34;tree surfing cover&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Table of Contents&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/ziontee113/syntax-tree-surfer/master/#version-20-beta-update-&#34;&gt;Version 2.0 Beta Update&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/ziontee113/syntax-tree-surfer/master/#version-11-update&#34;&gt;Version 1.1 Update&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/ziontee113/syntax-tree-surfer/master/#version-10-functionalities&#34;&gt;Version 1.0 Functionalities&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/ziontee113/syntax-tree-surfer/master/#how-do-i-install&#34;&gt;How do I install?&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h1&gt;Version 2.0 Beta Update ⚡&lt;/h1&gt; &#xA;&lt;h3&gt;Targeted Jump with Virtual Text 🆕&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/102876811/169820839-5ec66bd9-bf14-49f6-8e5a-3078b8ec43c4.mp4&#34;&gt;https://user-images.githubusercontent.com/102876811/169820839-5ec66bd9-bf14-49f6-8e5a-3078b8ec43c4.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Filtered Jump through user-defined node types 🆕&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/102876811/169820922-b1eefa5e-6ed9-4ebd-95d1-f3f35e0388da.mp4&#34;&gt;https://user-images.githubusercontent.com/102876811/169820922-b1eefa5e-6ed9-4ebd-95d1-f3f35e0388da.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;These are experimental features and I wish to expand them even further. If you have any suggestions, please feel free to let me know 😊&lt;/h3&gt; &#xA;&lt;p&gt;Example mappings for Version 2.0 Beta functionalities:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;-- Syntax Tree Surfer V2 Mappings&#xA;-- Targeted Jump with virtual_text&#xA;local sts = require(&#34;syntax-tree-surfer&#34;)&#xA;vim.keymap.set(&#34;n&#34;, &#34;gv&#34;, function() -- only jump to variable_declarations&#xA;&#x9;sts.targeted_jump({ &#34;variable_declaration&#34; })&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;gfu&#34;, function() -- only jump to functions&#xA;&#x9;sts.targeted_jump({ &#34;function&#34;, &#34;function_definition&#34; })&#xA;  --&amp;gt; In this example, the Lua language schema uses &#34;function&#34;,&#xA;  --  when the Python language uses &#34;function_definition&#34;&#xA;  --  we include both, so this keymap will work on both languages&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;gif&#34;, function() -- only jump to if_statements&#xA;&#x9;sts.targeted_jump({ &#34;if_statement&#34; })&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;gfo&#34;, function() -- only jump to for_statements&#xA;&#x9;sts.targeted_jump({ &#34;for_statement&#34; })&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;gj&#34;, function() -- jump to all that you specify&#xA;&#x9;sts.targeted_jump({&#xA;&#x9;&#x9;&#34;function&#34;,&#xA;&#x9;  &#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;&#x9;&#34;elseif_statement&#34;,&#xA;&#x9;&#x9;&#34;for_statement&#34;,&#xA;&#x9;&#x9;&#34;while_statement&#34;,&#xA;&#x9;&#x9;&#34;switch_statement&#34;,&#xA;&#x9;})&#xA;end, opts)&#xA;&#xA;-------------------------------&#xA;-- filtered_jump --&#xA;-- &#34;default&#34; means that you jump to the default_desired_types or your lastest jump types&#xA;vim.keymap.set(&#34;n&#34;, &#34;&amp;lt;A-n&amp;gt;&#34;, function()&#xA;&#x9;sts.filtered_jump(&#34;default&#34;, true) --&amp;gt; true means jump forward&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;&amp;lt;A-p&amp;gt;&#34;, function()&#xA;&#x9;sts.filtered_jump(&#34;default&#34;, false) --&amp;gt; false means jump backwards&#xA;end, opts)&#xA;&#xA;-- non-default jump --&amp;gt; custom desired_types&#xA;vim.keymap.set(&#34;n&#34;, &#34;your_keymap&#34;, function()&#xA;&#x9;sts.filtered_jump({&#xA;&#x9;&#x9;&#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;}, true) --&amp;gt; true means jump forward&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;your_keymap&#34;, function()&#xA;&#x9;sts.filtered_jump({&#xA;&#x9;&#x9;&#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;}, false) --&amp;gt; false means jump backwards&#xA;end, opts)&#xA;&#xA;-------------------------------&#xA;-- jump with limited targets --&#xA;-- jump to sibling nodes only&#xA;vim.keymap.set(&#34;n&#34;, &#34;-&#34;, function()&#xA;&#x9;sts.filtered_jump({&#xA;&#x9;&#x9;&#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;}, false, { destination = &#34;siblings&#34; })&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;=&#34;, function()&#xA;&#x9;sts.filtered_jump({ &#34;if_statement&#34;, &#34;else_clause&#34;, &#34;else_statement&#34; }, true, { destination = &#34;siblings&#34; })&#xA;end, opts)&#xA;&#xA;-- jump to parent or child nodes only&#xA;vim.keymap.set(&#34;n&#34;, &#34;_&#34;, function()&#xA;&#x9;sts.filtered_jump({&#xA;&#x9;&#x9;&#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;}, false, { destination = &#34;parent&#34; })&#xA;end, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;+&#34;, function()&#xA;&#x9;sts.filtered_jump({&#xA;&#x9;&#x9;&#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;}, true, { destination = &#34;children&#34; })&#xA;end, opts)&#xA;&#xA;-- Setup Function example:&#xA;-- These are the default options:&#xA;require(&#34;syntax-tree-surfer&#34;).setup({&#xA;&#x9;highlight_group = &#34;STS_highlight&#34;,&#xA;&#x9;disable_no_instance_found_report = false,&#xA;&#x9;default_desired_types = {&#xA;&#x9;&#x9;&#34;function&#34;,&#xA;&#x9;&#x9;&#34;function_definition&#34;,&#xA;&#x9;&#x9;&#34;if_statement&#34;,&#xA;&#x9;&#x9;&#34;else_clause&#34;,&#xA;&#x9;&#x9;&#34;else_statement&#34;,&#xA;&#x9;&#x9;&#34;elseif_statement&#34;,&#xA;&#x9;&#x9;&#34;for_statement&#34;,&#xA;&#x9;&#x9;&#34;while_statement&#34;,&#xA;&#x9;&#x9;&#34;switch_statement&#34;,&#xA;&#x9;},&#xA;&#x9;left_hand_side = &#34;fdsawervcxqtzb&#34;,&#xA;&#x9;right_hand_side = &#34;jkl;oiu.,mpy/n&#34;,&#xA;&#x9;icon_dictionary = {&#xA;&#x9;&#x9;[&#34;if_statement&#34;] = &#34;&#34;,&#xA;&#x9;&#x9;[&#34;else_clause&#34;] = &#34;&#34;,&#xA;&#x9;&#x9;[&#34;else_statement&#34;] = &#34;&#34;,&#xA;&#x9;&#x9;[&#34;elseif_statement&#34;] = &#34;&#34;,&#xA;&#x9;&#x9;[&#34;for_statement&#34;] = &#34;ﭜ&#34;,&#xA;&#x9;&#x9;[&#34;while_statement&#34;] = &#34;ﯩ&#34;,&#xA;&#x9;&#x9;[&#34;switch_statement&#34;] = &#34;ﳟ&#34;,&#xA;&#x9;&#x9;[&#34;function&#34;] = &#34;&#34;,&#xA;&#x9;&#x9;[&#34;function_definition&#34;] = &#34;&#34;,&#xA;&#x9;&#x9;[&#34;variable_declaration&#34;] = &#34;&#34;,&#xA;&#x9;},&#xA;})&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Because every languages have different schemas and node-types, you can check the node-types that you&#39;re interested in with &lt;a href=&#34;https://github.com/nvim-treesitter/playground&#34;&gt;https://github.com/nvim-treesitter/playground&lt;/a&gt;&lt;/h3&gt; &#xA;&lt;h3&gt;I&#39;ll try to incorporate a simple function to tell what kind of node is the cursor is on natively so you don&#39;t have to install a separate plugin soon :)&lt;/h3&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Version 1.1 update&lt;/h3&gt; &#xA;&lt;p&gt;This feature will help you save some keystrokes &amp;amp; brain power when you want to create some code at the top level node of your current cursor position.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;lua require(&#34;syntax-tree-surfer&#34;).go_to_top_node_and_execute_commands(false, { &#34;normal! O&#34;, &#34;normal! O&#34;, &#34;startinsert&#34; })&amp;lt;cr&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The .go_to_top_node_and_execute_commands() method takes 2 arguments:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;boolean: if false then it will jump to the beginning of the node, if true it jumps to the end.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;lua table: a table that contains strings, each tring is a vim command example: { &#34;normal! O&#34;, &#34;normal! O&#34;, &#34;startinsert&#34; }&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;hr&gt; &#xA;&lt;h1&gt;Version 1.0 Functionalities&lt;/h1&gt; &#xA;&lt;h3&gt;&lt;strong&gt;Navigate&lt;/strong&gt; around your document based on Treesitter&#39;s abstract Syntax Tree. Step into, step out, step over, step back.&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/102876811/163170843-a7c9f1a1-4ffb-4a39-9636-fc81521bd9b5.mp4&#34;&gt;https://user-images.githubusercontent.com/102876811/163170843-a7c9f1a1-4ffb-4a39-9636-fc81521bd9b5.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;&lt;strong&gt;Move / Swap&lt;/strong&gt; elements around based on your visual selection&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/102876811/163171460-4620be6b-360f-4d39-b025-55c412f54a96.mp4&#34;&gt;https://user-images.githubusercontent.com/102876811/163171460-4620be6b-360f-4d39-b025-55c412f54a96.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/102876811/163171686-4ad49b7a-9fd3-41d5-a2c2-deae1bb41c3d.mp4&#34;&gt;https://user-images.githubusercontent.com/102876811/163171686-4ad49b7a-9fd3-41d5-a2c2-deae1bb41c3d.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;&lt;strong&gt;Swap in Normal Mode&lt;/strong&gt; (limited support)&lt;/h3&gt; &#xA;&lt;h4&gt;Now supports Dot . Repeat&lt;/h4&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/102876811/163173466-b4bfd70f-c239-4e9c-a7ae-c540c093e0f4.mp4&#34;&gt;https://user-images.githubusercontent.com/102876811/163173466-b4bfd70f-c239-4e9c-a7ae-c540c093e0f4.mp4&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;How do I install?&lt;/h1&gt; &#xA;&lt;h4&gt;Use your favorite Plugin Manager with the link &lt;a href=&#34;https://raw.githubusercontent.com/ziontee113/syntax-tree-surfer/master/ziontee113/syntax-tree-surfer&#34;&gt;ziontee113/syntax-tree-surfer&lt;/a&gt;&lt;/h4&gt; &#xA;&lt;p&gt;For Packer:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;use &#34;ziontee113/syntax-tree-surfer&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;How do I set things up?&lt;/h1&gt; &#xA;&lt;h3&gt;Here&#39;s my suggestion:&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;-- Syntax Tree Surfer&#xA;local opts = {noremap = true, silent = true}&#xA;&#xA;-- Normal Mode Swapping:&#xA;-- Swap The Master Node relative to the cursor with it&#39;s siblings, Dot Repeatable&#xA;vim.keymap.set(&#34;n&#34;, &#34;vU&#34;, function()&#xA;&#x9;vim.opt.opfunc = &#34;v:lua.STSSwapUpNormal_Dot&#34;&#xA;&#x9;return &#34;g@l&#34;&#xA;end, { silent = true, expr = true })&#xA;vim.keymap.set(&#34;n&#34;, &#34;vD&#34;, function()&#xA;&#x9;vim.opt.opfunc = &#34;v:lua.STSSwapDownNormal_Dot&#34;&#xA;&#x9;return &#34;g@l&#34;&#xA;end, { silent = true, expr = true })&#xA;&#xA;-- Swap Current Node at the Cursor with it&#39;s siblings, Dot Repeatable&#xA;vim.keymap.set(&#34;n&#34;, &#34;vd&#34;, function()&#xA;&#x9;vim.opt.opfunc = &#34;v:lua.STSSwapCurrentNodeNextNormal_Dot&#34;&#xA;&#x9;return &#34;g@l&#34;&#xA;end, { silent = true, expr = true })&#xA;vim.keymap.set(&#34;n&#34;, &#34;vu&#34;, function()&#xA;&#x9;vim.opt.opfunc = &#34;v:lua.STSSwapCurrentNodePrevNormal_Dot&#34;&#xA;&#x9;return &#34;g@l&#34;&#xA;end, { silent = true, expr = true })&#xA;&#xA;--&amp;gt; If the mappings above don&#39;t work, use these instead (no dot repeatable)&#xA;-- vim.keymap.set(&#34;n&#34;, &#34;vd&#34;, &#39;&amp;lt;cmd&amp;gt;STSSwapCurrentNodeNextNormal&amp;lt;cr&amp;gt;&#39;, opts)&#xA;-- vim.keymap.set(&#34;n&#34;, &#34;vu&#34;, &#39;&amp;lt;cmd&amp;gt;STSSwapCurrentNodePrevNormal&amp;lt;cr&amp;gt;&#39;, opts)&#xA;-- vim.keymap.set(&#34;n&#34;, &#34;vD&#34;, &#39;&amp;lt;cmd&amp;gt;STSSwapDownNormal&amp;lt;cr&amp;gt;&#39;, opts)&#xA;-- vim.keymap.set(&#34;n&#34;, &#34;vU&#34;, &#39;&amp;lt;cmd&amp;gt;STSSwapUpNormal&amp;lt;cr&amp;gt;&#39;, opts)&#xA;&#xA;-- Visual Selection from Normal Mode&#xA;vim.keymap.set(&#34;n&#34;, &#34;vx&#34;, &#39;&amp;lt;cmd&amp;gt;STSSelectMasterNode&amp;lt;cr&amp;gt;&#39;, opts)&#xA;vim.keymap.set(&#34;n&#34;, &#34;vn&#34;, &#39;&amp;lt;cmd&amp;gt;STSSelectCurrentNode&amp;lt;cr&amp;gt;&#39;, opts)&#xA;&#xA;-- Select Nodes in Visual Mode&#xA;vim.keymap.set(&#34;x&#34;, &#34;J&#34;, &#39;&amp;lt;cmd&amp;gt;STSSelectNextSiblingNode&amp;lt;cr&amp;gt;&#39;, opts)&#xA;vim.keymap.set(&#34;x&#34;, &#34;K&#34;, &#39;&amp;lt;cmd&amp;gt;STSSelectPrevSiblingNode&amp;lt;cr&amp;gt;&#39;, opts)&#xA;vim.keymap.set(&#34;x&#34;, &#34;H&#34;, &#39;&amp;lt;cmd&amp;gt;STSSelectParentNode&amp;lt;cr&amp;gt;&#39;, opts)&#xA;vim.keymap.set(&#34;x&#34;, &#34;L&#34;, &#39;&amp;lt;cmd&amp;gt;STSSelectFirstChildNode&amp;lt;cr&amp;gt;&#39;, opts)&#xA;&#xA;-- Swapping Nodes in Visual Mode&#xA;vim.keymap.set(&#34;x&#34;, &#34;&amp;lt;A-j&amp;gt;&#34;, &#39;&amp;lt;cmd&amp;gt;STSSwapNextVisual&amp;lt;cr&amp;gt;&#39;, opts)&#xA;vim.keymap.set(&#34;x&#34;, &#34;&amp;lt;A-k&amp;gt;&#34;, &#39;&amp;lt;cmd&amp;gt;STSSwapPrevVisual&amp;lt;cr&amp;gt;&#39;, opts)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Now let&#39;s start Tree Surfing! 🌲💦&lt;/h1&gt;</summary>
  </entry>
</feed>