<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Ruby Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-10-27T01:39:47Z</updated>
  <subtitle>Daily Trending of Ruby in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>basecamp/kamal-skiff</title>
    <updated>2023-10-27T01:39:47Z</updated>
    <id>tag:github.com,2023-10-27:/basecamp/kamal-skiff</id>
    <link href="https://github.com/basecamp/kamal-skiff" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Deploy static sites using nginx + SSI with Kamal&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Skiff&lt;/h1&gt; &#xA;&lt;p&gt;Skiff uses &lt;a href=&#34;https://kamal-deploy.org&#34;&gt;Kamal&lt;/a&gt; to deploy static sites using nginx with Server-Side Includes (SSI).&lt;/p&gt; &#xA;&lt;p&gt;Understand the why and the how in this introduction video: &lt;a href=&#34;https://www.youtube.com/watch?v=YoabUEzpM6k&#34;&gt;https://www.youtube.com/watch?v=YoabUEzpM6k&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Local development&lt;/h2&gt; &#xA;&lt;p&gt;If you have a Ruby environment available, you can install Skiff globally with:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;gem install kamal-skiff&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then run &lt;code&gt;skiff dev&lt;/code&gt; to start the development server.&lt;/p&gt; &#xA;&lt;p&gt;...otherwise, you can run a dockerized version via an alias (add this to your .bashrc or similar to simplify re-use). On macOS, use:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;alias skiff-dev=&#34;docker build -t skiff-site . &amp;amp;&amp;amp; docker run -it --rm -p 4000:80 -v ./public:/site/public --name skiff-site skiff-site nginx &#39;-g daemon off;&#39;&#34;&#xA;alias skiff=&#34;docker run -it --rm -v &#39;${PWD}:/workdir&#39; -v /run/host-services/ssh-auth.sock:/run/host-services/ssh-auth.sock -e SSH_AUTH_SOCK=&#39;/run/host-services/ssh-auth.sock&#39; -v /var/run/docker.sock:/var/run/docker.sock ghcr.io/basecamp/kamal-skiff:latest&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then run &lt;code&gt;skiff-dev&lt;/code&gt; to start the development server, and use &lt;code&gt;skiff [command]&lt;/code&gt; for everything else.&lt;/p&gt; &#xA;&lt;h2&gt;Deploying the site for the first time&lt;/h2&gt; &#xA;&lt;p&gt;First ensure that you&#39;ve set &lt;code&gt;GIT_URL&lt;/code&gt; to a repository address with a valid access token embedded in the &lt;code&gt;.env&lt;/code&gt; file. This access token must have access to pull from the git repository in question (see &lt;a href=&#34;https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens&#34;&gt;personal access tokens for GitHub&lt;/a&gt; for an example).&lt;/p&gt; &#xA;&lt;p&gt;Then you must also setup an access token for your Docker image repository (see &lt;a href=&#34;https://docs.docker.com/security/for-developers/access-tokens/&#34;&gt;Create and manage access tokens for Docker Hub&lt;/a&gt; for an example).&lt;/p&gt; &#xA;&lt;p&gt;Finally, you must add the server address into &lt;code&gt;config/deploy.yml&lt;/code&gt;, and ensure that the image and repository configurations are correct.&lt;/p&gt; &#xA;&lt;p&gt;Now you&#39;re ready to run &lt;code&gt;skiff deploy&lt;/code&gt; to deploy your site to the server. This will install Docker on your server (using &lt;code&gt;apt-get&lt;/code&gt;), if it isn&#39;t already available.&lt;/p&gt; &#xA;&lt;h2&gt;Deploying changes to production&lt;/h2&gt; &#xA;&lt;p&gt;Changes checked into git are automatically pulled onto the Skiff server every 10 seconds. So all you have to do is checkin your changes and push them.&lt;/p&gt; &#xA;&lt;p&gt;If you need to change the nginx configuration in &lt;code&gt;config/server.conf&lt;/code&gt;, make your changes to that file, check them into git and push, and then run &lt;code&gt;skiff restart&lt;/code&gt; to test the configuration file and restart the server if it&#39;s valid.&lt;/p&gt; &#xA;&lt;h2&gt;Deploying changes to staging first&lt;/h2&gt; &#xA;&lt;p&gt;To use a staging server, you must set &lt;code&gt;GIT_BRANCH&lt;/code&gt; in .env to the branch you&#39;re using for staging. Then you can deploy the site to a staging server using &lt;code&gt;skiff deploy --staging&lt;/code&gt;, which will use the configuration in &lt;code&gt;config/deploy.staging.yml&lt;/code&gt;, and start pulling updates from the branch specified.&lt;/p&gt; &#xA;&lt;h2&gt;Flushing etag caches after changing include files&lt;/h2&gt; &#xA;&lt;p&gt;Skiff uses &lt;a href=&#34;https://nginx.org/en/docs/http/ngx_http_ssi_module.html&#34;&gt;Server Side Includes&lt;/a&gt;, which can change independently of your individual HTML files. When that happens, the caching etags for those latter files will not be updated automatically to reflect the change. You can run &lt;code&gt;skiff flush&lt;/code&gt; to touch all the public HTML files, which will flush the etag cache.&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;Skiff is released under the &lt;a href=&#34;https://opensource.org/licenses/MIT&#34;&gt;MIT License&lt;/a&gt;.&lt;/p&gt;</summary>
  </entry>
</feed>