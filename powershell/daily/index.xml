<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-04-11T01:41:30Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>PicZZp/rdp</title>
    <updated>2023-04-11T01:41:30Z</updated>
    <id>tag:github.com,2023-04-11:/PicZZp/rdp</id>
    <link href="https://github.com/PicZZp/rdp" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Bismillah lancar buat rdp free&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;WINRDP BA_channel&lt;/h1&gt; &#xA;&lt;p&gt;build yml :&lt;a href=&#34;https://pastebin.com/MBVNQp2G&#34;&gt;https://pastebin.com/MBVNQp2G&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Remotedesktop chrome : &lt;a href=&#34;https://remotedesktop.google.com/headless&#34;&gt;https://remotedesktop.google.com/headless&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;tutorial yt Bang Android Watch Video: &lt;a href=&#34;https://youtu.be/HXCjo8Ky3RA&#34;&gt;https://youtu.be/HXCjo8Ky3RA&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Selamat Mencoba Dan Semoga Berkah Teman Teman&lt;/h1&gt;</summary>
  </entry>
  <entry>
    <title>GoateePFE/ADCSTemplate</title>
    <updated>2023-04-11T01:41:30Z</updated>
    <id>tag:github.com,2023-04-11:/GoateePFE/ADCSTemplate</id>
    <link href="https://github.com/GoateePFE/ADCSTemplate" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A PowerShell module for exporting, importing, removing, permissioning, publishing Active Directory Certificate Templates. It also includes a DSC resource for creating AD CS templates using these functions. This was built with the intent of using DSC for rapid lab builds. Could also work in production to move templates between AD CS environments.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Find all code and samples at this location: &lt;a href=&#34;&#34;&gt;https://github.com/GoateePFE/ADCSTemplate/&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;ADCSTemplate&lt;/h1&gt; &#xA;&lt;p&gt;A PowerShell module for exporting, importing, removing, permissioning, publishing Active Directory Certificate Templates. It also includes a DSC resource for creating AD CS templates using these functions. This was built with the intent of using DSC for rapid lab builds, but it could also be used in production environments to move templates between AD CS environments.&lt;/p&gt; &#xA;&lt;h1&gt;Problem&lt;/h1&gt; &#xA;&lt;p&gt;Aren&#39;t you tired of using the Active Directory Certificate Services graphical interface to create and publish new certificate templates? Me too! I can build a domain controller and certificate server with DSC, but then I get stuck with manually creating the custom certificate templates for my environment. A popular example is the Document Encryption certificate used for DSC credential encryption and the CMS encryption cmdlets. You probably have some custom certificate templates unique to your company as well. No more right click, duplicate, permission, publish!&lt;/p&gt; &#xA;&lt;h1&gt;Solution&lt;/h1&gt; &#xA;&lt;p&gt;The ADCSTemplate module contains the following PowerShell functions:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Export-ADCSTemplate&lt;/li&gt; &#xA; &lt;li&gt;Get-ADCSTemplate&lt;/li&gt; &#xA; &lt;li&gt;New-ADCSDrive&lt;/li&gt; &#xA; &lt;li&gt;New-ADCSTemplate&lt;/li&gt; &#xA; &lt;li&gt;Remove-ADCSTemplate&lt;/li&gt; &#xA; &lt;li&gt;Set-ADCSTemplateACL&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;And the following DSC resource:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;ADCSTemplate&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Overview&lt;/h1&gt; &#xA;&lt;p&gt;This is a simple outline of the procedure to export and import your templates. Yes, you must create it manually at least once.&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Create your desired template in the AD CS GUI.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Install-Module ADCSTemplate&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Export-ADCSTemplate -DisplayName foo &amp;gt; .\foo.json&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Copy the JSON file to your destination environment.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Install-Module ADCSTemplate&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;New-ADCSTemplate -DisplayName foo2 -JSON (Get-Content .\foo.json -Raw) -Publish -Identity Contoso\MyGroup&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;-OR- Use the &lt;code&gt;ADCSTemplate&lt;/code&gt; DSC Resource with the JSON string data to define the template. This is most easily accomplished using a ConfigurationData block to pass the large string. See the sample provided.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;If you want to duplicate an existing template on the same server try this:&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;New-ADCSTemplate -DisplayName NewTemplateName -JSON (Export-ADCSTemplate -DisplayName OldTemplateName)&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;If you want to export all templates try this:&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt; (Get-ADCSTemplate).name | ForEach-Object {&#34;Exporting $_&#34;; Export-ADCSTemplate -DisplayName $_ | Out-File .\$_.json -Force}&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;See the module function help texts for many clever use cases for this code, including a bonus function for creating a PSDrive to browse the objects in AD without using the GUI.&lt;/p&gt; &#xA;&lt;p&gt;See the \Examples directory for&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;Demo.ps1&lt;/code&gt; showing popular use cases of the functions together.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Build-ADCS.ps1&lt;/code&gt; DSC example for a full Active Directory domain controller build with Certificate Services and two sample templates.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;PowerShellCMS.json&lt;/code&gt; a sample JSON output file you can use to create templates for PowerShell Cryptographic Message Syntax cmdlets and encryption credentials in DSC.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Requirements&lt;/h1&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;PowerShell 5.x&lt;/li&gt; &#xA; &lt;li&gt;Tested on Windows Server 2012 R2&lt;/li&gt; &#xA; &lt;li&gt;Tested on Windows Server 2016 (issues with the xActiveDirectory module here, but the ADCSTemplate DSC works just fine)&lt;/li&gt; &#xA; &lt;li&gt;Enterprise Administrator rights&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Credits&lt;/h1&gt; &#xA;&lt;p&gt;Created by Ashley McGlone&lt;/p&gt; &#xA;&lt;p&gt;2017-2018&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://twitter.com/goateepfe&#34;&gt;@GoateePFE&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;&#34;&gt;http://aka.ms/goateepfe&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Get-Help&lt;/h1&gt; &#xA;&lt;h2&gt;Export-ADCSTemplate&lt;/h2&gt; &#xA;&lt;h3&gt;Synopsis&lt;/h3&gt; &#xA;&lt;p&gt;Returns a JSON string with the properties of an Active Directory certificate template.&lt;/p&gt; &#xA;&lt;h3&gt;Description&lt;/h3&gt; &#xA;&lt;p&gt;Returns a JSON string with the properties of an Active Directory certificate template. By default returns only the PKI-related properties of the object. These properties are sufficient for passing to the New-ADCSTemplate function.&lt;/p&gt; &#xA;&lt;h3&gt;Parameters&lt;/h3&gt; &#xA;&lt;p&gt;-DisplayName &#xA; &lt;string&gt;&#xA;   DisplayName for the certificate to export.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    true&#xA;Position?                    1&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Server &#xA; &lt;string&gt;&#xA;   FQDN of Active Directory Domain Controller to target for the operation. When not specified it will search for the nearest Domain Controller.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    2&#xA;Default value                (Get-ADDomainController -Discover -ForceDiscover -Writable).HostName[0]&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Detailed [&#xA; &lt;switchparameter&gt;&#xA;  ] Includes all ADObject properties of the template. These are not required for use with the New-ADCSTemplate function.&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                False&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Notes&lt;/h3&gt; &#xA;&lt;p&gt;C.R.U.D. AD CS Template Operations in this module. No longer have to use the cert GUI to clone a template and build a new one. Create one manually the first time in the GUI, then export it to JSON. Pass the JSON in your new environment (file, here string, DSC, etc.) to build from scratch. Requires Enterprise Administrator permissions, since this touches the AD Configuration partition.&lt;/p&gt; &#xA;&lt;h3&gt;Examples&lt;/h3&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 1 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Export-ADCSTemplate -DisplayName PowerShellCMS&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 2 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Export-ADCSTemplate -DisplayName PowerShellCMS -Detailed&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 3 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; ### Backup all the templates to JSON&#xA;md C:\ADCSTemplates -ErrorAction SilentlyContinue&#xA;cd C:\ADCSTemplates&#xA;(Get-ADCSTemplate).name | ForEach-Object {&#34;Exporting $_&#34;; Export-ADCSTemplate -DisplayName $_ | Out-File .\$_.json -Force}&#xA;dir&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 4 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; New-ADCSTemplate -DisplayName PowerShellCMS-NEW -JSON (Export-ADCSTemplate -DisplayName PowerShellCMS-OLD)&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Get-ADCSTemplate&lt;/h2&gt; &#xA;&lt;h3&gt;Synopsis&lt;/h3&gt; &#xA;&lt;p&gt;Returns the properties of either a single or all Active Directory Certificate Template(s).&lt;/p&gt; &#xA;&lt;h3&gt;Description&lt;/h3&gt; &#xA;&lt;p&gt;Returns the properties of either a single or list of Active Directory Certificate Template(s) depending on whether a DisplayName parameter was passed.&lt;/p&gt; &#xA;&lt;h3&gt;Parameters&lt;/h3&gt; &#xA;&lt;p&gt;-DisplayName &#xA; &lt;string&gt;&#xA;   Name of an AD CS template to retrieve.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    1&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Server &#xA; &lt;string&gt;&#xA;   FQDN of Active Directory Domain Controller to target for the operation. When not specified it will search for the nearest Domain Controller.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                (Get-ADDomainController -Discover -ForceDiscover -Writable).HostName[0]&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Notes&lt;/h3&gt; &#xA;&lt;p&gt;Requires Enterprise Administrator permissions, since this touches the AD Configuration partition.&lt;/p&gt; &#xA;&lt;h3&gt;Examples&lt;/h3&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 1 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Get-ADCSTemplate&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 2 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Get-ADCSTemplate -DisplayName PowerShellCMS&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 3 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Get-ADCSTemplate | Sort-Object Name | ft Name, Created, Modified&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 4 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; ###View template permissions&#xA;(Get-ADCSTemplate pscms).nTSecurityDescriptor&#xA;(Get-ADCSTemplate pscms).nTSecurityDescriptor.Sddl&#xA;(Get-ADCSTemplate pscms).nTSecurityDescriptor.Access&#xA;ConvertFrom-SddlString -Sddl (Get-ADCSTemplate pscms).nTSecurityDescriptor.sddl -Type ActiveDirectoryRights&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;New-ADCSDrive&lt;/h2&gt; &#xA;&lt;h3&gt;Synopsis&lt;/h3&gt; &#xA;&lt;p&gt;Maps a PowerShell drive to the Active Directory Certificate Services location.&lt;/p&gt; &#xA;&lt;h3&gt;Description&lt;/h3&gt; &#xA;&lt;p&gt;Maps a PowerShell drive to the Active Directory Certificate Services location of the Configuration partition under CN=Public Key Services,CN=Services,... . The new drive is ADCS:. This is purely for convenience of checking the objects updated by functions in the ADCSTemplate module.&lt;/p&gt; &#xA;&lt;h3&gt;Parameters&lt;/h3&gt; &#xA;&lt;p&gt;-Server &#xA; &lt;string&gt;&#xA;   FQDN of Active Directory Domain Controller to target for the operation. When not specified it will search for the nearest Domain Controller.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    1&#xA;Default value                (Get-ADDomainController -Discover -ForceDiscover -Writable).HostName[0]&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Notes&lt;/h3&gt; &#xA;&lt;p&gt;Requires Enterprise Administrator permissions, since this touches the AD Configuration partition.&lt;/p&gt; &#xA;&lt;h3&gt;Examples&lt;/h3&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 1 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; New-ADCSDrive&#xA;PS C:\&amp;gt; Set-Location ADCS:&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 2 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; ### Explore templates with drive&#xA;New-ADCSDrive&#xA;Get-PSDrive&#xA;cd ADCS:&#xA;dir&#xA;&#xA;# List templates&#xA;cd &#39;.\CN=Certificate Templates&#39;&#xA;dir&#xA;dir | fl *&#xA;dir *WebServer*&#xA;&#xA;# list CAs&#xA;cd \&#xA;cd &#39;.\CN=Enrollment Services&#39;&#xA;dir&#xA;cd C:&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;New-ADCSTemplate&lt;/h2&gt; &#xA;&lt;h3&gt;Synopsis&lt;/h3&gt; &#xA;&lt;p&gt;Creates a new Active Directory Certificate Services template based on a JSON export.&lt;/p&gt; &#xA;&lt;h3&gt;Description&lt;/h3&gt; &#xA;&lt;p&gt;Creates a new Active Directory Certificate Services template based on a JSON export. Optionally can permission and publish the template (best practice).&lt;/p&gt; &#xA;&lt;h3&gt;Parameters&lt;/h3&gt; &#xA;&lt;p&gt;-DisplayName &#xA; &lt;string&gt;&#xA;   DisplayName for the certificate template to create. This does not have to match the original name of the exported template.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    true&#xA;Position?                    1&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-JSON &#xA; &lt;string&gt;&#xA;   JSON string output from Export-ADCSTemplate. Defines the template to create. Can be retrieved from file using Get-Content -Raw.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    true&#xA;Position?                    2&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Server &#xA; &lt;string&gt;&#xA;   FQDN of Active Directory Domain Controller to target for the operation. When not specified it will search for the nearest Domain Controller.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    3&#xA;Default value                (Get-ADDomainController -Discover -ForceDiscover -Writable).HostName[0]&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Identity &amp;lt;String[]&amp;gt; String or string array of Active Directory identities (users or groups). This is optional for permissioning the template.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    4&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-AutoEnroll [&#xA; &lt;switchparameter&gt;&#xA;  ] Default permission is Read and Enroll. Use this switch to also grant AutoEnroll to the identity. Only used when Identity parameter is used.&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                False&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Publish [&#xA; &lt;switchparameter&gt;&#xA;  ] Publish the template to &#xA;  &lt;em&gt;ALL&lt;/em&gt; Certificate Authority issuers. Use with caution in production environments. You may want to manually publish to only specific Certificate Authorities in production. In a lab this is ideal.&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                False&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Notes&lt;/h3&gt; &#xA;&lt;p&gt;This function does not use the official (complicated) API for PKI management. Instead it creates the exact same AD objects that are generated by the API, including AD forest-specific OIDs. Requires Enterprise Administrator permissions, since this touches the AD Configuration partition.&lt;/p&gt; &#xA;&lt;h3&gt;Examples&lt;/h3&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 1 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; New-ADCSTemplate -DisplayName PowerShellCMS -JSON (Get-Content .\pscms.json -Raw)&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 2 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; New-ADCSTemplate -DisplayName PowerShellCMS -JSON (Get-Content .\pscms.json -Raw) -Server dc1.contoso.com -Identity G_DSCNodes -AutoEnroll -Publish&#xA;# From a client configured for AD CS autoenrollment:&#xA;$Req = @{&#xA;    Template          = &#39;PowerShellCMS&#39;&#xA;    Url               = &#39;ldap:&#39;&#xA;    CertStoreLocation = &#39;Cert:\LocalMachine\My&#39;&#xA;}&#xA;Get-Certificate @Req&#xA;# Note: If you have the Carbon module installed, it conflicts with Get-Certificate native cmdlet.&#xA;&#xA;$DocEncrCert = (dir Cert:\LocalMachine\My -DocumentEncryptionCert | Sort-Object NotBefore)[-1]&#xA;Protect-CmsMessage -To $DocEncrCert -Content &#34;Encrypted with my new cert from the new template!&#34;&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 3 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; New-ADCSTemplate -DisplayName PowerShellCMS-NEW -JSON (Export-ADCSTemplate -DisplayName PowerShellCMS-OLD)&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Remove-ADCSTemplate&lt;/h2&gt; &#xA;&lt;h3&gt;Synopsis&lt;/h3&gt; &#xA;&lt;p&gt;Removes a certificate template from Active Directory.&lt;/p&gt; &#xA;&lt;h3&gt;Description&lt;/h3&gt; &#xA;&lt;p&gt;Removes the template from any issuers where it is published. Removes the template itself. Removes the unique OID object of the template.&lt;/p&gt; &#xA;&lt;h3&gt;Parameters&lt;/h3&gt; &#xA;&lt;p&gt;-DisplayName &#xA; &lt;string&gt;&#xA;   DisplayName for the certificate template to delete.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    true&#xA;Position?                    1&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Server &#xA; &lt;string&gt;&#xA;   FQDN of Active Directory Domain Controller to target for the operation. When not specified it will search for the nearest Domain Controller.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    2&#xA;Default value                (Get-ADDomainController -Discover -ForceDiscover -Writable).HostName[0]&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-WhatIf [&#xA; &lt;switchparameter&gt;&#xA;  ]&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Confirm [&#xA; &lt;switchparameter&gt;&#xA;  ]&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Notes&lt;/h3&gt; &#xA;&lt;p&gt;Use with caution! Requires Enterprise Administrator permissions, since this touches the AD Configuration partition.&lt;/p&gt; &#xA;&lt;h3&gt;Examples&lt;/h3&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 1 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Remove-ADCSTemplate -DisplayName PowerShellCMS&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 2 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; (Get-ADCSTemplate).name | Where-Object {$_ -like &#34;PowerShellCMS*&#34;} | ForEach-Object {Remove-ADCSTemplate -DisplayName $_ -Verbose}&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Set-ADCSTemplateACL&lt;/h2&gt; &#xA;&lt;h3&gt;Synopsis&lt;/h3&gt; &#xA;&lt;p&gt;Adds an ACL to an Active Directory Certificate template.&lt;/p&gt; &#xA;&lt;h3&gt;Description&lt;/h3&gt; &#xA;&lt;p&gt;Adds an ACL to an Active Directory Certificate template. Default permission is read (without the Enroll or AutoEnroll switches).&lt;/p&gt; &#xA;&lt;h3&gt;Parameters&lt;/h3&gt; &#xA;&lt;p&gt;-DisplayName &#xA; &lt;string&gt;&#xA;   Name of an AD CS template to receive the ACL.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    true&#xA;Position?                    1&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Server &#xA; &lt;string&gt;&#xA;   FQDN of Active Directory Domain Controller to target for the operation. When not specified it will search for the nearest Domain Controller.&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    2&#xA;Default value                (Get-ADDomainController -Discover -ForceDiscover -Writable).HostName[0]&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Type &#xA; &lt;string&gt;&#xA;   ACL type: Allow or Deny&#xA; &lt;/string&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    3&#xA;Default value                Allow&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Identity &amp;lt;String[]&amp;gt; String or string array of Active Directory identities (users or groups)&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    4&#xA;Default value                &#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-Enroll [&#xA; &lt;switchparameter&gt;&#xA;  ] Set the Enroll permission&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                False&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-AutoEnroll [&#xA; &lt;switchparameter&gt;&#xA;  ] Set the AutoEnroll permission&#xA; &lt;/switchparameter&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Required?                    false&#xA;Position?                    named&#xA;Default value                False&#xA;Accept pipeline input?       false&#xA;Accept wildcard characters?  false&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Notes&lt;/h3&gt; &#xA;&lt;p&gt;Requires Enterprise Administrator permissions, since this touches the AD Configuration partition.&lt;/p&gt; &#xA;&lt;h3&gt;Examples&lt;/h3&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 1 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Set-ADCSTemplateACL -DisplayName PowerShellCMS -Type Allow -Identity &#39;CONTOSO\Servers Group&#39; -Enroll&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 2 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Set-ADCSTemplateACL -DisplayName PowerShellCMS -Type Allow -Identity &#39;CONTOSO\Servers Group&#39;,&#39;CONTOSO\Workstations Group&#39; -Enroll -AutoEnroll&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;-------------------------- EXAMPLE 3 --------------------------&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; Set-ADCSTemplateACL -DisplayName PowerShellCMS -Type Deny -Identity &#39;CONTOSO\Servers Group&#39;&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>