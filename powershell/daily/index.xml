<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-01-02T01:36:26Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>p0w3rsh3ll/NetCease</title>
    <updated>2024-01-02T01:36:26Z</updated>
    <id>tag:github.com,2024-01-02:/p0w3rsh3ll/NetCease</id>
    <link href="https://github.com/p0w3rsh3ll/NetCease" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;NetCease PowerShell Module&lt;/h1&gt; &#xA;&lt;p&gt;&lt;strong&gt;NetCease module was designed to help disable Net Session Enumeration.&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Table of Contents&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Intent&#34;&gt;Intnet&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Usage&#34;&gt;Usage&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Install&#34;&gt;Install the module&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Functions&#34;&gt;Functions&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Help&#34;&gt;Help&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#WhatsNext&#34;&gt;What&#39;s Next&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#issues&#34;&gt;Issues&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Todo&#34;&gt;Todo&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/p0w3rsh3ll/NetCease/master/#Credits&#34;&gt;Credits&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;a name=&#34;Intent&#34;&gt;&lt;/a&gt; &#xA;&lt;h2&gt;Intent&lt;/h2&gt; &#xA;&lt;p&gt;This page and code is the result of a simple process: Study &amp;gt; Learn &amp;gt; Share.&lt;/p&gt; &#xA;&lt;p&gt;I started to study the great anti-reconnaissance tool provided by Itai Grady on &lt;a href=&#34;https://gallery.technet.microsoft.com/Net-Cease-Blocking-Net-1e8dcb5b&#34;&gt;https://gallery.technet.microsoft.com/Net-Cease-Blocking-Net-1e8dcb5b&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;The zip file contains a document than explains the details about how to harden the Net Session Enumeration.&lt;/p&gt; &#xA;&lt;p&gt;The zip file also contains a script that:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;saves a backup of the current permissions (whatever they are)&lt;/li&gt; &#xA; &lt;li&gt;transitions from the current security permissions to a hardened state by removing the NT AUTHORITY\Authenticated Users group and adding permissions to NT AUTHORITY\BATCH, NT AUTHORITY\INTERACTIVE, NT AUTHORITY\SERVICE.&lt;/li&gt; &#xA; &lt;li&gt;introduces a way to revert back to the backup verison of the permissions (the version 1.02)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;While the script will do the job on a safe computer, it doesn&#39;t assume breach. So, I propose a more straightforward approach :-D&lt;/p&gt; &#xA;&lt;p&gt;The module contains 3 functions, one to view the current permissions set (with translated SIDs), a second one to set the required permissions and a third one to restore the default permissions. It just aims to make the move from the default state to the hardened one and vice-versa more easy.&lt;/p&gt; &#xA;&lt;p&gt;I wanted the module to be available on &lt;a href=&#34;https://www.powershellgallery.com&#34;&gt;https://www.powershellgallery.com&lt;/a&gt;&lt;/p&gt; &#xA;&lt;a name=&#34;Usage&#34;&gt;&lt;/a&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;a name=&#34;Install&#34;&gt;&lt;/a&gt; &#xA;&lt;h3&gt;Install the module&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# Check the mmodule on powershellgallery.com&#xA;Find-Module -Name NetCease -Repository PSGallery&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;Version    Name                                Repository           Description&#xA;-------    ----                                ----------           -----------&#xA;1.0.2      NetCease                            PSGallery            NetCease is a module that will help disable Net ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# Save the module locally in Downloads folder&#xA;Save-Module -Name NetCease -Repository PSGallery -Path ~/Downloads&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Stop and please review the content of the module, I mean the code to make sure it&#39;s trustworthy :-)&lt;/p&gt; &#xA;&lt;p&gt;You can also verify that the SHA256 hashes of downloaded files match those stored in the catalog file&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$HT = @{&#xA;    CatalogFilePath = &#34;~/Downloads/NetCease/1.0.2/NetCease.cat&#34;&#xA;    Path = &#34;~/Downloads/NetCease/1.0.2&#34;&#xA;    Detailed = $true&#xA;    FilesToSkip = &#39;PSGetModuleInfo.xml&#39;&#xA;}&#xA;Test-FileCatalog @HT&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# Import the module&#xA;Import-Module ~/Downloads/NetCease/1.0.2/NetCease.psd1 -Force -Verbose&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;a name=&#34;Functions&#34;&gt;&lt;/a&gt; &#xA;&lt;h3&gt;Check the command available&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Get-Command -Module NetCease&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;CommandType     Name                                               Version    Source&#xA;-----------     ----                                               -------    ------&#xA;Function        Get-NetSessionEnumPermission                       1.0.2      NetCease&#xA;Function        Restore-NetSessionEnumPermission                   1.0.2      NetCease&#xA;Function        Set-NetSessionEnumPermission                       1.0.2      NetCease&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;a name=&#34;Help&#34;&gt;&lt;/a&gt; &#xA;&lt;h3&gt;Get-NetSessionEnumPermission&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt; Get-Help Get-NetSessionEnumPermission -Full&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;NAME&#xA;    Get-NetSessionEnumPermission&#xA;&#xA;SYNOPSIS&#xA;    Get the current Net Session Enumeration permissions&#xA;&#xA;&#xA;SYNTAX&#xA;    Get-NetSessionEnumPermission [&amp;lt;CommonParameters&amp;gt;]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Set-NetSessionEnumPermission&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt; Get-Help Set-NetSessionEnumPermission -Full&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;NAME&#xA;    Set-NetSessionEnumPermission&#xA;&#xA;SYNOPSIS&#xA;    Set the hardened Net Session Enumeration permissions&#xA;&#xA;&#xA;SYNTAX&#xA;    Set-NetSessionEnumPermission [&amp;lt;CommonParameters&amp;gt;]&#xA;&#xA;&#xA;DESCRIPTION&#xA;    Set the hardened Net Session Enumeration permissions:&#xA;&#xA;    TranslatedSID                   SecurityIdentifier AccessMask       AceType&#xA;    ------------                    ------------------ ----------       -------&#xA;    NT AUTHORITY\BATCH              S-1-5-3               2032127 AccessAllowed&#xA;    NT AUTHORITY\INTERACTIVE        S-1-5-4               2032127 AccessAllowed&#xA;    NT AUTHORITY\SERVICE            S-1-5-6               2032127 AccessAllowed&#xA;    BUILTIN\Administrators          S-1-5-32-544           983059 AccessAllowed&#xA;    BUILTIN\Power Users             S-1-5-32-547           983059 AccessAllowed&#xA;    BUILTIN\Server Operators        S-1-5-32-549           983059 AccessAllowed&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Restore-NetSessionEnumPermission&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Get-Help Restore-NetSessionEnumPermission -Full&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;NAME&#xA;    Restore-NetSessionEnumPermission&#xA;&#xA;SYNOPSIS&#xA;    Restore the default Net Session Enumeration permissions&#xA;&#xA;&#xA;SYNTAX&#xA;    Restore-NetSessionEnumPermission [&amp;lt;CommonParameters&amp;gt;]&#xA;&#xA;&#xA;DESCRIPTION&#xA;    Restore the default Net Session Enumeration permissions:&#xA;&#xA;    TranslatedSID                    SecurityIdentifier AccessMask       AceType&#xA;    ------------                    ------------------ ----------       -------&#xA;    NT AUTHORITY\Authenticated Users S-1-5-11                    1 AccessAllowed&#xA;    BUILTIN\Administrators           S-1-5-32-544           983059 AccessAllowed&#xA;    BUILTIN\Power Users              S-1-5-32-547           983059 AccessAllowed&#xA;    BUILTIN\Server Operators         S-1-5-32-549           983059 AccessAllowed&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;a name=&#34;WhatsNext&#34;&gt;&lt;/a&gt; &#xA;&lt;h2&gt;What&#39;s Next&lt;/h2&gt; &#xA;&lt;p&gt;Once you&#39;ve used either the Set-NetSessionEnumPermission or Restore-NetSessionEnumPermission functions, you need to restart the &#39;Server&#39; service for changes to take effect:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Restart-Service -Name LanmanServer -Force -Verbose&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;a name=&#34;Issues&#34;&gt;&lt;/a&gt; &#xA;&lt;h2&gt;Issues&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Version 1.0.0 had a -Whatif parameter after the Set-ItemProperty that was preventing to really set the hardened permissions&lt;/li&gt; &#xA; &lt;li&gt;Version 1.0.1 had the wrong catalog file published to the PowerShell gallery&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;a name=&#34;Todo&#34;&gt;&lt;/a&gt; &#xA;&lt;h2&gt;Todo&lt;/h2&gt; &#xA;&lt;h4&gt;Coding best practices&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; checked disabled&gt; Use PSScriptAnalyzer module to validate the code follows best practices&lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; Write Pester tests for this module&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;a name=&#34;Credits&#34;&gt;&lt;/a&gt; &#xA;&lt;h2&gt;Credits&lt;/h2&gt; &#xA;&lt;p&gt;Thanks go to:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://twitter.com/ItaiGrady&#34;&gt;@ItaiGrady&lt;/a&gt;&lt;/strong&gt;:&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>