<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-09-11T01:38:43Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>0xJs/domain_audit</title>
    <updated>2023-09-11T01:38:43Z</updated>
    <id>tag:github.com,2023-09-11:/0xJs/domain_audit</id>
    <link href="https://github.com/0xJs/domain_audit" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Audit tool for Active Directory. Automates a lot of checks from a pentester perspective.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Domain Audit&lt;/h1&gt; &#xA;&lt;p&gt;The tool is a wrapper around PowerView, Impacket, PowerUpSQL, BloodHound, Ldaprelayscan and Crackmapexec to automate the execution of enumeration and a lot of checks performed during a On-Prem Active Directory Penetrationtest. Thanks to all the authors of the original tools.&lt;/p&gt; &#xA;&lt;h2&gt;Installation &amp;amp; Setup&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Install python 3.10 (For example from the Windows store)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt;git clone https://github.com/0xJs/domain_audit&#xA;cd .\domain_audit\import\&#xA;git clone https://github.com/SecureAuthCorp/impacket&#xA;cd impacket; python3 -m pip install .&#xA;cd ../;&#xA;git clone https://github.com/zyn3rgy/LdapRelayScan;&#xA;cd LdapRelayScan;&#xA;python3 -m pip install -r .\requirements.txt&#xA;cd ../../;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Make sure the path viariables in the script to the following tools are correct (if you followed the installation steps it should be)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt;$script:PowerView_Path = &#34;$PSScriptRoot\import\PowerView.ps1&#34;&#xA;$script:Powerupsql_Path = &#34;$PSScriptRoot\import\PowerUpSQL.ps1&#34;&#xA;$script:Impacket_Path = &#34;$PSScriptRoot\import\impacket&#34;&#xA;$script:BloodHound_Path = &#34;$PSScriptRoot\import\Sharphound.ps1&#34;&#xA;$script:GpRegisteryPolicy_Path = &#34;$PSScriptRoot\import\GPRegistryPolicy\GPRegistryPolicy.psd1&#34;&#xA;$script:CME_Path = &#34;$PSScriptRoot\import\cme&#34;&#xA;$script:LdapRelayScan_Path = &#34;$PSScriptRoot\import\LdapRelayScan\LdapRelayScan.py&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Issue with accessing Sysvol access denied? &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;To resolve this issue run &lt;code&gt;gpedit.msc&lt;/code&gt;, go to &lt;code&gt;Computer -&amp;gt; Administrative Templates -&amp;gt; Network -&amp;gt; Network Provider -&amp;gt; Hardened UNC Paths&lt;/code&gt;, enable the policy and click &#34;Show&#34; button.&lt;/li&gt; &#xA;   &lt;li&gt;Enter &lt;code&gt;*&lt;/code&gt; into &#34;Value name&#34; and enter &lt;code&gt;RequireMutualAuthentication=0,RequireIntegrity=0,RequirePrivacy=0&lt;/code&gt; in value.&lt;/li&gt; &#xA;   &lt;li&gt;Enter &lt;code&gt;\\*\NETLOGON&lt;/code&gt; into &#34;Value name&#34; and enter &lt;code&gt;RequireMutualAuthentication=0,RequireIntegrity=0,RequirePrivacy=0&lt;/code&gt; in value.&lt;/li&gt; &#xA;   &lt;li&gt;Enter &lt;code&gt;\\*\SYSVOL&lt;/code&gt; into &#34;Value name&#34; and enter &lt;code&gt;RequireMutualAuthentication=0,RequireIntegrity=0,RequirePrivacy=0&lt;/code&gt; in value.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;If it still gives problems add the following:&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt;reg add HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths /v &#34;\\*\SYSVOL&#34; /d &#34;RequireMutualAuthentication=0&#34; /t REG_SZ /f&#xA;reg add HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths /v &#34;\\*\NETLOGON&#34; /d &#34;RequireMutualAuthentication=0&#34; /t REG_SZ /f&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Running domain_audit&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Start PowerShell as Administrator &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;This is required to change the DNS server to DC IP and add domain to hosts file. Otherwise some checks/executions will fail such as Impacket.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Run all checks&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\Users\user\Desktop&amp;gt; . C:\Tools\domain_audit\domain_audit.ps1&#xA;PS C:\Users\user\Desktop&amp;gt; Invoke-ADCheckAll -Domain &#34;amsterdam.bank.local&#34; -User &#34;john&#34; -Password &#34;Welcome2022!&#34; -Server 10.0.0.3&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Example output at the bottom of the page.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Run seperate checks&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Some checks need the DNS And domain name in the host file. So best is to set that!&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Set dns and host file&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;Invoke-ChangeDNS -Server 10.0.0.3 -Domain &#34;amsterdam.bank.local&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Run a check&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;Invoke-ADEnum -Domain &#34;amsterdam.bank.local&#34; -User &#34;john&#34; -Password &#34;Welcome2022!&#34; -Server 10.0.0.3&#xA;Invoke-ADEnumTrust -Domain &#34;amsterdam.bank.local&#34; -User &#34;john&#34; -Password &#34;Welcome2022!&#34; -Server 10.0.0.3&#xA;Invoke-ADCheckSQL -Domain &#34;amsterdam.bank.local&#34; -User &#34;john&#34; -Password &#34;Welcome2022!&#34; -Server 10.0.0.3&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Output&lt;/h2&gt; &#xA;&lt;p&gt;The tool will create a directory with the domain name and date on current directory or in the supplied location. In this directory there are three directories:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;Data&lt;/code&gt;, has .csv files from domain objects, bloodhound data and some lists of objects.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Findings&lt;/code&gt;, has output from checks that could be something interesting or reported as a finding.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Checks&lt;/code&gt;, has output from checks that should be assessed manually to check ifs something to be reported.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Checks&lt;/h2&gt; &#xA;&lt;p&gt;Invoke-ADCheckAll will execute the following in order:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Collect basic data of AD objects and place them in &lt;code&gt;/data/&lt;/code&gt; directory in &lt;code&gt;.csv&lt;/code&gt; format&lt;/li&gt; &#xA; &lt;li&gt;Collect data with bloodhound - Collectionmethods all, acl and sessions in the background.&lt;/li&gt; &#xA; &lt;li&gt;Create list of all (enabled) users, admin accounts, computers and groups in &lt;code&gt;/data/&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;List amount of users, groups, computers, OU&#39;s, GPO&#39;s, Administrators, domain controllers and domain functional level.&lt;/li&gt; &#xA; &lt;li&gt;Check if the amount of admins is more then 5% (High amount of admins in the domain)&lt;/li&gt; &#xA; &lt;li&gt;Enumerate domain trusts and trusts within forst&lt;/li&gt; &#xA; &lt;li&gt;Check if AzureAD or Azure SSO is installed&lt;/li&gt; &#xA; &lt;li&gt;Execute a runas in a new window for the SQL checks &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check for SQL instances in the domain&lt;/li&gt; &#xA;   &lt;li&gt;Check if current user has access to SQL instances &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Check if the current user is sysadmin&lt;/li&gt; &#xA;     &lt;li&gt;Gather database info on SQL instancees&lt;/li&gt; &#xA;     &lt;li&gt;Check as who the SQL instance is running&lt;/li&gt; &#xA;     &lt;li&gt;Check for database links as sysadmin&lt;/li&gt; &#xA;     &lt;li&gt;Run invoke-sqlaudit and save all data &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;Check for weak passwords&lt;/li&gt; &#xA;       &lt;li&gt;Check for Execute xp_dirtree and Execute xp_fileexist&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check if domain functional level is 2016&lt;/li&gt; &#xA; &lt;li&gt;Check password policy configuration &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check for cleartextpasswords = 1&lt;/li&gt; &#xA;   &lt;li&gt;Check passwordlength&lt;/li&gt; &#xA;   &lt;li&gt;Check passwordcomplexity&lt;/li&gt; &#xA;   &lt;li&gt;Check account lockout&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check if kerberos policy configuration is changed from the defaults&lt;/li&gt; &#xA; &lt;li&gt;Check if there is a GPO with LAPS in its name &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check to which OU&#39;s the GPO is applied to&lt;/li&gt; &#xA;   &lt;li&gt;Check the LAPS policy &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Check adminaccountname&lt;/li&gt; &#xA;     &lt;li&gt;Check passwordcomplexity&lt;/li&gt; &#xA;     &lt;li&gt;Check passwordlength&lt;/li&gt; &#xA;     &lt;li&gt;Check passwordagedays&lt;/li&gt; &#xA;     &lt;li&gt;Check pwdexpirationprotection enabled&lt;/li&gt; &#xA;     &lt;li&gt;Check admpwdenabled&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check if there are systems with LAPS installed &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check if there are systems where LAPS isn&#39;t installed on&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;If LAPS GPO found or LAPS computers found - Check if the current user can read LAPS passwords&lt;/li&gt; &#xA; &lt;li&gt;Get all users with a description - Manually check for passwords or interesting information &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check if the string pw, pass, ww or wachtwoord is in the description.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Get all groups with a description - Manually check for passwords or interesting information&lt;/li&gt; &#xA; &lt;li&gt;Get all computers with a description - Manually check for passwords or interesting information&lt;/li&gt; &#xA; &lt;li&gt;Check if there are admins with a Spn&lt;/li&gt; &#xA; &lt;li&gt;Check if there are users with a Spn &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Kerberoast users with a Spn&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check for users with constrained delegation&lt;/li&gt; &#xA; &lt;li&gt;Check for users with unconstrained delegation&lt;/li&gt; &#xA; &lt;li&gt;Check for computers with constrained delegation&lt;/li&gt; &#xA; &lt;li&gt;Check for computers with unconstrained delegation except domain controllers&lt;/li&gt; &#xA; &lt;li&gt;Check for computers with resource based constrained delegation set&lt;/li&gt; &#xA; &lt;li&gt;Check PASSWD_NOT_REQ attribute on users &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Checks if users has empty password&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check DONT_REQ_PREAUTH attribute on users &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;AS-REP Roast users&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check DONT_EXPIRE_PASSWORD attribute on users&lt;/li&gt; &#xA; &lt;li&gt;Check if there are users with reversible encryption&lt;/li&gt; &#xA; &lt;li&gt;Check if there are users that use DES encryption&lt;/li&gt; &#xA; &lt;li&gt;Check if there are domain admins with an old password&lt;/li&gt; &#xA; &lt;li&gt;Check if the KRBTGT has a old password&lt;/li&gt; &#xA; &lt;li&gt;Check for EOL operating systems in the AD&lt;/li&gt; &#xA; &lt;li&gt;Check for EOS Windows 10 versions&lt;/li&gt; &#xA; &lt;li&gt;Check for inactive computerobjects with no login or pwdlastset older then 365 days&lt;/li&gt; &#xA; &lt;li&gt;Check for inactive users that didn&#39;t login the last 365 days&lt;/li&gt; &#xA; &lt;li&gt;Check if all privileged users are part of the protected users groups&lt;/li&gt; &#xA; &lt;li&gt;Check if all privileged users have the flag &#34;This account is sensitive and cannot be delegated&#34;&lt;/li&gt; &#xA; &lt;li&gt;Check if there are members of the following privileged groups: Account Operators, Backup Operators, Print Operators, DNS Admins, Schema Admins&lt;/li&gt; &#xA; &lt;li&gt;Check if there are computerobjects part of a high privileged groups&lt;/li&gt; &#xA; &lt;li&gt;Check who can add computerobjects to the domain &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check if this is the default authenticated users group&lt;/li&gt; &#xA;   &lt;li&gt;Check what the ms-ds-machineaccountqouta is, if it is null(good) or not-set(bad) or another value.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check ADIDNS &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;if it contains createchild for the authenticated users group&lt;/li&gt; &#xA;   &lt;li&gt;If wildcard record exists&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check membership of Pre-Windows 2000 Compatible Access group and if authenticated users is still member of it&lt;/li&gt; &#xA; &lt;li&gt;Check if printspooler service is running on the DC&lt;/li&gt; &#xA; &lt;li&gt;Check if LDAP signing is enabled, if LDAPS is configured and LDAPS binding is enabled&lt;/li&gt; &#xA; &lt;li&gt;Check if default Exchange groups exists within the domain &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Check if there is an Exchange server and if its active&lt;/li&gt; &#xA;   &lt;li&gt;Check for memberships in the default Exchange groups&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Check for passwords in the sysvol&lt;/li&gt; &#xA; &lt;li&gt;Check for passwords in netlogon (scripts, programs etc)&lt;/li&gt; &#xA; &lt;li&gt;Retrieve IP adresses of all computer objects and create /24 ranges for further enumeration &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Scan the ranges for well known Windows ports + ssh and web. Create lists for each port&lt;/li&gt; &#xA;   &lt;li&gt;Checks for SMB on accessible machines &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Check SMBv1&lt;/li&gt; &#xA;     &lt;li&gt;Check signing requirement&lt;/li&gt; &#xA;     &lt;li&gt;Check for readable shares&lt;/li&gt; &#xA;     &lt;li&gt;Check for writable shares&lt;/li&gt; &#xA;     &lt;li&gt;Check if the webservice client is running on accessible machines&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Check Access &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Check if the current user is local admin through SMB&lt;/li&gt; &#xA;     &lt;li&gt;Check if the current user can access over WINRM&lt;/li&gt; &#xA;     &lt;li&gt;Check if the current user can access over RDP&lt;/li&gt; &#xA;     &lt;li&gt;Check if the current user can access over MSSQL and is sysadmin (WIP)&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;TO-DO &amp;amp; Features&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Create query for EOS Server versions?&lt;/li&gt; &#xA; &lt;li&gt;Update queries/checks for domain admin/enterprise admins to all privileged groups.&lt;/li&gt; &#xA; &lt;li&gt;Update queries to filter disabled users from data.&lt;/li&gt; &#xA; &lt;li&gt;Check for old vulnerable Exchange permissions&lt;/li&gt; &#xA; &lt;li&gt;Change privileged role function to loop and add more roles&lt;/li&gt; &#xA; &lt;li&gt;Remove -Ping function for accessible machines and execute a portscan for specific ports using Invoke-Portscan&lt;/li&gt; &#xA; &lt;li&gt;Check for access to discovered machines over SMB, RDP, MSSQL etc!&lt;/li&gt; &#xA; &lt;li&gt;Find a way to audit all ACL&#39;s (Invoke-ACLScanner doesnt work well from non domain joined perspective, -ResolvGUIDS breaks!)&lt;/li&gt; &#xA; &lt;li&gt;Add ADCS checks, but need to set this up in a LAB environment first.&lt;/li&gt; &#xA; &lt;li&gt;Add function to skip dns change&lt;/li&gt; &#xA; &lt;li&gt;Add dependancy options to each function&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Example output Invoke-ADCheckAll&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\Users\user\Desktop&amp;gt; . C:\Tools\domain_audit\domain_audit.ps1&#xA;PS C:\Users\user\Desktop&amp;gt; Invoke-ADCheckAll -Domain &#34;amsterdam.bank.local&#34; -User &#34;john&#34; -Password &#34;Welcome2022!&#34; -Server 10.0.0.3&#xA;&#xA;[+] Running as administrator, changing DNS to 10.0.0.3 and adding 10.0.0.3 amsterdam.bank.local to host file&#xA;[+] AD Authentication for amsterdam.bank.local\john succeeded!&#xA;[+] Output will be written in C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22&#xA;&#xA;---------- DATA EXPLAINED ----------&#xA;- All data is written to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\&#xA;- In this folder are three subfolders&#xA;- files in \findings\ are findings that should be reported&#xA;- files in \checks\ needs to be checked&#xA;- files in \data\ is raw data&#xA;&#xA;---------- COLORS EXPLAINED ----------&#xA;White is informational text&#xA;Green means check has passed&#xA;Yellow means manually check the data&#xA;Dark Red means finding&#xA;&#xA;---------- GATHERING DATA ----------&#xA;[+] Gathering data of all Users, Groups, Computerobject, GPO&#39;s, OU&#39;s, DC&#39;s and saving it to csv&#xA;[+] Gathering BloodHound data all, session and ACL in seperate PowerShell session in background&#xA;&#xA;---------- BASIC ENUMERATION ----------&#xA;[W] Saving a list of all users to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\list_users.txt&#xA;[W] Saving a list of all enabled users to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\list_users_enabled.txt&#xA;[W] Saving a list of all administrators to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\list_administrators.txt&#xA;[W] Saving a list of all groups to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\list_groups.txt&#xA;[W] Saving a list of all computerobjects to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\list_computers.txt&#xA;&#xA;---------- DOMAIN INFORMATION ----------&#xA;The domain functional level is: Windows 2016&#xA;In the domain amsterdam.bank.local there are:&#xA;- 27 users and 25 enabled users&#xA;- 51 groups&#xA;- 4 computers&#xA;- 4 OU&#39;s&#xA;- 2 GPO&#39;s&#xA;- 3 Administrators&#xA;- 1 Domain Controllers&#xA;&#xA;---Checking if amount of admins is more then 5% of all users---&#xA;[-] There are 3 administrators, which is 11.11% of all users&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\large_amount_of_administrators.txt&#xA;&#xA;---------- ENUMERATING DOMAIN TRUSTS ----------&#xA;[+] The domain amsterdam.bank.local trusts 1 domains which are:&#xA;bank.local&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\trusts.txt&#xA;&#xA;[+] The trust for domain bank.local is WITHIN_FOREST, enumerating trusts&#xA;[+] The domain bank.local trusts 2 domains which are:&#xA;amsterdam.bank.local&#xA;secure.local&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\trusts.txt&#xA;&#xA;---Checking if AzureAD connect is in use---&#xA;[+] AzureAD connect is not installed&#xA;&#xA;---Checking if Azure SSO is in use---&#xA;[+] Azure SSO is not configured&#xA;&#xA;---------- EXECUTING CHECKS ----------&#xA;[+] Executing in another window because runas is required&#xA;[+] Pleace manually supply the Password Welcome2022!&#xA;--- Running SQL checks in new window ---&#xA;Enter the password for amsterdam.bank.local\john:&#xA;Attempting to start powershell.exe -Exec bypass -NoExit Import-Module C:\Tools\domain_audit\domain_audit.ps1; Set-Variable Findings_Path -Value C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings; Set-Variable Data_Path -Value C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data; Set-Variable Checks_Path -Value C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\checks; Set-Variable OutputDirectoryCreated -Value True; Invoke-ADCheckSQL -Domain amsterdam.bank.local -Server 10.0.0.3 -User john -Password Welcome2022! -SkipPrompt as user &#34;amsterdam.bank.local\john&#34; ...&#xA;&#xA;---Checking password policy---&#xA;[+] Passwordpolicy contains ClearTextPassword=0. Domain controller does not save passwords in cleartext&#xA;[-] Password length requirement is 7 characters&#xA;[-] PasswordComplexity is 0 (Disabled)!&#xA;[-] LockOutBadCount is 0, accounts wont be locked!&#xA;[-] ResetLockoutCount is not set&#xA;[-] LockoutDuration is not set&#xA;Writing password policy to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\passwordpolicy.txt&#xA;&#xA;---Checking if there is a GPO with LAPS---&#xA;[-] There is no GPO with LAPS in their name&#xA;&#xA;---Checking if LAPS is enabled on any computerobject---&#xA;[-] There are no systems where LAPS is enabled&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\laps_notenabled.txt&#xA;&#xA;---Checking description field for passwords---&#xA;[-] There are 4 users that have a description, please manually check for passwords!&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\checks\description_users.txt&#xA;&#xA;---Checking groups description field for interesting information---&#xA;[-] There are 45 groups that have a description, please manually check for passwords or interesting information!&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\checks\description_groups.txt&#xA;&#xA;---Checking computerobjects description field for interesting information---&#xA;[+] There are no computerobjects with a description&#xA;&#xA;---Checking kerberoastable administrators---&#xA;[-] There are 1 kerberoastable administrators&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\administrators_serviceprincipalname.txt&#xA;&#xA;---Checking kerberoastable users---&#xA;[-] There are 2 kerberoastable users&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_serviceprincipalname.txt&#xA;[+] Requested 2 hashes, please crack with hashcat&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_kerberoast_hashes.txt&#xA;&#xA;---Checking if there are users with the DONT_REQ_PREAUTH attribute---&#xA;[-] There are 2 users with the attribute DONT_REQ_PREAUTH&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_dontrequirepreath.txt&#xA;[+] Requested 2 hashes, please crack with hashcat&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_aspreproast_hashes.txt&#xA;&#xA;---Checking constrained delegation users---&#xA;[-] There are 1 users that have constrained delegation enabled&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_constrained_delegation.txt&#xA;&#xA;---Checking unconstrained delegation computerobjects, excluding domain-controllers---&#xA;[-] There are 1 users that have unconstrained delegation enabled&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_unconstrained_delegation.txt&#xA;&#xA;---Checking constrained delegation computerobjects---&#xA;[+] There are no computerobjects with constrained delegation&#xA;&#xA;---Checking unconstrained delegation computerobjects, excluding domain-controllers---&#xA;[-] There are 1 computerobjects that have unconstrained delegation enabled&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\computers_unconstrained_delegation.txt&#xA;&#xA;---Checking resource based constrained delegation computerobjects---&#xA;[+] There are no computerobjects with resource based constrained delegation&#xA;&#xA;---Checking if there are users with the PASSWD_NOTREQD attribute---&#xA;[-] There are 2 users with the attribute PASSWD_NOTREQD&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_passwdnotreqd.txt&#xA;&#xA;---Checking for users with empty password---&#xA;[-] The password for user bank_dev is empty&#xA;[-] The password for user steve is empty&#xA;&#xA;---Checking if there are users with the DONT_EXPIRE_PASSWORD attribute---&#xA;[-] There are 17 users with the attribute DONT_EXPIRE_PASSWORD&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\users_dontexpirepassword.txt&#xA;&#xA;---Checking if there are users with the reversible encryption---&#xA;[+] There are no users with reversible encryption&#xA;&#xA;---Checking if there are users with DES encryption---&#xA;[+] There are no users with DES encryption&#xA;&#xA;---Checking if administrator accounts - that aren&#39;t disabled - have a password older then 365 days---&#xA;[+] There where no enabled administrators with a password older then 365 days&#xA;&#xA;---Checking if KRBTGT account has a password older then 365 days---&#xA;[+] The password from the krbtgt is not older then 365 days&#xA;&#xA;---Checking if there are EOL operating systems in the AD---&#xA;[+] There are no computerobjects in the AD that are EOL&#xA;&#xA;---Checking if there are end of service Windows 10 operating systems in the AD---&#xA;[+] There are no Windows 10 computerobjects computerobjects in the AD that are End Of Service&#xA;&#xA;---Checking if there are computerobjects that have no login or login/pwdlastset older then 365 days---&#xA;[+] There are no computerobjects in the AD that are inactive&#xA;&#xA;---Checking if there are users that didn&#39;t login for 365 days---&#xA;[+] There are no users in the AD that are inactive (didn&#39;t login or changed their password in the last 365 days)&#xA;&#xA;---Checking if members of privileged groups are part of the protected users group---&#xA;[-] There are 3 privileged users not part of the protected users group&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\administrators_notin_protectedusersgroup.txt&#xA;&#xA;---Checking if members of privileged groups have the flag &#39;this account is sensitive and cannot be delegated&#39;---&#xA;[-] There are 3 privileged users without the flag &#39;this account is sensitive and cannot be delegated&#39; that aren&#39;t in the Protected Users group&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\administrators_delegation_flag.txt&#xA;&#xA;---Checking if there are members in high privileged groups---&#xA;[+] There are no users in the Account Operators group&#xA;[+] There are no users in the Backup Operators group&#xA;[+] There are no users in the Print Operators group&#xA;[+] There are no users in the DNS Admins group&#xA;[+] There are no users in the Schema Admins group&#xA;&#xA;---Checking if there are computerobjects part ofhigh privileged groups---&#xA;[+] There are no computerobjects part of a high privileged groups&#xA;&#xA;---Checking who can add computerobjects to the domain---&#xA;[-] The authenticated users group(S-1-5-11) can add 10 computerobjects to the domain&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\authenticated_users_can_join_domain.txt&#xA;[W] Writing amount of computerobjects that can be joined to the domain by the object to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\checks\can_join_domain_amount.txt&#xA;&#xA;---Checking if there are passwords in the SYSVOL share---&#xA;This might take a while&#xA;[+] Checking SYSVOL of DC02&#xA;[-] There might be 1 passwords in the SYSVOL of DC02. Please manually check&#xA;Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\checks\sysvol_passwords.txt&#xA;&#xA;---Checking if there are passwords in the NETLOGON share---&#xA;This might take a while&#xA;[+] Checking NETLOGON of DC02&#xA;[-] There might be 1 passwords(string pass) in the NETLOGON of DC02. Please manually check&#xA;Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\checks\netlogon_passwords.txt&#xA;&#xA;---Checking printspooler service on each DC---&#xA;[-] Printspooler enabled on DC02&#xA;Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\printspooler_domaincontrollers.txt&#xA;&#xA;---Running LdapRelayScan---&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\domaincontrollers_ldaprelayscan.txt&#xA;&#xA;---Checking for LDAP signing---&#xA;[+] One or more domain controller(s) does not require LDAP signing&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\domaincontrollers_no_ldap_signing.txt&#xA;&#xA;---Checking for LDAPS binding---&#xA;[+] One or more domain controller(s) does not require LDAPS binding&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\domaincontrollers_no_ldaps_binding.txt&#xA;&#xA;---Checking if exchange is used within the domain---&#xA;[+] No Exchange groups exist&#xA;&#xA;---Checking which machines are reachable from current machine through ping---&#xA;[+] There are 3 computers which are reachable&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\computers_accessible.txt&#xA;&#xA;---Running crackmapexec against each reachable host enumerating SMB data and shares---&#xA;[+] Crackmapexec will hang and needs a enter to continue&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\crackmapexec_reachablecomputers.txt&#xA;&#xA;---Checking for hosts which have SMBV1 enabled---&#xA;[+] There are no reachable computers which have SMBV1 enabled (SMBv1:True)&#xA;&#xA;---Checking for hosts without signing---&#xA;[+] There are 2 reachable computers which does not require signing (Signing:False)&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\computers_nosigning.txt&#xA;&#xA;---Checking for shares with READ access---&#xA;[+] There are 4 shares the current user can READ&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\shares_read_access.txt&#xA;&#xA;---Checking for shares with WRITE access---&#xA;[+] There are 1 shares the current user can WRITE to&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\shares_write_access.txt&#xA;&#xA;---Running crackmapexec against each reachable host enumerating webclient service---&#xA;[+] Crackmapexec will hang and needs a enter to continue&#xA;[W] Writing all data to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\data\crackmapexec_webdav.txt&#xA;&#xA;[+] There are 1 systems with the webclient service running&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\computers_webdav.txt&#xA;&#xA;---------- EXECUTING SQL CHECKS ----------&#xA;---Checking MSSQL instances---&#xA;[+] Found 1 MSSQL instances&#xA;[+] Checking connection to each MSSQL instance&#xA;[-] The current user can access 1 MSSQL instances&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\SQLserver_user_has_access.txt&#xA;&#xA;---Checking if the user is sysadmin on the accessible instances---&#xA;[+] The current user is not sysdmin to any SQL instances&#xA;&#xA;---Checking database links for sysadmin security context---&#xA;[-] There are 1 links which run under the security context of a sysadmin user&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\SQLserver_sysadmin_on_links.txt&#xA;&#xA;---Running Invoke-SQLAudit on the accessible instances---&#xA;This might take a while&#xA;VERBOSE: WEB01.amsterdam.bank.local : No named instance found.&#xA;VERBOSE: WEB01.amsterdam.bank.local : Connection Success.&#xA;VERBOSE: WEB01.amsterdam.bank.local : Checking for autoexec stored procedures...&#xA;[-] Invoke-SQLAudit found 7 issues&#xA;[W] Writing to C:\Users\user\Desktop\amsterdam.bank.local-2022-08-22\findings\SQLserver_sqlaudit.txt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/43987245/179800219-f087ba71-7d87-4a03-8f02-f5833b6a0289.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>Slluxx/ImPS</title>
    <updated>2023-09-11T01:38:43Z</updated>
    <id>tag:github.com,2023-09-11:/Slluxx/ImPS</id>
    <link href="https://github.com/Slluxx/ImPS" rel="alternate"></link>
    <summary type="html">&lt;p&gt;ImPS is a wrapper module to create GUIs with PowerShell like you do with ImGui&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;ImPS&lt;/h1&gt; &#xA;&lt;p&gt;ImPS is a simple one-file module wrapper to use WPF components in your script without writing massive amounts of UI code or using XML layouts. It is heavily inspired by ImGUI/DearPyGui to make it as easy as possible to use while keeping the configurability.&lt;/p&gt; &#xA;&lt;p&gt;Please have in mind that this is in active development and, while usable, should not be used in any kind of production environment.&lt;/p&gt; &#xA;&lt;h2&gt;Documentation&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://slluxx.github.io/ImPS/&#34;&gt;Click me&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Comparison&lt;/h2&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Slluxx/ImPS/main/images/ImPS.png&#34; alt=&#34;ImPS Window&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;Here is the code you would need to write this basic window + label:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Add-Type -AssemblyName System.Windows.Forms&#xA;&#xA;$Window = New-Object System.Windows.Forms.Form&#xA;$Window.ClientSize = &#34;285,75&#34;&#xA;$Window.Text = &#34;ImPS Window&#34;&#xA;$Window.BackColor = &#34;#ffffff&#34;&#xA;$Window.StartPosition = [System.Windows.Forms.FormStartPosition]::CenterScreen&#xA;&#xA;$Label = New-Object System.Windows.Forms.label&#xA;$Label.Text = &#34;This is almost like ImGUI&#34;&#xA;$Label.AutoSize=$true&#xA;$Label.Font=&#34;Verdana,8,style=Regular&#34;&#xA;$Label.Location=New-Object System.Drawing.Point(20,20)&#xA;&#xA;$Window.Controls.Add($Label)&#xA;&#xA;$Window.ShowDialog()&#xA;$Window.Dispose()&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Here is ImPS&#39;s code for the exact same:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;using module &#34;.\ImPS.psm1&#34;&#xA;&#xA;$ImPS = [ImPS]::new()&#xA;$window = $ImPS.add_window(&#34;ImPS Window&#34;, 285, 75)&#xA;$window.Elements.add_Label(&#34;This is almost like ImGUI&#34;, 20,20)&#xA;$window.show()&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Usable Elements&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Label&lt;/li&gt; &#xA; &lt;li&gt;Button&lt;/li&gt; &#xA; &lt;li&gt;Checkbox&lt;/li&gt; &#xA; &lt;li&gt;ListBox (And its ListItem)&lt;/li&gt; &#xA; &lt;li&gt;TextBox&lt;/li&gt; &#xA; &lt;li&gt;ProgressBar&lt;/li&gt; &#xA; &lt;li&gt;ComboBox&lt;/li&gt; &#xA; &lt;li&gt;TableLayoutPanel&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;More elements will get added.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Slluxx/ImPS/main/images/elements.png&#34; alt=&#34;ImPS Window&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Advanced usage&lt;/h2&gt; &#xA;&lt;p&gt;ImPS is written for you to easily chain methods if desired:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$window.Elements.add_Label(&#34;My bold label&#34;, 20, 20).set_font(&#34;Verdana,8,style=Bold&#34;)&#xA;# or&#xA;$label = $window.Elements.add_Label(&#34;My italic label&#34;, 20, 40)&#xA;$label.set_font(&#34;Verdana,8,style=Italic&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Button onClick-handler work inline or as defined function:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$btn = $window.Elements.add_Button(&#34;Click me&#34;, 20, 20).onClick({&#xA;    write-host &#34;Got clicked&#34;&#xA;})&#xA;# or&#xA;$myfunc = { write-host &#34;Got clicked&#34; }&#xA;$btn = $window.Elements.add_Button(&#34;Click me&#34;, 20, 20).onClick($myfunc)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;[ImPS_Window].Drawable exposes a &lt;code&gt;System.Windows.Forms.Form&lt;/code&gt; Object, so you can combine ImPS with the normal method of creating UIs (for example if a UI element does not exist yet):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$window = [ImPS]::new(&#34;ImPS Window&#34;, 285, 200)&#xA;$objLabel = New-Object System.Windows.Forms.label&#xA;$objLabel.Location = New-Object System.Drawing.Size(7,10)&#xA;$objLabel.Size = New-Object System.Drawing.Size(130,15)&#xA;$objLabel.Text = &#34;Enter Computer Name&#34;&#xA;$window.Drawable.Controls.Add($objLabel)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Every UI Element by ImPS exposes its &#34;native&#34; Object at [Object].Drawable, which means you can change attributes even if there is no getter/setter by ImPS:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$texbox = $window.Elements.add_TextBox(&#34;password&#34;, 100, 20)&#xA;$texbox.Drawable.PasswordChar = &#39;*&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Note: This is discouraged and should not be done. I plan on supporting the most used attribute getter/setter.&lt;/p&gt;</summary>
  </entry>
</feed>