<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-08-20T01:36:17Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>AlbanAndrieu/ansible-windows</title>
    <updated>2023-08-20T01:36:17Z</updated>
    <id>tag:github.com,2023-08-20:/AlbanAndrieu/ansible-windows</id>
    <link href="https://github.com/AlbanAndrieu/ansible-windows" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Ansible role to manage windows installation&lt;/p&gt;&lt;hr&gt;&lt;h2&gt;&lt;a href=&#34;https://github.com/AlbanAndrieu&#34;&gt;&lt;img src=&#34;http://albandrieu.com/nabla/index/assets/nabla/nabla-4.png&#34; alt=&#34;Nabla&#34;&gt;&lt;/a&gt; roles/alban_andrieu_windows&lt;/h2&gt; &#xA;&lt;p&gt;This file was generated by Ansigenome. Do not edit this file directly but instead have a look at the files in the ./meta/ directory.&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;http://www.apache.org/licenses/LICENSE-2.0.html&#34;&gt;&lt;img src=&#34;http://img.shields.io/:license-apache-blue.svg?style=flat-square&#34; alt=&#34;License&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/AlbanAndrieu/ansible-windows/tree/master&#34;&gt;&lt;img src=&#34;http://img.shields.io/github/tag/AlbanAndrieu/ansible-windows.svg?style=flat-square&#34; alt=&#34;Branch&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://galaxy.ansible.com/alban.andrieu/windows&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/galaxy-alban.andrieu.windows-660198.svg?style=flat&#34; alt=&#34;Ansible Galaxy&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#&#34;&gt;&lt;img src=&#34;http://img.shields.io/badge/platforms-windows-lightgrey.svg?style=flat&#34; alt=&#34;Platforms&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Goal of this project is to launch ansible script using &lt;a href=&#34;https://pypi.python.org/pypi/pywinrm&#34;&gt;pywinrm&lt;/a&gt;. A VagrantFile is downloading a windows 2012 server VM that will be hosted on VirtualBox. Then we are launching Ansible script in order to set up this VM.&lt;/p&gt; &#xA;&lt;h2&gt;VM was taken from&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://vagrantcloud.com/opentable/boxes/win-2012r2-standard-amd64-nocm/versions/1.0.0/providers/virtualbox.box&#34;&gt;https://vagrantcloud.com/opentable/boxes/win-2012r2-standard-amd64-nocm/versions/1.0.0/providers/virtualbox.box&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Table of contents&lt;/h1&gt; &#xA;&lt;!-- toc --&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#actions&#34;&gt;Actions&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#usage-example&#34;&gt;Usage example&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#requirements&#34;&gt;Requirements&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#os-is-an-ubuntu-1804&#34;&gt;Os is an Ubuntu 18.04&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#test-winrm&#34;&gt;Test winrm&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#from-windows&#34;&gt;From windows&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#local-user&#34;&gt;Local user&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#domain-user&#34;&gt;Domain user&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#test-out-http&#34;&gt;Test out HTTP&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#test-out-https-will-fail-if-the-cert-is-not-verifiable&#34;&gt;Test out HTTPS (will fail if the cert is not verifiable)&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#from-unix&#34;&gt;From unix&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#user-prompted-for-realm-name-and-kdc-for-kerberos&#34;&gt;User prompted for REALM name and KDC for Kerberos&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#python-winrm-module&#34;&gt;Python WinRM module&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#ignore-warnings-about-maj_stat&#34;&gt;Ignore warnings about maj_stat&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#kerberos-and-credssp&#34;&gt;Kerberos and CredSSP&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#get-xmllint-for-pretty-print-of-soap-response&#34;&gt;Get xmllint for pretty print of SOAP response&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#replace-targethost-with-the-target-windows-host&#34;&gt;Replace &#39;targetHost&#39; with the target Windows host&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#basic-authentication-is-not-enabled-by-default-on-a-windows-host-but-can-be-enabled-by-running-the-following-in-powershell&#34;&gt;Basic authentication is not enabled by default on a Windows host but can be enabled by running the following in PowerShell&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#automate-jenkins-service&#34;&gt;Automate jenkins service&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#check-the-java-web-start-default-jdk&#34;&gt;Check the java web start default JDK&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#run-the-java-web-start-by-hand-if-the-jdk-is-not-right&#34;&gt;Run the java web start by hand if the JDK is not right&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#add--nocertificatecheck-to-the-jenkins-slavexml-in-the-jenkins-directory-if-missing&#34;&gt;Add -noCertificateCheck to the jenkins-slave.xml in the jenkins directory if missing&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#generate-id_rsa-from-msys2&#34;&gt;Generate id_rsa from MSYS2&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#log-on&#34;&gt;Log on&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#change-jenkins-service-to-start-as-log-on-as---this-account-and-use-my-user&#34;&gt;Change jenkins service to start as Log on as -&amp;gt; This account and use my user&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#checking-image&#34;&gt;Checking image&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#docker&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#recovery&#34;&gt;Recovery&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#documentation&#34;&gt;Documentation&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#role-variables&#34;&gt;Role variables&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#detailed-usage-guide&#34;&gt;Detailed usage guide&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#testing&#34;&gt;Testing&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#ansible-lint&#34;&gt;Ansible lint&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#contributing&#34;&gt;Contributing&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#authors-and-license&#34;&gt;Authors and license&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#license&#34;&gt;License&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/#feedback-bug-reports-requests-&#34;&gt;Feedback, bug-reports, requests, ...&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;!-- tocstop --&gt; &#xA;&lt;h2&gt;Actions&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Ensures that windows is installed&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;WARNING : In inventory file, please use ansible_ssh_user and ansible_ssh_pass instead of ansible_user ansible_password, because of vault overridden values&lt;/p&gt; &#xA;&lt;h2&gt;Usage example&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code&gt;- name: Install windows&#xA;  connection: local&#xA;  hosts: windows&#xA;&#xA;  roles:&#xA;    - role: windows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Requirements&lt;/h3&gt; &#xA;&lt;p&gt;On Ubuntu, where VirtualBox and Vagrant are installed, do not forge to do the following : sudo pip install &lt;a href=&#34;https://github.com/diyan/pywinrm/archive/df049454a9309280866e0156805ccda12d71c93a.zip&#34;&gt;https://github.com/diyan/pywinrm/archive/df049454a9309280866e0156805ccda12d71c93a.zip&lt;/a&gt; --upgrade&lt;/p&gt; &#xA;&lt;p&gt;It is working with the following version :&lt;/p&gt; &#xA;&lt;h1&gt;Os is an Ubuntu 18.04&lt;/h1&gt; &#xA;&lt;p&gt;$ python -V Python 2.7.3 $ pip -V pip 1.4.1 from /usr/local/lib/python2.7/dist-packages (python 2.7)&lt;/p&gt; &#xA;&lt;p&gt;$ VBoxManage --version 4.3.28r100309&lt;/p&gt; &#xA;&lt;p&gt;$ vagrant --version Vagrant 2.3.1.0&lt;/p&gt; &#xA;&lt;p&gt;$ vagrant plugin list winrm (1.1.3) vagrant-login (1.0.1, system) vagrant-share (1.1.0, system)&lt;/p&gt; &#xA;&lt;p&gt;$ ansible --version ansible 1.7.2&lt;/p&gt; &#xA;&lt;p&gt;Ansible 2.5.0 is required on order to have win_copy working on Windows 7 and Windows Server 2016&lt;/p&gt; &#xA;&lt;p&gt;Check winrm in target host&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;winrm id&#xA;winrm get winrm/config&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For older version of Windows, please do&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Set-Item WSMan:\localhost\Shell\MaxMemoryPerShellMB 5000&#xA;Set-Item WSMan:\localhost\Plugin\Microsoft.PowerShell\Quotas\MaxMemoryPerShellMB 5000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Restart-Service winrm&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;winrm set winrm/config/winrs &#39;@{MaxMemoryPerShellMB=&#34;0&#34;}&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;On the windows VM :&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;powershell -File upgrade_to_ps3.ps1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;@powershell -NoProfile -ExecutionPolicy unrestricted -Command &#34;iex ((new-object net.webclient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))&#34; &amp;amp;&amp;amp; SET PATH=%PATH%;%systemdrive%\chocolatey\bin&#xA;cinst powershell&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;choco install powershell&#xA;choco upgrade powershell&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;powershell -File ConfigureRemotingForAnsible.ps1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Test winrm&lt;/h2&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html&#34;&gt;windows_winrm&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://docs.ansible.com/ansible/devel/user_guide/windows_setup.html#common-winrm-issues&#34;&gt;common-winrm-issues&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;From windows&lt;/h2&gt; &#xA;&lt;h3&gt;Local user&lt;/h3&gt; &#xA;&lt;p&gt;$ winrm identify -u:myuser -p:Mypass123! -r:&lt;a href=&#34;http://targetHost:5985&#34;&gt;http://targetHost:5985&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Domain user&lt;/h3&gt; &#xA;&lt;p&gt;$ winrm identify -u:MISYSROOT\aandrieu -p:Mypass123! -r:&lt;a href=&#34;http://targetHost:5985&#34;&gt;http://targetHost:5985&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Test out HTTP&lt;/h3&gt; &#xA;&lt;p&gt;winrs -r:&lt;a href=&#34;http://server:5985/wsman&#34;&gt;http://server:5985/wsman&lt;/a&gt; -u:Username -p:Password ipconfig&lt;/p&gt; &#xA;&lt;h3&gt;Test out HTTPS (will fail if the cert is not verifiable)&lt;/h3&gt; &#xA;&lt;p&gt;winrs -r:&lt;a href=&#34;http://server:5985/wsman&#34;&gt;http://server:5985/wsman&lt;/a&gt; -u:Username -p:Password -ssl ipconfig&lt;/p&gt; &#xA;&lt;h2&gt;From unix&lt;/h2&gt; &#xA;&lt;h3&gt;User prompted for REALM name and KDC for Kerberos&lt;/h3&gt; &#xA;&lt;p&gt;$ sudo apt-get install python-dev libkrb5-dev krb5-user&lt;/p&gt; &#xA;&lt;h3&gt;Python WinRM module&lt;/h3&gt; &#xA;&lt;p&gt;$ sudo pip install pyOpenSSL --upgrade $ sudo pip install &#34;pywinrm&amp;gt;=0.2.2&#34;&lt;/p&gt; &#xA;&lt;h3&gt;Ignore warnings about maj_stat&lt;/h3&gt; &#xA;&lt;p&gt;$ sudo pip install kerberos&lt;/p&gt; &#xA;&lt;h3&gt;Kerberos and CredSSP&lt;/h3&gt; &#xA;&lt;p&gt;$ sudo pip install &#34;pywinrm[kerberos]&#34; $ sudo pip install &#34;pywinrm[credssp]&#34; $ sudo pip install &#34;requests-credssp&#34; &#34;requests-kerberos&#34;&lt;/p&gt; &#xA;&lt;h3&gt;Get xmllint for pretty print of SOAP response&lt;/h3&gt; &#xA;&lt;p&gt;$ sudo apt-get install libxml2-utils -y&lt;/p&gt; &#xA;&lt;h3&gt;Replace &#39;targetHost&#39; with the target Windows host&lt;/h3&gt; &#xA;&lt;p&gt;$ curl --header &#34;Content-Type: application/soap+xml;charset=UTF-8&#34; --header &#34;WSMANIDENTIFY: unauthenticated&#34; &lt;a href=&#34;http://targetHost:5985/wsman&#34;&gt;http://targetHost:5985/wsman&lt;/a&gt; --data &#39;&amp;lt;s:Envelope xmlns:s=&#34;&lt;a href=&#34;http://www.w3.org/2003/05/soap-envelope&#34;&gt;http://www.w3.org/2003/05/soap-envelope&lt;/a&gt;&#34; xmlns:wsmid=&#34;&lt;a href=&#34;http://schemas.dmtf.org/wbem/wsman/identity/1/wsmanidentity.xsd%22&amp;amp;gt;&amp;amp;lt;s:Header/&amp;amp;gt;&amp;amp;lt;s:Body&amp;amp;gt;&amp;amp;lt;wsmid:Identify/&amp;amp;gt;&amp;amp;lt;/s:Body&amp;amp;gt;&amp;amp;lt;/s:Envelope&#34;&gt;http://schemas.dmtf.org/wbem/wsman/identity/1/wsmanidentity.xsd&#34;&amp;amp;gt;&amp;amp;lt;s:Header/&amp;amp;gt;&amp;amp;lt;s:Body&amp;amp;gt;&amp;amp;lt;wsmid:Identify/&amp;amp;gt;&amp;amp;lt;/s:Body&amp;amp;gt;&amp;amp;lt;/s:Envelope&lt;/a&gt;&amp;gt;&#39; | xmllint --format -&lt;/p&gt; &#xA;&lt;h3&gt;Basic authentication is not enabled by default on a Windows host but can be enabled by running the following in PowerShell&lt;/h3&gt; &#xA;&lt;p&gt;$ Set-Item -Path WSMan:\localhost\Service\Auth\Basic -Value $true&lt;/p&gt; &#xA;&lt;p&gt;$ Set-Item -Path WSMan:\localhost\Service\Auth\Certificate -Value $true $ New-SelfSignedCertificate $ (Get-Service -Name winrm).Status&lt;/p&gt; &#xA;&lt;p&gt;$ .\ConfigureRemotingForAnsible.ps1 -ForceNewSSLCert&lt;/p&gt; &#xA;&lt;p&gt;On the windows VM :&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/AlbanAndrieu/ansible-windows/raw/master/files/upgrade_to_ps3.ps1&#34;&gt;Install PowerShell&lt;/a&gt; &lt;a href=&#34;https://github.com/AlbanAndrieu/ansible-windows/raw/master/files/ConfigureRemotingForAnsible.ps1&#34;&gt;Configure remoting&lt;/a&gt; &lt;a href=&#34;http://www.tenniswood.co.uk/technology/windows/how-to-disable-password-expiration-for-windows-server-2012/&#34;&gt;Disable password&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Automate jenkins service&lt;/h2&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://github.com/jenkinsci/docker-inbound-agent/raw/master/jenkins-agent.ps1&#34;&gt;jenkins-agent.ps1&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Change default JDK if wrong Replace Path Environment variable from C:\ProgramData\Oracle\Java\javapath by %JAVA_HOME%\bin Replace regedit Registry key &#39;Software\JavaSoft\Java Runtime Environment&#39;\CurrentVersion&#39; but 1.7 Replace regedit Registry key &#39;Software\JavaSoft\Java Development Kit&#39;\CurrentVersion&#39; but 1.7&lt;/p&gt; &#xA;&lt;h3&gt;Check the java web start default JDK&lt;/h3&gt; &#xA;&lt;p&gt;$ javaws -viewer&lt;/p&gt; &#xA;&lt;h3&gt;Run the java web start by hand if the JDK is not right&lt;/h3&gt; &#xA;&lt;p&gt;$ javaws &#34;slave-agent.jnlp&#34;&lt;/p&gt; &#xA;&lt;h3&gt;Add -noCertificateCheck to the jenkins-slave.xml in the jenkins directory if missing&lt;/h3&gt; &#xA;&lt;h3&gt;Generate id_rsa from MSYS2&lt;/h3&gt; &#xA;&lt;p&gt;Copy it from C:\msys64\home\mysuser or C:\tools\msys64\home\mysuser to the user Add the key to Bitbucket Test doing git clone ssh://stash:7999/test/repo.git&lt;/p&gt; &#xA;&lt;h3&gt;Log on&lt;/h3&gt; &#xA;&lt;p&gt;Make sure in the jenkins you have Log on -&amp;gt; Log on as -&amp;gt; Local System account BUT NOT Change jenkins service to start as Log on as -&amp;gt; This account and use my user, otherwise is do not reconnect automatically after reboot&lt;/p&gt; &#xA;&lt;p&gt;Add HOME C:\Users\jenkins&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;setx -m HOME ^%UserProfile^%&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://stackoverflow.com/questions/36011084/could-not-create-directory-home-username-ssh&#34;&gt;Git Bash&lt;/a&gt; See &lt;a href=&#34;https://stackoverflow.com/questions/4267051/error-5-access-denied-when-starting-windows-service#:~:text=If%20you%20are%20getting%20this,same%20for%20the%20exe%20too.&#34;&gt;Access denied&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Change jenkins service to start as Log on as -&amp;gt; This account and use my user&lt;/h3&gt; &#xA;&lt;h4&gt;Fix jenkins service -&amp;gt; &lt;code&gt;Access is denied. [0x00000005]&lt;/code&gt;&lt;/h4&gt; &#xA;&lt;p&gt;[https://github.com/jenkinsci/windows-slaves-plugin/blob/master/docs/troubleshooting.adoc#wbem-scripting-locator](WBEM Scripting Locator)&lt;/p&gt; &#xA;&lt;p&gt;Petelea, Mihai modify the permissions to local administrators instead of trusted installer but that was done with a server admin account that superseeds the normal admin accounts and then he changed the permissions to the entire C drive to Administrators&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/LocalAccountTokenFilterPolicy&#34;&gt;https://github.com/jenkinsci/windows-slaves-plugin/blob/master/docs/troubleshooting.adoc#access-is-denied-error&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h4&gt;Then install .Net 3.5 Framework&lt;/h4&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/.net-framework-3.5&#34;&gt;https://blogs.sap.com/2020/06/25/how-to-install-the-.net-framework-3.5-on-windows-server-2016-and-later/&lt;/a&gt; &lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/net-framework-3-5-in-windows-10&#34;&gt;https://winaero.com/install-net-framework-3-5-in-windows-10/&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;See files/net-framework-core.ps1&lt;/p&gt; &#xA;&lt;p&gt;PowerShell&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;Enable-WindowsOptionalFeature -Online -FeatureName &#34;NetFx3&#34;&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;Or Cmd&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;Dism /online /Enable-Feature /FeatureName:&#34;NetFx3&#34;&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Checking image&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/CheckHealth&#34;&gt;https://lecrabeinfo.net/reparer-image-de-windows-10-dism.html&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;Dism /Online /Cleanup-Image /CheckHealth&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Docker&lt;/h3&gt; &#xA;&lt;p&gt;Docker build on windows&lt;/p&gt; &#xA;&lt;p&gt;Fix docker&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;&#34;C:\Program Files\Docker\Docker\DockerCli.exe&#34; -SwitchDaemon&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;PowerShell&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;Restart-Service docker Get-Service docker&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;Build docker image&lt;/p&gt; &#xA;&lt;p&gt;` docker pull mcr.microsoft.com/windows/servercore:ltsc2019&lt;/p&gt; &#xA;&lt;p&gt;cd /c/workspace/fusionrisk-ansible/roles/windows/ docker login docker build -t nabla/ansible-jenkins-slave-win:1.0.0 . --platform=windows/amd64 docker manifest inspect nabla/ansible-jenkins-slave-win:1.0.0 --verbose docker run -it nabla/ansible-jenkins-slave-win:1.0.0 cmd.exe `&lt;/p&gt; &#xA;&lt;h3&gt;Recovery&lt;/h3&gt; &#xA;&lt;p&gt;Reset fail count after: 1 days Restart service after: 60 minutes&lt;/p&gt; &#xA;&lt;h3&gt;Documentation&lt;/h3&gt; &#xA;&lt;p&gt;More information about &lt;code&gt;alban.andrieu.windows&lt;/code&gt; can be found in the TODO &lt;a href=&#34;https://docs.debops.org/en/latest/ansible/roles/ansible-windows/docs/&#34;&gt;official alban.andrieu.windows documentation&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Role variables&lt;/h3&gt; &#xA;&lt;p&gt;List of default variables available in the inventory:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-YAML&#34;&gt;windows_enabled: yes                       # Enable module&#xA;&#xA;#ansible_ssh_user: vagrant&#xA;#ansible_ssh_pass: vagrant&#xA;#target port&#xA;#ansible_ssh_port: 5986&#xA;#local port&#xA;#ansible_ssh_port: 55985&#xA;ansible_connection: winrm&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Detailed usage guide&lt;/h3&gt; &#xA;&lt;p&gt;Run the following command :&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;ansible-playbook -i hosts -c local -v windows.yml -vvvv --ask-sudo-pass | tee setup.log&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Testing&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;ansible-galaxy install alban.andrieu.windows&#xA;vagrant up&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Ansible lint&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;git add tasks/pacman.yml # First add your file, then&#xA;pre-commit run ansible-lint&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Contributing&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;a href=&#34;https://github.com/AlbanAndrieu/ansible-windows/issues&#34;&gt;issue tracker&lt;/a&gt; is the preferred channel for bug reports, features requests and submitting pull requests.&lt;/p&gt; &#xA;&lt;p&gt;For pull requests, editor preferences are available in the &lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/.editorconfig&#34;&gt;editor config&lt;/a&gt; for easy use in common text editors. Read more and download plugins at &lt;a href=&#34;http://editorconfig.org&#34;&gt;http://editorconfig.org&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;In lieu of a formal styleguide, take care to maintain the existing coding style. Add unit tests and examples for any new or changed functionality.&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Fork it&lt;/li&gt; &#xA; &lt;li&gt;Create your feature branch (&lt;code&gt;git checkout -b my-new-feature&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;Commit your changes (&lt;code&gt;git commit -am &#39;Add some feature&#39;&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;Push to the branch (&lt;code&gt;git push origin my-new-feature&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;Create new Pull Request&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h3&gt;Authors and license&lt;/h3&gt; &#xA;&lt;p&gt;&lt;code&gt;roles/alban_andrieu_windows&lt;/code&gt; role was written by:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/nabla.mobi&#34;&gt;Alban Andrieu&lt;/a&gt; | &lt;a href=&#34;mailto:alban.andrieu@free.fr&#34;&gt;e-mail&lt;/a&gt; | &lt;a href=&#34;https://twitter.com/AlbanAndrieu&#34;&gt;Twitter&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;License: &lt;a href=&#34;https://tldrlegal.com/license/gnu-general-public-license-v3-%28gpl-3%29&#34;&gt;GPLv3&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Feedback, bug-reports, requests,&lt;/h3&gt; &#xA;&lt;p&gt;Are &lt;a href=&#34;https://github.com/AlbanAndrieu/ansible-windows/issues&#34;&gt;welcome&lt;/a&gt;!&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;This role is part of the &lt;a href=&#34;https://github.com/AlbanAndrieu&#34;&gt;Nabla&lt;/a&gt; project. README generated by &lt;a href=&#34;https://github.com/nickjj/ansigenome/&#34;&gt;Ansigenome&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;Alban Andrieu&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/AlbanAndrieu/ansible-windows/master/fr.linkedin.com/in/nabla/&#34;&gt;linkedin&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
</feed>