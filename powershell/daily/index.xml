<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2022-11-26T01:35:59Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>jseerden/IntuneBackupAndRestore</title>
    <updated>2022-11-26T01:35:59Z</updated>
    <id>tag:github.com,2022-11-26:/jseerden/IntuneBackupAndRestore</id>
    <link href="https://github.com/jseerden/IntuneBackupAndRestore" rel="alternate"></link>
    <summary type="html">&lt;p&gt;PowerShell Module that queries Microsoft Graph, and allows for cross-tenant Backup &amp; Restore actions of your Intune Configuration.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Intune Backup &amp;amp; Restore&lt;/h1&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://img.shields.io/powershellgallery/v/IntuneBackupAndRestore.svg?label=PSGallery%20Version&amp;amp;logo=PowerShell&amp;amp;style=flat-square&#34; alt=&#34;PowerShell Gallery&#34;&gt; &lt;img src=&#34;https://img.shields.io/powershellgallery/dt/IntuneBackupAndRestore.svg?label=PSGallery%20Downloads&amp;amp;logo=PowerShell&amp;amp;style=flat-square&#34; alt=&#34;PowerShell Gallery&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;This PowerShell Module queries Microsoft Graph, and allows for cross-tenant Backup &amp;amp; Restore actions of your Intune Configuration.&lt;/p&gt; &#xA;&lt;p&gt;Intune Configuration is backed up as (json) files in a given directory.&lt;/p&gt; &#xA;&lt;h2&gt;Installing IntuneBackupAndRestore&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# Install IntuneBackupAndRestore from the PowerShell Gallery&#xA;Install-Module -Name IntuneBackupAndRestore&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Updating IntuneBackupAndRestore&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# Update IntuneBackupAndRestore from the PowerShell Gallery&#xA;Update-Module -Name IntuneBackupAndRestore&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Prerequisites&lt;/h2&gt; &#xA;&lt;p&gt;As of version 2.0.0, the IntuneBackupAndRestore PowerShell Module has migrated from the MSGraphFunctions PowerShell module to the Microsoft.Graph.Intune PowerShell module. Please make sure you meet the prerequisites below.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Requires &lt;a href=&#34;https://github.com/Microsoft/Intune-PowerShell-SDK/&#34;&gt;Microsoft.Graph.Intune&lt;/a&gt; PowerShell Module (&lt;code&gt;Install-Module -Name Microsoft.Graph.Intune&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;Connect to Microsoft Graph using the &lt;code&gt;Connect-MSGraph&lt;/code&gt; PSCmdlet first.&lt;/li&gt; &#xA; &lt;li&gt;Make sure to import the IntuneBackupAndRestore PowerShell module before using it with the &lt;code&gt;Import-Module IntuneBackupAndRestore&lt;/code&gt; cmdlet.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Features&lt;/h2&gt; &#xA;&lt;h3&gt;Backup actions&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Administrative Templates (Device Configurations)&lt;/li&gt; &#xA; &lt;li&gt;Administrative Template Assignments&lt;/li&gt; &#xA; &lt;li&gt;App Protection Policies&lt;/li&gt; &#xA; &lt;li&gt;App Protection Policy Assignments&lt;/li&gt; &#xA; &lt;li&gt;Client Apps&lt;/li&gt; &#xA; &lt;li&gt;Client App Assignments&lt;/li&gt; &#xA; &lt;li&gt;Device Compliance Policies&lt;/li&gt; &#xA; &lt;li&gt;Device Compliance Policy Assignments&lt;/li&gt; &#xA; &lt;li&gt;Device Configurations&lt;/li&gt; &#xA; &lt;li&gt;Device Configuration Assignments&lt;/li&gt; &#xA; &lt;li&gt;Device Management Scripts (Device Configuration -&amp;gt; PowerShell Scripts)&lt;/li&gt; &#xA; &lt;li&gt;Device Management Script Assignments&lt;/li&gt; &#xA; &lt;li&gt;Proactive Remediations&lt;/li&gt; &#xA; &lt;li&gt;Proactive Remediation Assignments&lt;/li&gt; &#xA; &lt;li&gt;Settings Catalog Policies&lt;/li&gt; &#xA; &lt;li&gt;Settings Catalog Policy Assignments&lt;/li&gt; &#xA; &lt;li&gt;Software Update Rings&lt;/li&gt; &#xA; &lt;li&gt;Software Update Ring Assignments&lt;/li&gt; &#xA; &lt;li&gt;Endpoint Security Configurations &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Security Baselines &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Windows 10 Security Baselines&lt;/li&gt; &#xA;     &lt;li&gt;Microsoft Defender ATP Baselines&lt;/li&gt; &#xA;     &lt;li&gt;Microsoft Edge Baseline&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Antivirus&lt;/li&gt; &#xA;   &lt;li&gt;Disk encryption&lt;/li&gt; &#xA;   &lt;li&gt;Firewall&lt;/li&gt; &#xA;   &lt;li&gt;Endpoint detection and response&lt;/li&gt; &#xA;   &lt;li&gt;Attack surface reduction&lt;/li&gt; &#xA;   &lt;li&gt;Account protection&lt;/li&gt; &#xA;   &lt;li&gt;Device compliance&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Restore actions&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Administrative Templates (Device Configurations)&lt;/li&gt; &#xA; &lt;li&gt;Administrative Template Assignments&lt;/li&gt; &#xA; &lt;li&gt;App Protection Policies&lt;/li&gt; &#xA; &lt;li&gt;App Protection Policy Assignments&lt;/li&gt; &#xA; &lt;li&gt;Client App Assignments&lt;/li&gt; &#xA; &lt;li&gt;Device Compliance Policies&lt;/li&gt; &#xA; &lt;li&gt;Device Compliance Policy Assignments&lt;/li&gt; &#xA; &lt;li&gt;Device Configurations&lt;/li&gt; &#xA; &lt;li&gt;Device Configuration Assignments&lt;/li&gt; &#xA; &lt;li&gt;Device Management Scripts (Device Configuration -&amp;gt; PowerShell Scripts)&lt;/li&gt; &#xA; &lt;li&gt;Device Management Script Assignments&lt;/li&gt; &#xA; &lt;li&gt;Settings Catalog Policies&lt;/li&gt; &#xA; &lt;li&gt;Settings Catalog Policy Assignments&lt;/li&gt; &#xA; &lt;li&gt;Software Update Rings&lt;/li&gt; &#xA; &lt;li&gt;Software Update Ring Assignments&lt;/li&gt; &#xA; &lt;li&gt;Endpoint Security Configurations &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Security Baselines &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Windows 10 Security Baselines&lt;/li&gt; &#xA;     &lt;li&gt;Microsoft Defender ATP Baselines&lt;/li&gt; &#xA;     &lt;li&gt;Microsoft Edge Baseline&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;Antivirus&lt;/li&gt; &#xA;   &lt;li&gt;Disk encryption&lt;/li&gt; &#xA;   &lt;li&gt;Firewall&lt;/li&gt; &#xA;   &lt;li&gt;Endpoint detection and response&lt;/li&gt; &#xA;   &lt;li&gt;Attack surface reduction&lt;/li&gt; &#xA;   &lt;li&gt;Account protection&lt;/li&gt; &#xA;   &lt;li&gt;Device compliance&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Please note that some Client App settings can be backed up, for instance the retrieval of Win32 (un)install cmdlets, requirements, etcetera. The Client App itself is not backed up and this module does not support restoring Client Apps at this time.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h2&gt;Examples&lt;/h2&gt; &#xA;&lt;h3&gt;Example 01 - Full Intune Backup&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Start-IntuneBackup -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 02 - Full Intune Restore&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Start-IntuneRestoreConfig -Path C:\temp\IntuneBackup&#xA;Start-IntuneRestoreAssignments -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 03 - Restore Intune Assignments&lt;/h3&gt; &#xA;&lt;p&gt;If configurations have been restored:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Start-IntuneRestoreAssignments -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If reassigning assignments to existing (non-restored) configurations. In this case the assignments match the configuration id to restore to.&lt;br&gt; This allows for restoring if display names have changed.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Start-IntuneRestoreAssignments -Path C:\temp\IntuneBackup -RestoreById $true&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 04 - Restore only Intune Compliance Policies&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Invoke-IntuneRestoreDeviceCompliancePolicy -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Invoke-IntuneRestoreDeviceCompliancePolicyAssignment -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 05 - Restore Only Intune Device Configurations&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Invoke-IntuneRestoreDeviceConfiguration -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Invoke-IntuneRestoreDeviceConfigurationAssignment -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 06 - Backup Only Intune Endpoint Security Configurations&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Invoke-IntuneBackupDeviceManagementIntent -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 07 - Restore Only Intune Endpoint Security Configurations&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Invoke-IntuneRestoreDeviceManagementIntent -Path C:\temp\IntuneBackup&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 08 - Compare two Backup Files for changes&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# The DifferenceFilePath should point to the latest Intune Backup file, as it might contain new properties.&#xA;Compare-IntuneBackupFile -ReferenceFilePath &#39;C:\temp\IntuneBackup\Device Configurations\Windows - Endpoint Protection.json&#39; -DifferenceFilePath &#39;C:\temp\IntuneBackupLatest\Device Configurations\Windows - Endpoint Protection.json&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Example 09 - Compare all files in two Backup Directories for changes&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# The DifferenceFilePath should point to the latest Intune Backup file, as it might contain new properties.&#xA;Compare-IntuneBackupDirectories -ReferenceDirectory &#39;C:\temp\IntuneBackup&#39; -DifferenceDirectory &#39;C:\temp\IntuneBackup2&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Known Issues&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Does not support backing up Intune configuration items with duplicate Display Names. Files may be overwritten.&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>