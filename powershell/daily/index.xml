<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2022-10-18T01:37:24Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>TrimarcJake/Locksmith</title>
    <updated>2022-10-18T01:37:24Z</updated>
    <id>tag:github.com,2022-10-18:/TrimarcJake/Locksmith</id>
    <link href="https://github.com/TrimarcJake/Locksmith" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A tool to identify and remediate common misconfigurations in Active Directory Certificate Services&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Locksmith&lt;/h1&gt; &#xA;&lt;p&gt;A tool to identify and remediate common misconfigurations in Active Directory Certificate Services&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>Azure-Samples/ms-identity-node</title>
    <updated>2022-10-18T01:37:24Z</updated>
    <id>tag:github.com,2022-10-18:/Azure-Samples/ms-identity-node</id>
    <link href="https://github.com/Azure-Samples/ms-identity-node" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Sample code to authenticate from within a Webapp backed by Node.js using MSAL Node&lt;/p&gt;&lt;hr&gt;&lt;hr&gt; &#xA;&lt;p&gt;page_type: sample languages:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;javascript&lt;/li&gt; &#xA; &lt;li&gt;nodejs products:&lt;/li&gt; &#xA; &lt;li&gt;msal-node&lt;/li&gt; &#xA; &lt;li&gt;azure-active-directory description: &#34;Add authentication to a Node.js web application with the Microsoft Authentication Library for Node.js (MSAL Node).&#34; urlFragment: &#34;ms-identity-node&#34;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;hr&gt; &#xA;&lt;h1&gt;Express web application built with MSAL Node and Microsoft identity platform&lt;/h1&gt; &#xA;&lt;p&gt;This sample demonstrates how to use &lt;a href=&#34;https://www.npmjs.com/package/@azure/msal-node&#34;&gt;MSAL Node&lt;/a&gt; to login, logout and acquire an access token for a protected resource such as Microsoft Graph.&lt;/p&gt; &#xA;&lt;h2&gt;Features&lt;/h2&gt; &#xA;&lt;p&gt;This sample demonstrates the following MSAL Node concepts:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Configuration&lt;/li&gt; &#xA; &lt;li&gt;Login&lt;/li&gt; &#xA; &lt;li&gt;Logout&lt;/li&gt; &#xA; &lt;li&gt;Acquiring an access token and calling Microsoft Graph&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Contents&lt;/h2&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;File/folder&lt;/th&gt; &#xA;   &lt;th&gt;Description&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;App/&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Application source code resides here.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;AppCreationScripts/&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Contains PowerShell scripts for automating app registration.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;.gitignore&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Define what to ignore at commit time.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;CHANGELOG.md&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;List of changes to the sample.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;CONTRIBUTING.md&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;Guidelines for contributing to the sample.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;README.md&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;This README file.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;&lt;code&gt;LICENSE&lt;/code&gt;&lt;/td&gt; &#xA;   &lt;td&gt;The license for the sample.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; This sample was bootstrapped using &lt;a href=&#34;https://expressjs.com/en/starter/generator.html&#34;&gt;express-generator&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Getting Started&lt;/h2&gt; &#xA;&lt;h3&gt;Prerequisites&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://nodejs.org/en/&#34;&gt;Node.js&lt;/a&gt; must be installed to run this sample.&lt;/p&gt; &#xA;&lt;h3&gt;Setup&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Register a new application by following the steps shown &lt;a href=&#34;https://docs.microsoft.com/azure/active-directory/develop/web-app-quickstart?pivots=devlang-nodejs-msal#step-1-register-your-application&#34;&gt;here&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Clone this repository &lt;code&gt;git clone https://github.com/Azure-Samples/ms-identity-node.git&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Open the &lt;a href=&#34;https://raw.githubusercontent.com/Azure-Samples/ms-identity-node/main/App/.env&#34;&gt;/App/.env&lt;/a&gt; file and provide the required configuration values&lt;/li&gt; &#xA; &lt;li&gt;On the command line, navigate to the &lt;code&gt;App&lt;/code&gt; folder, and run&lt;code&gt;npm install&lt;/code&gt; to install the project dependencies via npm&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;Running the sample&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Configure authentication and authorization parameters: &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt;Open &lt;code&gt;App/.env&lt;/code&gt;&lt;/li&gt; &#xA;   &lt;li&gt;Replace the string &lt;code&gt;&#34;Enter_the_Application_Id_Here&#34;&lt;/code&gt; with your app/client ID on AAD Portal.&lt;/li&gt; &#xA;   &lt;li&gt;Replace the string &lt;code&gt;&#34;Enter_the_Cloud_Instance_Id_Here&#34;&lt;/code&gt; with &lt;code&gt;&#34;https://login.microsoftonline.com/&#34;&lt;/code&gt;&lt;/li&gt; &#xA;   &lt;li&gt;Replace the string &lt;code&gt;&#34;Enter_the_Tenant_Info_Here&#34;&lt;/code&gt; with your tenant ID on AAD Portal.&lt;/li&gt; &#xA;   &lt;li&gt;Replace the string &lt;code&gt;&#34;Enter_the_Client_Secret_Here&#34;&lt;/code&gt; with your client secret on AAD Portal.&lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;/li&gt; &#xA; &lt;li&gt;Configure the parameters for calling MS Graph API: &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt;Replace the string &lt;code&gt;&#34;Enter_the_Graph_Endpoint_Here&#34;&lt;/code&gt; with &lt;code&gt;&#34;https://graph.microsoft.com/&#34;&lt;/code&gt;&lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;/li&gt; &#xA; &lt;li&gt;Configure the Express session secret: &#xA;  &lt;ol&gt; &#xA;   &lt;li&gt;Replace the string &lt;code&gt;&#34;Enter_the_Express_Session_Secret_Here&#34;&lt;/code&gt; with a hard to guess value, such as your client secret.&lt;/li&gt; &#xA;  &lt;/ol&gt; &lt;/li&gt; &#xA; &lt;li&gt;To start the sample application, run &lt;code&gt;npm start&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Finally, open a browser and navigate to &lt;a href=&#34;http://localhost:3000&#34;&gt;http://localhost:3000&lt;/a&gt;.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;span&gt;ℹ&lt;/span&gt; To configure this app for tenants on Sovereign/National clouds, see: &lt;a href=&#34;https://docs.microsoft.com/azure/active-directory/develop/msal-national-cloud&#34;&gt;Use MSAL in a national cloud environment&lt;/a&gt;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;This project welcomes contributions and suggestions. Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit &lt;a href=&#34;https://cla.opensource.microsoft.com&#34;&gt;https://cla.opensource.microsoft.com&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;When you submit a pull request, a CLA bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA.&lt;/p&gt; &#xA;&lt;p&gt;This project has adopted the &lt;a href=&#34;https://opensource.microsoft.com/codeofconduct/&#34;&gt;Microsoft Open Source Code of Conduct&lt;/a&gt;. For more information see the &lt;a href=&#34;https://opensource.microsoft.com/codeofconduct/faq/&#34;&gt;Code of Conduct FAQ&lt;/a&gt; or contact &lt;a href=&#34;mailto:opencode@microsoft.com&#34;&gt;opencode@microsoft.com&lt;/a&gt; with any additional questions or comments.&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>cisagov/Sparrow</title>
    <updated>2022-10-18T01:37:24Z</updated>
    <id>tag:github.com,2022-10-18:/cisagov/Sparrow</id>
    <link href="https://github.com/cisagov/Sparrow" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Sparrow.ps1 was created by CISA&#39;s Cloud Forensics team to help detect possible compromised accounts and applications in the Azure/m365 environment.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Aviary&lt;/h1&gt; &#xA;&lt;p&gt;Aviary is a new dashboard that CISA and partners developed to help visualize and analyze outputs from its Sparrow detection tool released in December 2020. Sparrow helps network defenders detect possible compromised accounts and applications in Azure/Microsoft O365 environments. CISA created Sparrow to support hunts for threat activity following the SolarWinds compromise. Aviary--a Splunk-base dashboard--facilitates analysis of Sparrow data outputs.&lt;/p&gt; &#xA;&lt;p&gt;To download Aviary, visit &lt;a href=&#34;https://github.com/cisagov/Sparrow/releases/&#34;&gt;releases.&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Sparrow.ps1&lt;/h1&gt; &#xA;&lt;p&gt;Sparrow.ps1 was created by CISA&#39;s Cloud Forensics team to help detect possible compromised accounts and applications in the Azure/m365 environment. The tool is intended for use by incident responders, and focuses on the narrow scope of user and application activity endemic to identity and authentication based attacks seen recently in multiple sectors. It is neither comprehensive nor exhaustive of available data, and is intended to narrow a larger set of available investigation modules and telemetry to those specific to recent attacks on federated identity sources and applications.&lt;/p&gt; &#xA;&lt;p&gt;Sparrow.ps1 will check and install the required PowerShell modules on the analysis machine, check the unified audit log in Azure/M365 for certain indicators of compromise (IoC&#39;s), list Azure AD domains, and check Azure service principals and their Microsoft Graph API permissions to identify potential malicious activity. The tool then outputs the data into multiple CSV files that are located in the user&#39;s default home directory in a folder called &#39;ExportDir&#39; (ie: Desktop/ExportDir).&lt;/p&gt; &#xA;&lt;p&gt;For more guidance on how to use Sparrow and Aviary, please see: &lt;a href=&#34;https://us-cert.cisa.gov/ncas/alerts/aa21-008a&#34;&gt;https://us-cert.cisa.gov/ncas/alerts/aa21-008a&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Requirements&lt;/h2&gt; &#xA;&lt;p&gt;The following AzureAD/m365 permissions are required to run Sparrow.ps1, and provide it read-only access to the Tenant.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Azure Active Directory: &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Security Reader&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Security and Compliance Center: &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Compliance Administrator&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Exchange Online Admin Center: Utilize a custom group for these specific permissions: &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Mail Recipients&lt;/li&gt; &#xA;   &lt;li&gt;Security Group Creation and Membership&lt;/li&gt; &#xA;   &lt;li&gt;User options&lt;/li&gt; &#xA;   &lt;li&gt;View-Only Audit log&lt;/li&gt; &#xA;   &lt;li&gt;View-Only Configuration&lt;/li&gt; &#xA;   &lt;li&gt;View-Only Recipients&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;To check for the MailItemsAccessed Operation, your tenant organization requires an Office 365 or Microsoft 365 E5/G5 license.&lt;/p&gt; &#xA;&lt;p&gt;Unified Audit Logs will need to be enabled.&lt;/p&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;Sparrow.ps1 does not require any extra steps for installation once the permissions detailed in Requirements are satisfied.&lt;/p&gt; &#xA;&lt;p&gt;The function, Check-PSModules, will check to see if the three required PowerShell modules are installed on the system and if not, it will use the default PowerShell repository on the system to reach out and install. If the modules are present but not imported, the script will also import the missing modules so that they are ready for use.&lt;/p&gt; &#xA;&lt;p&gt;The required PowerShell modules:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;ExchangeOnlineManagement (&lt;a href=&#34;https://www.powershellgallery.com/packages/ExchangeOnlineManagement/2.0.3&#34;&gt;https://www.powershellgallery.com/packages/ExchangeOnlineManagement/2.0.3&lt;/a&gt;)&lt;/li&gt; &#xA; &lt;li&gt;AzureAD (&lt;a href=&#34;https://www.powershellgallery.com/packages/AzureAD/2.0.2.128&#34;&gt;https://www.powershellgallery.com/packages/AzureAD/2.0.2.128&lt;/a&gt;)&lt;/li&gt; &#xA; &lt;li&gt;MSOnline (&lt;a href=&#34;https://www.powershellgallery.com/packages/MSOnline/1.1.183.57&#34;&gt;https://www.powershellgallery.com/packages/MSOnline/1.1.183.57&lt;/a&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;To install the PowerShell modules, run the following commands:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Install-Module ExchangeOnlineManagement&#xA;Install-Module AzureAD&#xA;Install-Module MSOnline &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;To download and run Sparrow.ps1, type the following command into a PowerShell window (assuming file is in your working directory):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Invoke-WebRequest &#39;https://github.com/cisagov/Sparrow/raw/develop/Sparrow.ps1&#39; -OutFile &#39;Sparrow.ps1&#39; -UseBasicParsing; .\Sparrow.ps1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Using Behind A Proxy&lt;/h2&gt; &#xA;&lt;p&gt;If you are executing the script from behind a proxy, you may need to run the following commands, substituting your proxy server prior to execution:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;[System.Net.WebRequest]::DefaultWebProxy = New-Object System.Net.WebProxy(&#39;http://proxyname:port&#39;)&#xA;[System.Net.WebRequest]::DefaultWebProxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Issues&lt;/h2&gt; &#xA;&lt;p&gt;If you have issues using the code, open an issue on the repository!&lt;/p&gt; &#xA;&lt;p&gt;You can do this by clicking &#34;Issues&#34; at the top and clicking &#34;New Issue&#34; on the following page.&lt;/p&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;We welcome contributions! Please see &lt;a href=&#34;https://raw.githubusercontent.com/cisagov/Sparrow/develop/CONTRIBUTING.md&#34;&gt;here&lt;/a&gt; for details.&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;This project is in the worldwide &lt;a href=&#34;https://raw.githubusercontent.com/cisagov/Sparrow/develop/LICENSE&#34;&gt;public domain&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This project is in the public domain within the United States, and copyright and related rights in the work worldwide are waived through the &lt;a href=&#34;https://creativecommons.org/publicdomain/zero/1.0/&#34;&gt;CC0 1.0 Universal public domain dedication&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;All contributions to this project will be released under the CC0 dedication. By submitting a pull request, you are agreeing to comply with this waiver of copyright interest.&lt;/p&gt; &#xA;&lt;h2&gt;Legal Disclaimer&lt;/h2&gt; &#xA;&lt;p&gt;NOTICE&lt;/p&gt; &#xA;&lt;p&gt;This software package (“software” or “code”) was created by the United States Government and is not subject to copyright. You may use, modify, or redistribute the code in any manner. However, you may not subsequently copyright the code as it is distributed. The United States Government makes no claim of copyright on the changes you effect, nor will it restrict your distribution of bona fide changes to the software. If you decide to update or redistribute the code, please include this notice with the code. Where relevant, we ask that you credit the Cybersecurity and Infrastructure Security Agency with the following statement: “Original code developed by the Cybersecurity and Infrastructure Security Agency (CISA), U.S. Department of Homeland Security.”&lt;/p&gt; &#xA;&lt;p&gt;USE THIS SOFTWARE AT YOUR OWN RISK. THIS SOFTWARE COMES WITH NO WARRANTY, EITHER EXPRESS OR IMPLIED. THE UNITED STATES GOVERNMENT ASSUMES NO LIABILITY FOR THE USE OR MISUSE OF THIS SOFTWARE OR ITS DERIVATIVES.&lt;/p&gt; &#xA;&lt;p&gt;THIS SOFTWARE IS OFFERED “AS-IS.” THE UNITED STATES GOVERNMENT WILL NOT INSTALL, REMOVE, OPERATE OR SUPPORT THIS SOFTWARE AT YOUR REQUEST. IF YOU ARE UNSURE OF HOW THIS SOFTWARE WILL INTERACT WITH YOUR SYSTEM, DO NOT USE IT.&lt;/p&gt;</summary>
  </entry>
</feed>