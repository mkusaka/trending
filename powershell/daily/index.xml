<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-03-04T01:33:49Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>fabrisodotps1/M365PSProfile</title>
    <updated>2024-03-04T01:33:49Z</updated>
    <id>tag:github.com,2024-03-04:/fabrisodotps1/M365PSProfile</id>
    <link href="https://github.com/fabrisodotps1/M365PSProfile" rel="alternate"></link>
    <summary type="html">&lt;p&gt;M365PSProfile installs and keeps the PowerShell Modules needed for Microsoft 365 Management up to date. It provides a simple way to add it to the PowerShell Profile.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;M365PSProfile&lt;/h1&gt; &#xA;&lt;p&gt;If you&#39;re an Microsoft 365 Administrator, you need to have several PowerShell Modules for Managing an M365 Environement.&lt;/p&gt; &#xA;&lt;p&gt;We&#39;ve created a flexible Module, that simplifies the Installation and Update of these Modules.&lt;/p&gt; &#xA;&lt;h2&gt;Our Journey&lt;/h2&gt; &#xA;&lt;p&gt;A few Years ago Andres had created a PowerShell Profile Script that installed all the M365 Modules. The Modules where only installed when running as Administrator in the &#34;AllUsers&#34; Scope.&lt;/p&gt; &#xA;&lt;p&gt;That approach had some downsites:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Updating the Code required the User download the Script and Update the Profile for every Update&lt;/li&gt; &#xA; &lt;li&gt;Required &#34;Run as Admin&#34; for installation of Modules&lt;/li&gt; &#xA; &lt;li&gt;Updating Modules took a long Time â˜•&lt;/li&gt; &#xA; &lt;li&gt;The Modules where defined static in the Script&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Over time - that approach became unmanageable.&lt;/p&gt; &#xA;&lt;h2&gt;Goals&lt;/h2&gt; &#xA;&lt;p&gt;So we decided to write a Module that handles the Logic and can be updated from the PowerShell Gallery.&lt;/p&gt; &#xA;&lt;p&gt;Our Goals are:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Simple One-Liner in the &lt;a href=&#34;https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.3&#34;&gt;PowerShell Profile&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;No Admin Rights required -&amp;gt; Installation in the &#34;CurrentUser&#34; Scope&lt;/li&gt; &#xA; &lt;li&gt;Fast and configurable -&amp;gt; Predefined Modules or can be defined by yourself&lt;/li&gt; &#xA; &lt;li&gt;Support for PowerShell 5 and 7 (Install in CurrentUser Scope)&lt;/li&gt; &#xA; &lt;li&gt;Parameter for Modules that should be installed and updated&lt;/li&gt; &#xA; &lt;li&gt;Use the &lt;a href=&#34;https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.psresourceget/?view=powershellget-3.x&#34;&gt;Microsoft.PowerShell.PSResourceGet&lt;/a&gt; (included in PowerShell 7.4)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;You need to install the Module&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;#PowerShellGet&#xA;Install-Module -Name M365PSProfile -Scope CurrentUser&#xA;&#xA;#Microsoft.PowerShell.PSResourceGet&#xA;Install-PSResource -Name M365PSProfile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/fabrisodotps1/M365PSProfile/main/M365PSProfile_01.png&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Available Commands&lt;/h3&gt; &#xA;&lt;p&gt;You can view the available Commands of the Module with the command below&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;Get-Command -Module M365PSProfile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/fabrisodotps1/M365PSProfile/main/M365PSProfile_02.png&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;What you have to put into your Profile&lt;/h3&gt; &#xA;&lt;p&gt;If you don&#39;t have an existing PowerShell Profile you can simply use the command below.&lt;/p&gt; &#xA;&lt;p&gt;You have to do that for PowerShell 5 and PowerShell 7&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;Add-M365PSProfile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/fabrisodotps1/M365PSProfile/main/M365PSProfile_03.png&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;If you have already a PowerShell Profile you need to add at least one line to your PowerShell Profile&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;Import-Module -Name M365PSProfile&#xA;#Install or updates the default Modules (what we think every M365 Admin needs) in the CurrentUser Scope&#xA;Install-M365Module&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you have specific Modules that you want to keep up to date, use the -Modules Parameter with an Array of ModuleNames&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;#Install or Updates the Modules in the Array&#xA;Install-M365Module -Modules @(&#34;ExchangeOnlineManagement&#34;, &#34;Icewolf.EXO.SpamAnalyze&#34;, &#34;MicrosoftTeams&#34;, &#34;Microsoft.Online.SharePoint.PowerShell&#34;, &#34;PnP.PowerShell&#34;, &#34;ORCA&#34;, &#34;M365PSProfile&#34;, &#34;O365CentralizedAddInDeployment&#34;, &#34;MSCommerce&#34;, &#34;WhiteboardAdmin&#34;, &#34;Microsoft.Graph&#34;, &#34;Microsoft.Graph.Beta&#34;, &#34;MSIdentityTools&#34;, &#34;PSMSALNet&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;With these commands in the Profile it looks like this&lt;/p&gt; &#xA;&lt;p&gt;PowerShell 5&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/fabrisodotps1/M365PSProfile/main/M365PSProfile_04.png&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;PowerShell 7&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/fabrisodotps1/M365PSProfile/main/M365PSProfile_05.png&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Script Parameters&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;-Modules @(ArrayOfModulenames)&#xA;-Scope [Default:CurrentUser/AllUsers]&#xA;-AsciiArt [Default:true/false]&#xA;-RunInVSCode [Default:false/true]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;PowerShell Profiles&lt;/h3&gt; &#xA;&lt;p&gt;How do PowerShell Profiles work?&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;MS Learn &lt;a href=&#34;https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.4&#34;&gt;PowerShell Profiles&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Basically there exist four Types&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;All Users, All Hosts&lt;/li&gt; &#xA; &lt;li&gt;All Users, Current Host&lt;/li&gt; &#xA; &lt;li&gt;Current User, All Hosts&lt;/li&gt; &#xA; &lt;li&gt;Current user, Current Host&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Be aware that there are diffrent Profile Files for PowerShell 5 and 7. For Example &#34;Current user, Current Host&#34; on Windows&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;#PowerShell 5.1&#xA;#$HOME\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&#xA;$Profile&#xA;#View or Edit Profile&#xA;notepad $Profile&#xA;&#xA;#PowerShell 7&#xA;#$HOME\Documents\PowerShell\Microsoft.PowerShell_profile.ps1&#xA;$Profile&#xA;#View or Edit Profile&#xA;notepad $Profile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Standard Modules that are installed with this Module&lt;/h3&gt; &#xA;&lt;p&gt;These are the Modules that are installed if you don&#39;t use an Array with the -Modules Parameter.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;Module&lt;/th&gt; &#xA;   &lt;th&gt;Description&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;ExchangeOnlineManagement&lt;/td&gt; &#xA;   &lt;td&gt;Exchange Online&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Icewolf.EXO.SpamAnalyze&lt;/td&gt; &#xA;   &lt;td&gt;Exchange Online Message Tracking / &lt;a href=&#34;https://github.com/BohrenAn/GitHub_PowerShellScripts/tree/main/Icewolf.EXO.SpamAnalyze&#34;&gt;SpamAnalyze&lt;/a&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;MicrosoftTeams&lt;/td&gt; &#xA;   &lt;td&gt;Microsoft Teams&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Microsoft.Online.SharePoint.PowerShell&lt;/td&gt; &#xA;   &lt;td&gt;Microsoft Sharepoint&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;PnP.PowerShell&lt;/td&gt; &#xA;   &lt;td&gt;SharePoint / Microsoft Teams&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;ORCA&lt;/td&gt; &#xA;   &lt;td&gt;Defender for Office 365 Recommended Configuration Analyzer&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;O365CentralizedAddInDeployment&lt;/td&gt; &#xA;   &lt;td&gt;Deploy Office Add-Ins&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;M365PSProfile&lt;/td&gt; &#xA;   &lt;td&gt;Keep your M365 Modules up to date&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;MSCommerce&lt;/td&gt; &#xA;   &lt;td&gt;Manage M365 Self Service Purchase&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;WhiteboardAdmin&lt;/td&gt; &#xA;   &lt;td&gt;Manage Whiteboards&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Microsoft.Graph&lt;/td&gt; &#xA;   &lt;td&gt;Microsoft.Graph Modules &lt;a href=&#34;https://graph.microsoft.com/v1.0&#34;&gt;https://graph.microsoft.com/v1.0&lt;/a&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;Microsoft.Graph.Beta&lt;/td&gt; &#xA;   &lt;td&gt;Microsoft.Graph Modules &lt;a href=&#34;https://graph.microsoft.com/beta&#34;&gt;https://graph.microsoft.com/beta&lt;/a&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;PSMSALNet&lt;/td&gt; &#xA;   &lt;td&gt;PowerShell 7.2 MSAL.NET wrapper&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;MSIdentityTools&lt;/td&gt; &#xA;   &lt;td&gt;Additional Functions for Identity&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;p&gt;or you can use this command to list the default Modules&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;Get-M365StandardModule&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Uninstall&lt;/h3&gt; &#xA;&lt;p&gt;For Uninstalling there are three Options&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Uninstall the Standard Modules&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;#Uninstalls the Standard M365 Modules&#xA;Uninstall-M365Module&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol start=&#34;2&#34;&gt; &#xA; &lt;li&gt;Uninstall the PSProfile&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Note that PowerShell 5 and 7 have separate PowerShell Profiles&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;You need to edit the PowerShell Profile and remove these two Lines&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;Import-Module -Name M365PSProfile&#xA;Install-M365Module&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To view or delete the PowerShell Profile you can use these Commands&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;#View the Content of your PowerShell Profile&#xA;Get-Content $Profile&#xA;&#xA;#Delete the PowerShell Profile&#xA;Remove-Item $Profile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol start=&#34;3&#34;&gt; &#xA; &lt;li&gt;Uninstall the Module You can uninstall the M365PSProfile Module. Make sure you have removed the Lines in Option 2&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-pwsh&#34;&gt;#PowerShellGet&#xA;Uninstall-Module -Name M365PSProfile&#xA;&#xA;#Microsoft.PowerShell.PSResourceGet&#xA;Uninstall-PSResource -Name M365PSProfile&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Modules Path&lt;/h3&gt; &#xA;&lt;p&gt;Show the Path where PowerShell looks for Modules&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;$env:PSModulePath.Split(&#34;;&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Note: The Modules in the Scope &#34;CurrentUser&#34; has precedence over Scope &#34;AllUsers&#34;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h2&gt;Contribution&lt;/h2&gt; &#xA;&lt;p&gt;How can you contribute?&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Create an Issue&lt;/li&gt; &#xA; &lt;li&gt;Fork the Repo and create a Pull Request&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Maintainer&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Fabrice Reiser &lt;a href=&#34;https://twitter.com/fabrisodotps1&#34;&gt;@fabrisodotps1&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Andres Bohren &lt;a href=&#34;https://twitter.com/andresbohren&#34;&gt;@andresbohren&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>