<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-03-11T01:33:11Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>microsoft/Build-OMS-Agent-for-Linux</title>
    <updated>2024-03-11T01:33:11Z</updated>
    <id>tag:github.com,2024-03-11:/microsoft/Build-OMS-Agent-for-Linux</id>
    <link href="https://github.com/microsoft/Build-OMS-Agent-for-Linux" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Build projects required for omsagent&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Operations Management Suite Linux Agent&lt;/h1&gt; &#xA;&lt;h2&gt;Table of Contents&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#setting-up-a-machine-to-build-oms&#34;&gt;Setting up a machine to build OMS&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#sudoers-configuration&#34;&gt;Sudoers configuration&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#dependencies-to-build-a-native-package&#34;&gt;Dependencies to build a native package&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#setting-up-a-system-to-build-a-shell-bundle&#34;&gt;Setting up a system to build a shell bundle&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#cloning-the-repositories&#34;&gt;Cloning the repositories&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#preparing-system-tests&#34;&gt;Preparing system tests&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#building-omsagent&#34;&gt;Building omsagent&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#troubleshooting&#34;&gt;Troubleshooting&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#code-of-conduct&#34;&gt;Code of Conduct&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;If you are an active contributor to the OMS-Agent project, you should &lt;a href=&#34;https://github.com/Microsoft/ostc-docs/raw/master/setup-git.md&#34;&gt;set up your system&lt;/a&gt; and follow our &lt;a href=&#34;https://github.com/Microsoft/ostc-docs/raw/master/workflow-workflow.md&#34;&gt;common workflow&lt;/a&gt;. New to git? Read &lt;a href=&#34;https://github.com/Microsoft/ostc-docs/raw/master/setup-rules.md&#34;&gt;guidelines for development&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Setting up a machine to build OMS&lt;/h3&gt; &#xA;&lt;p&gt;A &#34;shell bundle&#34; is a distribution mechanism for the OMS agent. A shell bundle is a shell script that has, as part of it, .RPM and .DEB native package files. The shell bundle determines what has to be installed based on system configuration and installs the appropriate packages.&lt;/p&gt; &#xA;&lt;p&gt;There are two ways to build OMS.&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;As an RPM or DEB package that can be installed on the local system, assuming all dependencies are met (most easily met if a shell bundle was previously installed to &#34;seed&#34; the system), or&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;As a shell bundle.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;Building a shell bundle is a superset of setting up a system to build a local RPM, so we will cover that first.&lt;/p&gt; &#xA;&lt;h4&gt;Sudoers configuration&lt;/h4&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Microsoft/ostc-docs/raw/master/setup-build.md&#34;&gt;Configure sudo&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h4&gt;Dependencies to build a native package&lt;/h4&gt; &#xA;&lt;p&gt;Note that it&#39;s very nice to be able to use the &lt;a href=&#34;https://github.com/jeffaco/msft-updatedns&#34;&gt;updatedns&lt;/a&gt; project to use host names rather than IP numbers in a Hyper-V environment. On CentOS systems, this requires the bind-utils package (updatedns requires the &#39;dig&#39; program). The bind-utils package isn&#39;t otherwise necessary.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;On CentOS 7.x&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt; sudo yum install git bind-utils bison gcc-c++ rpm-devel pam-devel openssl-devel rpm-build mysql-devel cmake boost-devel boost-test audit-libs-devel unzip&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;On Ubuntu 14.04&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt; sudo apt-get install git pkg-config make bison g++ rpm librpm-dev libpam0g-dev libssl-dev libmysqlclient-dev cmake libboost-dev libboost-test-dev libaudit-dev libauparse-dev unzip&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Install minimum version of Ruby (the system must have 1.9 or higher, but 2.2.6 is recommended). This is needed for all systems. This can be done with the following commands:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt; wget https://cache.ruby-lang.org/pub/ruby/2.2/ruby-2.2.6.tar.gz&#xA; tar xzvf ruby-2.2.6.tar.gz&#xA; cd ruby-2.2.6&#xA; ./configure&#xA; make&#xA; sudo make install&#xA; $(which ruby) --version  # verify that this prints 2.2.6&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Note on libboost&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Libboost is not a runtime dependency. It is only needed to build and run the OMS-Auditd-Plugin unittests.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Notes on other platforms&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;When building a machine for ULINUX builds (such as CentOS 5.x), we suggest using the O/S distribution CD to install the packages. It&#39;s not as easy, but that&#39;s the only way to guarantee that packages aren&#39;t updated such that generated binaries are not backwards compatible. (See notes on building a shell bundle, elsewhere in this document.)&lt;/p&gt; &#xA;&lt;p&gt;Also note that since you won&#39;t use &#39;yum&#39;, you must also handle the dependent packages manually (keep adding lines to the &#39;rpm install&#39; command line until all dependencies are satisfied).&lt;/p&gt; &#xA;&lt;p&gt;Similar methods would be utilized if building a Redhat system that is not registered for use for up2date.&lt;/p&gt; &#xA;&lt;h4&gt;Setting up a system to build a shell bundle&lt;/h4&gt; &#xA;&lt;p&gt;To build a shell bundle, we need and older Linux system (we typically use CentOS 5.0 for this), as binary images created with older Linux systems are generally upwards compatible when installed on newer Linux systems.&lt;/p&gt; &#xA;&lt;p&gt;A notable exception: We use the OpenSSL package, and we can&#39;t tell if we need OpenSSL v1.0.x or OpenSSL v1.1.x. As a result, we have a &lt;a href=&#34;https://github.com/Microsoft/ostc-openssl/raw/master/README.md&#34;&gt;special process&lt;/a&gt; to build both versions of OpenSSL that we can link against.&lt;/p&gt; &#xA;&lt;p&gt;Once OpenSSL is set up, you need to configure omsagent to include the &lt;code&gt;--enable-ulinux&lt;/code&gt; qualifier, like this:&lt;br&gt;&lt;code&gt;./configure --enable-ulinux&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Cloning the repositories&lt;/h3&gt; &#xA;&lt;p&gt;If you have read access to the &lt;a href=&#34;https://github.com/Microsoft/OMS-Agent-for-Linux-testconfig&#34;&gt;OMS TestConfig&lt;/a&gt; project, use the following.&lt;/p&gt; &#xA;&lt;p&gt;Otherwise, only run the first &lt;code&gt;git clone&lt;/code&gt; command and refer to &lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#preparing-system-tests&#34;&gt;preparing system tests&lt;/a&gt; if you want them to be run.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;git clone --recursive git@github.com:Microsoft/Build-OMS-Agent-for-Linux.git bld-omsagent&#xA;git clone git@github.com:Microsoft/OMS-Agent-for-Linux-testconfig.git bld-omsagent/omsagent/test/config&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Note that there are several subprojects, and authentication is a hassle unless you set up an SSH key via your GitHub account. &lt;a href=&#34;https://github.com/Microsoft/ostc-docs/raw/master/setup-git.md&#34;&gt;Set up your machine&lt;/a&gt; properly for a much easier workflow.&lt;/p&gt; &#xA;&lt;h4&gt;Preparing system tests&lt;/h4&gt; &#xA;&lt;p&gt;&lt;strong&gt;This section only applies if you do not have read access to &lt;a href=&#34;https://github.com/Microsoft/OMS-Agent-for-Linux-testconfig&#34;&gt;OMS TestConfig&lt;/a&gt; project&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;System tests communicate with the server. They require keys which may not be published. You may obtain your own keys for free by creating an account on &lt;a href=&#34;http://www.microsoft.com/en-us/server-cloud/operations-management-suite/why-oms.aspx&#34;&gt;Microsoft Operations Management Suite&lt;/a&gt; then get the keys from the settings view.&lt;/p&gt; &#xA;&lt;p&gt;Create the file &lt;code&gt;bld-omsagent/omsagent/test/config/systest.conf&lt;/code&gt; with content like so:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;export TEST_WORKSPACE_ID=&amp;lt;id&amp;gt;&#xA;export TEST_SHARED_KEY=&amp;lt;key&amp;gt;&#xA;&#xA;export TEST_WORKSPACE_ID_2=&amp;lt;id&amp;gt;&#xA;export TEST_SHARED_KEY_2=&amp;lt;key&amp;gt;&#xA;&#xA;export TEST_PROXY_SETTING=&#34;http://proxyuser:proxypass@host:8080&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Building omsagent&lt;/h3&gt; &#xA;&lt;p&gt;From the bld-omsagent directory (created above from &#39;git clone&#39;, do the following:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;cd omsagent/build&#xA;./configure&#xA;make&#xA;make test&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Note that the &lt;code&gt;configure&lt;/code&gt; script takes a variety of options. You can use &lt;code&gt;configure --help&lt;/code&gt; to see the options available.&lt;/p&gt; &#xA;&lt;p&gt;When the build completes, you should have a native package that you can install on your system. The native package should be in a subdirectory off of bld-omsagent/omsagent/target (the directory name varies based on debug vs. release builds).&lt;/p&gt; &#xA;&lt;p&gt;As mentioned above, this form of build requires a shell bundle to be installed to &#34;seed&#34; your system with other required dependencies.&lt;/p&gt; &#xA;&lt;p&gt;Note that the build will build multiple versions of Ruby (one for unit test, only built once, even after &#34;make distclean&#34;), and then one or two versions depending if you&#39;re building for a shell bundle or not. Bottom line: The first build is always slower than subsequent builds.&lt;/p&gt; &#xA;&lt;h3&gt;Troubleshooting&lt;/h3&gt; &#xA;&lt;h4&gt;Improper clone of project&lt;/h4&gt; &#xA;&lt;p&gt;If you get an error during the Ruby build like:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;downloader.rb:180: private method `class_variable_set&#39; called for Downloader:Class (NoMethodError)&#xA;configure: error: cannot run /bin/sh tool/config.sub&#xA;make: *** [/usr/local/ruby-2.2.0a] Error 127&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;While this points to an issue where your system version of Ruby is too old (strangely enough, Ruby is required to build Ruby), the root source of the issue is that you didn&#39;t clone the repository recursively. Please read &lt;a href=&#34;https://raw.githubusercontent.com/microsoft/Build-OMS-Agent-for-Linux/master/#cloning-the-repositories&#34;&gt;the section on cloning the repositories&lt;/a&gt; for details on how to clone the repository.&lt;/p&gt; &#xA;&lt;h3&gt;Code of Conduct&lt;/h3&gt; &#xA;&lt;p&gt;This project has adopted the &lt;a href=&#34;https://opensource.microsoft.com/codeofconduct/&#34;&gt;Microsoft Open Source Code of Conduct&lt;/a&gt;. For more information see the &lt;a href=&#34;https://opensource.microsoft.com/codeofconduct/faq/&#34;&gt;Code of Conduct FAQ&lt;/a&gt; or contact &lt;a href=&#34;mailto:opencode@microsoft.com&#34;&gt;opencode@microsoft.com&lt;/a&gt; with any additional questions or comments.&lt;/p&gt;</summary>
  </entry>
</feed>