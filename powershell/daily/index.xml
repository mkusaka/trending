<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub PowerShell Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-05-02T01:30:14Z</updated>
  <subtitle>Daily Trending of PowerShell in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>LuccaSA/PingCastle-Notify</title>
    <updated>2024-05-02T01:30:14Z</updated>
    <id>tag:github.com,2024-05-02:/LuccaSA/PingCastle-Notify</id>
    <link href="https://github.com/LuccaSA/PingCastle-Notify" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Monitor your PingCastle scans to highlight the rule diff between two scans&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;PingCastle Notify&lt;/h1&gt; &#xA;&lt;p&gt;PingCastle Notify is a tool that will monitor your PingCastle reports ! You will be notified every time a change between a scan and a previous scan is made.&lt;/p&gt; &#xA;&lt;p&gt;How it works ? PingCastle-Notify is a PS1 script that will run a PingCastle scan, compare the difference between a previous scan, highlight the diff and send the result into a Slack / Teams channel or a log file !&lt;/p&gt; &#xA;&lt;p&gt;The slack/teams/log message will notify you regarding the different states: correction, recession etc&lt;/p&gt; &#xA;&lt;p align=&#34;center&#34;&gt; &lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/LuccaSA/PingCastle-Notify/assets/5891788/35eb7e52-600e-4c15-bcb3-f57bf0b2a89f&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;span&gt;âš &lt;/span&gt; If you don&#39;t want to use Slack or Teams set the variable &lt;code&gt;$teams&lt;/code&gt; and &lt;code&gt;$slack&lt;/code&gt; to 0 inside the ps1 script. Skip the step &#34;Create a BOT&#34; and check the log file inside the &lt;strong&gt;Reports&lt;/strong&gt; folder.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;First scan&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;table&gt; &#xA;  &lt;thead&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Slack&lt;/th&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Teams&lt;/th&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/thead&gt; &#xA;  &lt;tbody&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191265007-57656f04-12ed-4e93-af36-90b0711aa412.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/193760283-ef171f2d-6992-44b7-ad8e-8b3f113ffe3d.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/tbody&gt; &#xA; &lt;/table&gt; &#xA;&lt;/details&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;No new vulnerability but some rules have been updated&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191266282-cd790c58-76df-4116-89fa-4aa954f0dd7e.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;/details&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;New vulnerabilty&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;table&gt; &#xA;  &lt;thead&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Slack&lt;/th&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Teams&lt;/th&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/thead&gt; &#xA;  &lt;tbody&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191268156-cb1c1884-beef-421e-9aae-75661e071abf.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/193760136-668fca48-9ddf-47dd-b82a-0708117954f1.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/tbody&gt; &#xA; &lt;/table&gt; &#xA;&lt;/details&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;Some vulnerability have been removed&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;table&gt; &#xA;  &lt;thead&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Slack&lt;/th&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Teams&lt;/th&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/thead&gt; &#xA;  &lt;tbody&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191265798-0ef01763-6401-4c51-9d7d-8bf6f5ab246d.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/193760223-8658c35c-0ef3-4012-8679-8946987f4e4a.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/tbody&gt; &#xA; &lt;/table&gt; &#xA;&lt;/details&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;No new vulnerability&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;p&gt;No result in slack since reports are the same&lt;/p&gt; &#xA;&lt;/details&gt; &#xA;&lt;hr&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;ðŸ”°&lt;/span&gt; &lt;b&gt;Adding the result of the current scan&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;p&gt;Set the variable &lt;code&gt;$print_current_result&lt;/code&gt; to 1 in the script, the rules flagged on the current scan will be added as a thread into Slack or after the rule diff on Teams.&lt;/p&gt; &#xA; &lt;table&gt; &#xA;  &lt;thead&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Slack&lt;/th&gt; &#xA;    &lt;th align=&#34;center&#34;&gt;Teams&lt;/th&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/thead&gt; &#xA;  &lt;tbody&gt; &#xA;   &lt;tr&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/194527966-f13e0f85-cff6-4e22-86b1-00f871b29cc2.png&#34; alt=&#34;image&#34;&gt;&lt;/td&gt; &#xA;    &lt;td align=&#34;center&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/194527837-8f6f0910-aa17-47d2-bfee-01d4defa569b.png&#34; alt=&#34;Teams_8N2r3YiVh4&#34;&gt;&lt;/td&gt; &#xA;   &lt;/tr&gt; &#xA;  &lt;/tbody&gt; &#xA; &lt;/table&gt; &#xA;&lt;/details&gt; &#xA;&lt;h2&gt;How to install ?&lt;/h2&gt; &#xA;&lt;h3&gt;Structure of the project&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;SECU-TOOL-SCAN/&#xA;    - PingCastle-Notify.ps1&#xA;    - PingCastle/&#xA;        - Reports/&#xA;            - domain.local.xml&#xA;            - domain.local.html&#xA;            - scan.logs &amp;lt;-- contains the logs of the scan (diff scan)&#xA;        - Pingcastle.exe&#xA;        - ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;PingCastle &amp;amp; PingCastle-Notify.ps1&lt;/h4&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Download PingCastle&lt;/li&gt; &#xA; &lt;li&gt;Unzip the archive&lt;/li&gt; &#xA; &lt;li&gt;Create a &#34;&lt;strong&gt;Reports&lt;/strong&gt;&#34; folder inside the PingCastle folder&lt;/li&gt; &#xA; &lt;li&gt;Download and add the file &lt;code&gt;PingCastle-Notify.ps1&lt;/code&gt; on the parent directory&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h4&gt;Create a BOT&lt;/h4&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;Slack BOT&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;ol&gt; &#xA;  &lt;li&gt;In Slack create an application &lt;a href=&#34;https://api.slack.com/apps&#34;&gt;https://api.slack.com/apps&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;li&gt;Add the following rights &#xA;   &lt;ul&gt; &#xA;    &lt;li&gt;Click on &#34;Add features and functionality&#34; -&amp;gt; Bots (configure the name)&lt;/li&gt; &#xA;    &lt;li&gt;Click on &#34;Add features and functionality&#34; -&amp;gt; Permissions (add the following permissions)&lt;/li&gt; &#xA;    &lt;li&gt;Generate a &#34;Bot User OAuth Token&#34; on the Permissions tab&lt;/li&gt; &#xA;   &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;/ol&gt; &#xA; &lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191264679-7942173b-bb1f-4dd1-a936-4e97acdb1b5e.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA; &lt;ol start=&#34;3&#34;&gt; &#xA;  &lt;li&gt;Get your token add it to the PingCastle-Notify.ps1 script&lt;/li&gt; &#xA;  &lt;li&gt;Create a slack channel and add your bot user to the channel&lt;/li&gt; &#xA;  &lt;li&gt;You can test your bot using &lt;a href=&#34;https://api.slack.com/methods/chat.postMessage/test&#34;&gt;https://api.slack.com/methods/chat.postMessage/test&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;li&gt;Add the channel to the script&lt;/li&gt; &#xA;  &lt;li&gt;Run the script to test using this command: &lt;code&gt;powershell.exe -exec bypass C:\YOUR_PATH\SECU-TOOL-SCAN\PingCastle-Notify.ps1&lt;/code&gt;&lt;/li&gt; &#xA; &lt;/ol&gt; &#xA;&lt;/details&gt; &#xA;&lt;details&gt; &#xA; &lt;summary&gt;&lt;span&gt;â–¶&lt;/span&gt; &lt;b&gt;Teams BOT&lt;/b&gt;&lt;/summary&gt; &#xA; &lt;ol&gt; &#xA;  &lt;li&gt;Create a channel &lt;strong&gt;pingcastle-scan&lt;/strong&gt;&lt;/li&gt; &#xA;  &lt;li&gt;Click on the &#34;...&#34; dots and select &#34;Connectors&#34;&lt;/li&gt; &#xA;  &lt;li&gt;Search for &lt;strong&gt;Webhook&lt;/strong&gt;&lt;/li&gt; &#xA;  &lt;li&gt;Add the webhook&lt;/li&gt; &#xA;  &lt;li&gt;Re-click on the connectors button and on the webhook click &lt;strong&gt;&#34;configure&#34;&lt;/strong&gt;&lt;/li&gt; &#xA;  &lt;li&gt;Add a title and a logo and click &lt;strong&gt;Create&lt;/strong&gt;, copy the wehbook URL&lt;/li&gt; &#xA;  &lt;li&gt;Add the url on the variable &lt;code&gt;$teamsUri&lt;/code&gt;&lt;/li&gt; &#xA;  &lt;li&gt;Set the variable &lt;code&gt;$teams&lt;/code&gt; to 1 and &lt;code&gt;$slack&lt;/code&gt; to 0&lt;/li&gt; &#xA; &lt;/ol&gt; &#xA;&lt;/details&gt; &#xA;&lt;h4&gt;Deploy a Scheduled Task&lt;/h4&gt; &#xA;&lt;p&gt;On your Windows Server go to&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Create a service account that will run the PS1 script every night (no need to set the service account as domain admin)&lt;/li&gt; &#xA; &lt;li&gt;Give privileges to the service account on the folder &#34;Reports&#34;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191264615-ab0b9479-b869-4cbf-9e74-499ca0b38c4e.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt; &#xA;&lt;ol start=&#34;3&#34;&gt; &#xA; &lt;li&gt;Run taskschd.msc to open the Scheduler Task&lt;/li&gt; &#xA; &lt;li&gt;Create a Task and use the service account you just created&lt;/li&gt; &#xA; &lt;li&gt;In Actions tab set &#34;Start a program&#34; -&amp;gt; &#34;Script&#34;: &lt;code&gt;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&lt;/code&gt; -&amp;gt; &#34;Arguments&#34; -&amp;gt; &lt;code&gt;-exec bypass -f C:\PINGCASTLE\Pingcastle-Notify.ps1&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Give the permission &#34;Log on as Batch Job&#34; to service account &lt;a href=&#34;https://danblee.com/log-on-as-batch-job-rights-for-task-scheduler/&#34;&gt;https://danblee.com/log-on-as-batch-job-rights-for-task-scheduler/&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Run the scheduled task to test the result&lt;/li&gt; &#xA; &lt;li&gt;Enjoy :)&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p align=&#34;center&#34;&gt; &lt;img width=&#34;600&#34; height=&#34;400&#34; src=&#34;https://user-images.githubusercontent.com/5891788/191264530-bb4f2700-d91b-4e94-8bb8-ea57238e90ca.png&#34;&gt; &lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191264565-a5fe4a3c-b14d-4e5a-b6c0-efe741d4591d.png&#34;&gt; &lt;img src=&#34;https://user-images.githubusercontent.com/5891788/191264503-cb3155a9-f2b3-4fed-b6de-eaf35b47a545.png&#34;&gt; &lt;/p&gt; &#xA;&lt;h2&gt;Acknowledgement&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Vincent Le Toux - &lt;a href=&#34;https://twitter.com/mysmartlogon&#34;&gt;https://twitter.com/mysmartlogon&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Romain Tiennot - &lt;a href=&#34;https://github.com/aikiox&#34;&gt;https://github.com/aikiox&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Lilian Arago - &lt;a href=&#34;https://github.com/NahisWayard&#34;&gt;https://github.com/NahisWayard&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Romain Bourgue - &lt;a href=&#34;https://github.com/raomin&#34;&gt;https://github.com/raomin&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;MIT License&lt;/p&gt;</summary>
  </entry>
</feed>