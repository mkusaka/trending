<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub CSS Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-11-19T01:30:07Z</updated>
  <subtitle>Daily Trending of CSS in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>Anonym-tsk/nfqws-keenetic</title>
    <updated>2024-11-19T01:30:07Z</updated>
    <id>tag:github.com,2024-11-19:/Anonym-tsk/nfqws-keenetic</id>
    <link href="https://github.com/Anonym-tsk/nfqws-keenetic" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;nfqws-keenetic&lt;/h1&gt; &#xA;&lt;p&gt;Пакеты для установки &lt;code&gt;nfqws&lt;/code&gt; на маршрутизаторы с поддержкой &lt;code&gt;opkg&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!IMPORTANT] Данный материал подготовлен в научно-технических целях. Использование предоставленных материалов в целях отличных от ознакомления может являться нарушением действующего законодательства. Автор не несет ответственности за неправомерное использование данного материала.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!WARNING] &lt;strong&gt;Вы пользуетесь этой инструкцией на свой страх и риск!&lt;/strong&gt;&lt;/p&gt; &#xA; &lt;p&gt;Автор не несёт ответственности за порчу оборудования и программного обеспечения, проблемы с доступом и потенцией. Подразумевается, что вы понимаете, что вы делаете.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;Изначально написано для роутеров Keenetic с установленным entware. Однако, работоспособность также была проверена на прошивках Padavan и OpenWRT (читайте ниже).&lt;/p&gt; &#xA;&lt;p&gt;Списки проверенного оборудования собираем в &lt;a href=&#34;https://github.com/Anonym-tsk/nfqws-keenetic/discussions/1&#34;&gt;отдельной теме&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Поделиться опытом можно в разделе &lt;a href=&#34;https://github.com/Anonym-tsk/nfqws-keenetic/discussions&#34;&gt;Discussions&lt;/a&gt; или в &lt;a href=&#34;https://t.me/nfqws&#34;&gt;чате&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Если nfqws работает как-то не так, можете попробовать &lt;a href=&#34;https://github.com/Anonym-tsk/tpws-keenetic&#34;&gt;tpws&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Что это?&lt;/h3&gt; &#xA;&lt;p&gt;&lt;code&gt;nfqws&lt;/code&gt; - утилита для модификации TCP соединения на уровне пакетов, работает через обработчик очереди NFQUEUE и raw сокеты.&lt;/p&gt; &#xA;&lt;p&gt;Почитать подробнее можно на &lt;a href=&#34;https://github.com/bol-van/zapret&#34;&gt;странице авторов&lt;/a&gt; (ищите по ключевому слову &lt;code&gt;nfqws&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;h3&gt;Подготовка Keenetic&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;Прочитайте инструкцию полностью, прежде, чем начать что-то делать!&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Рекомендуется игнорировать предложенные провайдером адреса DNS-серверов. Для этого в интерфейсе роутера отметьте пункты &lt;a href=&#34;https://help.keenetic.com/hc/ru/articles/360008609399&#34;&gt;&#34;игнорировать DNS от провайдера&#34;&lt;/a&gt; в настройках IPv4 и IPv6.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Вместе с этим рекомендуется &lt;a href=&#34;https://help.keenetic.com/hc/ru/articles/360007687159&#34;&gt;настроить использование DoT/DoH&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установить entware на маршрутизатор по инструкции &lt;a href=&#34;https://help.keenetic.com/hc/ru/articles/360021888880&#34;&gt;на встроенную память роутера&lt;/a&gt; или &lt;a href=&#34;https://help.keenetic.com/hc/ru/articles/360021214160&#34;&gt;на USB-накопитель&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Через web-интерфейс Keenetic установить пакеты &lt;strong&gt;Протокол IPv6&lt;/strong&gt; (&lt;strong&gt;Network functions &amp;gt; IPv6&lt;/strong&gt;) и &lt;strong&gt;Модули ядра подсистемы Netfilter&lt;/strong&gt; (&lt;strong&gt;OPKG &amp;gt; Kernel modules for Netfilter&lt;/strong&gt; - не путать с &#34;Netflow&#34;). Обратите внимание, что второй компонент отобразится в списке пакетов только после того, как вы отметите к установке первый.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;В разделе &#34;Интернет-фильтры&#34; отключить все сторонние фильтры (NextDNS, SkyDNS, Яндекс DNS и другие).&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Все дальнейшие команды выполняются не в cli роутера, а &lt;strong&gt;в среде entware&lt;/strong&gt;. Подключиться в неё можно несколькими способами:&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Через telnet: в терминале выполнить &lt;code&gt;telnet 192.168.1.1&lt;/code&gt;, а потом &lt;code&gt;exec sh&lt;/code&gt;.&lt;/li&gt; &#xA;   &lt;li&gt;Или же подключиться напрямую через SSH (логин - &lt;code&gt;root&lt;/code&gt;, пароль по умолчанию - &lt;code&gt;keenetic&lt;/code&gt;, порт - 222 или 22). Для этого в терминале написать &lt;code&gt;ssh 192.168.1.1 -l root -p 222&lt;/code&gt;.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!IMPORTANT] &lt;strong&gt;Миграция с версии 1.x.x на 2.x.x:&lt;/strong&gt;&lt;/p&gt; &#xA; &lt;p&gt;Для определения версии выполните команду &lt;code&gt;opkg info nfqws-keenetic&lt;/code&gt; - она работает только на версиях 2.x.x и возвращает информацию о пакете. Если ничего не вернула – у вас установлена старая версия.&lt;/p&gt; &#xA; &lt;p&gt;Никакой специальной миграции не требуется, просто переустановите новую версию по инструкции ниже.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Установка на Keenetic и Entware&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите необходимые зависимости&lt;/p&gt; &lt;pre&gt;&lt;code&gt;opkg update&#xA;opkg install ca-certificates wget-ssl&#xA;opkg remove wget-nossl&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите opkg-репозиторий в систему&lt;/p&gt; &lt;pre&gt;&lt;code&gt;mkdir -p /opt/etc/opkg&#xA;echo &#34;src/gz nfqws-keenetic https://anonym-tsk.github.io/nfqws-keenetic/all&#34; &amp;gt; /opt/etc/opkg/nfqws-keenetic.conf&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Репозиторий универсальный, поддерживаемые архитектуры: &lt;code&gt;mipsel&lt;/code&gt;, &lt;code&gt;mips&lt;/code&gt;, &lt;code&gt;aarch64&lt;/code&gt;, &lt;code&gt;armv7&lt;/code&gt;, &lt;code&gt;x86&lt;/code&gt;, &lt;code&gt;x86_64&lt;/code&gt;.&lt;/p&gt; &#xA;  &lt;details&gt; &#xA;   &lt;summary&gt;Или можете выбрать репозиторий под конкретную архитектуру&lt;/summary&gt; &#xA;   &lt;ul&gt; &#xA;    &lt;li&gt; &lt;p&gt;&lt;code&gt;mips-3.4&lt;/code&gt; &lt;sub&gt;&lt;sup&gt;Keenetic Giga SE (KN-2410), Ultra SE (KN-2510), DSL (KN-2010), Launcher DSL (KN-2012), Duo (KN-2110), Skipper DSL (KN-2112), Hopper DSL (KN-3610)&lt;/sup&gt;&lt;/sub&gt;&lt;/p&gt; &lt;pre&gt;&lt;code&gt;mkdir -p /opt/etc/opkg&#xA;echo &#34;src/gz nfqws-keenetic https://anonym-tsk.github.io/nfqws-keenetic/mips&#34; &amp;gt; /opt/etc/opkg/nfqws-keenetic.conf&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;    &lt;li&gt; &lt;p&gt;&lt;code&gt;mipsel-3.4&lt;/code&gt; &lt;sub&gt;&lt;sup&gt;Keenetic Giga (KN-1010/1011), Ultra (KN-1810), Viva (KN-1910/1912), Hero 4G (KN-2310), Hero 4G+ (KN-2311), Giant (KN-2610), Skipper 4G (KN-2910), Hopper (KN-3810)&lt;/sup&gt;&lt;/sub&gt;&lt;/p&gt; &lt;pre&gt;&lt;code&gt;mkdir -p /opt/etc/opkg&#xA;echo &#34;src/gz nfqws-keenetic https://anonym-tsk.github.io/nfqws-keenetic/mipsel&#34; &amp;gt; /opt/etc/opkg/nfqws-keenetic.conf&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;    &lt;li&gt; &lt;p&gt;&lt;code&gt;aarch64-3.10&lt;/code&gt; &lt;sub&gt;&lt;sup&gt;Keenetic Peak (KN-2710), Ultra (KN-1811), Hopper SE (KN-3812), Keenetic Giga (KN-1012)&lt;/sup&gt;&lt;/sub&gt;&lt;/p&gt; &lt;pre&gt;&lt;code&gt;mkdir -p /opt/etc/opkg&#xA;echo &#34;src/gz nfqws-keenetic https://anonym-tsk.github.io/nfqws-keenetic/aarch64&#34; &amp;gt; /opt/etc/opkg/nfqws-keenetic.conf&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;   &lt;/ul&gt; &#xA;  &lt;/details&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите пакет&lt;/p&gt; &lt;pre&gt;&lt;code&gt;opkg update&#xA;opkg install nfqws-keenetic&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите веб-интерфейс (опционально)&lt;/p&gt; &lt;pre&gt;&lt;code&gt;opkg install nfqws-keenetic-web&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!NOTE] Для авторизации введите имя пользователя и пароль пользователя entware&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!TIP] По-умолчанию php использует только 8Мб памяти. Из-за этого ограничения, могут не загружаться большие списки файлов. Вы можете изменить конфигурацию php самостоятельно:&lt;br&gt; Откройте файл &lt;code&gt;/opt/etc/php.ini&lt;/code&gt; и измените следующие значения&lt;/p&gt; &#xA; &lt;pre&gt;&lt;code&gt;memory_limit = 32M&#xA;post_max_size = 32M&#xA;upload_max_filesize = 16M&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h5&gt;Обновление&lt;/h5&gt; &#xA;&lt;pre&gt;&lt;code&gt;opkg update&#xA;opkg upgrade nfqws-keenetic&#xA;opkg upgrade nfqws-keenetic-web&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h5&gt;Удаление&lt;/h5&gt; &#xA;&lt;pre&gt;&lt;code&gt;opkg remove --autoremove nfqws-keenetic-web nfqws-keenetic&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h5&gt;Информация об установленной версии&lt;/h5&gt; &#xA;&lt;pre&gt;&lt;code&gt;opkg info nfqws-keenetic&#xA;opkg info nfqws-keenetic-web&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Установка на OpenWRT&lt;/h3&gt; &#xA;&lt;p&gt;Пакет работает только с &lt;code&gt;iptables&lt;/code&gt;. Если в вашей системе используется &lt;code&gt;nftables&lt;/code&gt;, придется удалить &lt;code&gt;nftables&lt;/code&gt; и &lt;code&gt;firewall4&lt;/code&gt;, и установить &lt;code&gt;firewall3&lt;/code&gt; и &lt;code&gt;iptables&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Проверить, что ваша система использует &lt;code&gt;nftables&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;ls -la /sbin/fw4&#xA;which nft&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите необходимые зависимости&lt;/p&gt; &lt;pre&gt;&lt;code&gt;opkg update&#xA;opkg install ca-certificates wget-ssl&#xA;opkg remove wget-nossl&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите публичный ключ репозитория&lt;/p&gt; &lt;pre&gt;&lt;code&gt;wget -O &#34;/tmp/nfqws-keenetic.pub&#34; &#34;https://anonym-tsk.github.io/nfqws-keenetic/openwrt/nfqws-keenetic.pub&#34;&#xA;opkg-key add /tmp/nfqws-keenetic.pub&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите opkg-репозиторий в систему&lt;/p&gt; &lt;pre&gt;&lt;code&gt;echo &#34;src/gz nfqws-keenetic https://anonym-tsk.github.io/nfqws-keenetic/openwrt&#34; &amp;gt; /etc/opkg/nfqws-keenetic.conf&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Репозиторий универсальный, поддерживаемые архитектуры: &lt;code&gt;mipsel&lt;/code&gt;, &lt;code&gt;mips&lt;/code&gt;, &lt;code&gt;aarch64&lt;/code&gt;, &lt;code&gt;armv7&lt;/code&gt;, &lt;code&gt;x86&lt;/code&gt;, &lt;code&gt;x86_64&lt;/code&gt;. Для добавления поддержки новых устройств, &lt;a href=&#34;https://github.com/Anonym-tsk/nfqws-keenetic/issues/new?template=feature_request.md&amp;amp;title=%5BFeature+request%5D+&#34;&gt;создайте Feature Request&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите пакет&lt;/p&gt; &lt;pre&gt;&lt;code&gt;opkg update&#xA;opkg install nfqws-keenetic&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Установите веб-интерфейс (опционально)&lt;/p&gt; &lt;pre&gt;&lt;code&gt;opkg install nfqws-keenetic-web&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;[!NOTE] NB: Все пути файлов, описанные в этой инструкции, начинающиеся с &lt;code&gt;/opt&lt;/code&gt;, на OpenWRT будут начинаться с корня &lt;code&gt;/&lt;/code&gt;. Например конфиг расположен в &lt;code&gt;/etc/nfqws/nfqws.conf&lt;/code&gt;&lt;/p&gt; &#xA; &lt;p&gt;Для запуска/остановки используйте команду &lt;code&gt;service nfqws-keenetic {start|stop|restart|reload|status}&lt;/code&gt;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Настройки&lt;/h3&gt; &#xA;&lt;p&gt;Файл настроек расположен по пути &lt;code&gt;/opt/etc/nfqws/nfqws.conf&lt;/code&gt;. Для редактирования можно воспользоваться встроенным редактором &lt;code&gt;vi&lt;/code&gt; или установить &lt;code&gt;nano&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;# Интерфейс провайдера. Обычно `eth3` или `eth2.2` для проводного соединения, и `ppp0` для PPPoE&#xA;# Заполняется автоматически при установке&#xA;# Можно ввести несколько интерфейсов, например ISP_INTERFACE=&#34;eth3 nwg1&#34;&#xA;ISP_INTERFACE=&#34;eth3&#34;&#xA;&#xA;# Стратегии обработки HTTPS и QUIC трафика&#xA;NFQWS_ARGS=&#34;--dpi-desync=fake,split2 --dpi-desync-ttl=0 --dpi-desync-repeats=16 --dpi-desync-split-pos=1 --dpi-desync-fooling=md5sig,badseq --dpi-desync-cutoff=d4 --dpi-desync-fake-tls=/opt/etc/nfqws/tls_clienthello.bin&#34;&#xA;NFQWS_ARGS_QUIC=&#34;--filter-udp=443 --dpi-desync=fake --dpi-desync-repeats=11 --dpi-desync-cutoff=d4 --dpi-desync-fake-quic=/opt/etc/nfqws/quic_initial.bin&#34;&#xA;&#xA;# Стратегия обработки UDP трафика (не использует параметры из NFQWS_EXTRA_ARGS)&#xA;NFQWS_ARGS_UDP=&#34;--filter-udp=50000-50099 --dpi-desync=fake --dpi-desync-any-protocol --dpi-desync-repeats=6 --dpi-desync-cutoff=n2&#34;&#xA;&#xA;# Режим работы (auto, list, all)&#xA;NFQWS_EXTRA_ARGS=&#34;--hostlist=/opt/etc/nfqws/user.list --hostlist-auto=/opt/etc/nfqws/auto.list --hostlist-auto-debug=/opt/var/log/nfqws.log --hostlist-exclude=/opt/etc/nfqws/exclude.list&#34;&#xA;&#xA;# Обрабатывать ли IPv6 соединения&#xA;IPV6_ENABLED=1&#xA;&#xA;# TCP порты для iptables&#xA;# Оставьте пустым, если нужно отключить обработку TCP&#xA;# Добавьте порт 80 для обработки HTTP (TCP_PORTS=443,80)&#xA;TCP_PORTS=443&#xA;&#xA;# UDP порты для iptables&#xA;# Оставьте пустым, если нужно отключить обработку UDP&#xA;# Удалите порт 443, если не нужно обрабатывать QUIC&#xA;UDP_PORTS=443,50000:50099&#xA;&#xA;# Логирование в Syslog&#xA;LOG_LEVEL=0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Стратегии применяются ко всем доменам из &lt;code&gt;user.list&lt;/code&gt; и &lt;code&gt;auto.list&lt;/code&gt;, за исключением доменов из &lt;code&gt;exclude.list&lt;/code&gt;. В конфиге есть 3 варианта параметра &lt;code&gt;NFQWS_EXTRA_ARGS&lt;/code&gt; - это режим работы nfqws:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;В режиме &lt;code&gt;list&lt;/code&gt; будут обрабатываться только домены из файла &lt;code&gt;user.list&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;В режиме &lt;code&gt;auto&lt;/code&gt; кроме этого будут автоматически определяться недоступные домены и добавляться в список, по которому &lt;code&gt;nfqws&lt;/code&gt; обрабатывает трафик. Домен будет добавлен, если за 60 секунд будет 3 раза определено, что ресурс недоступен&lt;/li&gt; &#xA; &lt;li&gt;В режиме &lt;code&gt;all&lt;/code&gt; будет обрабатываться весь трафик кроме доменов из списка &lt;code&gt;exclude.list&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;hr&gt; &#xA;&lt;h3&gt;Полезное&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Конфиг-файл &lt;code&gt;/opt/etc/nfqws/nfqws.conf&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Скрипт запуска/остановки &lt;code&gt;/opt/etc/init.d/S51nfqws {start|stop|restart|reload|status}&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Вручную добавить домены в список можно в файле &lt;code&gt;/opt/etc/nfqws/user.list&lt;/code&gt; (один домен на строке, поддомены учитываются автоматически)&lt;/li&gt; &#xA; &lt;li&gt;Автоматически добавленные домены &lt;code&gt;/opt/etc/nfqws/auto.list&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Лог автоматически добавленных доменов &lt;code&gt;/opt/var/log/nfqws.log&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Домены-исключения &lt;code&gt;/opt/etc/nfqws/exclude.list&lt;/code&gt; (один домен на строке, поддомены учитываются автоматически)&lt;/li&gt; &#xA; &lt;li&gt;Проверить, что нужные правила добавлены в таблицу маршрутизации &lt;code&gt;iptables-save | grep &#34;queue-num 200&#34;&lt;/code&gt; &#xA;  &lt;blockquote&gt; &#xA;   &lt;p&gt;Вы должны увидеть похожие строки&lt;/p&gt; &#xA;   &lt;pre&gt;&lt;code&gt;-A POSTROUTING -o eth3 -p tcp -m tcp --dport 443 -m connbytes --connbytes 1:6 --connbytes-mode packets --connbytes-dir original -m mark ! --mark 0x40000000/0x40000000 -j NFQUEUE --queue-num 200 --queue-bypass&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;  &lt;/blockquote&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h3&gt;Если ничего не работает...&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Если ваше устройство поддерживает аппаратное ускорение (flow offloading, hardware nat, hardware acceleration), то iptables могут не работать. При включенном offloading пакет не проходит по обычному пути netfilter. Необходимо или его отключить, или выборочно им управлять.&lt;/li&gt; &#xA; &lt;li&gt;На Keenetic можно попробовать выключить или наоборот включить &lt;a href=&#34;https://help.keenetic.com/hc/ru/articles/214470905&#34;&gt;сетевой ускоритель&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Возможно, стоит выключить службу классификации трафика IntelliQOS.&lt;/li&gt; &#xA; &lt;li&gt;Можно попробовать отключить IPv6 на сетевом интерфейсе провайдера через веб-интерфейс маршрутизатора.&lt;/li&gt; &#xA; &lt;li&gt;Можно попробовать запретить весь UDP трафик на 443 порт для отключения QUIC: &#xA;  &lt;blockquote&gt; &#xA;   &lt;p&gt;Межсетевой экран → Домашняя сеть → Добавить правило&lt;br&gt; Включить правило: Включено&lt;br&gt; Описание: Блокировать QUIC&lt;br&gt; Действие: Запретить&lt;br&gt; Протокол: UDP&lt;br&gt; Номер порта назначения: Равен 443&lt;br&gt; Остальные параметры оставляем без изменений&lt;/p&gt; &#xA;  &lt;/blockquote&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h3&gt;Частые проблемы&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;code&gt;iptables: No chain/target/match by that name&lt;/code&gt;&lt;br&gt; Не установлен пакет &#34;Модули ядра подсистемы Netfilter&#34;. На Keenetic он появляется в списке пакетов только после установки &#34;Протокол IPv6&#34;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;can&#39;t initialize ip6tables table&lt;/code&gt; и/или &lt;code&gt;Perhaps ip6tables or your kernel needs to be upgraded&lt;/code&gt;&lt;br&gt; Не установлен пакет &#34;Протокол IPv6&#34;. Также, проблема может появляться на старых прошивках 2.xx, выключите поддержку IPv6 в конфиге NFQWS&lt;/li&gt; &#xA; &lt;li&gt;Ошибки вида &lt;code&gt;readlink: not found&lt;/code&gt;, &lt;code&gt;dirname: not found&lt;/code&gt;&lt;br&gt; Обычно возникают не на кинетиках. Решение - установить busybox: &lt;code&gt;opkg install busybox&lt;/code&gt; или отдельно пакеты &lt;code&gt;opkg install coreutils-readlink coreutils-dirname&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h3&gt;Как использовать несколько стратегий&lt;/h3&gt; &#xA;&lt;p&gt;По-умолчанию, параметры для запуска &lt;code&gt;nfqws&lt;/code&gt; формируются из двух переменных – &lt;code&gt;$NFQWS_ARGS $NFQWS_EXTRA_ARGS&lt;/code&gt;.&lt;br&gt; Если вы хотите использовать несколько стратегий, можно разделять их параметром &lt;code&gt;--new&lt;/code&gt;. Например, стратегия ниже применит опцию &lt;code&gt;--dpi-desync=fake,split2&lt;/code&gt; для HTTPS запросов к доменам из &lt;code&gt;custom.list&lt;/code&gt;, а для всех остальных, соответствующих настройке &lt;code&gt;NFQWS_EXTRA_ARGS&lt;/code&gt;, будет использовать &lt;code&gt;--dpi-desync=disorder2 --dpi-desync-fooling=md5sig,badseq&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;NFQWS_ARGS=&#34;--filter-tcp=443 --dpi-desync=fake,split2 --hostlist=custom.list --new --dpi-desync=disorder2 --dpi-desync-fooling=md5sig,badseq&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Как подобрать рабочую стратегию NFQWS&lt;/h3&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;Запустить скрипт и следовать его инструкциям&lt;/p&gt; &lt;pre&gt;&lt;code&gt;/bin/sh -c &#34;$(curl -fsSL https://github.com/Anonym-tsk/nfqws-keenetic/raw/master/common/strategy.sh)&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Подробнее можно почитать на &lt;a href=&#34;https://github.com/bol-van/zapret?tab=readme-ov-file#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%B2%D0%B0%D0%B9%D0%B4%D0%B5%D1%80%D0%B0&#34;&gt;исходной странице&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Найденную стратегию вписать в конфиге &lt;code&gt;/opt/etc/nfqws/nfqws.conf&lt;/code&gt; в параметр &lt;code&gt;NFQWS_ARGS&lt;/code&gt;&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;Нравится проект? Поддержи автора &lt;a href=&#34;https://yoomoney.ru/to/410019180291197&#34;&gt;здесь&lt;/a&gt; или &lt;a href=&#34;https://pay.cloudtips.ru/p/054d0666&#34;&gt;тут&lt;/a&gt;. Купи ему немного &lt;span&gt;🍻&lt;/span&gt; или &lt;span&gt;☕&lt;/span&gt;!&lt;/p&gt;</summary>
  </entry>
</feed>