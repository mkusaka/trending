<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub XSLT Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2022-09-13T01:40:24Z</updated>
  <subtitle>Daily Trending of XSLT in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>kangtegong/centos-repo</title>
    <updated>2022-09-13T01:40:24Z</updated>
    <id>tag:github.com,2022-09-13:/kangtegong/centos-repo</id>
    <link href="https://github.com/kangtegong/centos-repo" rel="alternate"></link>
    <summary type="html">&lt;p&gt;centos-mirror-project&lt;/p&gt;&lt;hr&gt;&lt;h2&gt;Reposerver setup and configuration repository&lt;/h2&gt; &#xA;&lt;p&gt;This repository contains tools and config files for full reposerver deployment on CentOS 7.7 minimal OS.&lt;/p&gt; &#xA;&lt;p&gt;Organization:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;├── README.md&#xA;...&#xA;├── deploy.yml    # main deploy playbook&#xA;├── roles         # ansible roles for configuring server&#xA;│&amp;nbsp;&amp;nbsp; ├── ansible.osc-zabbix-agent   # monitoring&#xA;│&amp;nbsp;&amp;nbsp; ├── reposerver_base_os         # basic OS configuration, public mirror configuration and webserver&#xA;│   │   └── files/www-public&#xA;│&amp;nbsp;&amp;nbsp; ├── reposerver_tls             # lentencrypt certificate configuration&#xA;│&amp;nbsp;&amp;nbsp; └── reposerver_project-centos  # CentOS sync project&#xA;│       └── files/www-fake&#xA;...&#xA;├── project-centos  # CentOS project&#xA;│&amp;nbsp;&amp;nbsp; ├── README.md                             # CentOS project README&#xA;│&amp;nbsp;&amp;nbsp; ├── deploy_project-centos.yml             # deployment playbook for CentOS project&#xA;│&amp;nbsp;&amp;nbsp; ├── roles                                 # directory with roles for this project&#xA;│&amp;nbsp;&amp;nbsp; └── zabbix_tmpl_CentOS_mirror_checks.xml  # monitoring template for Zabbix&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Monitoring of reposerver&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;CentOS main mirror sync status - &lt;a href=&#34;https://mirror-status.centos.org/#kr&#34;&gt;CentOS mirror-status&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;Zabbix monitoring &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;host &#39;reposerver&#39;&lt;/li&gt; &#xA;   &lt;li&gt;dashboard widget for daily transfered data&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/kangtegong/centos-repo/master/zabbix_dashboard_widget.png&#34; alt=&#34;dashboard daily sent data widget&#34;&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;log files &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;mirroring scripts - &lt;code&gt;/var/log/cron_project-centos.log&lt;/code&gt;&lt;/li&gt; &#xA;   &lt;li&gt;SSL auto-renewal script - &lt;code&gt;/var/log/getssl.log&lt;/code&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;used disk space &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;on mirror filesystem &lt;code&gt;/data&lt;/code&gt;&lt;/li&gt; &#xA;   &lt;li&gt;on VDO device &lt;code&gt;vdostats --human-readable&lt;/code&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code&gt;# lsblk&#xA;...&#xA;sdb                8:16   0 372.5G  0 disk&#xA;└─vdo_data       253:2    0   500G  0 vdo  /data&#xA;# df -h |grep data&#xA;/dev/mapper/vdo_data      500G  397G  104G  80% /data&#xA;# vdostats --human-readable&#xA;Device                    Size      Used Available Use% Space saving%&#xA;/dev/mapper/vdo_data    372.5G    283.2G     89.3G  76%           30%&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Manual sync of CentOS repository&lt;/h3&gt; &#xA;&lt;p&gt;Use modified command from &lt;code&gt;/etc/cron.reposerver.d/project-centos/01_sync_script.sh&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;# flock -n -E 2 /data/centos -c &#39;timeout 4h rsync -avzH4 --progress --delay-updates --delete msync.centos.org::CentOS /data/centos/&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Base OS configuration deployment steps:&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;download this repository as ZIP archive&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;on minimal CentOS 7.x server install &lt;code&gt;unzip&lt;/code&gt; package and copy the ZIP archive to server&lt;/p&gt; &lt;pre&gt;&lt;code&gt;$ scp &#39;reposerver-master@xxxxxxxxxxx.zip&#39; root@reposerver:&#xA;# yum install unzip&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;extract the ZIP archive into &lt;code&gt;/reposerver&lt;/code&gt; directory&lt;/p&gt; &lt;pre&gt;&lt;code&gt;# mkdir /reposerver&#xA;# unzip reposerver-master\@7119315f759.zip -d /reposerver&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;adjust the &lt;code&gt;vdo_disk&lt;/code&gt; and &lt;code&gt;vdo_disk_size&lt;/code&gt; in &lt;code&gt;/reposerver/deploy.yml&lt;/code&gt; if needed:&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;vdo_disk&lt;/code&gt; - path to disk that will be used for storing repository data&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;vdo_disk_size&lt;/code&gt; - virtual size of &lt;code&gt;vdo_disk&lt;/code&gt;, this can be larger than physical size because data are automatically de-duplicated&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;enable EPEL and install &lt;code&gt;ansible&lt;/code&gt;&lt;/p&gt; &lt;pre&gt;&lt;code&gt;# yum install epel-release&#xA;# yum install ansible&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;apply &lt;code&gt;deploy.yml&lt;/code&gt; playbook from the &lt;code&gt;/reposerver&lt;/code&gt; directory to run basic configuration of reposerver&lt;/p&gt; &lt;pre&gt;&lt;code&gt;# cd /reposerver&#xA;# ansible-playbook deploy.yml&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;REBOOT&lt;/p&gt; &lt;pre&gt;&lt;code&gt;# reboot&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;check the state of server and services:&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;run the &lt;code&gt;deploy.yml&lt;/code&gt; playbook with &lt;code&gt;--check&lt;/code&gt; option and check that there are NO &#39;changed&#39; tasks. &lt;strong&gt;NOTE:&lt;/strong&gt; When running this check after server was running for some time, then it is expected that few &#39;changed&#39; tasks will appear.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;pre&gt;&lt;code&gt;# cd /reposerver&#xA;# ansible-playbook deploy.yml --check&#xA;...&#xA;PLAY RECAP ******************************************************************&#xA;localhost: ok=46 changed=0 unreachable=0 failed=0 skipped=2 rescued=0 ignored=0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;VDO disk is mounted on &lt;code&gt;/data/&lt;/code&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;pre&gt;&lt;code&gt;# df -h |grep data&#xA;/dev/mapper/vdo_data      500G   33M  500G   1% /data&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;HTTP server default site check&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;pre&gt;&lt;code&gt;# curl http://127.0.0.1/&#xA;This is default server page that should redirect in future to public mirro page.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;HTTP server public site check&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;pre&gt;&lt;code&gt;# curl -H &#39;Host: mirror.opensourcelab.co.kr&#39; http://127.0.0.1/&#xA;&amp;lt;html&amp;gt;&#xA;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;OpenSource Consulting Public Mirror Site&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;&amp;lt;img src=&#34;https://osci.kr/images/main/header_logo_c.png&#34; alt=&#34;OSC logo&#34;/&amp;gt;&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;RSYNC server check&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;pre&gt;&lt;code&gt;# rsync 127.0.0.1::&#xA;===============================================================&#xA;Welcome on OpenSource Consulting (OSC) public mirror rsync server&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;TLS certificate renewal&lt;/h3&gt; &#xA;&lt;p&gt;This process is automated and every &#39;Monday at 7:30 am&#39; cron will run &lt;code&gt;getssl -a&lt;/code&gt; to renew any certificates that needs update. Logs are stored at &lt;code&gt;/var/log/getssl.log&lt;/code&gt;&lt;/p&gt;</summary>
  </entry>
</feed>