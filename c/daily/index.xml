<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub C Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-05-07T01:31:17Z</updated>
  <subtitle>Daily Trending of C in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>shchmue/Lockpick_RCM</title>
    <updated>2023-05-07T01:31:17Z</updated>
    <id>tag:github.com,2023-05-07:/shchmue/Lockpick_RCM</id>
    <link href="https://github.com/shchmue/Lockpick_RCM" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Nintendo Switch encryption key derivation bare metal RCM payload&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Lockpick_RCM&lt;/h1&gt; &#xA;&lt;p&gt;Lockpick_RCM is a bare metal Nintendo Switch payload that derives encryption keys for use in Switch file handling software like hactool, hactoolnet/LibHac, ChoiDujour, etc. without booting Horizon OS.&lt;/p&gt; &#xA;&lt;p&gt;Due to changes imposed by firmware 7.0.0, Lockpick homebrew can no longer derive the latest keys. In the boot-time environment however, there is no such limitation.&lt;/p&gt; &#xA;&lt;h1&gt;Usage&lt;/h1&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;It is highly recommended, but not required, to place Minerva on SD from the latest &lt;a href=&#34;https://github.com/CTCaer/hekate/releases&#34;&gt;Hekate&lt;/a&gt; for best performance, especially while dumping titlekeys - the file and path is &lt;code&gt;/bootloader/sys/libsys_minerva.bso&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;Launch Lockpick_RCM.bin using your favorite payload injector or chainloader&lt;/li&gt; &#xA; &lt;li&gt;Upon completion, keys will be saved to &lt;code&gt;/switch/prod.keys&lt;/code&gt; and titlekeys to &lt;code&gt;/switch/title.keys&lt;/code&gt; on SD&lt;/li&gt; &#xA; &lt;li&gt;This release bundles the Falcon keygen from &lt;a href=&#34;https://github.com/Atmosphere-NX/Atmosphere&#34;&gt;Atmosph√®re-NX&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Mariko-Specific Keys&lt;/h1&gt; &#xA;&lt;p&gt;Mariko consoles have several unique keys and protected keyslots. To get your SBK or the Mariko specific keys, you will need to use the &lt;code&gt;/switch/partialaes.keys&lt;/code&gt; file along with a brute forcing tool such as &lt;a href=&#34;https://files.sshnuke.net/PartialAesKeyCrack.zip&#34;&gt;https://files.sshnuke.net/PartialAesKeyCrack.zip&lt;/a&gt;. The contents of this file are the keyslot number followed by the result of that keyslot encrypting 16 null bytes. With the tool linked above, enter them in sequence for a given keyslot you want the contents of, for example: &lt;code&gt;PartialAesKeyCrack.exe &amp;lt;num1&amp;gt; &amp;lt;num2&amp;gt; &amp;lt;num3&amp;gt; &amp;lt;num4&amp;gt;&lt;/code&gt; with the &lt;code&gt;--numthreads=N&lt;/code&gt; where N is the number of threads you can dedicate to the brute force.&lt;/p&gt; &#xA;&lt;p&gt;The keyslots are as follows, with names recognized by &lt;code&gt;hactool&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;0-11 - &lt;code&gt;mariko_aes_class_key_xx&lt;/code&gt; (this is not used by the Switch but is set by the bootrom; hactoolnet recognizes it but it serves no purpose)&lt;/li&gt; &#xA; &lt;li&gt;12 - &lt;code&gt;mariko_kek&lt;/code&gt; (not unique - this is used for master key derivation)&lt;/li&gt; &#xA; &lt;li&gt;13 - &lt;code&gt;mariko_bek&lt;/code&gt; (not unique - this is used for BCT and package1 decryption)&lt;/li&gt; &#xA; &lt;li&gt;14 - &lt;code&gt;secure_boot_key&lt;/code&gt; (console unique - this isn&#39;t needed for further key derivation than what Lockpick_RCM does but might be nice to have for your records)&lt;/li&gt; &#xA; &lt;li&gt;15 - Secure storage key (console unique - this is not used on retail or dev consoles and not recognized by any tools)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;So if you want to brute force the &lt;code&gt;mariko_kek&lt;/code&gt;, open your &lt;code&gt;partialaes.keys&lt;/code&gt; and observe the numbers beneath keyslot 12. Here&#39;s an example with fake numbers:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;12&#xA;11111111111111111111111111111111 22222222222222222222222222222222 33333333333333333333333333333333 44444444444444444444444444444444&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then take those numbers and open a command prompt window at the location of the exe linked above and type: &lt;code&gt;PartialAesKeyCrack.exe 11111111111111111111111111111111 22222222222222222222222222222222 33333333333333333333333333333333 44444444444444444444444444444444&lt;/code&gt; and if you&#39;re on a powerful enough multicore system, add &lt;code&gt; --numthreads=[whatever number of threads]&lt;/code&gt;, ideally not your system&#39;s maximum if it&#39;s, for example, an older laptop with a low-end dual core CPU. On a Ryzen 3900x with 24 threads this generates a lot of heat but finishes in about 45 seconds.&lt;/p&gt; &#xA;&lt;p&gt;These keys never change so a brute force need only be conducted once.&lt;/p&gt; &#xA;&lt;p&gt;This works due to the security engine immediately flushing writes to keyslots which can be written one 32-bit chunk at a time. See: &lt;a href=&#34;https://switchbrew.org/wiki/Switch_System_Flaws#Hardware&#34;&gt;https://switchbrew.org/wiki/Switch_System_Flaws#Hardware&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Building&lt;/h1&gt; &#xA;&lt;p&gt;Install &lt;a href=&#34;https://devkitpro.org/&#34;&gt;devkitARM&lt;/a&gt; and run &lt;code&gt;make&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h1&gt;Massive Thanks to CTCaer!&lt;/h1&gt; &#xA;&lt;p&gt;This software is heavily based on &lt;a href=&#34;https://github.com/CTCaer/hekate&#34;&gt;Hekate&lt;/a&gt;. Beyond that, CTCaer was exceptionally helpful in the development of this project, lending loads of advice, expertise, and humor.&lt;/p&gt; &#xA;&lt;h1&gt;License&lt;/h1&gt; &#xA;&lt;p&gt;This project is under the GPLv2 license. The Save processing module is adapted from &lt;a href=&#34;https://github.com/SciresM/hactool&#34;&gt;hactool&lt;/a&gt; code under ISC.&lt;/p&gt;</summary>
  </entry>
</feed>