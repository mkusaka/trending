<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub C# Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-05-19T01:32:05Z</updated>
  <subtitle>Daily Trending of C# in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>vdohney/keepass-password-dumper</title>
    <updated>2023-05-19T01:32:05Z</updated>
    <id>tag:github.com,2023-05-19:/vdohney/keepass-password-dumper</id>
    <link href="https://github.com/vdohney/keepass-password-dumper" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;KeePass 2.X Master Password Dumper (&lt;a href=&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32784&#34;&gt;CVE-2023-32784&lt;/a&gt;)&lt;/h1&gt; &#xA;&lt;h2&gt;Update&lt;/h2&gt; &#xA;&lt;p&gt;The vulnerability was assigned &lt;a href=&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32784&#34;&gt;CVE-2023-32784&lt;/a&gt;. It should be fixed in KeePass 2.54, which &lt;a href=&#34;https://sourceforge.net/p/keepass/discussion/329220/thread/f3438e6283/#8a4a&#34;&gt;should come out in the beginning of June 2023&lt;/a&gt;. Thanks again to Dominik Reichl for his fast response and creative fix!&lt;/p&gt; &#xA;&lt;p&gt;Clarification: &lt;strong&gt;the password has to be typed on a keyboard, not copied from a clipboard&lt;/strong&gt; (see the How it works sections).&lt;/p&gt; &#xA;&lt;h3&gt;What can you do&lt;/h3&gt; &#xA;&lt;p&gt;First, &lt;strong&gt;update to KeePass 2.54 or higher&lt;/strong&gt; once available. Second, if you&#39;ve been using KeePass for a long time, your master password (and potentially other passwords) is likely in your pagefile/swapfile and hibernation file. Depending on your paranoia level, you can consider these steps to resolve the issue:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Change your master password&lt;/li&gt; &#xA; &lt;li&gt;Delete hibernation file&lt;/li&gt; &#xA; &lt;li&gt;Delete pagefile/swapfile (can be quite annoying)&lt;/li&gt; &#xA; &lt;li&gt;Overwrite deleted data on the HDD to prevent carving (e.g. &lt;a href=&#34;https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/cipher&#34;&gt;Cipher&lt;/a&gt; with &lt;code&gt;/w&lt;/code&gt; on Windows)&lt;/li&gt; &#xA; &lt;li&gt;Restart your computer&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Or just overwrite your HDD and do a fresh install of your OS.&lt;/p&gt; &#xA;&lt;p&gt;Incomplete list of products &lt;strong&gt;that are not impacted&lt;/strong&gt; (please create a pull request or an issue for adding more). Rule of thumb is that if it isn&#39;t the original KeePass 2.X app written in .NET, it&#39;s likely not affected.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/keepassxreboot/keepassxc/discussions/9433&#34;&gt;KeePassXC&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://www.reddit.com/r/strongbox/comments/13jg2pz/keepass_2x_master_password_dumper_cve202332784/&#34;&gt;Strongbox&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://sourceforge.net/p/keepass/discussion/329220/thread/f3438e6283/#08e1/2240&#34;&gt;KeePass 1.X&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;hr&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;KeePass Master Password Dumper is a simple proof-of-concept tool used to dump the master password from KeePass&#39;s memory. Apart from the first password character, it is mostly able to recover the password in plaintext. No code execution on the target system is required, just a memory dump. It doesn&#39;t matter where the memory comes from - can be the &lt;strong&gt;process dump, swap file (&lt;code&gt;pagefile.sys&lt;/code&gt;), hibernation file (&lt;code&gt;hiberfil.sys&lt;/code&gt;) or RAM dump&lt;/strong&gt; of the entire system. &lt;strong&gt;It doesn&#39;t matter whether or not the workspace is locked&lt;/strong&gt;. It is also possible to dump the password from RAM after KeePass is no longer running, although the chance of that working goes down with the time it&#39;s been since then.&lt;/p&gt; &#xA;&lt;p&gt;Tested with &lt;code&gt;KeePass 2.53.1&lt;/code&gt; on Windows (English). PoC might have issues with different encodings (languages), but that&#39;s not confirmed as of now (see &lt;a href=&#34;https://github.com/vdohney/keepass-password-dumper/issues/3&#34;&gt;issue #3&lt;/a&gt;). Should work for Linux and macOS versions as well. Finding was confirmed by Dominik Reichl, KeePass&#39;s author, &lt;a href=&#34;https://sourceforge.net/p/keepass/discussion/329220/thread/f3438e6283/&#34;&gt;here&lt;/a&gt;. I appreciate Dominik&#39;s fast response. Hopefully it will be fixed soon!&lt;/p&gt; &#xA;&lt;h2&gt;Setup&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://dotnet.microsoft.com/en-us/download&#34;&gt;Install .NET&lt;/a&gt; (most major operating systems supported).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;dotnet run PATH_TO_DUMP&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;The easiest way to test this on Windows is to create a process dump in the task manager by right-clicking the KeePass process and selecting &#34;Create dump file&#34;.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/vdohney/keepass-password-dumper/main/assets/anim.gif&#34; alt=&#34;Usage example&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Should You Be Worried?&lt;/h2&gt; &#xA;&lt;p&gt;Depends on your threat model. &lt;strong&gt;If your computer is already infected by malware that&#39;s running in the background with the privileges of your user, this finding doesn&#39;t make your situation much worse.&lt;/strong&gt; However, it might be easier for the malware to be stealthy and evade the antivirus, since unlike KeeTheft or KeeFarce, no process injection or other type of code execution is necessary.&lt;/p&gt; &#xA;&lt;p&gt;If you have a reasonable suspicion that someone could obtain access to your computer and conduct forensic analysis, this could be bad. Worst case scenario is that the master password will be recovered, despite KeePass being locked or not running at all.&lt;/p&gt; &#xA;&lt;p&gt;If you use full disk encryption with a strong password and your system is clean, you should be fine. No one can steal your passwords remotely over the internet with this finding alone.&lt;/p&gt; &#xA;&lt;h2&gt;How It Works&lt;/h2&gt; &#xA;&lt;p&gt;KeePass 2.X uses a custom-developed text box for password entry, &lt;code&gt;SecureTextBoxEx&lt;/code&gt;. This text box is not only used for the master password entry, but in other places in KeePass as well, like password edit boxes (so the attack can also be used to recover their contents).&lt;/p&gt; &#xA;&lt;p&gt;The flaw exploited here is that for every character typed, a leftover string is created in memory. Because of how .NET works, it is nearly impossible to get rid of it once it gets created. For example, when &#34;Password&#34; is typed, it will result in these leftover strings: •a, ••s, •••s, ••••w, •••••o, ••••••r, •••••••d. The POC application searches the dump for these patterns and offers a likely password character for each position in the password.&lt;/p&gt; &#xA;&lt;p&gt;Reliability of this attack can be influenced depending on how the password was typed and how many passwords were typed per session. However, I&#39;ve discovered that even if there are multiple passwords per session or typos, the way .NET CLR allocates these strings means that they are likely to be nicely ordered in memory. So if three different passwords were typed, you are likely to get three candidates for each character position in that order, which makes it possible to recover all three passwords.&lt;/p&gt; &#xA;&lt;h2&gt;Dev&lt;/h2&gt; &#xA;&lt;p&gt;It&#39;s a quick POC, so likely not very reliable and robust. Please create a pull request if you happen to find an issue and fix it.&lt;/p&gt; &#xA;&lt;p&gt;Allowed password characters are currently hardcoded like this: &lt;code&gt;^[\x20-\x7E]+$&lt;/code&gt; (all printable ASCII characters and space)&lt;/p&gt; &#xA;&lt;h2&gt;Related Projects&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/CMEPW/keepass-dump-masterkey&#34;&gt;Python implementation of the PoC&lt;/a&gt; by &lt;a href=&#34;https://github.com/CMEPW&#34;&gt;CMEPW&lt;/a&gt; (haven&#39;t checked if it works)&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>