<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Dockerfile Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-06-03T01:35:44Z</updated>
  <subtitle>Daily Trending of Dockerfile in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>overliner/ocash-mining-pool</title>
    <updated>2023-06-03T01:35:44Z</updated>
    <id>tag:github.com,2023-06-03:/overliner/ocash-mining-pool</id>
    <link href="https://github.com/overliner/ocash-mining-pool" rel="alternate"></link>
    <summary type="html">&lt;p&gt;This template is for setting up a simple ōCash mining pool and is for educational purposes only.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;ōCash Mining Pool&lt;/h1&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;BEWARE: You should understand how this pool setup works! It involves manipulation with your pool&#39;s private key and password to it so it is crucial to configure it in a secure way. Default setup provides a secure configuration but if you change things, you can end up with your ōCash node being open to the internet and accepting transactions from you pool&#39;s address&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;This template is for setting up a simple ōCash mining pool. It uses a docker-compose to run all needed components, stores all persistent data in docker volumes (ōCash chain, pool database, DAGs...), so containers can be removed, changed, rebuilt and rerun and until you delete these volumes, no data is lost.&lt;/p&gt; &#xA;&lt;h2&gt;Requirements&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;linux machine&lt;/li&gt; &#xA; &lt;li&gt;docker CE, with docker compose plugin / standalone docker-compose - for installing these, refer to &lt;a href=&#34;https://docs.docker.com/engine/install/&#34;&gt;official Docker documentation&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;recent git&lt;/li&gt; &#xA; &lt;li&gt;enough disk space for storage of chain data and pool software database&lt;/li&gt; &#xA; &lt;li&gt;machine has to have port &lt;code&gt;30303&lt;/code&gt; open for ōCash node P2P to works, for accessing the pools REST api from internet also port &lt;code&gt;4000&lt;/code&gt; needs to be open (port numbers can be changed, these are for default setup)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Components&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;ōCash node&lt;/li&gt; &#xA; &lt;li&gt;miningcore pool&lt;/li&gt; &#xA; &lt;li&gt;postgresql database&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Running&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;prepare your Geth keystore, keep it in a secure space&lt;/li&gt; &#xA; &lt;li&gt;clone the pool git repository (&lt;code&gt;git clone https://github.com/blockcollider/ocash-mining-pool.git&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;move to the repository clone (&lt;code&gt;cd ocash-mining-pool&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;copy template configuration files to actual ones (&lt;code&gt;cp .env.example .env &amp;amp;&amp;amp; cp config/config.example.json config/config.json&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;fill in the values in &lt;code&gt;.env&lt;/code&gt; to match your setup&lt;/li&gt; &#xA; &lt;li&gt;fill in the needed values in &lt;code&gt;config/config.json&lt;/code&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;pools.[0].address&lt;/code&gt; is the only needed one for basic setup, must match &lt;code&gt;POOL_ADDRESS&lt;/code&gt; in &lt;code&gt;.env&lt;/code&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;put your keystore in the directory you filled in &lt;code&gt;.env&lt;/code&gt; file&lt;/li&gt; &#xA; &lt;li&gt;put your keystore password in the file you filled in &lt;code&gt;.env&lt;/code&gt; file&lt;/li&gt; &#xA; &lt;li&gt;double check permissions on these two&lt;/li&gt; &#xA; &lt;li&gt;run the containers using &lt;code&gt;docker compose up&lt;/code&gt;, refer to &lt;a href=&#34;https://docs.docker.com/compose/&#34;&gt;Docker Compose documentation&lt;/a&gt; for usage&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;TLS configuration&lt;/h2&gt; &#xA;&lt;p&gt;It is strongly recommended to run the pool only with TLS encryption (pool will serve &lt;code&gt;stratum2+ssl://&lt;/code&gt; endpoint in that case).&lt;/p&gt; &#xA;&lt;h3&gt;Testing setup&lt;/h3&gt; &#xA;&lt;p&gt;This setup will allow you to test the TLS setup, although it creates a testing CA which is not trusted by clients by default (it&#39;s root key is not in common CA stores)&lt;/p&gt; &#xA;&lt;p&gt;For simpliest setup with self-signed certificate, you can use for example &lt;a href=&#34;https://github.com/FiloSottile/mkcert&#34;&gt;&lt;code&gt;mkcert&lt;/code&gt; utility&lt;/a&gt; (refer to you host system package manager how to install this tool, e.g. on Debian it would be &lt;code&gt;apt install mkcert&lt;/code&gt;) for generating the certificate. Mind that miningcore needs &lt;code&gt;pkcs12&lt;/code&gt; key format, so the steps would be:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;em&gt;install the mkcert utility&lt;/em&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;mkcert -install&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;mkcert -cert-file pool-cert.pem -key-file pool-cert.key &amp;lt;POOL_PUBLIC_IP_ADDRESS&amp;gt;&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;openssl pkcs12 -export -out pool-cert-self-signed.pfx -inkey pool-cert.key -in pool-cert.pem&lt;/code&gt; (choose a password or leave blank for no password)&lt;/li&gt; &#xA; &lt;li&gt;put the path from previous step (option &lt;code&gt;-out&lt;/code&gt;) to you &lt;code&gt;.env&lt;/code&gt; file to key &lt;code&gt;POOL_TLS_CERT_PATH&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;change &lt;code&gt;pool[0].ports[0].tls&lt;/code&gt; to &lt;code&gt;true&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;change &lt;code&gt;pool[0].ports[0].tlsPfxPassword&lt;/code&gt; to the certifcate password&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Mind that this setup is solely for testing purposes - you have to advise your clients to ignore certificate validation (e.g. &lt;code&gt;SSL_NOVERIFY=1&lt;/code&gt; when using &lt;code&gt;ethminer&lt;/code&gt;)&lt;/p&gt; &#xA;&lt;h3&gt;Production setup&lt;/h3&gt; &#xA;&lt;p&gt;Simpliest way for using proper valid certificate is having a domain you own pointed to the server IP running the pool setup. Then you can use Let&#39;s Encrypt for generating your keys, the common tool for this is &lt;a href=&#34;https://certbot.eff.org/&#34;&gt;certbot&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Steps (on Debian 10):&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;install certbot (&lt;code&gt;apt install certbot&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;generate the keys with &lt;code&gt;certbot certonly --manual --preferred-challenges dns --email &amp;lt;your email&amp;gt; --domains &amp;lt;your domain&amp;gt;&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;as instructed, create the required TXT DNS record for you domain to pass the validation&lt;/li&gt; &#xA; &lt;li&gt;convert the key to PKCS12 format using &lt;code&gt;openssl pkcs12 -export -out pool-cert.pfx -inkey /etc/letsencrypt/live/&amp;lt;your domain&amp;gt;/privkey.pem -in /etc/letsencrypt/live/&amp;lt;your domain&amp;gt;/fullchain.pem&lt;/code&gt; the PKCS12 key is in file &lt;code&gt;pool-cert.pfx&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;mind that the conversion step needs to be done after each key renewal, so it&#39;s better to use &lt;a href=&#34;https://eff-certbot.readthedocs.io/en/stable/using.html#pre-and-post-validation-hooks&#34;&gt;certbot hooks&lt;/a&gt; to this for you&lt;/li&gt; &#xA; &lt;li&gt;put path to converted &lt;code&gt;pool-cert.pfx&lt;/code&gt; to your &lt;code&gt;.env&lt;/code&gt;s &lt;code&gt;POOL_TLS_CERT_PATH&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;change &lt;code&gt;pool[0].ports[0].tls&lt;/code&gt; to &lt;code&gt;true&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;change &lt;code&gt;pool[0].ports[0].tlsPfxPassword&lt;/code&gt; to the certifcate password&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;TODO&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; Pool web UI&lt;/li&gt; &#xA;&lt;/ul&gt;</summary>
  </entry>
</feed>