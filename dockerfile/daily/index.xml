<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Dockerfile Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-10-31T01:29:58Z</updated>
  <subtitle>Daily Trending of Dockerfile in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>giovtorres/slurm-docker-cluster</title>
    <updated>2024-10-31T01:29:58Z</updated>
    <id>tag:github.com,2024-10-31:/giovtorres/slurm-docker-cluster</id>
    <link href="https://github.com/giovtorres/slurm-docker-cluster" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A Slurm cluster using docker-compose&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Slurm Docker Cluster&lt;/h1&gt; &#xA;&lt;p&gt;&lt;strong&gt;Slurm Docker Cluster&lt;/strong&gt; is a multi-container Slurm cluster designed for rapid deployment using Docker Compose. This repository simplifies the process of setting up a robust Slurm environment for development, testing, or lightweight usage.&lt;/p&gt; &#xA;&lt;h2&gt;üèÅ Getting Started&lt;/h2&gt; &#xA;&lt;p&gt;To get up and running with Slurm in Docker, make sure you have the following tools installed:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://docs.docker.com/get-docker/&#34;&gt;Docker&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://docs.docker.com/compose/install/&#34;&gt;Docker Compose&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Clone the repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git clone https://github.com/giovtorres/slurm-docker-cluster.git&#xA;cd slurm-docker-cluster&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;üì¶ Containers and Volumes&lt;/h2&gt; &#xA;&lt;p&gt;This setup consists of the following containers:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;mysql&lt;/strong&gt;: Stores job and cluster data.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;slurmdbd&lt;/strong&gt;: Manages the Slurm database.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;slurmctld&lt;/strong&gt;: The Slurm controller responsible for job and resource management.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;c1, c2&lt;/strong&gt;: Compute nodes (running &lt;code&gt;slurmd&lt;/code&gt;).&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Persistent Volumes:&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;etc_munge&lt;/code&gt;: Mounted to &lt;code&gt;/etc/munge&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;etc_slurm&lt;/code&gt;: Mounted to &lt;code&gt;/etc/slurm&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;slurm_jobdir&lt;/code&gt;: Mounted to &lt;code&gt;/data&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;var_lib_mysql&lt;/code&gt;: Mounted to &lt;code&gt;/var/lib/mysql&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;var_log_slurm&lt;/code&gt;: Mounted to &lt;code&gt;/var/log/slurm&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;üõ†Ô∏è Building the Docker Image&lt;/h2&gt; &#xA;&lt;p&gt;The version of the Slurm project and the Docker build process can be simplified by using a &lt;code&gt;.env&lt;/code&gt; file, which will be automatically picked up by Docker Compose.&lt;/p&gt; &#xA;&lt;p&gt;Update the &lt;code&gt;SLURM_TAG&lt;/code&gt; and &lt;code&gt;IMAGE_TAG&lt;/code&gt; found in the &lt;code&gt;.env&lt;/code&gt; file and build the image:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose build&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Alternatively, you can build the Slurm Docker image locally by specifying the &lt;a href=&#34;https://github.com/SchedMD/slurm/tags&#34;&gt;SLURM_TAG&lt;/a&gt; as a build argument and tagging the container with a version &lt;em&gt;&lt;strong&gt;(IMAGE_TAG)&lt;/strong&gt;&lt;/em&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker build --build-arg SLURM_TAG=&#34;slurm-21-08-6-1&#34; -t slurm-docker-cluster:21.08.6 .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;üöÄ Starting the Cluster&lt;/h2&gt; &#xA;&lt;p&gt;Once the image is built, deploy the cluster with the default version of slurm using Docker Compose:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose up -d&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To specify a specific version and override what is configured in &lt;code&gt;.env&lt;/code&gt;, specify the &lt;code&gt;IMAGE_TAG&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;IMAGE_TAG=21.08.6 docker compose up -d&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This will start up all containers in detached mode. You can monitor their status using:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose ps&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;üìù Register the Cluster&lt;/h2&gt; &#xA;&lt;p&gt;After the containers are up and running, register the cluster with &lt;strong&gt;SlurmDBD&lt;/strong&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;./register_cluster.sh&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;Tip&lt;/strong&gt;: Wait a few seconds for the daemons to initialize before running the registration script to avoid connection errors like: &lt;code&gt;sacctmgr: error: Problem talking to the database: Connection refused&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;For real-time cluster logs, use:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose logs -f&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;üñ•Ô∏è Accessing the Cluster&lt;/h2&gt; &#xA;&lt;p&gt;To interact with the Slurm controller, open a shell inside the &lt;code&gt;slurmctld&lt;/code&gt; container:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker exec -it slurmctld bash&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Now you can run any Slurm command from inside the container:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;[root@slurmctld /]# sinfo&#xA;PARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST&#xA;normal*      up 5-00:00:00      2   idle c[1-2]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;üßë‚Äçüíª Submitting Jobs&lt;/h2&gt; &#xA;&lt;p&gt;The cluster mounts the &lt;code&gt;slurm_jobdir&lt;/code&gt; volume across all nodes, making job files accessible from the &lt;code&gt;/data&lt;/code&gt; directory. To submit a job:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;[root@slurmctld /]# cd /data/&#xA;[root@slurmctld data]# sbatch --wrap=&#34;hostname&#34;&#xA;Submitted batch job 2&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Check the output of the job:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;[root@slurmctld data]# cat slurm-2.out&#xA;c1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;üîÑ Cluster Management&lt;/h2&gt; &#xA;&lt;h3&gt;Stopping and Restarting:&lt;/h3&gt; &#xA;&lt;p&gt;Stop the cluster without removing the containers:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose stop&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Restart it later:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose start&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Deleting the Cluster:&lt;/h3&gt; &#xA;&lt;p&gt;To completely remove the containers and associated volumes:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker compose down -v&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;‚öôÔ∏è Advanced Configuration&lt;/h2&gt; &#xA;&lt;p&gt;You can modify Slurm configurations (&lt;code&gt;slurm.conf&lt;/code&gt;, &lt;code&gt;slurmdbd.conf&lt;/code&gt;) on the fly without rebuilding the containers. Just run:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;./update_slurmfiles.sh slurm.conf slurmdbd.conf&#xA;docker compose restart&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This makes it easy to add/remove nodes or test new configuration settings dynamically.&lt;/p&gt; &#xA;&lt;h2&gt;ü§ù Contributing&lt;/h2&gt; &#xA;&lt;p&gt;Contributions are welcomed from the community! If you want to add features, fix bugs, or improve documentation:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Fork this repo.&lt;/li&gt; &#xA; &lt;li&gt;Create a new branch: &lt;code&gt;git checkout -b feature/your-feature&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Submit a pull request.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;üìÑ License&lt;/h2&gt; &#xA;&lt;p&gt;This project is licensed under the &lt;a href=&#34;https://raw.githubusercontent.com/giovtorres/slurm-docker-cluster/main/LICENSE&#34;&gt;MIT License&lt;/a&gt;.&lt;/p&gt;</summary>
  </entry>
</feed>