<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Dockerfile Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-01-18T01:33:54Z</updated>
  <subtitle>Daily Trending of Dockerfile in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>carlossg/docker-maven</title>
    <updated>2023-01-18T01:33:54Z</updated>
    <id>tag:github.com,2023-01-18:/carlossg/docker-maven</id>
    <link href="https://github.com/carlossg/docker-maven" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Official Docker image with Maven&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;docker-maven&lt;/h1&gt; &#xA;&lt;h1&gt;Supported tags and respective Dockerfile links&lt;/h1&gt; &#xA;&lt;p&gt;Images are published under:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://hub.docker.com/r/csanchez/maven&#34;&gt;&lt;code&gt;csanchez/maven&lt;/code&gt;&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://hub.docker.com/_/maven&#34;&gt;&lt;code&gt;maven&lt;/code&gt;&lt;/a&gt; (linux and extending Docker official images only)&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/pkgs/container/maven&#34;&gt;&lt;code&gt;ghcr.io/carlossg/maven&lt;/code&gt;&lt;/a&gt; (linux only)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Linux Based Images&lt;/h2&gt; &#xA;&lt;p&gt;See Docker Hub or GitHub Container Registry for an updated list of tags&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-8/Dockerfile&#34;&gt;openjdk-8&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-8-slim/Dockerfile&#34;&gt;openjdk-8-slim&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-11/Dockerfile&#34;&gt;openjdk-11&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-11-slim/Dockerfile&#34;&gt;openjdk-11-slim&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-17/Dockerfile&#34;&gt;openjdk-17&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-17-slim/Dockerfile&#34;&gt;openjdk-17-slim&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-17/Dockerfile&#34;&gt;openjdk-18&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-17-slim/Dockerfile&#34;&gt;openjdk-18-slim&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-8/Dockerfile&#34;&gt;eclipse-temurin-8&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-8-alpine/Dockerfile&#34;&gt;eclipse-temurin-8-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-8-focal/Dockerfile&#34;&gt;eclipse-temurin-8-focal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-11/Dockerfile&#34;&gt;eclipse-temurin-11&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-11-alpine/Dockerfile&#34;&gt;eclipse-temurin-11-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-11-focal/Dockerfile&#34;&gt;eclipse-temurin-11-focal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-16/Dockerfile&#34;&gt;eclipse-temurin-16&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-16-alpine/Dockerfile&#34;&gt;eclipse-temurin-16-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-17/Dockerfile&#34;&gt;eclipse-temurin-17&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-17-alpine/Dockerfile&#34;&gt;eclipse-temurin-17-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-17-focal/Dockerfile&#34;&gt;eclipse-temurin-17-focal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-17/Dockerfile&#34;&gt;eclipse-temurin-19&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-17-alpine/Dockerfile&#34;&gt;eclipse-temurin-19-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/eclipse-temurin-17-focal/Dockerfile&#34;&gt;eclipse-temurin-19-focal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/ibm-semeru-11-focal/Dockerfile&#34;&gt;ibm-semeru-11-focal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/ibm-semeru-17-focal/Dockerfile&#34;&gt;ibm-semeru-17-focal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/ibmjava-8/Dockerfile&#34;&gt;ibmjava-8&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/ibmjava-8-alpine/Dockerfile&#34;&gt;ibmjava-8-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-8/Dockerfile&#34;&gt;amazoncorretto-8&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-11/&#34;&gt;amazoncorretto-11&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-16/&#34;&gt;amazoncorretto-16&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-17/&#34;&gt;amazoncorretto-17&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-19/&#34;&gt;amazoncorretto-19&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/sapmachine-11/&#34;&gt;sapmachine-11&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/sapmachine-17/&#34;&gt;sapmachine-17&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Only under &lt;code&gt;csanchez/maven&lt;/code&gt; and &lt;code&gt;ghcr.io/carlossg/maven&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/azulzulu-11/Dockerfile&#34;&gt;azulzulu-11&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/azulzulu-11-alpine/Dockerfile&#34;&gt;azulzulu-11-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/azulzulu-17/Dockerfile&#34;&gt;azulzulu-17&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/azulzulu-17-alpine/Dockerfile&#34;&gt;azulzulu-17-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/libericaopenjdk-11/Dockerfile&#34;&gt;libericaopenjdk-11&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/libericaopenjdk-11-alpine/Dockerfile&#34;&gt;libericaopenjdk-11-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/libericaopenjdk-17/Dockerfile&#34;&gt;libericaopenjdk-17&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/libericaopenjdk-17-alpine/Dockerfile&#34;&gt;libericaopenjdk-17-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/libericaopenjdk-8/Dockerfile&#34;&gt;libericaopenjdk-8&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/libericaopenjdk-8-alpine/Dockerfile&#34;&gt;libericaopenjdk-8-alpine&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/microsoft-openjdk-11-ubuntu/Dockerfile&#34;&gt;microsoft-openjdk-11-ubuntu&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/microsoft-openjdk-16-ubuntu/Dockerfile&#34;&gt;microsoft-openjdk-16-ubuntu&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/microsoft-openjdk-17-ubuntu/Dockerfile&#34;&gt;microsoft-openjdk-17-ubuntu&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Windows Based Images&lt;/h2&gt; &#xA;&lt;p&gt;See Docker Hub &lt;a href=&#34;https://hub.docker.com/r/csanchez/maven&#34;&gt;&lt;code&gt;csanchez/maven&lt;/code&gt;&lt;/a&gt; for an updated list of tags&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-8-windowsservercore/Dockerfile&#34;&gt;openjdk-8-windowsservercore-1809&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-8-nanoserver/Dockerfile&#34;&gt;openjdk-8-nanoserver&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-11-windowsservercore/Dockerfile&#34;&gt;openjdk-11-windowsservercore-1809&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;del&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/openjdk-11-nanoserver/Dockerfile&#34;&gt;openjdk-11-nanoserver&lt;/a&gt;&lt;/del&gt; &lt;a href=&#34;https://github.com/infosiftr/docker-library-docs/raw/master/openjdk/deprecated.md&#34;&gt;(deprecated)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-8-windowsservercore/Dockerfile&#34;&gt;amazoncorretto-8-windowsservercore-1809&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-11-windowsservercore/Dockerfile&#34;&gt;amazoncorretto-11-windowsservercore-1809&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/amazoncorretto-15-windowsservercore/Dockerfile&#34;&gt;amazoncorretto-15-windowsservercore-1809&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/carlossg/docker-maven/raw/master/azulzulu-11-windowsservercore/Dockerfile&#34;&gt;azulzulu-11-windowsservercore-1809&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;What is Maven?&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;http://maven.apache.org&#34;&gt;Apache Maven&lt;/a&gt; is a software project management and comprehension tool. Based on the concept of a project object model (POM), Maven can manage a project&#39;s build, reporting and documentation from a central piece of information.&lt;/p&gt; &#xA;&lt;h1&gt;How to use this image&lt;/h1&gt; &#xA;&lt;p&gt;You can run a Maven project by using the Maven Docker image directly, passing a Maven command to &lt;code&gt;docker run&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;h3&gt;Linux&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker run -it --rm --name my-maven-project -v &#34;$(pwd)&#34;:/usr/src/mymaven -w /usr/src/mymaven maven:3.3-jdk-8 mvn verify&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Windows&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;docker run -it --rm --name my-maven-project -v &#34;$(Get-Location)&#34;:C:/Src -w C:/Src csanchez/maven:3.3-jdk-8-windows mvn verify&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Windows&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;docker run -it --rm --name my-maven-project -v &#34;$(Get-Location)&#34;:C:/Src -w C:/Src maven:3.3-jdk-8-windows mvn clean install&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Building local Docker image (optional)&lt;/h2&gt; &#xA;&lt;p&gt;This is a base image that you can extend, so it has the bare minimum packages needed. If you add custom package(s) to the &lt;code&gt;Dockerfile&lt;/code&gt;, then you can build your local Docker image like this:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker build --tag my_local_maven:3.8.7-jdk-8 .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Multi-stage Builds&lt;/h1&gt; &#xA;&lt;p&gt;You can build your application with Maven and package it in an image that does not include Maven using &lt;a href=&#34;https://docs.docker.com/engine/userguide/eng-image/multistage-build/&#34;&gt;multi-stage builds&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;# build&#xA;FROM maven&#xA;WORKDIR /usr/src/app&#xA;COPY pom.xml .&#xA;RUN mvn -B -e -C -T 1C org.apache.maven.plugins:maven-dependency-plugin:3.1.2:go-offline&#xA;COPY . .&#xA;RUN mvn -B -e -o -T 1C verify&#xA;&#xA;# package without maven&#xA;FROM openjdk&#xA;COPY --from=0 /usr/src/app/target/*.jar ./&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Reusing the Maven local repository&lt;/h1&gt; &#xA;&lt;p&gt;The local Maven repository can be reused across containers by creating a volume and mounting it in &lt;code&gt;/root/.m2&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker volume create --name maven-repo&#xA;docker run -it -v maven-repo:/root/.m2 maven mvn archetype:generate # will download artifacts&#xA;docker run -it -v maven-repo:/root/.m2 maven mvn archetype:generate # will reuse downloaded artifacts&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Or you can just use your home .m2 cache directory that you share e.g. with your Eclipse/IDEA:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker run -it --rm -v &#34;$PWD&#34;:/usr/src/mymaven -v &#34;$HOME/.m2&#34;:/root/.m2 -v &#34;$PWD/target:/usr/src/mymaven/target&#34; -w /usr/src/mymaven maven mvn package  &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Packaging a local repository with the image&lt;/h1&gt; &#xA;&lt;p&gt;The &lt;code&gt;$MAVEN_CONFIG&lt;/code&gt; dir (default to &lt;code&gt;/root/.m2&lt;/code&gt; or &lt;code&gt;C:\Users\ContainerUser\.m2&lt;/code&gt;) could be configured as a volume so anything copied there in a Dockerfile at build time is lost. For that reason the dir &lt;code&gt;/usr/share/maven/ref/&lt;/code&gt; (or &lt;code&gt;C:\ProgramData\Maven\Reference&lt;/code&gt;) exists, and anything in that directory will be copied on container startup to &lt;code&gt;$MAVEN_CONFIG&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;To create a pre-packaged repository, create a &lt;code&gt;pom.xml&lt;/code&gt; with the dependencies you need and use this in your &lt;code&gt;Dockerfile&lt;/code&gt;. &lt;code&gt;/usr/share/maven/ref/settings-docker.xml&lt;/code&gt; (&lt;code&gt;C:\ProgramData\Maven\Reference\settings-docker.xml&lt;/code&gt;) is a settings file that changes the local repository to &lt;code&gt;/usr/share/maven/ref/repository&lt;/code&gt; (&lt;code&gt;C:\Programdata\Maven\Reference\repository&lt;/code&gt;), but you can use your own settings file as long as it uses &lt;code&gt;/usr/share/maven/ref/repository&lt;/code&gt; (&lt;code&gt;C:\ProgramData\Maven\Reference\repository&lt;/code&gt;) as local repo.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;COPY pom.xml /tmp/pom.xml&#xA;RUN mvn -B -f /tmp/pom.xml -s /usr/share/maven/ref/settings-docker.xml dependency:resolve&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To add your custom &lt;code&gt;settings.xml&lt;/code&gt; file to the image use&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;COPY settings.xml /usr/share/maven/ref/&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For an example, check the &lt;code&gt;tests&lt;/code&gt; dir&lt;/p&gt; &#xA;&lt;h1&gt;Running as non-root (not supported on Windows)&lt;/h1&gt; &#xA;&lt;p&gt;Maven needs the user home to download artifacts to, and if the user does not exist in the image an extra &lt;code&gt;user.home&lt;/code&gt; Java property needs to be set.&lt;/p&gt; &#xA;&lt;p&gt;For example, to run as the current user (instead of root), mounting the host Maven repo (at &lt;code&gt;~/.m2&lt;/code&gt;)&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker run -v ~/.m2:/var/maven/.m2 -it --rm -u $(id -u) -e MAVEN_CONFIG=/var/maven/.m2 maven mvn -Duser.home=/var/maven archetype:generate&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Image Variants&lt;/h1&gt; &#xA;&lt;p&gt;The &lt;code&gt;maven&lt;/code&gt; images come in many flavors, each designed for a specific use case.&lt;/p&gt; &#xA;&lt;h2&gt;&lt;code&gt;maven:&amp;lt;version&amp;gt;&lt;/code&gt;&lt;/h2&gt; &#xA;&lt;p&gt;This is the defacto image. If you are unsure about what your needs are, you probably want to use this one. It is designed to be used both as a throw away container (mount your source code and start the container to start your app), as well as the base to build other images off of.&lt;/p&gt; &#xA;&lt;h1&gt;Image Verification&lt;/h1&gt; &#xA;&lt;p&gt;Images under &lt;code&gt;csanchez/maven&lt;/code&gt; and &lt;code&gt;ghcr.io/carlossg/maven&lt;/code&gt; are signed with &lt;a href=&#34;https://github.com/sigstore/cosign&#34;&gt;sigstore/cosign&lt;/a&gt; using GitHub OIDC&lt;/p&gt; &#xA;&lt;p&gt;Verification can be done with &lt;code&gt;cosign verify&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;Example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;COSIGN_EXPERIMENTAL=true cosign verify csanchez/maven:3-eclipse-temurin-17&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Building&lt;/h1&gt; &#xA;&lt;p&gt;Build with the usual&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker build -t maven .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Tests are written using &lt;a href=&#34;https://github.com/sstephenson/bats&#34;&gt;bats&lt;/a&gt; for Linux images and &lt;a href=&#34;https://github.com/pester/Pester&#34;&gt;pester&lt;/a&gt; for Windows images (requires Pester 4.x) under the &lt;code&gt;tests&lt;/code&gt; dir.&lt;/p&gt; &#xA;&lt;p&gt;Use the env var TAG to choose what image to run tests against.&lt;/p&gt; &#xA;&lt;h3&gt;Linux&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;TAG=eclipse-temurin-17 bats tests&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Windows&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$env:TAG=&#34;openjdk-11&#34; ; Invoke-Pester -Path tests&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;or run all the tests with&lt;/p&gt; &#xA;&lt;h3&gt;Linux&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;for dir in $(/bin/ls -1 -d */ | grep -v &#39;tests\|windows&#39;); do TAG=$(basename $dir) bats tests; done&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Windows&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Get-ChildItem -File -Include &#34;*windows*&#34; | ForEach-Object { Push-Location ; $env:TAG=$_.Name ; Invoke-Pester -Path tests ; Pop-Location }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Bats can be easily installed with &lt;code&gt;brew install bats-core&lt;/code&gt; on OS X.&lt;/p&gt; &#xA;&lt;p&gt;Note that you may first need to:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git submodule init&#xA;git submodule update&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Pester comes with most modern Windows (Windows 10 and Windows Server 2019), but is an older version than required. You may need to follow &lt;a href=&#34;https://blog.damianflynn.com/Windows10-Pester/&#34;&gt;this tutorial&lt;/a&gt; on upgrading Pester to 4.x.&lt;/p&gt; &#xA;&lt;h2&gt;Adding New Images&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Copy an existing dir to the new name and update &lt;code&gt;Dockerfile&lt;/code&gt; as needed.&lt;/li&gt; &#xA; &lt;li&gt;Update &lt;code&gt;README.md&lt;/code&gt; to include the new image.&lt;/li&gt; &#xA; &lt;li&gt;Run &lt;code&gt;github-action-generation.sh&lt;/code&gt; to generate new GitHub Actions for the new image&lt;/li&gt; &#xA; &lt;li&gt;When adding a new JDK then it also needs to be added to the beginning of &lt;code&gt;common.sh&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;When a parent image changes the &lt;code&gt;latest&lt;/code&gt; tag to a new JDK version it can be updated in &lt;code&gt;common.sh&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Publishing to Docker Hub&lt;/h2&gt; &#xA;&lt;p&gt;In order to publish the images a PR needs to be opened against &lt;a href=&#34;https://github.com/docker-library/official-images&#34;&gt;docker-library/official-images&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;For that we use &lt;code&gt;publish.sh&lt;/code&gt; that runs &lt;code&gt;generate-stackbrew-library.sh&lt;/code&gt;&lt;/p&gt; &#xA;&lt;h1&gt;License&lt;/h1&gt; &#xA;&lt;p&gt;View &lt;a href=&#34;https://www.apache.org/licenses/&#34;&gt;license information&lt;/a&gt; for the software contained in this image.&lt;/p&gt; &#xA;&lt;h1&gt;User Feedback&lt;/h1&gt; &#xA;&lt;h2&gt;Issues&lt;/h2&gt; &#xA;&lt;p&gt;If you have any problems with or questions about this image, please contact us through a &lt;a href=&#34;https://github.com/carlossg/docker-maven/issues&#34;&gt;GitHub issue&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;You can also reach many of the official image maintainers via the &lt;code&gt;#docker-library&lt;/code&gt; IRC channel on Freenode.&lt;/p&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;You are invited to contribute new features, fixes, or updates, large or small; we are always thrilled to receive pull requests, and do our best to process them as fast as we can.&lt;/p&gt; &#xA;&lt;p&gt;Before you start to code, we recommend discussing your plans through a &lt;a href=&#34;https://github.com/carlossg/docker-maven/issues&#34;&gt;GitHub issue&lt;/a&gt;, especially for more ambitious contributions. This gives other contributors a chance to point you in the right direction, give you feedback on your design, and help you find out if someone else is working on the same thing.&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>kelseyhightower/lambda-on-cloud-run</title>
    <updated>2023-01-18T01:33:54Z</updated>
    <id>tag:github.com,2023-01-18:/kelseyhightower/lambda-on-cloud-run</id>
    <link href="https://github.com/kelseyhightower/lambda-on-cloud-run" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Tutorial: Running Lambda Functions on Cloud Run&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Lambda Functions on Cloud Run Tutorial&lt;/h1&gt; &#xA;&lt;p&gt;This tutorial walks you through building and deploying an &lt;a href=&#34;https://aws.amazon.com/lambda/&#34;&gt;AWS Lambda&lt;/a&gt; function &lt;a href=&#34;https://aws.amazon.com/blogs/aws/new-for-aws-lambda-container-image-support&#34;&gt;packaged in a container image&lt;/a&gt; to &lt;a href=&#34;https://cloud.google.com/run&#34;&gt;Cloud Run&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Prerequisites&lt;/h2&gt; &#xA;&lt;p&gt;This tutorial assumes you have a GCP and AWS account and the corresponding commandline tools installed.&lt;/p&gt; &#xA;&lt;p&gt;Verify &lt;code&gt;gcloud&lt;/code&gt; is installed:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;gcloud --version&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;Google Cloud SDK 319.0.0&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Verify &lt;code&gt;aws&lt;/code&gt; is installed:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws --version&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws-cli/2.1.6 ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This tutorial leverages &lt;code&gt;docker&lt;/code&gt; to build images locally:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker version&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;Client: Docker Engine - Community&#xA; Version:           19.03.14&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Clone this repo and change into the &lt;code&gt;lambda-on-cloud-run&lt;/code&gt; directory:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;git clone https://github.com/kelseyhightower/lambda-on-cloud-run.git&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;cd lambda-on-cloud-run/&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;This tutorial assumes &lt;code&gt;lambda-on-cloud-run&lt;/code&gt; is the current working directory.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;h2&gt;Testing Locally&lt;/h2&gt; &#xA;&lt;p&gt;In this section you will build and test the &lt;code&gt;sum&lt;/code&gt; Lambda function locally. The &lt;code&gt;sum&lt;/code&gt; function is written in Go using the &lt;a href=&#34;https://github.com/aws/aws-lambda-go&#34;&gt;&lt;code&gt;aws-lambda-go&lt;/code&gt;&lt;/a&gt; Go library. The &lt;code&gt;sum&lt;/code&gt; function adds a set of integers and returns the sum.&lt;/p&gt; &#xA;&lt;p&gt;Example input:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;{&#34;input&#34;: [1,2,3]}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Response:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;{&#34;sum&#34;:6}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Build the &lt;code&gt;sum&lt;/code&gt; Go binary:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;go build .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you attempt to run the &lt;code&gt;sum&lt;/code&gt; binary you&#39;ll get the following error:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;2020/12/02 09:19:15 expected AWS Lambda environment variables [_LAMBDA_SERVER_PORT AWS_LAMBDA_RUNTIME_API] are not defined&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Lambda functions are not servers that listen on a port. Lambda functions are clients that run inside an AWS Lambda environment. In order to test the &lt;code&gt;sum&lt;/code&gt; function locally we need to emulate a working Lambda environment. That&#39;s where the &lt;a href=&#34;https://github.com/aws/aws-lambda-runtime-interface-emulator/&#34;&gt;Lambda Runtime Interface Emulator&lt;/a&gt; comes in.&lt;/p&gt; &#xA;&lt;p&gt;While the Lambda Runtime Interface Emulator was designed to run inside a container image, it can also be run directly on a Linux machine.&lt;/p&gt; &#xA;&lt;p&gt;The emulator checks a few directories during startup so lets create those now:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;sudo mkdir /opt/extensions&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Start the emulator and pass it the relative path to the &lt;code&gt;sum&lt;/code&gt; function binary:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;./aws-lambda-rie ./sum&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;INFO[0000] exec &#39;echo&#39; (cwd=/home/khightower/lambda-on-cloud-run, handler=) &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;At this point the &lt;code&gt;aws-lambda-rie&lt;/code&gt; emulator is up and running on port 8080. Open a separate terminal and submit an event to the &lt;code&gt;sum&lt;/code&gt; function:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;curl -i -X POST \&#xA;  &#34;http://127.0.0.1:8080/2015-03-31/functions/function/invocations&#34; \&#xA;  -d &#39;{&#34;input&#34;: [1,2,3]}&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;HTTP/1.1 200 OK&#xA;Content-Length: 9&#xA;Content-Type: text/plain; charset=utf-8&#xA;&#xA;{&#34;sum&#34;:6}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Build Docker Image&lt;/h2&gt; &#xA;&lt;p&gt;Now that we have proven the &lt;code&gt;sum&lt;/code&gt; function is working. It&#39;s time to package the &lt;code&gt;sum&lt;/code&gt; function binary in a container image using Docker.&lt;/p&gt; &#xA;&lt;p&gt;Build the &lt;code&gt;sum&lt;/code&gt; container image and tag it:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker build -t sum:0.0.1 .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;Successfully built 39e4b4b3bb47&#xA;Successfully tagged sum:0.0.1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;At this point you should have a couple of docker images in your local repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker images&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE&#xA;sum                 0.0.1               39e4b4b3bb47        19 seconds ago      17.4MB&#xA;&amp;lt;none&amp;gt;              &amp;lt;none&amp;gt;              4582118131f5        27 seconds ago      886MB&#xA;golang              1.15.5-buster       6d8772fbd285        13 days ago         839MB&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Deploy to Cloud Run&lt;/h1&gt; &#xA;&lt;p&gt;Before you can deploy to Cloud Run you need to push the &lt;code&gt;sum&lt;/code&gt; container image to Google&#39;s &lt;a href=&#34;https://cloud.google.com/container-registry&#34;&gt;Container Registry&lt;/a&gt; or &lt;a href=&#34;https://cloud.google.com/artifact-registry&#34;&gt;Artifact Registry&lt;/a&gt; as described in &lt;a href=&#34;https://cloud.google.com/run/docs/deploying#images&#34;&gt;Cloud Run docs&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;In this section we are going to push the &lt;code&gt;sum&lt;/code&gt; container image to the same project we plan to deploy to later.&lt;/p&gt; &#xA;&lt;p&gt;Capture the current GCP project ID:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PROJECT_ID=$(gcloud config get-value project)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Tag the &lt;code&gt;sum&lt;/code&gt; container image using a &lt;a href=&#34;https://cloud.google.com/container-registry/docs/pushing-and-pulling#tag_the_local_image_with_the_registry_name&#34;&gt;valid Container Registry name&lt;/a&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker tag sum:0.0.1 gcr.io/${PROJECT_ID}/sum:0.0.1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker images&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;REPOSITORY                 TAG                 IMAGE ID            CREATED             SIZE&#xA;sum                        0.0.1               39e4b4b3bb47        2 minutes ago       17.4MB&#xA;gcr.io/hightowerlabs/sum   0.0.1               39e4b4b3bb47        2 minutes ago       17.4MB&#xA;&amp;lt;none&amp;gt;                     &amp;lt;none&amp;gt;              4582118131f5        2 minutes ago       886MB&#xA;golang                     1.15.5-buster       6d8772fbd285        13 days ago         839MB&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Before you can push to the container registry you need to authenticate:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;gcloud auth configure-docker&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Push the &lt;code&gt;gcr.io/${PROJECT_ID}/sum:0.0.1&lt;/code&gt; image to the container registry:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker push gcr.io/${PROJECT_ID}/sum:0.0.1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;The push refers to repository [gcr.io/hightowerlabs/sum]&#xA;dfcf3d04c699: Pushed &#xA;2745df127edc: Layer already exists &#xA;bd501ff22e48: Pushed &#xA;0.0.1: digest: sha256:87fd1dcfc1d9221b28d4d20d032bf8597e23c4307db06835c8c187576d03c8bf size: 946&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Create the Cloud Run Service&lt;/h2&gt; &#xA;&lt;p&gt;With the &lt;code&gt;sum&lt;/code&gt; container image in place you are now ready to deploy it to Cloud Run.&lt;/p&gt; &#xA;&lt;p&gt;Capture the current GCP project ID:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PROJECT_ID=$(gcloud config get-value project)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Deploy the &lt;code&gt;sum&lt;/code&gt; Cloud Run service:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;gcloud run deploy sum \&#xA;  --allow-unauthenticated \&#xA;  --command &#34;/aws-lambda-rie&#34; \&#xA;  --args &#34;/sum&#34; \&#xA;  --concurrency 80 \&#xA;  --cpu 1 \&#xA;  --image gcr.io/${PROJECT_ID}/sum:0.0.1 \&#xA;  --memory &#39;1G&#39; \&#xA;  --platform managed \&#xA;  --port 8080 \&#xA;  --region us-west1 \&#xA;  --timeout 30&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;Deploying container to Cloud Run service [sum] in project [hightowerlabs] region [us-west1]&#xA;✓ Deploying new service... Done.&#xA;  ✓ Creating Revision... Deploying Revision.&#xA;  ✓ Routing traffic...&#xA;  ✓ Setting IAM Policy...&#xA;Done.&#xA;Service [sum] revision [sum-00001-vev] has been deployed and is serving 100 percent of traffic.&#xA;Service URL: https://sum-XXXXXXXXXX-uw.a.run.app&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Test the Cloud Run Service&lt;/h2&gt; &#xA;&lt;p&gt;Capture the &lt;code&gt;sum&lt;/code&gt; Cloud Run service URL:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;CLOUD_RUN_URL=$(gcloud run services describe sum \&#xA;  --platform managed \&#xA;  --region us-west1 \&#xA;  --format=&#39;value(status.url)&#39;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Submit an event to the &lt;code&gt;sum&lt;/code&gt; Cloud Run service:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;curl -i -X POST \&#xA;  ${CLOUD_RUN_URL}/2015-03-31/functions/function/invocations \&#xA;  -d &#39;{&#34;input&#34;: [1,2,3]}&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;HTTP/2 200 &#xA;date: Wed, 02 Dec 2020 16:54:04 GMT&#xA;content-length: 9&#xA;content-type: text/plain; charset=utf-8&#xA;server: Google Frontend&#xA;&#xA;{&#34;sum&#34;:6}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Deploy to Lambda&lt;/h2&gt; &#xA;&lt;p&gt;I&#39;ll add more details later, but these are the commands to tag and push the &lt;code&gt;sum&lt;/code&gt; container image to ECR, deploy it to Lambda, and invoke the &lt;code&gt;sum&lt;/code&gt; function.&lt;/p&gt; &#xA;&lt;p&gt;Create an ECR repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws ecr create-repository --repository-name sum&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Capture the registry id:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;AWS_REGISTRY_ID=$(aws ecr describe-repositories \&#xA;  --repository-name sum \&#xA;  --query &#39;repositories[0].registryId&#39; \&#xA;  --output text)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Authenticate to the ECR repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws ecr get-login-password --region us-west-2 | \&#xA;  docker login \&#xA;    --username AWS \&#xA;    --password-stdin \&#xA;    ${AWS_REGISTRY_ID}.dkr.ecr.us-west-2.amazonaws.com&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Capture the ECR repository URI:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;AWS_REPOSITORY_URI=$(aws ecr describe-repositories \&#xA;  --repository-name sum \&#xA;  --query &#39;repositories[0].repositoryUri&#39; \&#xA;  --output text)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Tag the &lt;code&gt;sum&lt;/code&gt; container image:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker tag sum:0.0.1 ${AWS_REPOSITORY_URI}:0.0.1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker images&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;REPOSITORY                                         TAG                 IMAGE ID            CREATED             SIZE&#xA;231532395880.dkr.ecr.us-west-2.amazonaws.com/sum   0.0.1               39e4b4b3bb47        2 hours ago         17.4MB&#xA;sum                                                0.0.1               39e4b4b3bb47        2 hours ago         17.4MB&#xA;gcr.io/hightowerlabs/sum                           0.0.1               39e4b4b3bb47        2 hours ago         17.4MB&#xA;&amp;lt;none&amp;gt;                                             &amp;lt;none&amp;gt;              4582118131f5        2 hours ago         886MB&#xA;golang                                             1.15.5-buster       6d8772fbd285        13 days ago         839MB&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Push the container image to GCR:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;docker push ${AWS_REPOSITORY_URI}:0.0.1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;The push refers to repository [231532395880.dkr.ecr.us-west-2.amazonaws.com/sum]&#xA;dfcf3d04c699: Pushed &#xA;2745df127edc: Pushed &#xA;bd501ff22e48: Pushed &#xA;0.0.1: digest: sha256:87fd1dcfc1d9221b28d4d20d032bf8597e23c4307db06835c8c187576d03c8bf size: 946&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Create an IAM role for the &lt;code&gt;sum&lt;/code&gt; lambda function:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws iam create-role \&#xA;  --role-name lambda \&#xA;  --assume-role-policy-document &#39;{&#xA;    &#34;Version&#34;: &#34;2012-10-17&#34;,&#xA;    &#34;Statement&#34;: [{ &#34;Effect&#34;: &#34;Allow&#34;, &#34;Principal&#34;: {&#34;Service&#34;: &#34;lambda.amazonaws.com&#34;}, &#xA;    &#34;Action&#34;: &#34;sts:AssumeRole&#34;}]&#xA;  }&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Capture the role ARN:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;LAMBDA_ROLE_ARN=$(aws iam get-role \&#xA;  --role-name lambda \&#xA;  --query &#39;Role.Arn&#39; \&#xA;  --output text)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Create the Lambda Function&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws lambda create-function \&#xA;  --code &#34;ImageUri=${AWS_REPOSITORY_URI}:0.0.1&#34; \&#xA;  --function-name sum \&#xA;  --package-type Image \&#xA;  --region us-west-2 \&#xA;  --role ${LAMBDA_ROLE_ARN}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Test the Lambda Function&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code&gt;aws lambda invoke \&#xA;  --cli-binary-format raw-in-base64-out \&#xA;  --function-name sum \&#xA;  --payload &#39;{&#34;input&#34;: [1,2,3]}&#39; \&#xA;  response.json&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;{&#xA;    &#34;StatusCode&#34;: 200,&#xA;    &#34;ExecutedVersion&#34;: &#34;$LATEST&#34;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;cat response.json&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code&gt;{&#34;sum&#34;:6}&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>