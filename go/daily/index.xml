<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Go Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2022-09-01T01:33:09Z</updated>
  <subtitle>Daily Trending of Go in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>onsi/ginkgo</title>
    <updated>2022-09-01T01:33:09Z</updated>
    <id>tag:github.com,2022-09-01:/onsi/ginkgo</id>
    <link href="https://github.com/onsi/ginkgo" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A Modern Testing Framework for Go&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;img src=&#34;https://onsi.github.io/ginkgo/images/ginkgo.png&#34; alt=&#34;Ginkgo&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/onsi/ginkgo/actions?query=workflow%3Atest+branch%3Amaster&#34;&gt;&lt;img src=&#34;https://github.com/onsi/ginkgo/workflows/test/badge.svg?branch=master&#34; alt=&#34;test&#34;&gt;&lt;/a&gt; | &lt;a href=&#34;https://onsi.github.io/ginkgo/&#34;&gt;Ginkgo Docs&lt;/a&gt;&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;h1&gt;Ginkgo 2.0 is now Generally Available!&lt;/h1&gt; &#xA;&lt;p&gt;You can learn more about 2.0 in the &lt;a href=&#34;https://onsi.github.io/ginkgo/MIGRATING_TO_V2&#34;&gt;Migration Guide&lt;/a&gt;!&lt;/p&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;Ginkgo is a mature testing framework for Go designed to help you write expressive specs. Ginkgo builds on top of Go&#39;s &lt;code&gt;testing&lt;/code&gt; foundation and is complemented by the &lt;a href=&#34;https://github.com/onsi/gomega&#34;&gt;Gomega&lt;/a&gt; matcher library. Together, Ginkgo and Gomega let you express the intent behind your specs clearly:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;import (&#xA;    . &#34;github.com/onsi/ginkgo/v2&#34;&#xA;    . &#34;github.com/onsi/gomega&#34;&#xA;    ...&#xA;)&#xA;&#xA;Describe(&#34;Checking books out of the library&#34;, Label(&#34;library&#34;), func() {&#xA;    var library *libraries.Library&#xA;    var book *books.Book&#xA;    var valjean *users.User&#xA;    BeforeEach(func() {&#xA;        library = libraries.NewClient()&#xA;        book = &amp;amp;books.Book{&#xA;            Title: &#34;Les Miserables&#34;,&#xA;            Author: &#34;Victor Hugo&#34;,&#xA;        }&#xA;        valjean = users.NewUser(&#34;Jean Valjean&#34;)&#xA;    })&#xA;&#xA;    When(&#34;the library has the book in question&#34;, func() {&#xA;        BeforeEach(func() {&#xA;            Expect(library.Store(book)).To(Succeed())&#xA;        })&#xA;&#xA;        Context(&#34;and the book is available&#34;, func() {&#xA;            It(&#34;lends it to the reader&#34;, func() {&#xA;                Expect(valjean.Checkout(library, &#34;Les Miserables&#34;)).To(Succeed())&#xA;                Expect(valjean.Books()).To(ContainElement(book))&#xA;                Expect(library.UserWithBook(book)).To(Equal(valjean))&#xA;            })&#xA;        })&#xA;&#xA;        Context(&#34;but the book has already been checked out&#34;, func() {&#xA;            var javert *users.User&#xA;            BeforeEach(func() {&#xA;                javert = users.NewUser(&#34;Javert&#34;)&#xA;                Expect(javert.Checkout(library, &#34;Les Miserables&#34;)).To(Succeed())&#xA;            })&#xA;&#xA;            It(&#34;tells the user&#34;, func() {&#xA;                err := valjean.Checkout(library, &#34;Les Miserables&#34;)&#xA;                Expect(error).To(MatchError(&#34;Les Miserables is currently checked out&#34;))&#xA;            })&#xA;&#xA;            It(&#34;lets the user place a hold and get notified later&#34;, func() {&#xA;                Expect(valjean.Hold(library, &#34;Les Miserables&#34;)).To(Succeed())&#xA;                Expect(valjean.Holds()).To(ContainElement(book))&#xA;&#xA;                By(&#34;when Javert returns the book&#34;)&#xA;                Expect(javert.Return(library, book)).To(Succeed())&#xA;&#xA;                By(&#34;it eventually informs Valjean&#34;)&#xA;                notification := &#34;Les Miserables is ready for pick up&#34;&#xA;                Eventually(valjean.Notifications).Should(ContainElement(notification))&#xA;&#xA;                Expect(valjean.Checkout(library, &#34;Les Miserables&#34;)).To(Succeed())&#xA;                Expect(valjean.Books()).To(ContainElement(book))&#xA;                Expect(valjean.Holds()).To(BeEmpty())&#xA;            })&#xA;        })  &#xA;    })&#xA;&#xA;    When(&#34;the library does not have the book in question&#34;, func() {&#xA;        It(&#34;tells the reader the book is unavailable&#34;, func() {&#xA;            err := valjean.Checkout(library, &#34;Les Miserables&#34;)&#xA;            Expect(error).To(MatchError(&#34;Les Miserables is not in the library catalog&#34;))&#xA;        })&#xA;    })&#xA;})&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Jump to the &lt;a href=&#34;https://onsi.github.io/ginkgo/&#34;&gt;docs&lt;/a&gt; to learn more. It&#39;s easy to &lt;a href=&#34;https://onsi.github.io/ginkgo/#bootstrapping-a-suite&#34;&gt;bootstrap&lt;/a&gt; and start writing your &lt;a href=&#34;https://onsi.github.io/ginkgo/#adding-specs-to-a-suite&#34;&gt;first specs&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;If you have a question, comment, bug report, feature request, etc. please open a &lt;a href=&#34;https://github.com/onsi/ginkgo/issues/new&#34;&gt;GitHub issue&lt;/a&gt;, or visit the &lt;a href=&#34;https://app.slack.com/client/T029RQSE6/CQQ50BBNW&#34;&gt;Ginkgo Slack channel&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Capabilities&lt;/h2&gt; &#xA;&lt;p&gt;Whether writing basic unit specs, complex integration specs, or even performance specs - Ginkgo gives you an expressive Domain-Specific Language (DSL) that will be familiar to users coming from frameworks such as &lt;a href=&#34;https://github.com/Quick/Quick&#34;&gt;Quick&lt;/a&gt;, &lt;a href=&#34;https://rspec.info&#34;&gt;RSpec&lt;/a&gt;, &lt;a href=&#34;https://jasmine.github.io&#34;&gt;Jasmine&lt;/a&gt;, and &lt;a href=&#34;https://olivinelabs.com/busted/&#34;&gt;Busted&lt;/a&gt;. This style of testing is sometimes referred to as &#34;Behavior-Driven Development&#34; (BDD) though Ginkgo&#39;s utility extends beyond acceptance-level testing.&lt;/p&gt; &#xA;&lt;p&gt;With Ginkgo&#39;s DSL you can use nestable &lt;a href=&#34;https://onsi.github.io/ginkgo/#organizing-specs-with-container-nodes&#34;&gt;&lt;code&gt;Describe&lt;/code&gt;, &lt;code&gt;Context&lt;/code&gt; and &lt;code&gt;When&lt;/code&gt; container nodes&lt;/a&gt; to help you organize your specs. &lt;a href=&#34;https://onsi.github.io/ginkgo/#extracting-common-setup-beforeeach&#34;&gt;&lt;code&gt;BeforeEach&lt;/code&gt; and &lt;code&gt;AfterEach&lt;/code&gt; setup nodes&lt;/a&gt; for setup and cleanup. &lt;a href=&#34;https://onsi.github.io/ginkgo/#spec-subjects-it&#34;&gt;&lt;code&gt;It&lt;/code&gt; and &lt;code&gt;Specify&lt;/code&gt; subject nodes&lt;/a&gt; that hold your assertions. &lt;a href=&#34;https://onsi.github.io/ginkgo/#suite-setup-and-cleanup-beforesuite-and-aftersuite&#34;&gt;&lt;code&gt;BeforeSuite&lt;/code&gt; and &lt;code&gt;AfterSuite&lt;/code&gt; nodes&lt;/a&gt; to prep for and cleanup after a suite... and &lt;a href=&#34;https://onsi.github.io/ginkgo/#writing-specs&#34;&gt;much more!&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;At runtime, Ginkgo can run your specs in reproducibly &lt;a href=&#34;https://onsi.github.io/ginkgo/#spec-randomization&#34;&gt;random order&lt;/a&gt; and has sophisticated support for &lt;a href=&#34;https://onsi.github.io/ginkgo/#spec-parallelization&#34;&gt;spec parallelization&lt;/a&gt;. In fact, running specs in parallel is as easy as&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;ginkgo -p&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;By following &lt;a href=&#34;https://onsi.github.io/ginkgo/#patterns-for-parallel-integration-specs&#34;&gt;established patterns for writing parallel specs&lt;/a&gt; you can build even large, complex integration suites that parallelize cleanly and run performantly.&lt;/p&gt; &#xA;&lt;p&gt;As your suites grow Ginkgo helps you keep your specs organized with &lt;a href=&#34;https://onsi.github.io/ginkgo/#spec-labels&#34;&gt;labels&lt;/a&gt; and lets you easily run &lt;a href=&#34;https://onsi.github.io/ginkgo/#filtering-specs&#34;&gt;subsets of specs&lt;/a&gt;, either &lt;a href=&#34;https://onsi.github.io/ginkgo/#focused-specs&#34;&gt;programmatically&lt;/a&gt; or on the &lt;a href=&#34;https://onsi.github.io/ginkgo/#combining-filters&#34;&gt;command line&lt;/a&gt;. And Ginkgo&#39;s reporting infrastructure generates machine-readable output in a &lt;a href=&#34;https://onsi.github.io/ginkgo/#generating-machine-readable-reports&#34;&gt;variety of formats&lt;/a&gt; &lt;em&gt;and&lt;/em&gt; allows you to build your own &lt;a href=&#34;https://onsi.github.io/ginkgo/#generating-reports-programmatically&#34;&gt;custom reporting infrastructure&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Ginkgo ships with &lt;code&gt;ginkgo&lt;/code&gt;, a &lt;a href=&#34;https://onsi.github.io/ginkgo/#ginkgo-cli-overview&#34;&gt;command line tool&lt;/a&gt; with support for generating, running, filtering, and profiling Ginkgo suites. You can even have Ginkgo automatically run your specs when it detects a change with &lt;code&gt;ginkgo watch&lt;/code&gt;, enabling rapid feedback loops during test-driven development.&lt;/p&gt; &#xA;&lt;p&gt;And that&#39;s just Ginkgo! &lt;a href=&#34;https://onsi.github.io/gomega/&#34;&gt;Gomega&lt;/a&gt; brings a rich, mature, family of &lt;a href=&#34;https://onsi.github.io/gomega/#provided-matchers&#34;&gt;assertions and matchers&lt;/a&gt; to your suites. With Gomega you can easily mix &lt;a href=&#34;https://onsi.github.io/ginkgo/#patterns-for-asynchronous-testing&#34;&gt;synchronous and asynchronous assertions&lt;/a&gt; in your specs. You can even build your own set of expressive domain-specific matchers quickly and easily by composing Gomega&#39;s &lt;a href=&#34;https://onsi.github.io/ginkgo/#building-custom-matchers&#34;&gt;existing building blocks&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Happy Testing!&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;Ginkgo is MIT-Licensed&lt;/p&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://raw.githubusercontent.com/onsi/ginkgo/master/CONTRIBUTING.md&#34;&gt;CONTRIBUTING.md&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>guangzhengli/k8s-tutorials</title>
    <updated>2022-09-01T01:33:09Z</updated>
    <id>tag:github.com,2022-09-01:/guangzhengli/k8s-tutorials</id>
    <link href="https://github.com/guangzhengli/k8s-tutorials" rel="alternate"></link>
    <summary type="html">&lt;p&gt;k8s tutorials | k8s æ•™ç¨‹&lt;/p&gt;&lt;hr&gt;&lt;h1 align=&#34;center&#34;&gt;Kubernetes Tutorials ï½œ k8s æ•™ç¨‹&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/guangzhengli/k8s-tutorials/network&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/forks/guangzhengli/k8s-tutorials&#34; alt=&#34;GitHub forks&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://github.com/guangzhengli/k8s-tutorials/stargazers&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/stars/guangzhengli/k8s-tutorials&#34; alt=&#34;GitHub stars&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://github.com/guangzhengli/k8s-tutorials/issues&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/issues/guangzhengli/k8s-tutorials&#34; alt=&#34;GitHub issues&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://github.com/guangzhengli/k8s-tutorials/raw/main/LICENSE&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/license/guangzhengli/k8s-tutorials&#34; alt=&#34;GitHub license&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h4 align=&#34;center&#34;&gt;ğŸŒˆ Kubernetes | ğŸ“° Tutorials&lt;/h4&gt; &#xA;&lt;p&gt;k8s ä½œä¸ºäº‘åŸç”Ÿæ—¶ä»£çš„æ“ä½œç³»ç»Ÿï¼Œå­¦ä¹ å®ƒçš„å¿…è¦æ€§ä¸è¨€è€Œå–»ï¼Œå¦‚æœä½ é‡åˆ°äº†ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/guangzhengli/k8s-tutorials/discussions&#34;&gt;Discussions&lt;/a&gt; ä¸­è¯„è®ºæˆ–è€… Issue ä¸­æå‡ºï¼Œå¦‚æœä½ è§‰å¾—è¿™ä¸ªä»“åº“å¯¹ä½ æœ‰ä»·å€¼ï¼Œæ¬¢è¿ start æˆ–è€…æ PR / Issueï¼Œè®©å®ƒå˜å¾—æ›´å¥½ï¼&lt;/p&gt; &#xA;&lt;p&gt;åœ¨å­¦ä¹ æœ¬æ•™ç¨‹å‰ï¼Œéœ€è¦æ³¨æ„æœ¬æ•™ç¨‹ä¾§é‡äºå®æˆ˜å¼•å¯¼ï¼Œä»¥æ¸è¿›å¼ä¿®æ”¹ä»£ç çš„æ–¹å¼ï¼Œå°†ä»æœ€åŸºç¡€çš„ container å®¹å™¨çš„å®šä¹‰å¼€å§‹ï¼Œç»è¿‡ &lt;code&gt;pod&lt;/code&gt;, &lt;code&gt;deployment&lt;/code&gt;, &lt;code&gt;servcie&lt;/code&gt;, &lt;code&gt;ingress&lt;/code&gt;, &lt;code&gt;configmap&lt;/code&gt;, &lt;code&gt;secret&lt;/code&gt; ç­‰èµ„æºç›´åˆ°ç”¨ &lt;code&gt;helm&lt;/code&gt; æ¥æ‰“åŒ…éƒ¨ç½²ä¸€å¥—å®Œæ•´æœåŠ¡ã€‚æ‰€ä»¥å¦‚æœä½ å¯¹å®¹å™¨å’Œ k8s çš„åŸºç¡€ç†è®ºçŸ¥è¯†ä¸ç”šäº†è§£çš„è¯ï¼Œå»ºè®®å…ˆä» &lt;a href=&#34;https://kubernetes.io/zh-cn/docs/home/&#34;&gt;å®˜ç½‘æ–‡æ¡£&lt;/a&gt; æˆ–è€…å…¶å®ƒæ•™ç¨‹è·å–åŸºç¡€ç†è®ºçŸ¥è¯†ï¼Œå†é€šè¿‡å®æˆ˜åŠ æ·±å¯¹çŸ¥è¯†çš„æŒæ¡ï¼&lt;/p&gt; &#xA;&lt;p&gt;è¿™é‡Œæ˜¯æ–‡æ¡£çš„ç´¢å¼•ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/pre.md&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/container.md&#34;&gt;container&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/pod.md&#34;&gt;pod&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/deployment.md&#34;&gt;deployment&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/service.md&#34;&gt;service&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/ingress.md&#34;&gt;ingress&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/namespace.md&#34;&gt;namespace&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/configmap.md&#34;&gt;configmap&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/secret.md&#34;&gt;secret&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/job.md&#34;&gt;job/cronjob&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/helm.md&#34;&gt;helm(å¾…å®Œæˆ)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/docs/dashboard.md&#34;&gt;dashboard(å¾…å®Œæˆ)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;ç¿»è¯‘è‹±æ–‡(æœªå®Œæˆ)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;ä¸‹é¢æ˜¯æ‰€æœ‰æ–‡æ¡£çš„é›†åˆï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#kubernetes-tutorials&#34;&gt;kubernetes tutorials&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%AE%89%E8%A3%85-docker&#34;&gt;å®‰è£… docker&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E6%8E%A8%E8%8D%90%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95&#34;&gt;æ¨èå®‰è£…æ–¹æ³•&lt;/a&gt;&lt;/li&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%85%B6%E5%AE%83%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95&#34;&gt;å…¶å®ƒå®‰è£…æ–¹æ³•&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%AE%89%E8%A3%85-minikube&#34;&gt;å®‰è£… minikube&lt;/a&gt; &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%90%AF%E5%8A%A8-minikube&#34;&gt;å¯åŠ¨ minikube&lt;/a&gt;&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%AE%89%E8%A3%85-kubectl&#34;&gt;å®‰è£… kubectl&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E6%B3%A8%E5%86%8C-docker-hub-%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95&#34;&gt;æ³¨å†Œ docker hub è´¦å·ç™»å½•&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#container&#34;&gt;Container&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#pod&#34;&gt;Pod&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#pod-%E4%B8%8E-container-%E7%9A%84%E4%B8%8D%E5%90%8C&#34;&gt;Pod ä¸ Container çš„ä¸åŒ&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#pod-%E5%85%B6%E5%AE%83%E5%91%BD%E4%BB%A4&#34;&gt;Pod å…¶å®ƒå‘½ä»¤&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#deployment&#34;&gt;Deployment&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E6%89%A9%E5%AE%B9&#34;&gt;æ‰©å®¹&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%8D%87%E7%BA%A7%E7%89%88%E6%9C%AC&#34;&gt;å‡çº§ç‰ˆæœ¬&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#rolling-update%E6%BB%9A%E5%8A%A8%E6%9B%B4%E6%96%B0&#34;&gt;Rolling Update(æ»šåŠ¨æ›´æ–°)&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%AD%98%E6%B4%BB%E6%8E%A2%E9%92%88-livenessprob&#34;&gt;å­˜æ´»æ¢é’ˆ (livenessProb)&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%B0%B1%E7%BB%AA%E6%8E%A2%E9%92%88-readiness&#34;&gt;å°±ç»ªæ¢é’ˆ (readiness)&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#service&#34;&gt;Service&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#clusterip&#34;&gt;ClusterIP&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#nodeport&#34;&gt;NodePort&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#loadbalancer&#34;&gt;LoadBalancer&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#ingress&#34;&gt;ingress&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#namespace&#34;&gt;Namespace&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#configmap&#34;&gt;Configmap&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#secret&#34;&gt;Secret&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#job&#34;&gt;Job&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#cronjob&#34;&gt;CronJob&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#helmtodo&#34;&gt;Helm(TODO)&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%AE%89%E8%A3%85-hellok8s-chart-%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8Btodo&#34;&gt;å®‰è£… hellok8s chart å¿«é€Ÿå¼€å§‹(TODO)&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E5%88%9B%E5%BB%BA-helm-charts&#34;&gt;åˆ›å»º helm charts&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD%E5%85%B6%E5%AE%83-helm-chart-%E4%BD%BF%E7%94%A8-todo&#34;&gt;ä¸Šä¼ å’Œä¸‹è½½å…¶å®ƒ helm chart ä½¿ç”¨ (TODO)&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#dashboardtodo&#34;&gt;Dashboard(TODO)&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/guangzhengli/k8s-tutorials/main/#k9stodo&#34;&gt;K9s(TODO)&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;kubernetes tutorials&lt;/h1&gt; &#xA;&lt;h2&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt; &#xA;&lt;p&gt;åœ¨å¼€å§‹æœ¬æ•™ç¨‹ä¹‹å‰ï¼Œéœ€è¦é…ç½®å¥½æœ¬åœ°ç¯å¢ƒï¼Œä»¥ä¸‹æ˜¯éœ€è¦å®‰è£…çš„ä¾èµ–å’ŒåŒ…ã€‚&lt;/p&gt; &#xA;&lt;h3&gt;å®‰è£… docker&lt;/h3&gt; &#xA;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£… &lt;code&gt;docker&lt;/code&gt; æ¥æ‰“åŒ…é•œåƒï¼Œå¦‚æœä½ æœ¬åœ°å·²ç»å®‰è£…äº† &lt;code&gt;docker&lt;/code&gt;ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€‰æ‹©è·³è¿‡è¿™ä¸€å°èŠ‚ã€‚&lt;/p&gt; &#xA;&lt;h4&gt;æ¨èå®‰è£…æ–¹æ³•&lt;/h4&gt; &#xA;&lt;p&gt;ç›®å‰ä½¿ç”¨ &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34;&gt;Docker Desktop&lt;/a&gt; æ¥å®‰è£… docker è¿˜æ˜¯æœ€ç®€å•çš„æ–¹æ¡ˆï¼Œæ‰“å¼€å®˜ç½‘ä¸‹è½½å¯¹åº”ä½ ç”µè„‘æ“ä½œç³»ç»Ÿçš„åŒ…å³å¯ (&lt;a href=&#34;https://www.docker.com/products/docker-desktop/)%EF%BC%8C&#34;&gt;https://www.docker.com/products/docker-desktop/)ï¼Œ&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;å½“å®‰è£…å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;docker run hello-world&lt;/code&gt; æ¥å¿«é€Ÿæ ¡éªŒæ˜¯å¦å®‰è£…æˆåŠŸï¼&lt;/p&gt; &#xA;&lt;h4&gt;å…¶å®ƒå®‰è£…æ–¹æ³•&lt;/h4&gt; &#xA;&lt;p&gt;ç›®å‰ Docker å…¬å¸å®£å¸ƒ &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34;&gt;Docker Desktop&lt;/a&gt; åªå¯¹ä¸ªäººå¼€å‘è€…æˆ–è€…å°å‹å›¢ä½“å…è´¹ (2021å¹´èµ·å¯¹å¤§å‹å…¬å¸ä¸å†å…è´¹)ï¼Œæ‰€ä»¥å¦‚æœä½ ä¸èƒ½é€šè¿‡ &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34;&gt;Docker Desktop&lt;/a&gt; çš„æ–¹å¼ä¸‹è½½å®‰è£… &lt;code&gt;docker&lt;/code&gt;ï¼Œå¯ä»¥å‚è€ƒ &lt;a href=&#34;https://dhwaneetbhatt.com/blog/run-docker-without-docker-desktop-on-macos&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt; åªå®‰è£… &lt;a href=&#34;https://github.com/docker/cli&#34;&gt;Docker CLI&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;h3&gt;å®‰è£… minikube&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦æ­å»ºä¸€å¥— k8s æœ¬åœ°é›†ç¾¤ (ä½¿ç”¨äº‘å‚å•†æˆ–è€…å…¶å®ƒ k8s é›†ç¾¤éƒ½å¯) ã€‚æœ¬åœ°æ­å»º k8s é›†ç¾¤çš„æ–¹å¼æ¨èä½¿ç”¨ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/&#34;&gt;minikube&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;å¯ä»¥æ ¹æ® &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/start/&#34;&gt;minikube å¿«é€Ÿå®‰è£…&lt;/a&gt; æ¥è¿›è¡Œä¸‹è½½å®‰è£…ï¼Œè¿™é‡Œç®€å•åˆ—ä¸¾ MacOS çš„å®‰è£…æ–¹å¼ï¼ŒLinux &amp;amp; Windows æ“ä½œç³»ç»Ÿå¯ä»¥å‚è€ƒ&lt;a href=&#34;https://minikube.sigs.k8s.io/docs/start/&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt; å¿«é€Ÿå®‰è£…ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;brew install minikube&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;å¯åŠ¨ minikube&lt;/h4&gt; &#xA;&lt;p&gt;å› ä¸º minikube æ”¯æŒå¾ˆå¤šå®¹å™¨å’Œè™šæ‹ŸåŒ–æŠ€æœ¯ (&lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/docker/&#34;&gt;Docker&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/hyperkit/&#34;&gt;Hyperkit&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/hyperv/&#34;&gt;Hyper-V&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/kvm2/&#34;&gt;KVM&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/parallels/&#34;&gt;Parallels&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/podman/&#34;&gt;Podman&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/virtualbox/&#34;&gt;VirtualBox&lt;/a&gt;, or &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/drivers/vmware/&#34;&gt;VMware Fusion/Workstation&lt;/a&gt;)ï¼Œä¹Ÿæ˜¯é—®é¢˜å‡ºç°æ¯”è¾ƒå¤šçš„åœ°æ–¹ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯ç¨å¾®è¯´æ˜ä¸€ä¸‹ã€‚&lt;/p&gt; &#xA;&lt;p&gt;å¦‚æœä½ ä½¿ç”¨ &lt;code&gt;docker&lt;/code&gt; çš„æ–¹æ¡ˆæ˜¯ä¸Šé¢æ¨èçš„ &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34;&gt;Docker Desktop&lt;/a&gt; ï¼Œé‚£ä¹ˆä½ ä»¥ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨ minikube å³å¯ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ä¸‹è½½ä¾èµ–ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;minikube start --vm-driver docker --container-runtime=docker&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å¯åŠ¨å®Œæˆåï¼Œè¿è¡Œ &lt;code&gt;minikube status&lt;/code&gt; æŸ¥çœ‹å½“å‰çŠ¶æ€ç¡®å®šæ˜¯å¦å¯åŠ¨æˆåŠŸï¼&lt;/p&gt; &#xA;&lt;p&gt;å¦‚æœä½ æœ¬åœ°åªæœ‰ Docker CLIï¼Œåˆ¤æ–­æ ‡å‡†å¦‚æœæ‰§è¡Œ &lt;code&gt;docker ps&lt;/code&gt; ç­‰å‘½ä»¤ï¼Œè¿”å›é”™è¯¯ &lt;code&gt;Cannot connect to the Docker daemon at unix:///Users/xxxx/.colima/docker.sock. Is the docker daemon running?&lt;/code&gt; é‚£ä¹ˆå°±éœ€è¦æ“ä½œä¸‹é¢çš„å‘½ä»¤ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;brew install hyperkit&#xA;minikube start --vm-driver hyperkit --container-runtime=docker&#xA;&#xA;# Tell Docker CLI to talk to minikube&#39;s VM&#xA;eval $(minikube docker-env)&#xA;&#xA;# Save IP to a hostname&#xA;echo &#34;`minikube ip` docker.local&#34; | sudo tee -a /etc/hosts &amp;gt; /dev/null&#xA;&#xA;# Test&#xA;docker run hello-world&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;strong&gt;minikube å‘½ä»¤é€ŸæŸ¥&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;minikube stop&lt;/code&gt; ä¸ä¼šåˆ é™¤ä»»ä½•æ•°æ®ï¼Œåªæ˜¯åœæ­¢ VM å’Œ k8s é›†ç¾¤ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;minikube delete&lt;/code&gt; åˆ é™¤æ‰€æœ‰ minikube å¯åŠ¨åçš„æ•°æ®ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;minikube ip&lt;/code&gt; æŸ¥çœ‹é›†ç¾¤å’Œ docker enginer è¿è¡Œçš„ IP åœ°å€ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;minikube pause&lt;/code&gt; æš‚åœå½“å‰çš„èµ„æºå’Œ k8s é›†ç¾¤&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;minikube status&lt;/code&gt; æŸ¥çœ‹å½“å‰é›†ç¾¤çŠ¶æ€&lt;/p&gt; &#xA;&lt;h3&gt;å®‰è£… kubectl&lt;/h3&gt; &#xA;&lt;p&gt;è¿™ä¸€æ­¥æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸å®‰è£…çš„è¯ï¼Œåç»­æ‰€æœ‰ &lt;code&gt;kubectl&lt;/code&gt; ç›¸å…³çš„å‘½ä»¤ï¼Œä½¿ç”¨ &lt;code&gt;minikube kubectl&lt;/code&gt; å‘½ä»¤æ›¿ä»£å³å¯ã€‚&lt;/p&gt; &#xA;&lt;p&gt;å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ &lt;code&gt;minikube kubectl&lt;/code&gt; æˆ–è€…é…ç½®ç›¸å…³ç¯å¢ƒå˜é‡æ¥è¿›è¡Œä¸‹é¢çš„æ•™å­¦çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ç›´æ¥å®‰è£… &lt;code&gt;kubectl&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;brew install kubectl&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;æ³¨å†Œ docker hub è´¦å·ç™»å½•&lt;/h3&gt; &#xA;&lt;p&gt;å› ä¸ºé»˜è®¤ minikube ä½¿ç”¨çš„é•œåƒåœ°å€æ˜¯ DockerHubï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨ DockerHub (&lt;a href=&#34;https://hub.docker.com/&#34;&gt;https://hub.docker.com/&lt;/a&gt;) ä¸­æ³¨å†Œè´¦å·ï¼Œå¹¶ä¸”ä½¿ç”¨ login å‘½ä»¤ç™»å½•è´¦å·ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker login&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Container&lt;/h2&gt; &#xA;&lt;p&gt;æˆ‘ä»¬çš„æ—…ç¨‹ä»ä¸€æ®µä»£ç å¼€å§‹ã€‚æ–°å»ºä¸€ä¸ª &lt;code&gt;main.go&lt;/code&gt; æ–‡ä»¶ï¼Œå¤åˆ¶ä¸‹é¢çš„ä»£ç åˆ°æ–‡ä»¶ä¸­ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main&#xA;&#xA;import (&#xA;&#x9;&#34;io&#34;&#xA;&#x9;&#34;net/http&#34;&#xA;)&#xA;&#xA;func hello(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;io.WriteString(w, &#34;[v1] Hello, Kubernetes!&#34;)&#xA;}&#xA;&#xA;func main() {&#xA;&#x9;http.HandleFunc(&#34;/&#34;, hello)&#xA;&#x9;http.ListenAndServe(&#34;:3000&#34;, nil)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä¸Šé¢æ˜¯ä¸€ä¸²ç”¨ &lt;a href=&#34;https://go.dev/&#34;&gt;Go&lt;/a&gt; å†™çš„ä»£ç ï¼Œä»£ç é€»è¾‘éå¸¸çš„ç®€å•ï¼Œé¦–å…ˆå¯åŠ¨ HTTP æœåŠ¡å™¨ï¼Œç›‘å¬ &lt;code&gt;3000&lt;/code&gt; ç«¯å£ï¼Œå½“è®¿é—®è·¯ç”± &lt;code&gt;/&lt;/code&gt;çš„æ—¶å€™ è¿”å›å­—ç¬¦ä¸² &lt;code&gt;[v1] Hello, Kubernetes!&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨ä»¥å‰ï¼Œå¦‚æœä½ æƒ³å°†è¿™æ®µä»£ç è¿è¡Œèµ·æ¥å¹¶æµ‹è¯•ä¸€ä¸‹ã€‚ä½ é¦–å…ˆéœ€è¦æ‡‚å¾—å¦‚ä½•ä¸‹è½½ golang çš„å®‰è£…åŒ…è¿›è¡Œå®‰è£…ï¼Œæ¥ç€éœ€è¦æ‡‚å¾— &lt;code&gt;golang module&lt;/code&gt; çš„åŸºæœ¬ä½¿ç”¨ï¼Œæœ€åè¿˜éœ€è¦äº†è§£ golang çš„ç¼–è¯‘å’Œè¿è¡Œå‘½ä»¤ï¼Œæ‰èƒ½å°†è¯¥ä»£ç è¿è¡Œèµ·æ¥ã€‚ç”šè‡³åœ¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå› ä¸ºç¯å¢ƒå˜é‡é—®é¢˜ã€æ“ä½œç³»ç»Ÿé—®é¢˜ã€å¤„ç†å™¨æ¶æ„ç­‰é—®é¢˜å¯¼è‡´ç¼–è¯‘æˆ–è¿è¡Œå¤±è´¥ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ä½†æ˜¯é€šè¿‡å®¹å™¨æŠ€æœ¯ï¼Œåªéœ€è¦ä¸Šé¢çš„ä»£ç ï¼Œé™„å¸¦ç€å¯¹åº”çš„å®¹å™¨ &lt;code&gt;Dockerfile&lt;/code&gt; æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±ä¸éœ€è¦ golang çš„ä»»ä½•çŸ¥è¯†ï¼Œä¹Ÿèƒ½å°†ä»£ç é¡ºåˆ©è¿è¡Œèµ·æ¥ã€‚&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Container (å®¹å™¨) æ˜¯ä¸€ç§æ²™ç›’æŠ€æœ¯ã€‚å®ƒæ˜¯åŸºäº Linux ä¸­ Namespace / Cgroups / chroot ç­‰æŠ€æœ¯ç»“åˆè€Œæˆï¼Œæ›´å¤šæŠ€æœ¯ç»†èŠ‚å¯ä»¥å‚çœ‹è¿™ä¸ªè§†é¢‘ &lt;a href=&#34;https://www.youtube.com/watch?v=8fi7uSYlOdc&#34;&gt;å¦‚ä½•è‡ªå·±å®ç°ä¸€ä¸ªå®¹å™¨&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;ä¸‹é¢å°±æ˜¯ Go ä»£ç å¯¹åº”çš„ &lt;code&gt;Dockerfile&lt;/code&gt;ï¼Œç®€å•çš„æ–¹æ¡ˆæ˜¯ç›´æ¥ä½¿ç”¨ golang çš„ alpine é•œåƒæ¥æ‰“åŒ…ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬åç»­ç»ƒä¹ éœ€è¦é¢‘ç¹çš„æ¨é€é•œåƒåˆ° DockerHub å’Œæ‹‰å–é•œåƒåˆ° k8s é›†ç¾¤ä¸­ï¼Œä¸ºäº†ä¼˜åŒ–ç½‘ç»œé€Ÿåº¦ï¼Œæˆ‘ä»¬é€‰æ‹©å…ˆåœ¨ &lt;code&gt;golang:1.16-buster&lt;/code&gt; ä¸­å°†ä¸Šè¿° Go ä»£ç ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå†å°†äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ° &lt;code&gt;base-debian10&lt;/code&gt; é•œåƒä¸­è¿è¡Œ (Dockerfile ä¸ç†è§£æ²¡æœ‰å…³ç³»ï¼Œä¸å½±å“åç»­æ•™ç¨‹å­¦ä¹ )ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™æ ·æˆ‘ä»¬å¯ä»¥å°† 300MB å¤§å°çš„é•œåƒå˜æˆåªæœ‰ 20MB çš„é•œåƒï¼Œç”šè‡³å‹ç¼©ä¸Šä¼ åˆ° DockerHub åå¤§å°åªæœ‰ 10MBï¼&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-dockerfile&#34;&gt;# Dockerfile&#xA;FROM golang:1.16-buster AS builder&#xA;RUN mkdir /src&#xA;ADD . /src&#xA;WORKDIR /src&#xA;&#xA;RUN go env -w GO111MODULE=auto&#xA;RUN go build -o main .&#xA;&#xA;FROM gcr.io/distroless/base-debian10&#xA;&#xA;WORKDIR /&#xA;&#xA;COPY --from=builder /src/main /main&#xA;EXPOSE 3000&#xA;ENTRYPOINT [&#34;/main&#34;]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;éœ€è¦æ³¨æ„ &lt;code&gt;main.go&lt;/code&gt; æ–‡ä»¶éœ€è¦å’Œ &lt;code&gt;Dockerfile&lt;/code&gt; æ–‡ä»¶åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹æ–¹ &lt;code&gt;docker build&lt;/code&gt; å‘½ä»¤ï¼Œç¬¬ä¸€æ¬¡éœ€è¦è€å¿ƒç­‰å¾…æ‹‰å–åŸºç¡€é•œåƒã€‚å¹¶ä¸”&lt;strong&gt;éœ€è¦æ³¨æ„å°† &lt;code&gt;guangzhengli&lt;/code&gt; æ›¿æ¢æˆè‡ªå·±çš„ &lt;code&gt;DockerHub&lt;/code&gt; è´¦å·åç§°&lt;/strong&gt;ã€‚ è¿™æ ·æˆ‘ä»¬åç»­å¯ä»¥æ¨é€é•œåƒåˆ°è‡ªå·±æ³¨å†Œçš„ &lt;code&gt;DockerHub&lt;/code&gt; ä»“åº“å½“ä¸­ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker build . -t guangzhengli/hellok8s:v1&#xA;# Step 1/11 : FROM golang:1.16-buster AS builder&#xA;# ...&#xA;# ...&#xA;# Step 11/11 : ENTRYPOINT [&#34;/main&#34;]&#xA;# Successfully tagged guangzhengli/hellok8s:v1&#xA;&#xA;&#xA;docker images&#xA;# guangzhengli/hellok8s          v1         f956e8cf7d18   8 days ago      25.4MB&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;docker build&lt;/code&gt; å‘½ä»¤å®Œæˆåæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;docker images&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹é•œåƒæ˜¯å¦ build æˆåŠŸï¼Œæœ€åæˆ‘ä»¬æ‰§è¡Œ &lt;code&gt;docker run&lt;/code&gt; å‘½ä»¤å°†å®¹å™¨å¯åŠ¨ï¼Œ &lt;code&gt;-p&lt;/code&gt; æŒ‡å®š &lt;code&gt;3000&lt;/code&gt; ä½œä¸ºç«¯å£ï¼Œ&lt;code&gt;-d&lt;/code&gt; æŒ‡å®šåˆšæ‰“åŒ…æˆåŠŸçš„é•œåƒåç§°ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker run -p 3000:3000 --name hellok8s -d guangzhengli/hellok8s:v1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿è¡ŒæˆåŠŸåï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨æˆ–è€… &lt;code&gt;curl&lt;/code&gt; æ¥è®¿é—® &lt;code&gt;http://127.0.0.1:3000&lt;/code&gt; , æŸ¥çœ‹æ˜¯å¦æˆåŠŸè¿”å›å­—ç¬¦ä¸² &lt;code&gt;[v1] Hello, Kubernetes!&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™é‡Œå› ä¸ºæˆ‘æœ¬åœ°åªç”¨ Docker CLIï¼Œè€Œ docker runtime æ˜¯ä½¿ç”¨ &lt;code&gt;minikube&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å…ˆè°ƒç”¨ &lt;code&gt;minikube ip&lt;/code&gt; æ¥è¿”å› minikube IP åœ°å€ï¼Œä¾‹å¦‚è¿”å›äº† &lt;code&gt;192.168.59.100&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘éœ€è¦è®¿é—® &lt;code&gt;http://192.168.59.100:3000&lt;/code&gt; æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸè¿”å›å­—ç¬¦ä¸² &lt;code&gt;[v1] Hello, Kubernetes!&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æœ€åç¡®è®¤æ²¡æœ‰é—®é¢˜ï¼Œä½¿ç”¨ &lt;code&gt;docker push&lt;/code&gt; å°†é•œåƒä¸Šä¼ åˆ°è¿œç¨‹çš„ &lt;code&gt;DockerHub&lt;/code&gt; ä»“åº“å½“ä¸­ï¼Œè¿™æ ·å¯ä»¥ä¾›ä»–äººä¸‹è½½ä½¿ç”¨ï¼Œä¹Ÿæ–¹ä¾¿åç»­ &lt;code&gt;Minikube&lt;/code&gt; ä¸‹è½½é•œåƒä½¿ç”¨ã€‚ &lt;strong&gt;éœ€è¦æ³¨æ„å°† &lt;code&gt;guangzhengli&lt;/code&gt; æ›¿æ¢æˆè‡ªå·±çš„ &lt;code&gt;DockerHub&lt;/code&gt; è´¦å·åç§°&lt;/strong&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker push guangzhengli/hellok8s:v1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ç»è¿‡è¿™ä¸€èŠ‚çš„ç»ƒä¹ ï¼Œæœ‰æ²¡æœ‰å¯¹å®¹å™¨çš„å¼ºå¤§æœ‰ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†å‘¢ï¼Ÿå¯ä»¥æƒ³è±¡å½“ä½ æƒ³éƒ¨ç½²ä¸€ä¸ªæ›´å¤æ‚çš„æœåŠ¡æ—¶ï¼Œä¾‹å¦‚ Nginxï¼ŒMySQLï¼ŒRedisã€‚ä½ åªéœ€è¦åˆ° &lt;a href=&#34;https://hub.docker.com/search?q=&#34;&gt;DockerHub æœç´¢&lt;/a&gt; ä¸­æœç´¢å¯¹åº”çš„é•œåƒï¼Œé€šè¿‡ &lt;code&gt;docker pull&lt;/code&gt; ä¸‹è½½é•œåƒï¼Œ&lt;code&gt;docker run&lt;/code&gt; å¯åŠ¨æœåŠ¡å³å¯ï¼è€Œæ— éœ€å…³ç³»ä¾èµ–å’Œå„ç§é…ç½®ï¼&lt;/p&gt; &#xA;&lt;h2&gt;Pod&lt;/h2&gt; &#xA;&lt;p&gt;&lt;code&gt;pod&lt;/code&gt; æ˜¯æˆ‘ä»¬ç»ƒä¹ çš„ç¬¬ä¸€ä¸ª k8s èµ„æºï¼Œåœ¨äº†è§£ &lt;code&gt;pod&lt;/code&gt; å’Œ &lt;code&gt;container&lt;/code&gt; çš„åŒºåˆ«ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„ pod è¯•è¯•ï¼Œ&lt;/p&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å…ˆåˆ›å»º &lt;code&gt;nginx.yaml&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;# nginx.yaml&#xA;apiVersion: v1&#xA;kind: Pod&#xA;metadata:&#xA;  name: nginx-pod&#xA;spec:&#xA;  containers:&#xA;    - name: nginx-container&#xA;      image: nginx&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å…¶ä¸­ &lt;code&gt;kind&lt;/code&gt; è¡¨ç¤ºæˆ‘ä»¬è¦åˆ›å»ºçš„èµ„æºæ˜¯ &lt;code&gt;Pod&lt;/code&gt; ç±»å‹ï¼Œ &lt;code&gt;metadata.name&lt;/code&gt; è¡¨ç¤ºè¦åˆ›å»ºçš„ pod çš„åå­—ï¼Œè¿™ä¸ªåå­—éœ€è¦æ˜¯å”¯ä¸€çš„ã€‚ &lt;code&gt;spec.containers&lt;/code&gt; è¡¨ç¤ºè¦è¿è¡Œçš„å®¹å™¨çš„åç§°å’Œé•œåƒåç§°ã€‚é•œåƒé»˜è®¤æ¥æº &lt;code&gt;DockerHub&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æˆ‘ä»¬è¿è¡Œç¬¬ä¸€æ¡ k8s å‘½ä»¤ &lt;code&gt;kubectl apply -f nginx.yaml&lt;/code&gt; å‘½ä»¤å¯åŠ¨ podã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f nginx.yaml&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;kubectl get pods&lt;/code&gt; æ¥æŸ¥çœ‹ pod æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼Œ&lt;/p&gt; &#xA;&lt;p&gt;é€šè¿‡å‘½ä»¤ä¸‹é¢çš„å‘½ä»¤æ¥é…ç½® &lt;code&gt;nginx&lt;/code&gt; çš„é¦–é¡µå†…å®¹&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl exec -it nginx-pod /bin/bash&#xA;&#xA;echo &#34;hello kubernetes by nginx!&#34; &amp;gt; /usr/share/nginx/html/index.html&#xA;&#xA;kubectl port-forward nginx-pod 4000:80&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æœ€åå¯ä»¥é€šè¿‡æµè§ˆå™¨æˆ–è€… &lt;code&gt;curl&lt;/code&gt; æ¥è®¿é—® &lt;code&gt;http://127.0.0.1:4000&lt;/code&gt; , æŸ¥çœ‹æ˜¯å¦æˆåŠŸå¯åŠ¨ &lt;code&gt;nginx&lt;/code&gt; å’Œè¿”å›å­—ç¬¦ä¸² &lt;code&gt;hello kubernetes by nginx!&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;h3&gt;Pod ä¸ Container çš„ä¸åŒ&lt;/h3&gt; &#xA;&lt;p&gt;å›åˆ° &lt;code&gt;pod&lt;/code&gt; å’Œ &lt;code&gt;container&lt;/code&gt; çš„åŒºåˆ«ï¼Œæˆ‘ä»¬ä¼šå‘ç°åˆšåˆšåˆ›å»ºå‡ºæ¥çš„èµ„æºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨æœ€å†…å±‚æ˜¯æˆ‘ä»¬çš„æœåŠ¡ &lt;code&gt;nginx&lt;/code&gt;ï¼Œè¿è¡Œåœ¨ &lt;code&gt;container&lt;/code&gt; ä¸­ï¼Œ &lt;code&gt;container&lt;/code&gt; (å®¹å™¨) çš„æœ¬è´¨æ˜¯è¿›ç¨‹ï¼Œè€Œ &lt;code&gt;pod&lt;/code&gt; æ˜¯ç®¡ç†è¿™ä¸€ç»„è¿›ç¨‹çš„èµ„æºã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/nginx_pod.png&#34; alt=&#34;nginx_pod&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;æ‰€ä»¥è‡ªç„¶ &lt;code&gt;pod&lt;/code&gt; å¯ä»¥ç®¡ç†å¤šä¸ª &lt;code&gt;container&lt;/code&gt;ï¼Œåœ¨æŸäº›åœºæ™¯ä¾‹å¦‚ &lt;code&gt;container&lt;/code&gt; ä¹‹é—´éœ€è¦æ–‡ä»¶äº¤æ¢(æ—¥å¿—æ”¶é›†)ï¼Œæœ¬åœ°ç½‘ç»œé€šä¿¡éœ€æ±‚(ä½¿ç”¨ localhost æˆ–è€… Socket æ–‡ä»¶è¿›è¡Œæœ¬åœ°é€šä¿¡)ï¼Œåœ¨è¿™äº›åœºæ™¯ä¸­ä½¿ç”¨ &lt;code&gt;pod&lt;/code&gt; ç®¡ç†å¤šä¸ª &lt;code&gt;container&lt;/code&gt; å°±éå¸¸çš„æ¨èã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/pod.png&#34; alt=&#34;pod&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;Pod å…¶å®ƒå‘½ä»¤&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;logs&lt;/code&gt; æˆ–è€… &lt;code&gt;logs -f&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹ pod æ—¥å¿—ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;exec -it&lt;/code&gt; è¿›å…¥ pod æˆ–è€…è°ƒç”¨å®¹å™¨å‘½ä»¤ï¼Œé€šè¿‡ &lt;code&gt;delete pod&lt;/code&gt; æˆ–è€… &lt;code&gt;delete -f nginx.yaml&lt;/code&gt; çš„æ–¹å¼åˆ é™¤ pod èµ„æºã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ° &lt;a href=&#34;https://kubernetes.io/docs/reference/kubectl/cheatsheet/&#34;&gt;kubectl æ‰€æœ‰å‘½ä»¤&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl&amp;nbsp;logs&amp;nbsp;--follow&amp;nbsp;nginx&#xA;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&#xA;kubectl exec nginx -- ls&#xA;&#xA;kubectl delete pod nginx&#xA;# pod &#34;nginx&#34; deleted&#xA;&#xA;kubectl delete -f nginx.yaml&#xA;# pod &#34;nginx&#34; deleted&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ ¹æ®æˆ‘ä»¬åœ¨ &lt;code&gt;container&lt;/code&gt; çš„é‚£èŠ‚æ„å»ºçš„ &lt;code&gt;hellok8s:v1&lt;/code&gt; çš„é•œåƒï¼ŒåŒæ—¶å‚è€ƒ &lt;code&gt;nginx&lt;/code&gt; pod çš„èµ„æºå®šä¹‰ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çš„ç¼–å†™å‡º &lt;code&gt;hellok8s:v1&lt;/code&gt; &lt;code&gt;pod&lt;/code&gt; çš„èµ„æºæ–‡ä»¶ã€‚å¹¶é€šè¿‡ &lt;code&gt;port-forward&lt;/code&gt; åˆ°æœ¬åœ°çš„ &lt;code&gt;3000&lt;/code&gt; ç«¯å£è¿›è¡Œè®¿é—®ï¼Œæœ€ç»ˆå¾—åˆ°å­—ç¬¦ä¸² &lt;code&gt;[v1] Hello, Kubernetes!&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;# hellok8s.yaml&#xA;apiVersion: v1&#xA;kind: Pod&#xA;metadata:&#xA;  name: hellok8s&#xA;spec:&#xA;  containers:&#xA;    - name: hellok8s-container&#xA;      image: guangzhengli/hellok8s:v1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl get pods&#xA;&#xA;kubectl port-forward hellok8s 3000:3000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Deployment&lt;/h2&gt; &#xA;&lt;p&gt;åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šä¸ä¼šç›´æ¥ç®¡ç† podï¼Œæˆ‘ä»¬éœ€è¦ &lt;code&gt;kubernetes&lt;/code&gt; æ¥å¸®åŠ©æˆ‘ä»¬æ¥å®Œæˆä¸€äº›è‡ªåŠ¨åŒ–æ“ä½œï¼Œä¾‹å¦‚è‡ªåŠ¨æ‰©å®¹æˆ–è€…è‡ªåŠ¨å‡çº§ç‰ˆæœ¬ã€‚å¯ä»¥æƒ³è±¡åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬æ‰‹åŠ¨éƒ¨ç½²äº† 10 ä¸ª &lt;code&gt;hellok8s:v1&lt;/code&gt; çš„ podï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å‡çº§æˆ &lt;code&gt;hellok8s:v2&lt;/code&gt; ç‰ˆæœ¬ï¼Œæˆ‘ä»¬éš¾é“éœ€è¦ä¸€ä¸ªä¸€ä¸ªçš„å°† &lt;code&gt;hellok8s:v1&lt;/code&gt; çš„ pod æ‰‹åŠ¨å‡çº§å—ï¼Ÿ&lt;/p&gt; &#xA;&lt;p&gt;è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬æ¥çœ‹ &lt;code&gt;kubernetes&lt;/code&gt; çš„å¦å¤–ä¸€ä¸ªèµ„æº &lt;code&gt;deployment&lt;/code&gt;ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† podã€‚&lt;/p&gt; &#xA;&lt;h3&gt;æ‰©å®¹&lt;/h3&gt; &#xA;&lt;p&gt;é¦–å…ˆå¯ä»¥åˆ›å»ºä¸€ä¸ª &lt;code&gt;deployment.yaml&lt;/code&gt; çš„æ–‡ä»¶ã€‚æ¥ç®¡ç† &lt;code&gt;hellok8s&lt;/code&gt; podã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  replicas: 1&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:v1&#xA;          name: hellok8s-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å…¶ä¸­ &lt;code&gt;kind&lt;/code&gt; è¡¨ç¤ºæˆ‘ä»¬è¦åˆ›å»ºçš„èµ„æºæ˜¯ &lt;code&gt;deployment&lt;/code&gt; ç±»å‹ï¼Œ &lt;code&gt;metadata.name&lt;/code&gt; è¡¨ç¤ºè¦åˆ›å»ºçš„ deployment çš„åå­—ï¼Œè¿™ä¸ªåå­—éœ€è¦æ˜¯&lt;strong&gt;å”¯ä¸€&lt;/strong&gt;çš„ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨ &lt;code&gt;spec&lt;/code&gt; é‡Œé¢è¡¨ç¤ºï¼Œé¦–å…ˆ &lt;code&gt;replicas&lt;/code&gt; è¡¨ç¤ºçš„æ˜¯éƒ¨ç½²çš„ pod å‰¯æœ¬æ•°é‡ï¼Œ&lt;code&gt;selector&lt;/code&gt; é‡Œé¢è¡¨ç¤ºçš„æ˜¯ &lt;code&gt;deployment&lt;/code&gt; èµ„æºå’Œ &lt;code&gt;pod&lt;/code&gt; èµ„æºå…³è”çš„æ–¹å¼ï¼Œè¿™é‡Œè¡¨ç¤º &lt;code&gt;deployment&lt;/code&gt; ä¼šç®¡ç† (selector) æ‰€æœ‰ &lt;code&gt;labels=hellok8s&lt;/code&gt; çš„ podã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;template&lt;/code&gt; çš„å†…å®¹æ˜¯ç”¨æ¥å®šä¹‰ &lt;code&gt;pod&lt;/code&gt; èµ„æºçš„ï¼Œä½ ä¼šå‘ç°å’Œ Hellok8s Pod èµ„æºçš„å®šä¹‰æ˜¯å·®ä¸å¤šçš„ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬éœ€è¦åŠ ä¸Š &lt;code&gt;metadata.labels&lt;/code&gt; æ¥å’Œä¸Šé¢çš„ &lt;code&gt;selector.matchLabels&lt;/code&gt; å¯¹åº”èµ·æ¥ã€‚æ¥è¡¨æ˜ pod æ˜¯è¢« deployment ç®¡ç†ï¼Œä¸ç”¨åœ¨&lt;code&gt;template&lt;/code&gt; é‡Œé¢åŠ ä¸Š &lt;code&gt;metadata.name&lt;/code&gt; æ˜¯å› ä¸º deployment ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»º pod çš„å”¯ä¸€&lt;code&gt;name&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æ¥ä¸‹æ¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥åˆ›å»º &lt;code&gt;deployment&lt;/code&gt; èµ„æºã€‚é€šè¿‡ &lt;code&gt;get&lt;/code&gt; å’Œ &lt;code&gt;delete pod&lt;/code&gt; å‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šåˆæ­¥æ„Ÿå— deployment çš„é­…åŠ›ã€‚&lt;strong&gt;æ¯æ¬¡åˆ›å»ºçš„ pod åç§°éƒ½ä¼šå˜åŒ–ï¼ŒæŸäº›å‘½ä»¤è®°å¾—æ›¿æ¢æˆä½ çš„ pod çš„åç§°&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f deployment.yaml&#xA;&#xA;kubectl get deployments&#xA;#NAME                  READY   UP-TO-DATE   AVAILABLE   AGE&#xA;#hellok8s-deployment   1/1     1            1           39s&#xA;&#xA;kubectl get pods             &#xA;#NAME                                   READY   STATUS    RESTARTS   AGE&#xA;#hellok8s-deployment-77bffb88c5-qlxss   1/1     Running   0          119s&#xA;&#xA;kubectl delete pod hellok8s-deployment-77bffb88c5-qlxss &#xA;#pod &#34;hellok8s-deployment-77bffb88c5-qlxss&#34; deleted&#xA;&#xA;kubectl get pods                                       &#xA;#NAME                                   READY   STATUS    RESTARTS   AGE&#xA;#hellok8s-deployment-77bffb88c5-xp8f7   1/1     Running   0          18s&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼Œå½“æ‰‹åŠ¨åˆ é™¤ä¸€ä¸ª &lt;code&gt;pod&lt;/code&gt; èµ„æºåï¼Œdeployment ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code&gt;pod&lt;/code&gt;ï¼Œè¿™å’Œæˆ‘ä»¬ä¹‹å‰æ‰‹åŠ¨åˆ›å»º pod èµ„æºæœ‰æœ¬è´¨çš„åŒºåˆ«ï¼è¿™ä»£è¡¨ç€å½“ç”Ÿäº§ç¯å¢ƒç®¡ç†ç€æˆåƒä¸Šä¸‡ä¸ª pod æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒå…·ä½“çš„æƒ…å†µï¼Œåªéœ€è¦ç»´æŠ¤å¥½è¿™ä»½ &lt;code&gt;deployment.yaml&lt;/code&gt; æ–‡ä»¶çš„èµ„æºå®šä¹‰å³å¯ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡è‡ªåŠ¨æ‰©å®¹æ¥åŠ æ·±è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œå½“æˆ‘ä»¬æƒ³è¦å°† &lt;code&gt;hellok8s:v1&lt;/code&gt; çš„èµ„æºæ‰©å®¹åˆ° 3 ä¸ªå‰¯æœ¬æ—¶ï¼Œåªéœ€è¦å°† &lt;code&gt;replicas&lt;/code&gt; çš„å€¼è®¾ç½®æˆ 3ï¼Œæ¥ç€é‡æ–°è¾“å…¥ &lt;code&gt;kubectl apply -f deployment.yaml&lt;/code&gt; å³å¯ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:v1&#xA;          name: hellok8s-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å¯ä»¥åœ¨ &lt;code&gt;kubectl apply&lt;/code&gt; ä¹‹å‰é€šè¿‡æ–°å»ºçª—å£æ‰§è¡Œ &lt;code&gt;kubectl get pods --watch&lt;/code&gt; å‘½ä»¤æ¥è§‚å¯Ÿ pod å¯åŠ¨å’Œåˆ é™¤çš„è®°å½•ï¼Œæƒ³è¦å‡å°‘å‰¯æœ¬æ•°æ—¶ä¹Ÿå¾ˆç®€å•ï¼Œä½ å¯ä»¥å°è¯•å°†å‰¯æœ¬æ•°éšæ„å¢å¤§æˆ–è€…ç¼©å°ï¼Œå†é€šè¿‡ &lt;code&gt;watch&lt;/code&gt; æ¥è§‚å¯Ÿå®ƒçš„çŠ¶æ€ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/deployment.png&#34; alt=&#34;deployment&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;å‡çº§ç‰ˆæœ¬&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬æ¥ä¸‹æ¥å°è¯•å°†æ‰€æœ‰ &lt;code&gt;v1&lt;/code&gt; ç‰ˆæœ¬çš„ &lt;code&gt;pod&lt;/code&gt; å‡çº§åˆ° &lt;code&gt;v2&lt;/code&gt; ç‰ˆæœ¬ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä»½ &lt;code&gt;hellok8s:v2&lt;/code&gt; çš„ç‰ˆæœ¬é•œåƒã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å­—ç¬¦ä¸²æ›¿æ¢æˆäº† &lt;code&gt;[v2] Hello, Kubernetes!&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main&#xA;&#xA;import (&#xA;&#x9;&#34;io&#34;&#xA;&#x9;&#34;net/http&#34;&#xA;)&#xA;&#xA;func hello(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;io.WriteString(w, &#34;[v2] Hello, Kubernetes!&#34;)&#xA;}&#xA;&#xA;func main() {&#xA;&#x9;http.HandleFunc(&#34;/&#34;, hello)&#xA;&#x9;http.ListenAndServe(&#34;:3000&#34;, nil)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å°† &lt;code&gt;hellok8s:v2&lt;/code&gt; æ¨åˆ° DockerHub ä»“åº“ä¸­ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker build . -t guangzhengli/hellok8s:v2&#xA;docker push guangzhengli/hellok8s:v2&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€ç¼–å†™ &lt;code&gt;v2&lt;/code&gt; ç‰ˆæœ¬çš„ deployment èµ„æºæ–‡ä»¶ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:v2&#xA;          name: hellok8s-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f deployment.yaml&#xA;# deployment.apps/hellok8s-deployment configured&#xA;&#xA;kubectl get pods                &#xA;# NAME                                   READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-66799848c4-kpc6q   1/1     Running   0          3s&#xA;# hellok8s-deployment-66799848c4-pllj6   1/1     Running   0          3s&#xA;# hellok8s-deployment-66799848c4-r7qtg   1/1     Running   0          3s&#xA;&#xA;kubectl port-forward hellok8s-deployment-66799848c4-kpc6q 3000:3000&#xA;# Forwarding from 127.0.0.1:3000 -&amp;gt; 3000&#xA;# Forwarding from [::1]:3000 -&amp;gt; 3000&#xA;&#xA;# open another terminal&#xA;curl http://localhost:3000&#xA;# [v2] Hello, Kubernetes!&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä½ ä¹Ÿå¯ä»¥è¾“å…¥ &lt;code&gt;kubectl describe pod hellok8s-deployment-66799848c4-kpc6q&lt;/code&gt; æ¥çœ‹æ˜¯å¦æ˜¯ &lt;code&gt;v2&lt;/code&gt; ç‰ˆæœ¬çš„é•œåƒã€‚&lt;/p&gt; &#xA;&lt;h3&gt;Rolling Update(æ»šåŠ¨æ›´æ–°)&lt;/h3&gt; &#xA;&lt;p&gt;å¦‚æœæˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šï¼Œç®¡ç†ç€å¤šä¸ªå‰¯æœ¬çš„ &lt;code&gt;hellok8s:v1&lt;/code&gt; ç‰ˆæœ¬çš„ podï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°åˆ° &lt;code&gt;v2&lt;/code&gt; çš„ç‰ˆæœ¬ï¼Œåƒä¸Šé¢é‚£æ ·çš„éƒ¨ç½²æ–¹å¼æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ‰€æœ‰çš„å‰¯æœ¬åœ¨åŒä¸€æ—¶é—´æ›´æ–°ï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬ &lt;code&gt;hellok8s&lt;/code&gt; æœåŠ¡åœ¨çŸ­æ—¶é—´å†…æ˜¯ä¸å¯ç”¨çš„ï¼Œå› ä¸ºæ‰€æœ‰ pod éƒ½åœ¨å‡çº§åˆ° &lt;code&gt;v2&lt;/code&gt; ç‰ˆæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç­‰å¾…æŸä¸ª pod å‡çº§å®Œæˆåæ‰èƒ½æä¾›æœåŠ¡ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ»šåŠ¨æ›´æ–° (rolling update)ï¼Œåœ¨ä¿è¯æ–°ç‰ˆæœ¬ &lt;code&gt;v2&lt;/code&gt; çš„ pod è¿˜æ²¡æœ‰ &lt;code&gt;ready&lt;/code&gt; ä¹‹å‰ï¼Œå…ˆä¸åˆ é™¤ &lt;code&gt;v1&lt;/code&gt; ç‰ˆæœ¬çš„ podã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨ deployment çš„èµ„æºå®šä¹‰ä¸­, &lt;code&gt;spec.strategy.type&lt;/code&gt; æœ‰ä¸¤ç§é€‰æ‹©:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;RollingUpdate:&lt;/strong&gt; é€æ¸å¢åŠ æ–°ç‰ˆæœ¬çš„ podï¼Œé€æ¸å‡å°‘æ—§ç‰ˆæœ¬çš„ podã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Recreate:&lt;/strong&gt; åœ¨æ–°ç‰ˆæœ¬çš„ pod å¢åŠ å‰ï¼Œå…ˆå°†æ‰€æœ‰æ—§ç‰ˆæœ¬ pod åˆ é™¤ã€‚&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬ä¼šé‡‡ç”¨æ»šåŠ¨æ›´æ–° (RollingUpdate) çš„æ–¹å¼ï¼Œæ»šåŠ¨æ›´æ–°åˆå¯ä»¥é€šè¿‡ &lt;code&gt;maxSurge&lt;/code&gt; å’Œ &lt;code&gt;maxUnavailable&lt;/code&gt; å­—æ®µæ¥æ§åˆ¶å‡çº§ pod çš„é€Ÿç‡ï¼Œå…·ä½“å¯ä»¥è¯¦ç»†çœ‹&lt;a href=&#34;https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/deployment/&#34;&gt;å®˜ç½‘å®šä¹‰&lt;/a&gt;ã€‚ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-surge&#34;&gt;&lt;strong&gt;maxSurge:&lt;/strong&gt;&lt;/a&gt; æœ€å¤§å³°å€¼ï¼Œç”¨æ¥æŒ‡å®šå¯ä»¥åˆ›å»ºçš„è¶…å‡ºæœŸæœ› Pod ä¸ªæ•°çš„ Pod æ•°é‡ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-unavailable,&#34;&gt;&lt;strong&gt;maxUnavailable:&lt;/strong&gt;&lt;/a&gt; æœ€å¤§ä¸å¯ç”¨ï¼Œç”¨æ¥æŒ‡å®šæ›´æ–°è¿‡ç¨‹ä¸­ä¸å¯ç”¨çš„ Pod çš„ä¸ªæ•°ä¸Šé™ã€‚&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å…ˆè¾“å…¥å‘½ä»¤å›æ»šæˆ‘ä»¬çš„ deploymentï¼Œè¾“å…¥ &lt;code&gt;kubectl describe pod&lt;/code&gt; ä¼šå‘ç° deployment å·²ç»æŠŠ &lt;code&gt;v2&lt;/code&gt; ç‰ˆæœ¬çš„ pod å›æ»šåˆ° &lt;code&gt; v1&lt;/code&gt; çš„ç‰ˆæœ¬ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl&amp;nbsp;rollout&amp;nbsp;undo&amp;nbsp;deployment&amp;nbsp;hellok8s-deployment&#xA;&#xA;kubectl get pods                                    &#xA;# NAME                                   READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-77bffb88c5-cvm5c   1/1     Running   0          39s&#xA;# hellok8s-deployment-77bffb88c5-lktbl   1/1     Running   0          41s&#xA;# hellok8s-deployment-77bffb88c5-nh82z   1/1     Running   0          37s&#xA;&#xA;kubectl describe pod hellok8s-deployment-77bffb88c5-cvm5c&#xA;# Image: guangzhengli/hellok8s:v1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;é™¤äº†ä¸Šé¢çš„å‘½ä»¤ï¼Œè¿˜å¯ä»¥ç”¨ &lt;code&gt;history&lt;/code&gt; æ¥æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œ&lt;code&gt;--to-revision=2&lt;/code&gt; æ¥å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl rollout history deployment hellok8s-deployment&#xA;kubectl rollout undo deployment/hellok8s-deployment --to-revision=2&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€è®¾ç½® &lt;code&gt;strategy=rollingUpdate&lt;/code&gt; , &lt;code&gt;maxSurge=1&lt;/code&gt; , &lt;code&gt;maxUnavailable=1&lt;/code&gt; å’Œ &lt;code&gt;replicas=3&lt;/code&gt; åˆ° deployment.yaml æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªå‚æ•°é…ç½®æ„å‘³ç€æœ€å¤§å¯èƒ½ä¼šåˆ›å»º 4 ä¸ª hellok8s pod (replicas + maxSurge)ï¼Œæœ€å°ä¼šæœ‰ 2 ä¸ª hellok8s pod å­˜æ´» (replicas - maxUnavailable)ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  strategy:&#xA;     rollingUpdate:&#xA;      maxSurge: 1&#xA;      maxUnavailable: 1&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;      - image: guangzhengli/hellok8s:v2&#xA;        name: hellok8s-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;kubectl apply -f deployment.yaml&lt;/code&gt; æ¥é‡æ–°åˆ›å»º &lt;code&gt;v2&lt;/code&gt; çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;kubectl get pods --watch&lt;/code&gt; æ¥è§‚å¯Ÿ pod çš„åˆ›å»ºé”€æ¯æƒ…å†µï¼Œæ˜¯å¦å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/rollingupdate.png&#34; alt=&#34;rollingupdate&#34;&gt;&lt;/p&gt; &#xA;&lt;h3&gt;å­˜æ´»æ¢é’ˆ (livenessProb)&lt;/h3&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;å­˜æ´»æ¢æµ‹å™¨æ¥ç¡®å®šä»€ä¹ˆæ—¶å€™è¦é‡å¯å®¹å™¨ã€‚ ä¾‹å¦‚ï¼Œå­˜æ´»æ¢æµ‹å™¨å¯ä»¥æ¢æµ‹åˆ°åº”ç”¨æ­»é”ï¼ˆåº”ç”¨ç¨‹åºåœ¨è¿è¡Œï¼Œä½†æ˜¯æ— æ³•ç»§ç»­æ‰§è¡Œåé¢çš„æ­¥éª¤ï¼‰æƒ…å†µã€‚ é‡å¯è¿™ç§çŠ¶æ€ä¸‹çš„å®¹å™¨æœ‰åŠ©äºæé«˜åº”ç”¨çš„å¯ç”¨æ€§ï¼Œå³ä½¿å…¶ä¸­å­˜åœ¨ç¼ºé™·ã€‚-- &lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/&#34;&gt;LivenessProb&lt;/a&gt;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;åœ¨ç”Ÿäº§ä¸­ï¼Œæœ‰æ—¶å€™å› ä¸ºæŸäº› bug å¯¼è‡´åº”ç”¨æ­»é”æˆ–è€…çº¿ç¨‹è€—å°½äº†ï¼Œæœ€ç»ˆä¼šå¯¼è‡´åº”ç”¨æ— æ³•ç»§ç»­æä¾›æœåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæ²¡æœ‰æ‰‹æ®µæ¥è‡ªåŠ¨ç›‘æ§å’Œå¤„ç†è¿™ä¸€é—®é¢˜çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾ˆé•¿ä¸€æ®µæ—¶é—´æ— äººå‘ç°ã€‚&lt;a href=&#34;https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/&#34;&gt;kubelet&lt;/a&gt; ä½¿ç”¨å­˜æ´»æ¢æµ‹å™¨ (livenessProb) æ¥ç¡®å®šä»€ä¹ˆæ—¶å€™è¦é‡å¯å®¹å™¨ã€‚&lt;/p&gt; &#xA;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å†™ä¸€ä¸ª &lt;code&gt;/healthz&lt;/code&gt; æ¥å£æ¥è¯´æ˜ &lt;code&gt;livenessProb&lt;/code&gt; å¦‚ä½•ä½¿ç”¨ã€‚ &lt;code&gt;/healthz&lt;/code&gt; æ¥å£ä¼šåœ¨å¯åŠ¨æˆåŠŸçš„ 15s å†…æ­£å¸¸è¿”å› 200 çŠ¶æ€ç ï¼Œåœ¨ 15s åï¼Œä¼šä¸€ç›´è¿”å› 500 çš„çŠ¶æ€ç ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main&#xA;&#xA;import (&#xA;&#x9;&#34;fmt&#34;&#xA;&#x9;&#34;io&#34;&#xA;&#x9;&#34;net/http&#34;&#xA;&#x9;&#34;time&#34;&#xA;)&#xA;&#xA;func hello(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;io.WriteString(w, &#34;[v2] Hello, Kubernetes!&#34;)&#xA;}&#xA;&#xA;func main() {&#xA;&#x9;started := time.Now()&#xA;&#x9;http.HandleFunc(&#34;/healthz&#34;, func(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;&#x9;duration := time.Since(started)&#xA;&#x9;&#x9;if duration.Seconds() &amp;gt; 15 {&#xA;&#x9;&#x9;&#x9;w.WriteHeader(500)&#xA;&#x9;&#x9;&#x9;w.Write([]byte(fmt.Sprintf(&#34;error: %v&#34;, duration.Seconds())))&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;w.WriteHeader(200)&#xA;&#x9;&#x9;&#x9;w.Write([]byte(&#34;ok&#34;))&#xA;&#x9;&#x9;}&#xA;&#x9;})&#xA;&#xA;&#x9;http.HandleFunc(&#34;/&#34;, hello)&#xA;&#x9;http.ListenAndServe(&#34;:3000&#34;, nil)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;# Dockerfile&#xA;FROM golang:1.16-buster AS builder&#xA;RUN mkdir /src&#xA;ADD . /src&#xA;WORKDIR /src&#xA;&#xA;RUN go env -w GO111MODULE=auto&#xA;RUN go build -o main .&#xA;&#xA;FROM gcr.io/distroless/base-debian10&#xA;&#xA;WORKDIR /&#xA;&#xA;COPY --from=builder /src/main /main&#xA;EXPOSE 3000&#xA;ENTRYPOINT [&#34;/main&#34;]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;Dockerfile&lt;/code&gt; çš„ç¼–å†™å’ŒåŸæ¥ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬æŠŠ &lt;code&gt;tag&lt;/code&gt; ä¿®æ”¹ä¸º &lt;code&gt;liveness&lt;/code&gt; å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker build . -t guangzhengli/hellok8s:liveness&#xA;docker push guangzhengli/hellok8s:liveness&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æœ€åç¼–å†™ deployment çš„å®šä¹‰ï¼Œè¿™é‡Œä½¿ç”¨å­˜æ´»æ¢æµ‹æ–¹å¼æ˜¯ä½¿ç”¨ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚çš„æ˜¯åˆšæ‰å®šä¹‰çš„ &lt;code&gt;/healthz&lt;/code&gt; æ¥å£ï¼Œ&lt;code&gt;periodSeconds&lt;/code&gt; å­—æ®µæŒ‡å®šäº† kubelet æ¯éš” 3 ç§’æ‰§è¡Œä¸€æ¬¡å­˜æ´»æ¢æµ‹ã€‚ &lt;code&gt;initialDelaySeconds&lt;/code&gt; å­—æ®µå‘Šè¯‰ kubelet åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹å‰åº”è¯¥ç­‰å¾… 3 ç§’ã€‚å¦‚æœæœåŠ¡å™¨ä¸Š &lt;code&gt;/healthz&lt;/code&gt; è·¯å¾„ä¸‹çš„å¤„ç†ç¨‹åºè¿”å›æˆåŠŸä»£ç ï¼Œåˆ™ kubelet è®¤ä¸ºå®¹å™¨æ˜¯å¥åº·å­˜æ´»çš„ã€‚ å¦‚æœå¤„ç†ç¨‹åºè¿”å›å¤±è´¥ä»£ç ï¼Œåˆ™ kubelet ä¼šæ€æ­»è¿™ä¸ªå®¹å™¨å¹¶å°†å…¶é‡å¯ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  strategy:&#xA;     rollingUpdate:&#xA;      maxSurge: 1&#xA;      maxUnavailable: 1&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:liveness&#xA;          name: hellok8s-container&#xA;          livenessProbe:&#xA;            httpGet:&#xA;              path: /healthz&#xA;              port: 3000&#xA;            initialDelaySeconds: 3&#xA;            periodSeconds: 3&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;é€šè¿‡ &lt;code&gt;get&lt;/code&gt; æˆ–è€… &lt;code&gt;describe&lt;/code&gt; å‘½ä»¤å¯ä»¥å‘ç° pod ä¸€ç›´å¤„äºé‡å¯å½“ä¸­ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f deployment.yaml&#xA;&#xA;kubectl get pods&#xA;# NAME                                   READY   STATUS    RESTARTS     AGE&#xA;# hellok8s-deployment-5995ff9447-d5fbz   1/1     Running   4 (6s ago)   102s&#xA;# hellok8s-deployment-5995ff9447-gz2cx   1/1     Running   4 (5s ago)   101s&#xA;# hellok8s-deployment-5995ff9447-rh29x   1/1     Running   4 (6s ago)   102s&#xA;&#xA;kubectl describe pod hellok8s-68f47f657c-zwn6g&#xA;&#xA;# ...&#xA;# ...&#xA;# ...&#xA;# Events:&#xA;#  Type     Reason     Age                   From               Message&#xA;#  ----     ------     ----                  ----               -------&#xA;#  Normal   Scheduled  12m                   default-scheduler  Successfully assigned default/hellok8s-deployment-5995ff9447-rh29x to minikube&#xA;#  Normal   Pulled     11m (x4 over 12m)     kubelet            Container image &#34;guangzhengli/hellok8s:liveness&#34; already present on machine&#xA;#  Normal   Created    11m (x4 over 12m)     kubelet            Created container hellok8s-container&#xA;#  Normal   Started    11m (x4 over 12m)     kubelet            Started container hellok8s-container&#xA;#  Normal   Killing    11m (x3 over 12m)     kubelet            Container hellok8s-container failed liveness probe, will be restarted&#xA;#  Warning  Unhealthy  11m (x10 over 12m)    kubelet            Liveness probe failed: HTTP probe failed with statuscode: 500&#xA;#  Warning  BackOff    2m41s (x36 over 10m)  kubelet            Back-off restarting failed container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;å°±ç»ªæ¢é’ˆ (readiness)&lt;/h3&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;å°±ç»ªæ¢æµ‹å™¨å¯ä»¥çŸ¥é“å®¹å™¨ä½•æ—¶å‡†å¤‡å¥½æ¥å—è¯·æ±‚æµé‡ï¼Œå½“ä¸€ä¸ª Pod å†…çš„æ‰€æœ‰å®¹å™¨éƒ½å°±ç»ªæ—¶ï¼Œæ‰èƒ½è®¤ä¸ºè¯¥ Pod å°±ç»ªã€‚ è¿™ç§ä¿¡å·çš„ä¸€ä¸ªç”¨é€”å°±æ˜¯æ§åˆ¶å“ªä¸ª Pod ä½œä¸º Service çš„åç«¯ã€‚ è‹¥ Pod å°šæœªå°±ç»ªï¼Œä¼šè¢«ä» Service çš„è´Ÿè½½å‡è¡¡å™¨ä¸­å‰”é™¤ã€‚-- &lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/&#34;&gt;ReadinessProb&lt;/a&gt;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå‡çº§æœåŠ¡çš„ç‰ˆæœ¬æ˜¯æ—¥å¸¸çš„éœ€æ±‚ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸€ç§åœºæ™¯ï¼Œå³å½“å‘å¸ƒçš„ç‰ˆæœ¬å­˜åœ¨é—®é¢˜ï¼Œå°±ä¸åº”è¯¥è®©å®ƒå‡çº§æˆåŠŸã€‚kubelet ä½¿ç”¨å°±ç»ªæ¢æµ‹å™¨å¯ä»¥çŸ¥é“å®¹å™¨ä½•æ—¶å‡†å¤‡å¥½æ¥å—è¯·æ±‚æµé‡ï¼Œå½“ä¸€ä¸ª pod å‡çº§åä¸èƒ½å°±ç»ªï¼Œå³ä¸åº”è¯¥è®©æµé‡è¿›å…¥è¯¥ podï¼Œåœ¨é…åˆ &lt;code&gt;rollingUpate&lt;/code&gt; çš„åŠŸèƒ½ä¸‹ï¼Œä¹Ÿä¸èƒ½å…è®¸å‡çº§ç‰ˆæœ¬ç»§ç»­ä¸‹å»ï¼Œå¦åˆ™æœåŠ¡ä¼šå‡ºç°å…¨éƒ¨å‡çº§å®Œæˆï¼Œå¯¼è‡´æ‰€æœ‰æœåŠ¡å‡ä¸å¯ç”¨çš„æƒ…å†µã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬æŠŠæœåŠ¡å›æ»šåˆ° &lt;code&gt;hellok8s:v2&lt;/code&gt; çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡ä¸Šé¢å­¦ä¹ çš„æ–¹æ³•è¿›è¡Œå›æ»šã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl rollout undo deployment hellok8s-deployment --to-revision=2&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬å°†åº”ç”¨çš„ &lt;code&gt;/healthz&lt;/code&gt; æ¥å£ç›´æ¥è®¾ç½®æˆè¿”å› 500 çŠ¶æ€ç ï¼Œä»£è¡¨è¯¥ç‰ˆæœ¬æ˜¯ä¸€ä¸ªæœ‰é—®é¢˜çš„ç‰ˆæœ¬ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main&#xA;&#xA;import (&#xA;&#x9;&#34;io&#34;&#xA;&#x9;&#34;net/http&#34;&#xA;)&#xA;&#xA;func hello(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;io.WriteString(w, &#34;[v2] Hello, Kubernetes!&#34;)&#xA;}&#xA;&#xA;func main() {&#xA;&#x9;http.HandleFunc(&#34;/healthz&#34;, func(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;&#x9;&#x9;w.WriteHeader(500)&#xA;&#x9;})&#xA;&#xA;&#x9;http.HandleFunc(&#34;/&#34;, hello)&#xA;&#x9;http.ListenAndServe(&#34;:3000&#34;, nil)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;åœ¨ &lt;code&gt;build&lt;/code&gt; é˜¶æ®µæˆ‘ä»¬å°† &lt;code&gt;tag&lt;/code&gt; è®¾ç½®ä¸º &lt;code&gt;bad&lt;/code&gt;ï¼Œæ‰“åŒ…å push åˆ°è¿œç¨‹ä»“åº“ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker build . -t guangzhengli/hellok8s:bad&#xA;&#xA;docker push guangzhengli/hellok8s:bad&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€ç¼–å†™ deployment èµ„æºæ–‡ä»¶ï¼Œ&lt;a href=&#34;https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.25/#probe-v1-core&#34;&gt;Probe&lt;/a&gt; æœ‰å¾ˆå¤šé…ç½®å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®åœ°æ§åˆ¶å°±ç»ªæ£€æµ‹çš„è¡Œä¸ºï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;initialDelaySeconds&lt;/code&gt;ï¼šå®¹å™¨å¯åŠ¨åè¦ç­‰å¾…å¤šå°‘ç§’åæ‰å¯åŠ¨å­˜æ´»å’Œå°±ç»ªæ¢æµ‹å™¨ï¼Œ é»˜è®¤æ˜¯ 0 ç§’ï¼Œæœ€å°å€¼æ˜¯ 0ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;periodSeconds&lt;/code&gt;ï¼šæ‰§è¡Œæ¢æµ‹çš„æ—¶é—´é—´éš”ï¼ˆå•ä½æ˜¯ç§’ï¼‰ã€‚é»˜è®¤æ˜¯ 10 ç§’ã€‚æœ€å°å€¼æ˜¯ 1ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;timeoutSeconds&lt;/code&gt;ï¼šæ¢æµ‹çš„è¶…æ—¶åç­‰å¾…å¤šå°‘ç§’ã€‚é»˜è®¤å€¼æ˜¯ 1 ç§’ã€‚æœ€å°å€¼æ˜¯ 1ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;successThreshold&lt;/code&gt;ï¼šæ¢æµ‹å™¨åœ¨å¤±è´¥åï¼Œè¢«è§†ä¸ºæˆåŠŸçš„æœ€å°è¿ç»­æˆåŠŸæ•°ã€‚é»˜è®¤å€¼æ˜¯ 1ã€‚ å­˜æ´»å’Œå¯åŠ¨æ¢æµ‹çš„è¿™ä¸ªå€¼å¿…é¡»æ˜¯ 1ã€‚æœ€å°å€¼æ˜¯ 1ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;failureThreshold&lt;/code&gt;ï¼šå½“æ¢æµ‹å¤±è´¥æ—¶ï¼ŒKubernetes çš„é‡è¯•æ¬¡æ•°ã€‚ å¯¹å­˜æ´»æ¢æµ‹è€Œè¨€ï¼Œæ”¾å¼ƒå°±æ„å‘³ç€é‡æ–°å¯åŠ¨å®¹å™¨ã€‚ å¯¹å°±ç»ªæ¢æµ‹è€Œè¨€ï¼Œæ”¾å¼ƒæ„å‘³ç€ Pod ä¼šè¢«æ‰“ä¸Šæœªå°±ç»ªçš„æ ‡ç­¾ã€‚é»˜è®¤å€¼æ˜¯ 3ã€‚æœ€å°å€¼æ˜¯ 1ã€‚&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  strategy:&#xA;     rollingUpdate:&#xA;      maxSurge: 1&#xA;      maxUnavailable: 1&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:bad&#xA;          name: hellok8s-container&#xA;          readinessProbe:&#xA;            httpGet:&#xA;              path: /healthz&#xA;              port: 3000&#xA;            initialDelaySeconds: 1&#xA;            successThreshold: 5&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;é€šè¿‡ &lt;code&gt;get&lt;/code&gt; å‘½ä»¤å¯ä»¥å‘ç°ä¸¤ä¸ª pod ä¸€ç›´å¤„äºè¿˜æ²¡æœ‰ Ready çš„çŠ¶æ€å½“ä¸­ï¼Œé€šè¿‡ &lt;code&gt;describe&lt;/code&gt; å‘½ä»¤å¯ä»¥çœ‹åˆ°æ˜¯å› ä¸º &lt;code&gt;Readiness probe failed: HTTP probe failed with statuscode: 500&lt;/code&gt; çš„åŸå› ã€‚åˆå› ä¸ºè®¾ç½®äº†æœ€å°ä¸å¯ç”¨çš„æœåŠ¡æ•°é‡ä¸º&lt;code&gt;maxUnavailable=1&lt;/code&gt;ï¼Œè¿™æ ·èƒ½ä¿è¯å‰©ä¸‹ä¸¤ä¸ª &lt;code&gt;v2&lt;/code&gt; ç‰ˆæœ¬çš„ &lt;code&gt;hellok8s&lt;/code&gt; èƒ½ç»§ç»­æä¾›æœåŠ¡ï¼&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f deployment.yaml&#xA;&#xA;kubectl get pods                &#xA;# NAME                                   READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-66799848c4-8xzsz   1/1     Running   0          102s&#xA;# hellok8s-deployment-66799848c4-m9dl5   1/1     Running   0          102s&#xA;# hellok8s-deployment-9c57c7f56-rww7k    0/1     Running   0          26s&#xA;# hellok8s-deployment-9c57c7f56-xt9tw    0/1     Running   0          26s&#xA;&#xA;&#xA;kubectl describe pod hellok8s-deployment-9c57c7f56-rww7k&#xA;# Events:&#xA;#   Type     Reason     Age                From               Message&#xA;#   ----     ------     ----               ----               -------&#xA;#   Normal   Scheduled  74s                default-scheduler  Successfully assigned default/hellok8s-deployment-9c57c7f56-rww7k to minikube&#xA;#   Normal   Pulled     73s                kubelet            Container image &#34;guangzhengli/hellok8s:bad&#34; already present on machine&#xA;#   Normal   Created    73s                kubelet            Created container hellok8s-container&#xA;#   Normal   Started    73s                kubelet            Started container hellok8s-container&#xA;#   Warning  Unhealthy  0s (x10 over 72s)  kubelet            Readiness probe failed: HTTP probe failed with statuscode: 500&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Service&lt;/h2&gt; &#xA;&lt;p&gt;ç»è¿‡å‰é¢å‡ èŠ‚çš„ç»ƒä¹ ï¼Œå¯èƒ½ä½ ä¼šæœ‰ä¸€äº›ç–‘æƒ‘ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;ä¸ºä»€ä¹ˆ pod ä¸å°±ç»ª (Ready) çš„è¯ï¼Œ&lt;code&gt;kubernetes&lt;/code&gt; ä¸ä¼šå°†æµé‡é‡å®šå‘åˆ°è¯¥ podï¼Œè¿™æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ&lt;/li&gt; &#xA; &lt;li&gt;å‰é¢è®¿é—®æœåŠ¡çš„æ–¹å¼æ˜¯é€šè¿‡ &lt;code&gt;port-forword&lt;/code&gt; å°† pod çš„ç«¯å£æš´éœ²åˆ°æœ¬åœ°ï¼Œä¸ä»…éœ€è¦å†™å¯¹ pod çš„åå­—ï¼Œä¸€æ—¦ deployment é‡æ–°åˆ›å»ºæ–°çš„ podï¼Œpod åå­—å’Œ pod çš„ IP åœ°å€ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼Œæœ‰æ²¡æœ‰ä¸€ä¸ªåœ°å€èƒ½è®©æˆ‘ä»¬ç¨³å®šè®¿é—®ï¼Ÿ&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;port-forword&lt;/code&gt; çš„æ–¹å¼éœ€è¦æœ‰æƒé™è®¿é—® &lt;code&gt;kubernetes&lt;/code&gt; é›†ç¾¤æ‰èƒ½åšåˆ°ï¼Œéš¾é“ç”Ÿäº§ç¯å¢ƒä¹Ÿèƒ½è¿™ä¹ˆåšå—ï¼Ÿ&lt;/li&gt; &#xA; &lt;li&gt;å¦‚æœéƒ¨ç½²äº†å¤šä¸ªå‰¯æœ¬ podï¼Œå¦‚ä½•åšè´Ÿè½½å‡è¡¡ï¼Ÿ&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;kubernetes&lt;/code&gt; æä¾›äº†ä¸€ç§åå« &lt;code&gt;Service&lt;/code&gt; çš„èµ„æºå¸®åŠ©è§£å†³è¿™äº›é—®é¢˜ï¼Œå®ƒä¸º pod æä¾›ä¸€ä¸ªç¨³å®šçš„ Endpointã€‚Servie ä½äº pod çš„å‰é¢ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚å¹¶å°†å®ƒä»¬ä¼ é€’ç»™å®ƒåé¢çš„æ‰€æœ‰podã€‚ä¸€æ—¦æœåŠ¡ä¸­çš„ Pod é›†åˆå‘ç”Ÿæ›´æ”¹ï¼ŒEndpoints å°±ä¼šè¢«æ›´æ–°ï¼Œè¯·æ±‚çš„é‡å®šå‘è‡ªç„¶ä¹Ÿä¼šå¯¼å‘æœ€æ–°çš„ podã€‚&lt;/p&gt; &#xA;&lt;h3&gt;ClusterIP&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ &lt;code&gt;Service&lt;/code&gt; é»˜è®¤ä½¿ç”¨çš„ &lt;code&gt;ClusterIP&lt;/code&gt; ç±»å‹ï¼Œé¦–å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œåœ¨ä¹‹å‰çš„ &lt;code&gt;hellok8s:v2&lt;/code&gt; ç‰ˆæœ¬ä¸ŠåŠ ä¸Šè¿”å›å½“å‰æœåŠ¡æ‰€åœ¨çš„ &lt;code&gt;hostname&lt;/code&gt; åŠŸèƒ½ï¼Œå‡çº§åˆ° &lt;code&gt;v3&lt;/code&gt; ç‰ˆæœ¬ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main&#xA;&#xA;import (&#xA;&#x9;&#34;fmt&#34;&#xA;&#x9;&#34;io&#34;&#xA;&#x9;&#34;net/http&#34;&#xA;&#x9;&#34;os&#34;&#xA;)&#xA;&#xA;func hello(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;host, _ := os.Hostname()&#xA;&#x9;io.WriteString(w, fmt.Sprintf(&#34;[v3] Hello, Kubernetes!, From host: %s&#34;, host))&#xA;}&#xA;&#xA;func main() {&#xA;&#x9;http.HandleFunc(&#34;/&#34;, hello)&#xA;&#x9;http.ListenAndServe(&#34;:3000&#34;, nil)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;Dockerfile&lt;/code&gt; å’Œä¹‹å‰ä¿æŒä¸€è‡´ï¼Œæ‰“åŒ… &lt;code&gt;tag=v3&lt;/code&gt; å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker build . -t guangzhengli/hellok8s:v3&#xA;&#xA;docker push guangzhengli/hellok8s:v3&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä¿®æ”¹ deployment çš„ &lt;code&gt;hellok8s&lt;/code&gt; ä¸º &lt;code&gt;v3&lt;/code&gt; ç‰ˆæœ¬ã€‚æ‰§è¡Œ &lt;code&gt;kubectl apply -f deployment.yaml&lt;/code&gt; æ›´æ–° deploymentã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:v3&#xA;          name: hellok8s-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ä¸‹æ¥æ˜¯ &lt;code&gt;Service&lt;/code&gt; èµ„æºçš„å®šä¹‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;ClusterIP&lt;/code&gt; çš„æ–¹å¼å®šä¹‰ Serviceï¼Œé€šè¿‡ &lt;code&gt;kubernetes&lt;/code&gt; é›†ç¾¤çš„å†…éƒ¨ IP æš´éœ²æœåŠ¡ï¼Œå½“æˆ‘ä»¬åªéœ€è¦è®©é›†ç¾¤ä¸­è¿è¡Œçš„å…¶ä»–åº”ç”¨ç¨‹åºè®¿é—®æˆ‘ä»¬çš„podæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§ç±»å‹çš„æœåŠ¡ã€‚åˆ›å»ºä¸€ä¸ª service-hellok8s-clusterip.yaml` æ–‡ä»¶ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Service&#xA;metadata:&#xA;  name: service-hellok8s-clusterip&#xA;spec:&#xA;  type: ClusterIP&#xA;  selector:&#xA;    app: hellok8s&#xA;  ports:&#xA;  - port: 3000&#xA;    targetPort: 3000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f service-hellok8s-clusterip.yaml&#xA;&#xA;kubectl get service&#xA;# NAME                         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE&#xA;# service-hellok8s-clusterip   ClusterIP   10.104.96.153   &amp;lt;none&amp;gt;        3000/TCP   10s&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨é›†ç¾¤å…¶å®ƒåº”ç”¨ä¸­è®¿é—® &lt;code&gt;service-hellok8s-clusterip&lt;/code&gt; çš„ IP åœ°å€ &lt;code&gt;10.104.96.153&lt;/code&gt; æ¥è®¿é—® &lt;code&gt;hellok8s:v3&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™é‡Œé€šè¿‡åœ¨é›†ç¾¤å†…åˆ›å»ºä¸€ä¸ª &lt;code&gt;nginx&lt;/code&gt; æ¥è®¿é—®ã€‚åˆ›å»ºåè¿›å…¥ &lt;code&gt;nginx&lt;/code&gt; å®¹å™¨æ¥ç”¨ &lt;code&gt;curl&lt;/code&gt; å‘½ä»¤è®¿é—® &lt;code&gt;service-hellok8s-clusterip&lt;/code&gt; ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Pod&#xA;metadata:&#xA;  name: nginx&#xA;  labels:&#xA;    app: nginx&#xA;spec:&#xA;  containers:&#xA;    - name: nginx-container&#xA;      image: nginx&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl get pods&#xA;# NAME                                   READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-5d5545b69c-24lw5   1/1     Running   0          27m&#xA;# hellok8s-deployment-5d5545b69c-9g94t   1/1     Running   0          27m&#xA;# hellok8s-deployment-5d5545b69c-9gm8r   1/1     Running   0          27m&#xA;# nginx                                  1/1     Running   0          41m&#xA;&#xA;kubectl get service&#xA;# NAME                         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE&#xA;# service-hellok8s-clusterip   ClusterIP   10.104.96.153   &amp;lt;none&amp;gt;        3000/TCP   10s&#xA;&#xA;kubectl exec -it nginx-pod /bin/bash&#xA;# root@nginx-pod:/# curl 10.104.96.153:3000&#xA;# [v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-9gm8r&#xA;# root@nginx-pod:/# curl 10.104.96.153:3000&#xA;#[v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-9g94t&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¤šæ¬¡ &lt;code&gt;curl 10.104.96.153:3000&lt;/code&gt; è®¿é—® &lt;code&gt;hellok8s&lt;/code&gt; Service IP åœ°å€ï¼Œè¿”å›çš„ &lt;code&gt;hellok8s:v3&lt;/code&gt; &lt;code&gt;hostname&lt;/code&gt; ä¸ä¸€æ ·ï¼Œè¯´æ˜ Service å¯ä»¥æ¥æ”¶è¯·æ±‚å¹¶å°†å®ƒä»¬ä¼ é€’ç»™å®ƒåé¢çš„æ‰€æœ‰ podï¼Œè¿˜å¯ä»¥è‡ªåŠ¨è´Ÿè½½å‡è¡¡ã€‚ä½ ä¹Ÿå¯ä»¥è¯•è¯•å¢åŠ æˆ–è€…å‡å°‘ &lt;code&gt;hellok8s:v3&lt;/code&gt; pod å‰¯æœ¬æ•°é‡ï¼Œè§‚å¯Ÿ Service çš„è¯·æ±‚æ˜¯å¦ä¼šåŠ¨æ€å˜æ›´ã€‚è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/service-clusterip-fix-name.png&#34; alt=&#34;service-clusterip-fix-name&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;é™¤äº†ä¸Šè¿°çš„ &lt;code&gt;ClusterIp&lt;/code&gt; çš„æ–¹å¼å¤–ï¼ŒKubernetes &lt;code&gt;ServiceTypes&lt;/code&gt; å…è®¸æŒ‡å®šä½ æ‰€éœ€è¦çš„ Service ç±»å‹ï¼Œé»˜è®¤æ˜¯ &lt;code&gt;ClusterIP&lt;/code&gt;ã€‚&lt;code&gt;Type&lt;/code&gt; çš„å€¼åŒ…æ‹¬å¦‚ä¸‹ï¼š&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;ClusterIP&lt;/code&gt;ï¼šé€šè¿‡é›†ç¾¤çš„å†…éƒ¨ IP æš´éœ²æœåŠ¡ï¼Œé€‰æ‹©è¯¥å€¼æ—¶æœåŠ¡åªèƒ½å¤Ÿåœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚ è¿™ä¹Ÿæ˜¯é»˜è®¤çš„ &lt;code&gt;ServiceType&lt;/code&gt;ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport&#34;&gt;&lt;code&gt;NodePort&lt;/code&gt;&lt;/a&gt;ï¼šé€šè¿‡æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ IP å’Œé™æ€ç«¯å£ï¼ˆ&lt;code&gt;NodePort&lt;/code&gt;ï¼‰æš´éœ²æœåŠ¡ã€‚ &lt;code&gt;NodePort&lt;/code&gt; æœåŠ¡ä¼šè·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ &lt;code&gt;ClusterIP&lt;/code&gt; æœåŠ¡ã€‚ é€šè¿‡è¯·æ±‚ &lt;code&gt;&amp;lt;èŠ‚ç‚¹ IP&amp;gt;:&amp;lt;èŠ‚ç‚¹ç«¯å£&amp;gt;&lt;/code&gt;ï¼Œä½ å¯ä»¥ä»é›†ç¾¤çš„å¤–éƒ¨è®¿é—®ä¸€ä¸ª &lt;code&gt;NodePort&lt;/code&gt; æœåŠ¡ã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer&#34;&gt;&lt;code&gt;LoadBalancer&lt;/code&gt;&lt;/a&gt;ï¼šä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å‘å¤–éƒ¨æš´éœ²æœåŠ¡ã€‚ å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨å¯ä»¥å°†æµé‡è·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ &lt;code&gt;NodePort&lt;/code&gt; æœåŠ¡å’Œ &lt;code&gt;ClusterIP&lt;/code&gt; æœåŠ¡ä¸Šã€‚&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/#externalname&#34;&gt;&lt;code&gt;ExternalName&lt;/code&gt;&lt;/a&gt;ï¼šé€šè¿‡è¿”å› &lt;code&gt;CNAME&lt;/code&gt; å’Œå¯¹åº”å€¼ï¼Œå¯ä»¥å°†æœåŠ¡æ˜ å°„åˆ° &lt;code&gt;externalName&lt;/code&gt; å­—æ®µçš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œ&lt;code&gt;foo.bar.example.com&lt;/code&gt;ï¼‰ã€‚ æ— éœ€åˆ›å»ºä»»ä½•ç±»å‹ä»£ç†ã€‚&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;NodePort&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬çŸ¥é“&lt;code&gt;kubernetes&lt;/code&gt; é›†ç¾¤å¹¶ä¸æ˜¯å•æœºè¿è¡Œï¼Œå®ƒç®¡ç†ç€å¤šå°èŠ‚ç‚¹å³ &lt;a href=&#34;https://kubernetes.io/docs/concepts/architecture/nodes/&#34;&gt;Node&lt;/a&gt;ï¼Œå¯ä»¥é€šè¿‡æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ IP å’Œé™æ€ç«¯å£ï¼ˆ&lt;code&gt;NodePort&lt;/code&gt;ï¼‰æš´éœ²æœåŠ¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœé›†ç¾¤å†…æœ‰ä¸¤å° Node è¿è¡Œç€ &lt;code&gt;hellok8s:v3&lt;/code&gt;ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª &lt;code&gt;NodePort&lt;/code&gt; ç±»å‹çš„ Serviceï¼Œå°† &lt;code&gt;hellok8s:v3&lt;/code&gt; çš„ &lt;code&gt;3000&lt;/code&gt; ç«¯å£æ˜ å°„åˆ° Node æœºå™¨çš„ &lt;code&gt;30000&lt;/code&gt; ç«¯å£ (åœ¨ 30000-32767 èŒƒå›´å†…)ï¼Œå°±å¯ä»¥é€šè¿‡è®¿é—® &lt;code&gt;http://node1-ip:30000&lt;/code&gt; æˆ–è€… &lt;code&gt;http://node2-ip:30000&lt;/code&gt; è®¿é—®åˆ°æœåŠ¡ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/service-nodeport-fix-name.png&#34; alt=&#34;service-nodeport-fix-name&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;è¿™é‡Œä»¥ &lt;code&gt;minikube&lt;/code&gt; ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;minikube ip&lt;/code&gt; å‘½ä»¤æ‹¿åˆ° k8s cluster node IPåœ°å€ã€‚ä¸‹é¢çš„æ•™ç¨‹éƒ½ä»¥æˆ‘æœ¬æœºçš„ &lt;code&gt;192.168.59.100&lt;/code&gt; ä¸ºä¾‹ï¼Œéœ€è¦æ›¿æ¢æˆä½ çš„ IP åœ°å€ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;minikube ip&#xA;# 192.168.59.100&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€ä»¥ NodePort çš„ ServiceType åˆ›å»ºä¸€ä¸ª Service æ¥æ¥ç®¡ pod æµé‡ã€‚é€šè¿‡&lt;code&gt;minikube&lt;/code&gt; èŠ‚ç‚¹ä¸Šçš„ IP &lt;code&gt;192.168.59.100&lt;/code&gt; æš´éœ²æœåŠ¡ã€‚ &lt;code&gt;NodePort&lt;/code&gt; æœåŠ¡ä¼šè·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ &lt;code&gt;ClusterIP&lt;/code&gt; æœåŠ¡ã€‚ é€šè¿‡è¯·æ±‚ &lt;code&gt;&amp;lt;èŠ‚ç‚¹ IP&amp;gt;:&amp;lt;èŠ‚ç‚¹ç«¯å£&amp;gt;&lt;/code&gt; -- &lt;code&gt;192.168.59.100&lt;/code&gt;:30000ï¼Œä½ å¯ä»¥ä»é›†ç¾¤çš„å¤–éƒ¨è®¿é—®ä¸€ä¸ª &lt;code&gt;NodePort&lt;/code&gt; æœåŠ¡ï¼Œæœ€ç»ˆé‡å®šå‘åˆ° &lt;code&gt;hellok8s:v3&lt;/code&gt; çš„ &lt;code&gt;3000&lt;/code&gt; ç«¯å£ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Service&#xA;metadata:&#xA;  name: service-hellok8s-nodeport&#xA;spec:&#xA;  type: NodePort&#xA;  selector:&#xA;    app: hellok8s&#xA;  ports:&#xA;  - port: 3000&#xA;    nodePort: 30000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;åˆ›å»º &lt;code&gt;service-hellok8s-nodeport&lt;/code&gt; Servcie åï¼Œä½¿ç”¨ &lt;code&gt;curl&lt;/code&gt; å‘½ä»¤æˆ–è€…æµè§ˆå™¨è®¿é—® &lt;code&gt;http://192.168.59.100:30000&lt;/code&gt; å¯ä»¥å¾—åˆ°ç»“æœã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl&amp;nbsp;apply&amp;nbsp;-f&amp;nbsp;service-hellok8s-nodeport.yaml&#xA;&#xA;kubectl get service&#xA;# NAME                         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE&#xA;# service-hellok8s-nodeport    NodePort    10.109.188.161   &amp;lt;none&amp;gt;        3000:30000/TCP   28s&#xA;&#xA;kubectl get pods&#xA;# NAME                                   READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-5d5545b69c-24lw5   1/1     Running   0          27m&#xA;# hellok8s-deployment-5d5545b69c-9g94t   1/1     Running   0          27m&#xA;# hellok8s-deployment-5d5545b69c-9gm8r   1/1     Running   0          27m&#xA;&#xA;curl http://192.168.59.100:30000&#xA;# [v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-9g94t&#xA;&#xA;curl http://192.168.59.100:30000&#xA;# [v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-24lw5&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;LoadBalancer&lt;/h3&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer&#34;&gt;&lt;code&gt;LoadBalancer&lt;/code&gt;&lt;/a&gt; æ˜¯ä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å‘å¤–éƒ¨æš´éœ²æœåŠ¡ã€‚ å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨å¯ä»¥å°†æµé‡è·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ &lt;code&gt;NodePort&lt;/code&gt; æœåŠ¡å’Œ &lt;code&gt;ClusterIP&lt;/code&gt; æœåŠ¡ä¸Šï¼Œå‡å¦‚ä½ åœ¨ &lt;a href=&#34;https://aws.amazon.com&#34;&gt;AWS&lt;/a&gt; çš„ &lt;a href=&#34;https://aws.amazon.com/eks/&#34;&gt;EKS&lt;/a&gt; é›†ç¾¤ä¸Šåˆ›å»ºä¸€ä¸ª Type ä¸º &lt;code&gt;LoadBalancer&lt;/code&gt; çš„ Serviceã€‚å®ƒä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª ELB (&lt;a href=&#34;https://aws.amazon.com/elasticloadbalancing&#34;&gt;Elastic Load Balancer&lt;/a&gt;) ï¼Œå¹¶å¯ä»¥æ ¹æ®é…ç½®çš„ IP æ± ä¸­è‡ªåŠ¨åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„ IP åœ°å€ï¼Œå¯ä»¥ä¾›å¤–éƒ¨è®¿é—®ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™é‡Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ &lt;code&gt;minikube&lt;/code&gt;ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;minikube tunnel&lt;/code&gt; æ¥è¾…åŠ©åˆ›å»º LoadBalancer çš„ &lt;code&gt;EXTERNAL_IP&lt;/code&gt;ï¼Œå…·ä½“æ•™ç¨‹å¯ä»¥æŸ¥çœ‹&lt;a href=&#34;https://minikube.sigs.k8s.io/docs/handbook/accessing/#loadbalancer-access&#34;&gt;å®˜ç½‘æ–‡æ¡£&lt;/a&gt;ï¼Œä½†æ˜¯å’Œå®é™…äº‘æä¾›å•†çš„ LoadBalancer è¿˜æ˜¯æœ‰æœ¬è´¨åŒºåˆ«ï¼Œæ‰€ä»¥ &lt;a href=&#34;https://github.com/guangzhengli/kubernetes_workshop&#34;&gt;Repository&lt;/a&gt; ä¸åšæ›´å¤šé˜è¿°ï¼Œæœ‰æ¡ä»¶çš„å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://aws.amazon.com&#34;&gt;AWS&lt;/a&gt; çš„ &lt;a href=&#34;https://aws.amazon.com/eks/&#34;&gt;EKS&lt;/a&gt; é›†ç¾¤ä¸Šåˆ›å»ºä¸€ä¸ª ELB (&lt;a href=&#34;https://aws.amazon.com/elasticloadbalancing&#34;&gt;Elastic Load Balancer&lt;/a&gt;) è¯•è¯•ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ä¸‹å›¾æ˜¾ç¤º LoadBalancer çš„ Service æ¶æ„å›¾ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/service-loadbalancer-fix-name.png&#34; alt=&#34;service-loadbalancer-fix-name&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;ingress&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.25/#ingress-v1beta1-networking-k8s-io&#34;&gt;Ingress&lt;/a&gt; å…¬å¼€ä»é›†ç¾¤å¤–éƒ¨åˆ°é›†ç¾¤å†…&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/&#34;&gt;æœåŠ¡&lt;/a&gt;çš„ HTTP å’Œ HTTPS è·¯ç”±ã€‚ æµé‡è·¯ç”±ç”± Ingress èµ„æºä¸Šå®šä¹‰çš„è§„åˆ™æ§åˆ¶ã€‚Ingress å¯ä¸º Service æä¾›å¤–éƒ¨å¯è®¿é—®çš„ URLã€è´Ÿè½½å‡è¡¡æµé‡ã€ SSL/TLSï¼Œä»¥åŠåŸºäºåç§°çš„è™šæ‹Ÿæ‰˜ç®¡ã€‚ä½ å¿…é¡»æ‹¥æœ‰ä¸€ä¸ª &lt;a href=&#34;https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress-controllers&#34;&gt;Ingress æ§åˆ¶å™¨&lt;/a&gt; æ‰èƒ½æ»¡è¶³ Ingress çš„è¦æ±‚ã€‚ ä»…åˆ›å»º Ingress èµ„æºæœ¬èº«æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚ &lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers&#34;&gt;Ingress æ§åˆ¶å™¨&lt;/a&gt; é€šå¸¸è´Ÿè´£é€šè¿‡è´Ÿè½½å‡è¡¡å™¨æ¥å®ç° Ingressï¼Œä¾‹å¦‚ &lt;code&gt;minikube&lt;/code&gt; é»˜è®¤ä½¿ç”¨çš„æ˜¯ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/tutorials/nginx_tcp_udp_ingress/&#34;&gt;nginx-ingress&lt;/a&gt;ï¼Œç›®å‰ &lt;code&gt;minikube&lt;/code&gt; ä¹Ÿæ”¯æŒ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/handbook/addons/kong-ingress/&#34;&gt;Kong-Ingress&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;Ingress å¯ä»¥â€œç®€å•ç†è§£â€ä¸ºæœåŠ¡çš„ç½‘å…³ Gatewayï¼Œå®ƒæ˜¯æ‰€æœ‰æµé‡çš„å…¥å£ï¼Œç»è¿‡é…ç½®çš„è·¯ç”±è§„åˆ™ï¼Œå°†æµé‡é‡å®šå‘åˆ°åç«¯çš„æœåŠ¡ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨ &lt;code&gt;minikube&lt;/code&gt; ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤å¼€å¯ Ingress-Controller çš„åŠŸèƒ½ã€‚é»˜è®¤ä½¿ç”¨çš„æ˜¯ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/tutorials/nginx_tcp_udp_ingress/&#34;&gt;nginx-ingress&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;minikube addons enable ingress&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€åˆ é™¤ä¹‹å‰åˆ›å»ºçš„æ‰€æœ‰ &lt;code&gt;pod&lt;/code&gt;, &lt;code&gt;deployment&lt;/code&gt;, &lt;code&gt;service&lt;/code&gt; èµ„æºã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl delete deployment,service --all&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€æ ¹æ®ä¹‹å‰çš„æ•™ç¨‹ï¼Œåˆ›å»º &lt;code&gt;hellok8s:v3&lt;/code&gt; å’Œ &lt;code&gt;nginx&lt;/code&gt; çš„&lt;code&gt;deployment&lt;/code&gt;ä¸ &lt;code&gt;service&lt;/code&gt; èµ„æºã€‚Service çš„ type ä¸º ClusterIP å³å¯ã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;hellok8s:v3&lt;/code&gt; çš„ç«¯å£æ˜ å°„ä¸º &lt;code&gt;3000:3000&lt;/code&gt;ï¼Œ&lt;code&gt;nginx&lt;/code&gt; çš„ç«¯å£æ˜ å°„ä¸º &lt;code&gt;4000:80&lt;/code&gt;ï¼Œè¿™é‡Œåç»­å†™ Ingress Route è§„åˆ™æ—¶ä¼šç”¨åˆ°ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Service&#xA;metadata:&#xA;  name: service-hellok8s-clusterip&#xA;spec:&#xA;  type: ClusterIP&#xA;  selector:&#xA;    app: hellok8s&#xA;  ports:&#xA;  - port: 3000&#xA;    targetPort: 3000&#xA;&#xA;---&#xA;&#xA;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:v3&#xA;          name: hellok8s-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Service&#xA;metadata:&#xA;  name: service-nginx-clusterip&#xA;spec:&#xA;  type: ClusterIP&#xA;  selector:&#xA;    app: nginx&#xA;  ports:&#xA;  - port: 4000&#xA;    targetPort: 80&#xA;&#xA;---&#xA;&#xA;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: nginx-deployment&#xA;spec:&#xA;  replicas: 2&#xA;  selector:&#xA;    matchLabels:&#xA;      app: nginx&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: nginx&#xA;    spec:&#xA;      containers:&#xA;      - image: nginx&#xA;        name: nginx-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f hellok8s.yaml                 &#xA;# service/service-hellok8s-clusterip created&#xA;# deployment.apps/hellok8s-deployment created&#xA;&#xA;kubectl apply -f nginx.yaml   &#xA;# service/service-nginx-clusterip created&#xA;# deployment.apps/nginx-deployment created&#xA;&#xA;kubectl get pods            &#xA;# NAME                                   READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-5d5545b69c-4wvmf   1/1     Running   0          55s&#xA;# hellok8s-deployment-5d5545b69c-qcszp   1/1     Running   0          55s&#xA;# hellok8s-deployment-5d5545b69c-sn7mn   1/1     Running   0          55s&#xA;# nginx-deployment-d47fd7f66-d9r7x       1/1     Running   0          34s&#xA;# nginx-deployment-d47fd7f66-hp5nf       1/1     Running   0          34s&#xA;&#xA;kubectl get service&#xA;# NAME                         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE&#xA;# service-hellok8s-clusterip   ClusterIP   10.97.88.18      &amp;lt;none&amp;gt;        3000/TCP   77s&#xA;# service-nginx-clusterip      ClusterIP   10.103.161.247   &amp;lt;none&amp;gt;        4000/TCP   56s&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è¿™æ ·åœ¨ k8s é›†ç¾¤ä¸­ï¼Œå°±æœ‰ 3 ä¸ª &lt;code&gt;hellok8s:v3&lt;/code&gt; çš„ podï¼Œ2 ä¸ª &lt;code&gt;nginx&lt;/code&gt; çš„ podã€‚å¹¶ä¸”&lt;code&gt;hellok8s:v3&lt;/code&gt; çš„ç«¯å£æ˜ å°„ä¸º &lt;code&gt;3000:3000&lt;/code&gt;ï¼Œ&lt;code&gt;nginx&lt;/code&gt; çš„ç«¯å£æ˜ å°„ä¸º &lt;code&gt;4000:80&lt;/code&gt;ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæ¥ä¸‹æ¥ç¼–å†™ Ingress èµ„æºçš„å®šä¹‰ï¼Œ&lt;code&gt;nginx.ingress.kubernetes.io/ssl-redirect: &#34;false&#34;&lt;/code&gt; çš„æ„æ€æ˜¯è¿™é‡Œå…³é—­ &lt;code&gt;https&lt;/code&gt; è¿æ¥ï¼Œåªä½¿ç”¨ &lt;code&gt;http&lt;/code&gt; è¿æ¥ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åŒ¹é…å‰ç¼€ä¸º &lt;code&gt;/hello&lt;/code&gt; çš„è·¯ç”±è§„åˆ™ï¼Œé‡å®šå‘åˆ° &lt;code&gt;hellok8s:v3&lt;/code&gt; æœåŠ¡ï¼ŒåŒ¹é…å‰ç¼€ä¸º &lt;code&gt;/&lt;/code&gt; çš„è·Ÿè·¯å¾„é‡å®šå‘åˆ° &lt;code&gt;nginx&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: networking.k8s.io/v1&#xA;kind: Ingress&#xA;metadata:&#xA;  name: hello-ingress&#xA;  annotations:&#xA;    # We are defining this annotation to prevent nginx&#xA;    # from redirecting requests to `https` for now&#xA;    nginx.ingress.kubernetes.io/ssl-redirect: &#34;false&#34;&#xA;spec:&#xA;  rules:&#xA;    - http:&#xA;        paths:&#xA;          - path: /hello&#xA;            pathType: Prefix&#xA;            backend:&#xA;              service:&#xA;                name: service-hellok8s-clusterip&#xA;                port:&#xA;                  number: 3000&#xA;          - path: /&#xA;            pathType: Prefix&#xA;            backend:&#xA;              service:&#xA;                name: service-nginx-clusterip&#xA;                port:&#xA;                  number: 4000&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f ingress.yaml&#xA;# ingress.extensions/hello-ingress created&#xA;&#xA;kubectl get ingress          &#xA;# NAME            CLASS   HOSTS   ADDRESS   PORTS   AGE&#xA;# hello-ingress   nginx   *                 80      16s&#xA;&#xA;# replace 192.168.59.100 by your minikube ip&#xA;curl http://192.168.59.100/hello&#xA;# [v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-sn7mn&#xA;&#xA;curl http://192.168.59.100/&#xA;# (....Thank you for using nginx.....)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä¸Šé¢çš„æ•™ç¨‹ä¸­å°†æ‰€æœ‰æµé‡éƒ½å‘é€åˆ° Ingress ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/ingress.png&#34; alt=&#34;ingress&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Namespace&lt;/h2&gt; &#xA;&lt;p&gt;åœ¨å®é™…çš„å¼€å‘å½“ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸åŒçš„ç¯å¢ƒæ¥åšå¼€å‘å’Œæµ‹è¯•ï¼Œä¾‹å¦‚ &lt;code&gt;dev&lt;/code&gt; ç¯å¢ƒç»™å¼€å‘ä½¿ç”¨ï¼Œ&lt;code&gt;test&lt;/code&gt; ç¯å¢ƒç»™ QA ä½¿ç”¨ï¼Œé‚£ä¹ˆ k8s èƒ½ä¸èƒ½åœ¨ä¸åŒç¯å¢ƒ &lt;code&gt;dev&lt;/code&gt; &lt;code&gt;test&lt;/code&gt; &lt;code&gt;uat&lt;/code&gt; &lt;code&gt;prod&lt;/code&gt; ä¸­åŒºåˆ†èµ„æºï¼Œè®©ä¸åŒç¯å¢ƒçš„èµ„æºç‹¬ç«‹äº’ç›¸ä¸å½±å“å‘¢ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œk8s æä¾›äº†åä¸º Namespace çš„èµ„æºæ¥å¸®åŠ©éš”ç¦»èµ„æºã€‚&lt;/p&gt; &#xA;&lt;p&gt;åœ¨ Kubernetes ä¸­ï¼Œ&lt;strong&gt;åå­—ç©ºé—´ï¼ˆNamespaceï¼‰&lt;/strong&gt; æä¾›ä¸€ç§æœºåˆ¶ï¼Œå°†åŒä¸€é›†ç¾¤ä¸­çš„èµ„æºåˆ’åˆ†ä¸ºç›¸äº’éš”ç¦»çš„ç»„ã€‚ åŒä¸€åå­—ç©ºé—´å†…çš„èµ„æºåç§°è¦å”¯ä¸€ï¼Œä½†è·¨åå­—ç©ºé—´æ—¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚ åå­—ç©ºé—´ä½œç”¨åŸŸä»…é’ˆå¯¹å¸¦æœ‰åå­—ç©ºé—´çš„å¯¹è±¡ï¼Œä¾‹å¦‚ Deploymentã€Service ç­‰ã€‚&lt;/p&gt; &#xA;&lt;p&gt;å‰é¢çš„æ•™ç¨‹ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„ namespace æ˜¯ &lt;code&gt;default&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ä¸‹é¢å±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„ namespaceï¼Œ &lt;code&gt;namespace.yaml&lt;/code&gt; æ–‡ä»¶å®šä¹‰äº†ä¸¤ä¸ªä¸åŒçš„ namespaceï¼Œåˆ†åˆ«æ˜¯ &lt;code&gt;dev&lt;/code&gt; å’Œ &lt;code&gt;test&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Namespace&#xA;metadata:&#xA;  name: dev&#xA;  &#xA;---&#xA;&#xA;apiVersion: v1&#xA;kind: Namespace&#xA;metadata:&#xA;  name: test&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å¯ä»¥é€šè¿‡&lt;code&gt;kubectl apply -f namespaces.yaml&lt;/code&gt; åˆ›å»ºä¸¤ä¸ªæ–°çš„ namespaceï¼Œåˆ†åˆ«æ˜¯ &lt;code&gt;dev&lt;/code&gt; å’Œ &lt;code&gt;test&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;kubectl apply -f namespaces.yaml    &#xA;# namespace/dev created&#xA;# namespace/test created&#xA;&#xA;&#xA;kubectl get namespaces          &#xA;# NAME              STATUS   AGE&#xA;# default           Active   215d&#xA;# dev               Active   2m44s&#xA;# ingress-nginx     Active   110d&#xA;# kube-node-lease   Active   215d&#xA;# kube-public       Active   215d&#xA;# kube-system       Active   215d&#xA;# test              Active   2m44s&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;é‚£ä¹ˆå¦‚ä½•åœ¨æ–°çš„ namespace ä¸‹åˆ›å»ºèµ„æºå’Œè·å–èµ„æºå‘¢ï¼Ÿåªéœ€è¦åœ¨å‘½ä»¤åé¢åŠ ä¸Š &lt;code&gt;-n namespace&lt;/code&gt; å³å¯ã€‚ä¾‹å¦‚æ ¹æ®ä¸Šé¢æ•™ç¨‹ä¸­ï¼Œåœ¨åä¸º &lt;code&gt;dev&lt;/code&gt; çš„ namespace ä¸‹åˆ›å»º &lt;code&gt;hellok8s:v3&lt;/code&gt; çš„ deployment èµ„æºã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f deployment.yaml -n dev&#xA;&#xA;kubectl get pods -n dev&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Configmap&lt;/h2&gt; &#xA;&lt;p&gt;ä¸Šé¢çš„æ•™ç¨‹æåˆ°ï¼Œæˆ‘ä»¬åœ¨ä¸åŒç¯å¢ƒ &lt;code&gt;dev&lt;/code&gt; &lt;code&gt;test&lt;/code&gt; &lt;code&gt;uat&lt;/code&gt; &lt;code&gt;prod&lt;/code&gt; ä¸­åŒºåˆ†èµ„æºï¼Œå¯ä»¥è®©å…¶èµ„æºç‹¬ç«‹äº’ç›¸ä¸å—å½±å“ï¼Œä½†æ˜¯éšä¹‹è€Œæ¥ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ä¸åŒç¯å¢ƒçš„æ•°æ®åº“çš„åœ°å€å¾€å¾€æ˜¯ä¸ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå¦‚æœåœ¨ä»£ç ä¸­å†™åŒä¸€ä¸ªæ•°æ®åº“çš„åœ°å€ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚&lt;/p&gt; &#xA;&lt;p&gt;K8S ä½¿ç”¨ ConfigMap æ¥å°†ä½ çš„é…ç½®æ•°æ®å’Œåº”ç”¨ç¨‹åºä»£ç åˆ†å¼€ï¼Œå°†éæœºå¯†æ€§çš„æ•°æ®ä¿å­˜åˆ°é”®å€¼å¯¹ä¸­ã€‚ConfigMap åœ¨è®¾è®¡ä¸Šä¸æ˜¯ç”¨æ¥ä¿å­˜å¤§é‡æ•°æ®çš„ã€‚åœ¨ ConfigMap ä¸­ä¿å­˜çš„æ•°æ®ä¸å¯è¶…è¿‡ 1 MiBã€‚å¦‚æœä½ éœ€è¦ä¿å­˜è¶…å‡ºæ­¤å°ºå¯¸é™åˆ¶çš„æ•°æ®ï¼Œä½ å¯èƒ½è€ƒè™‘æŒ‚è½½å­˜å‚¨å·ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¹‹å‰ä»£ç ï¼Œå‡è®¾ä¸åŒç¯å¢ƒçš„æ•°æ®åº“åœ°å€ä¸åŒï¼Œä¸‹é¢ä»£ç ä»ç¯å¢ƒå˜é‡ä¸­è·å– &lt;code&gt;DB_URL&lt;/code&gt;ï¼Œå¹¶å°†å®ƒè¿”å›ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main&#xA;&#xA;import (&#xA;&#x9;&#34;fmt&#34;&#xA;&#x9;&#34;io&#34;&#xA;&#x9;&#34;net/http&#34;&#xA;&#x9;&#34;os&#34;&#xA;)&#xA;&#xA;func hello(w http.ResponseWriter, r *http.Request) {&#xA;&#x9;host, _ := os.Hostname()&#xA;&#x9;dbURL := os.Getenv(&#34;DB_URL&#34;)&#xA;&#x9;io.WriteString(w, fmt.Sprintf(&#34;[v4] Hello, Kubernetes! From host: %s, Get Database Connect URL: %s&#34;, host, dbURL))&#xA;}&#xA;&#xA;func main() {&#xA;&#x9;http.HandleFunc(&#34;/&#34;, hello)&#xA;&#x9;http.ListenAndServe(&#34;:3000&#34;, nil)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ„å»º &lt;code&gt;hellok8s:v4&lt;/code&gt; çš„é•œåƒï¼Œæ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚å¹¶åˆ é™¤ä¹‹å‰åˆ›å»ºçš„æ‰€æœ‰èµ„æºã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;docker build . -t guangzhengli/hellok8s:v4&#xA;docker push guangzhengli/hellok8s:v4&#xA;&#xA;kubectl delete deployment,service,ingress --all&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ä¸‹æ¥åˆ›å»ºä¸åŒ namespace çš„ configmap æ¥å­˜æ”¾ &lt;code&gt;DB_URL&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;p&gt;åˆ›å»º &lt;code&gt;hellok8s-config-dev.yaml&lt;/code&gt; æ–‡ä»¶&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: ConfigMap&#xA;metadata:&#xA;  name: hellok8s-config&#xA;data:&#xA;  DB_URL: &#34;http://DB_ADDRESS_DEV&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;åˆ›å»º &lt;code&gt;hellok8s-config-test.yaml&lt;/code&gt; æ–‡ä»¶&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: ConfigMap&#xA;metadata:&#xA;  name: hellok8s-config&#xA;data:&#xA;  DB_URL: &#34;http://DB_ADDRESS_TEST&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;åˆ†åˆ«åœ¨ &lt;code&gt;dev&lt;/code&gt; &lt;code&gt;test&lt;/code&gt; ä¸¤ä¸ª namespace ä¸‹åˆ›å»ºç›¸åŒçš„ &lt;code&gt;ConfigMap&lt;/code&gt;ï¼Œåå­—éƒ½å« hellok8s-configï¼Œä½†æ˜¯å­˜æ”¾çš„ Pair å¯¹ä¸­ Value å€¼ä¸ä¸€æ ·ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f hellok8s-config-dev.yaml -n dev&#xA;# configmap/hellok8s-config created&#xA;&#xA;kubectl apply -f hellok8s-config-test.yaml -n test &#xA;# configmap/hellok8s-config created&#xA;&#xA;kubectl get configmap --all-namespaces&#xA;NAMESPACE         NAME                                 DATA   AGE&#xA;dev               hellok8s-config                      1      3m12s&#xA;test              hellok8s-config                      1      2m1s&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;æ¥ç€ä½¿ç”¨ POD çš„æ–¹å¼æ¥éƒ¨ç½² &lt;code&gt;hellok8s:v4&lt;/code&gt;ï¼Œå…¶ä¸­ &lt;code&gt;env.name&lt;/code&gt; è¡¨ç¤ºçš„æ˜¯å°† configmap ä¸­çš„å€¼å†™è¿›ç¯å¢ƒå˜é‡ï¼Œè¿™æ ·ä»£ç ä»ç¯å¢ƒå˜é‡ä¸­è·å– &lt;code&gt;DB_URL&lt;/code&gt;ï¼Œè¿™ä¸ª KEY åç§°å¿…é¡»ä¿æŒä¸€è‡´ã€‚&lt;code&gt;valueFrom&lt;/code&gt; ä»£è¡¨ä»å“ªé‡Œè¯»å–ï¼Œ&lt;code&gt;configMapKeyRef&lt;/code&gt; è¿™é‡Œè¡¨ç¤ºä»åä¸º &lt;code&gt;hellok8s-config&lt;/code&gt; çš„ &lt;code&gt;configMap&lt;/code&gt; ä¸­è¯»å– &lt;code&gt;KEY=DB_URL&lt;/code&gt; çš„ Valueã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Pod&#xA;metadata:&#xA;  name: hellok8s-pod&#xA;spec:&#xA;  containers:&#xA;    - name: hellok8s-container&#xA;      image: guangzhengli/hellok8s:v4&#xA;      env:&#xA;        - name: DB_URL&#xA;          valueFrom:&#xA;            configMapKeyRef:&#xA;              name: hellok8s-config&#xA;              key: DB_URL&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä¸‹é¢åˆ†åˆ«åœ¨ &lt;code&gt;dev&lt;/code&gt; &lt;code&gt;test&lt;/code&gt; ä¸¤ä¸ª namespace ä¸‹åˆ›å»º &lt;code&gt;hellok8s:v4&lt;/code&gt;ï¼Œæ¥ç€é€šè¿‡ &lt;code&gt;port-forward&lt;/code&gt; çš„æ–¹å¼è®¿é—®ä¸åŒ namespace çš„æœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°è¿”å›çš„ &lt;code&gt;Get Database Connect URL: http://DB_ADDRESS_TEST&lt;/code&gt; æ˜¯ä¸ä¸€æ ·çš„ï¼&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f hellok8s.yaml -n dev             &#xA;# pod/hellok8s-pod created&#xA;&#xA;kubectl apply -f hellok8s.yaml -n test&#xA;# pod/hellok8s-pod created&#xA;&#xA;kubectl port-forward hellok8s-pod 3000:3000 -n dev&#xA;&#xA;curl http://localhost:3000&#xA;# [v4] Hello, Kubernetes! From host: hellok8s-pod, Get Database Connect URL: http://DB_ADDRESS_DEV&#xA;&#xA;kubectl port-forward hellok8s-pod 3000:3000 -n test&#xA;&#xA;curl http://localhost:3000&#xA;# [v4] Hello, Kubernetes! From host: hellok8s-pod, Get Database Connect URL: http://DB_ADDRESS_TEST&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Secret&lt;/h2&gt; &#xA;&lt;p&gt;ä¸Šé¢æåˆ°ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©ä»¥ configmap çš„æ–¹å¼æŒ‚è½½é…ç½®ä¿¡æ¯ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„é…ç½®ä¿¡æ¯éœ€è¦åŠ å¯†çš„æ—¶å€™ï¼Œ configmap å°±æ— æ³•æ»¡è¶³è¿™ä¸ªè¦æ±‚ã€‚ä¾‹å¦‚ä¸Šé¢è¦æŒ‚è½½æ•°æ®åº“å¯†ç çš„æ—¶å€™ï¼Œå°±éœ€è¦æ˜æ–‡æŒ‚è½½ã€‚&lt;/p&gt; &#xA;&lt;p&gt;è¿™ä¸ªæ—¶å€™å°±éœ€è¦ Secret æ¥å­˜å‚¨åŠ å¯†ä¿¡æ¯ï¼Œè™½ç„¶åœ¨èµ„æºæ–‡ä»¶çš„ç¼–ç ä¸Šï¼Œåªæ˜¯é€šè¿‡ Base64 çš„æ–¹å¼ç®€å•ç¼–ç ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ pipeline æˆ–è€…ä¸“ä¸šçš„ &lt;a href=&#34;https://aws.amazon.com/kms/&#34;&gt;AWS KMS&lt;/a&gt; æœåŠ¡è¿›è¡Œå¯†é’¥ç®¡ç†ã€‚è¿™æ ·å°±å¤§å¤§å‡å°‘äº†å®‰å…¨äº‹æ•…ã€‚&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Secret æ˜¯ä¸€ç§åŒ…å«å°‘é‡æ•æ„Ÿä¿¡æ¯ä¾‹å¦‚å¯†ç ã€ä»¤ç‰Œæˆ–å¯†é’¥çš„å¯¹è±¡ã€‚ç”±äºåˆ›å»º Secret å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„ Podï¼Œ å› æ­¤åœ¨åˆ›å»ºã€æŸ¥çœ‹å’Œç¼–è¾‘ Pod çš„å·¥ä½œæµç¨‹ä¸­æš´éœ² Secretï¼ˆåŠå…¶æ•°æ®ï¼‰çš„é£é™©è¾ƒå°ã€‚ Kubernetes å’Œåœ¨é›†ç¾¤ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥å¯¹ Secret é‡‡å–é¢å¤–çš„é¢„é˜²æªæ–½ï¼Œ ä¾‹å¦‚é¿å…å°†æœºå¯†æ•°æ®å†™å…¥éæ˜“å¤±æ€§å­˜å‚¨ã€‚&lt;/p&gt; &#xA; &lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes Secret æœªåŠ å¯†åœ°å­˜å‚¨åœ¨ API æœåŠ¡å™¨çš„åº•å±‚æ•°æ®å­˜å‚¨ï¼ˆetcdï¼‰ä¸­ã€‚ ä»»ä½•æ‹¥æœ‰ API è®¿é—®æƒé™çš„äººéƒ½å¯ä»¥æ£€ç´¢æˆ–ä¿®æ”¹ Secretï¼Œä»»ä½•æœ‰æƒè®¿é—® etcd çš„äººä¹Ÿå¯ä»¥ã€‚ æ­¤å¤–ï¼Œä»»ä½•æœ‰æƒé™åœ¨å‘½åç©ºé—´ä¸­åˆ›å»º Pod çš„äººéƒ½å¯ä»¥ä½¿ç”¨è¯¥è®¿é—®æƒé™è¯»å–è¯¥å‘½åç©ºé—´ä¸­çš„ä»»ä½• Secretï¼› è¿™åŒ…æ‹¬é—´æ¥è®¿é—®ï¼Œä¾‹å¦‚åˆ›å»º Deployment çš„èƒ½åŠ›ã€‚&lt;/p&gt; &#xA; &lt;p&gt;ä¸ºäº†å®‰å…¨åœ°ä½¿ç”¨ Secretï¼Œè¯·è‡³å°‘æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt; &#xA; &lt;ol&gt; &#xA;  &lt;li&gt;ä¸º Secret &lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/&#34;&gt;å¯ç”¨é™æ€åŠ å¯†&lt;/a&gt;ï¼›&lt;/li&gt; &#xA;  &lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/reference/access-authn-authz/authorization/&#34;&gt;å¯ç”¨æˆ–é…ç½® RBAC è§„åˆ™&lt;/a&gt;æ¥é™åˆ¶è¯»å–å’Œå†™å…¥ Secret çš„æ•°æ®ï¼ˆåŒ…æ‹¬é€šè¿‡é—´æ¥æ–¹å¼ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¢«å‡†è®¸åˆ›å»º Pod çš„äººä¹Ÿéšå¼åœ°è¢«æˆæƒè·å– Secret å†…å®¹ã€‚&lt;/li&gt; &#xA;  &lt;li&gt;åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ RBAC ç­‰æœºåˆ¶æ¥é™åˆ¶å…è®¸å“ªäº›ä¸»ä½“åˆ›å»ºæ–° Secret æˆ–æ›¿æ¢ç°æœ‰ Secretã€‚&lt;/li&gt; &#xA; &lt;/ol&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;Secret çš„èµ„æºå®šä¹‰å’Œ ConfigMap ç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äº kind æ˜¯ &lt;code&gt;Secret&lt;/code&gt;ï¼Œè¿˜æœ‰ Value éœ€è¦ Base64 ç¼–ç ï¼Œä½ å¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤å¿«é€Ÿ Base64 ç¼–è§£ç ã€‚å½“ç„¶ Secret ä¹Ÿæä¾›äº†ä¸€ç§ &lt;code&gt;stringData&lt;/code&gt;ï¼Œå¯ä»¥ä¸éœ€è¦ Base64 ç¼–ç ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;echo &#34;db_password&#34; | base64&#xA;# ZGJfcGFzc3dvcmQK&#xA;&#xA;echo &#34;ZGJfcGFzc3dvcmQK&#34; | base64 -d&#xA;# db_password&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Secret&#xA;metadata:&#xA;  name: hellok8s-secret&#xA;data:&#xA;  DB_PASSWORD: &#34;ZGJfcGFzc3dvcmQK&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Pod&#xA;metadata:&#xA;  name: hellok8s-pod&#xA;spec:&#xA;  containers:&#xA;    - name: hellok8s-container&#xA;      image: guangzhengli/hellok8s:v4&#xA;      env:&#xA;        - name: DB_PASSWORD&#xA;          valueFrom:&#xA;            secretKeyRef:&#xA;              name: hellok8s-secret&#xA;              key: DB_PASSWORD&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Secret çš„ä½¿ç”¨æ–¹æ³•å’Œå‰é¢æ•™ç¨‹ä¸­ ConfigMap åŸºæœ¬ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†è¿‡å¤šèµ˜è¿°ã€‚&lt;/p&gt; &#xA;&lt;h2&gt;Job&lt;/h2&gt; &#xA;&lt;p&gt;åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¿˜æœ‰ä¸€ç±»ä»»åŠ¡æ˜¯ä¹‹å‰çš„èµ„æºä¸èƒ½æ»¡è¶³çš„ï¼Œå³ä¸€æ¬¡æ€§ä»»åŠ¡ã€‚ä¾‹å¦‚å¸¸è§çš„è®¡ç®—ä»»åŠ¡ï¼Œåªéœ€è¦æ‹¿åˆ°ç›¸å…³æ•°æ®è®¡ç®—åå¾—å‡ºç»“æœå³å¯ï¼Œæ— éœ€ä¸€ç›´è¿è¡Œã€‚è€Œå¤„ç†è¿™ä¸€ç±»ä»»åŠ¡çš„èµ„æºå°±æ˜¯ Jobã€‚&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Job ä¼šåˆ›å»ºä¸€ä¸ªæˆ–è€…å¤šä¸ª Podï¼Œå¹¶å°†ç»§ç»­é‡è¯• Pod çš„æ‰§è¡Œï¼Œç›´åˆ°æŒ‡å®šæ•°é‡çš„ Pod æˆåŠŸç»ˆæ­¢ã€‚ éšç€ Pod æˆåŠŸç»“æŸï¼ŒJob è·Ÿè¸ªè®°å½•æˆåŠŸå®Œæˆçš„ Pod ä¸ªæ•°ã€‚ å½“æ•°é‡è¾¾åˆ°æŒ‡å®šçš„æˆåŠŸä¸ªæ•°é˜ˆå€¼æ—¶ï¼Œä»»åŠ¡ï¼ˆå³ Jobï¼‰ç»“æŸã€‚ åˆ é™¤ Job çš„æ“ä½œä¼šæ¸…é™¤æ‰€åˆ›å»ºçš„å…¨éƒ¨ Podã€‚ æŒ‚èµ· Job çš„æ“ä½œä¼šåˆ é™¤ Job çš„æ‰€æœ‰æ´»è·ƒ Podï¼Œç›´åˆ° Job è¢«å†æ¬¡æ¢å¤æ‰§è¡Œã€‚&lt;/p&gt; &#xA; &lt;p&gt;ä¸€ç§ç®€å•çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œä½ ä¼šåˆ›å»ºä¸€ä¸ª Job å¯¹è±¡ä»¥ä¾¿ä»¥ä¸€ç§å¯é çš„æ–¹å¼è¿è¡ŒæŸ Pod ç›´åˆ°å®Œæˆã€‚ å½“ç¬¬ä¸€ä¸ª Pod å¤±è´¥æˆ–è€…è¢«åˆ é™¤ï¼ˆæ¯”å¦‚å› ä¸ºèŠ‚ç‚¹ç¡¬ä»¶å¤±æ•ˆæˆ–è€…é‡å¯ï¼‰æ—¶ï¼ŒJob å¯¹è±¡ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ Podã€‚&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;ä¸‹é¢æ¥çœ‹ä¸€ä¸ª Job çš„èµ„æºå®šä¹‰ï¼Œå…¶ä¸­ Kind å’Œ metadata.name æ˜¯èµ„æºç±»å‹å’Œåå­—å°±ä¸å†è§£é‡Šï¼Œ&lt;code&gt;completions&lt;/code&gt; æŒ‡çš„æ˜¯ä¼šåˆ›å»º Pod çš„æ•°é‡ï¼Œæ¯ä¸ª pod éƒ½ä¼šå®Œæˆä¸‹é¢çš„ä»»åŠ¡ã€‚&lt;code&gt;parallelism&lt;/code&gt; æŒ‡çš„æ˜¯å¹¶å‘æ‰§è¡Œæœ€å¤§æ•°é‡ï¼Œä¾‹å¦‚ä¸‹é¢å°±ä¼šå…ˆåˆ›å»º 3 ä¸ª pod å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œä¸€æ—¦æŸä¸ª pod æ‰§è¡Œå®Œæˆï¼Œå°±ä¼šå†åˆ›å»ºæ–°çš„ pod æ¥æ‰§è¡Œï¼Œç›´åˆ° 5 ä¸ª pod æ‰§è¡Œå®Œæˆï¼ŒJob æ‰ä¼šè¢«æ ‡è®°ä¸ºå®Œæˆã€‚&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;restartPolicy = &#34;OnFailure&lt;/code&gt; çš„å«ä¹‰å’Œ Pod ç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼ŒPod ä¸­çš„å®¹å™¨å¯èƒ½å› ä¸ºé€€å‡ºæ—¶è¿”å›å€¼éé›¶ï¼Œ æˆ–è€…å®¹å™¨å› ä¸ºè¶…å‡ºå†…å­˜çº¦æŸè€Œè¢«æ€æ­»ç­‰ç­‰ã€‚ å¦‚æœå‘ç”Ÿè¿™ç±»äº‹ä»¶ï¼Œå¹¶ä¸” &lt;code&gt;.spec.template.spec.restartPolicy = &#34;OnFailure&#34;&lt;/code&gt;ï¼Œ Pod åˆ™ç»§ç»­ç•™åœ¨å½“å‰èŠ‚ç‚¹ï¼Œä½†å®¹å™¨ä¼šè¢«é‡æ–°è¿è¡Œã€‚å› æ­¤ï¼Œä½ çš„ç¨‹åºéœ€è¦èƒ½å¤Ÿå¤„ç†åœ¨æœ¬åœ°è¢«é‡å¯çš„æƒ…å†µï¼Œæˆ–è€…è¦è®¾ç½® &lt;code&gt;.spec.template.spec.restartPolicy = &#34;Never&#34;&lt;/code&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: batch/v1&#xA;kind: Job&#xA;metadata:&#xA;  name: hello-job&#xA;spec:&#xA;  parallelism: 3&#xA;  completions: 5&#xA;  template:&#xA;    spec:&#xA;      restartPolicy: OnFailure&#xA;      containers:&#xA;        - name: echo&#xA;          image: busybox&#xA;          command: [for i in 9 8 7 6 5 4 3 2 1 ; do echo $i ; done]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;é€šè¿‡ä¸‹é¢çš„å‘½ä»¤åˆ›å»º jobï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;kubectl get pods -w&lt;/code&gt; æ¥è§‚å¯Ÿ job åˆ›å»º pod çš„è¿‡ç¨‹å’Œç»“æœã€‚æœ€åå¯ä»¥é€šè¿‡ &lt;code&gt;logs&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹æ—¥å¿—ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f hello-job.yaml&#xA;&#xA;kubectl get jobs                  &#xA;# NAME        COMPLETIONS   DURATION   AGE&#xA;# hello-job   5/5           19s        83s&#xA;&#xA;kubectl get pods                      &#xA;# NAME                                   READY   STATUS      RESTARTS   AGE&#xA;# hello-job--1-5gjjr                     0/1     Completed   0          34s&#xA;# hello-job--1-8ffmn                     0/1     Completed   0          26s&#xA;# hello-job--1-ltsvm                     0/1     Completed   0          34s&#xA;# hello-job--1-mttwv                     0/1     Completed   0          29s&#xA;# hello-job--1-ww2qp                     0/1     Completed   0          34s&#xA;&#xA;kubectl logs -f hello-job--1-5gjjr &#xA;# 1&#xA;# ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Job å®Œæˆæ—¶ä¸ä¼šå†åˆ›å»ºæ–°çš„ Podï¼Œä¸è¿‡å·²æœ‰çš„ Pod &lt;a href=&#34;https://kubernetes.io/docs/concepts/workloads/controllers/job/#pod-backoff-failure-policy&#34;&gt;é€šå¸¸&lt;/a&gt;ä¹Ÿä¸ä¼šè¢«åˆ é™¤ã€‚ ä¿ç•™è¿™äº› Pod ä½¿å¾—ä½ å¯ä»¥æŸ¥çœ‹å·²å®Œæˆçš„ Pod çš„æ—¥å¿—è¾“å‡ºï¼Œä»¥ä¾¿æ£€æŸ¥é”™è¯¯ã€è­¦å‘Šæˆ–è€…å…¶å®ƒè¯Šæ–­æ€§è¾“å‡ºã€‚ å¯ä»¥ä½¿ç”¨ &lt;code&gt;kubectl&lt;/code&gt; æ¥åˆ é™¤ Jobï¼ˆä¾‹å¦‚ &lt;code&gt;kubectl delete -f hello-job.yaml&lt;/code&gt;)ã€‚å½“ä½¿ç”¨ &lt;code&gt;kubectl&lt;/code&gt; æ¥åˆ é™¤ Job æ—¶ï¼Œè¯¥ Job æ‰€åˆ›å»ºçš„ Pod ä¹Ÿä¼šè¢«åˆ é™¤ã€‚&lt;/p&gt; &#xA;&lt;h2&gt;CronJob&lt;/h2&gt; &#xA;&lt;p&gt;&lt;em&gt;CronJob&lt;/em&gt; å¯ä»¥ç†è§£ä¸ºå®šæ—¶ä»»åŠ¡ï¼Œåˆ›å»ºåŸºäº Cron æ—¶é—´è°ƒåº¦çš„ &lt;a href=&#34;https://kubernetes.ion/docs/concepts/workloads/controllers/job/&#34;&gt;Jobs&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;CronJob ç”¨äºæ‰§è¡Œå‘¨æœŸæ€§çš„åŠ¨ä½œï¼Œä¾‹å¦‚å¤‡ä»½ã€æŠ¥å‘Šç”Ÿæˆç­‰ã€‚ è¿™äº›ä»»åŠ¡ä¸­çš„æ¯ä¸€ä¸ªéƒ½åº”è¯¥é…ç½®ä¸ºå‘¨æœŸæ€§é‡å¤çš„ï¼ˆä¾‹å¦‚ï¼šæ¯å¤©/æ¯å‘¨/æ¯æœˆä¸€æ¬¡ï¼‰ï¼› ä½ å¯ä»¥å®šä¹‰ä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„æ—¶é—´é—´éš”ã€‚&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;Cron æ—¶é—´è¡¨è¯­æ³•&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0 - 59)&#xA;# â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0 - 23)&#xA;# â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆçš„æŸå¤© (1 - 31)&#xA;# â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆä»½ (1 - 12)&#xA;# â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘¨çš„æŸå¤© (0 - 6)ï¼ˆå‘¨æ—¥åˆ°å‘¨ä¸€ï¼›åœ¨æŸäº›ç³»ç»Ÿä¸Šï¼Œ7 ä¹Ÿæ˜¯æ˜ŸæœŸæ—¥ï¼‰&#xA;# â”‚ â”‚ â”‚ â”‚ â”‚                          æˆ–è€…æ˜¯ sunï¼Œmonï¼Œtueï¼Œwebï¼Œthuï¼Œfriï¼Œsat&#xA;# â”‚ â”‚ â”‚ â”‚ â”‚&#xA;# â”‚ â”‚ â”‚ â”‚ â”‚&#xA;# * * * * *&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ç”¨æ³•é™¤äº†éœ€è¦åŠ ä¸Š cron è¡¨è¾¾å¼ä¹‹å¤–ï¼Œå…¶ä½™åŸºæœ¬å’Œ Job ä¿æŒä¸€è‡´ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: batch/v1&#xA;kind: CronJob&#xA;metadata:&#xA;  name: hello-cronjob&#xA;spec:&#xA;  schedule: &#34;* * * * *&#34; # Every minute&#xA;  jobTemplate:&#xA;    spec:&#xA;      template:&#xA;        spec:&#xA;          restartPolicy: OnFailure&#xA;          containers:&#xA;            - name: echo&#xA;              image: busybox&#xA;              command: [for i in 9 8 7 6 5 4 3 2 1 ; do echo $i ; done]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;ä½¿ç”¨å‘½ä»¤å’Œ Job ä¹ŸåŸºæœ¬ä¿æŒä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;kubectl apply -f hello-cronjob.yaml&#xA;# cronjob.batch/hello-cronjob created&#xA;&#xA;kubectl get cronjob                &#xA;# NAME            SCHEDULE    SUSPEND   ACTIVE   LAST SCHEDULE   AGE&#xA;# hello-cronjob   * * * * *   False     0        &amp;lt;none&amp;gt;          8s&#xA;&#xA;kubectl get pods   &#xA;# NAME                                   READY   STATUS      RESTARTS   AGE&#xA;# hello-cronjob-27694609--1-2nmdx        0/1     Completed   0          15s&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Helm(TODO)&lt;/h2&gt; &#xA;&lt;p&gt;ç»è¿‡å‰é¢çš„æ•™ç¨‹ï¼Œæƒ³å¿…ä½ å·²ç»å¯¹ kubernetes çš„ä½¿ç”¨æœ‰äº†ä¸€å®šçš„ç†è§£ã€‚ä½†æ˜¯ä¸çŸ¥é“ä½ æ˜¯å¦æƒ³è¿‡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å‰é¢æ•™ç¨‹ä¸­æåˆ°çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬ç”¨ &lt;code&gt;pod&lt;/code&gt;, &lt;code&gt;deployment&lt;/code&gt;, &lt;code&gt;service&lt;/code&gt;, &lt;code&gt;ingress&lt;/code&gt;, &lt;code&gt;configmap&lt;/code&gt;,&lt;code&gt;secret&lt;/code&gt; æ‰€æœ‰èµ„æºæ¥éƒ¨ç½²ä¸€å¥—å®Œæ•´çš„ &lt;code&gt;hellok8s&lt;/code&gt; æœåŠ¡çš„è¯ï¼Œéš¾é“éœ€è¦ä¸€ä¸ªä¸€ä¸ªçš„ &lt;code&gt;kubectl apply -f&lt;/code&gt; æ¥åˆ›å»ºå—ï¼Ÿå¦‚æœæ¢ä¸€ä¸ª namespaceï¼Œæˆ–è€…è¯´æ¢ä¸€å¥— kubernetes é›†ç¾¤éƒ¨ç½²çš„è¯ï¼Œåˆè¦é‡å¤æ€§çš„æ“ä½œåˆ›å»ºçš„è¿‡ç¨‹å—ï¼Ÿ&lt;/p&gt; &#xA;&lt;p&gt;æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨æ“ä½œç³»ç»Ÿæ—¶ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªåº”ç”¨çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ &lt;code&gt;apt&lt;/code&gt; æˆ–è€… &lt;code&gt;brew&lt;/code&gt; æ¥ç›´æ¥å®‰è£…ï¼Œè€Œä¸éœ€è¦å…³å¿ƒè¿™ä¸ªåº”ç”¨éœ€è¦å“ªäº›ä¾èµ–ï¼Œå“ªäº›é…ç½®ã€‚åœ¨ä½¿ç”¨ kubernetes å®‰è£…åº”ç”¨æœåŠ¡ &lt;code&gt;hellok8s&lt;/code&gt; æ—¶ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå¸Œæœ›èƒ½å¤Ÿä¸€ä¸ªå‘½ä»¤å°±å®‰è£…å®Œæˆï¼Œè€Œæä¾›è¿™ä¸ªèƒ½åŠ›çš„ï¼Œå°±æ˜¯ CNCF çš„æ¯•ä¸šé¡¹ç›® &lt;a href=&#34;https://github.com/helm/helm&#34;&gt;Helm&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;Helm å¸®åŠ©æ‚¨ç®¡ç† Kubernetes åº”ç”¨â€”â€” Helm Chartï¼ŒHelm æ˜¯æŸ¥æ‰¾ã€åˆ†äº«å’Œä½¿ç”¨è½¯ä»¶æ„å»º &lt;a href=&#34;https://kubernetes.io/&#34;&gt;Kubernetes&lt;/a&gt; çš„æœ€ä¼˜æ–¹å¼ã€‚&lt;/p&gt; &#xA; &lt;p&gt;å¤æ‚æ€§ç®¡ç† â€”â€”å³ä½¿æ˜¯æœ€å¤æ‚çš„åº”ç”¨ï¼ŒHelm Chart ä¾ç„¶å¯ä»¥æè¿°ï¼Œ æä¾›ä½¿ç”¨å•ç‚¹æˆæƒçš„å¯é‡å¤å®‰è£…åº”ç”¨ç¨‹åºã€‚&lt;/p&gt; &#xA; &lt;p&gt;æ˜“äºå‡çº§ â€”â€”éšæ—¶éšåœ°å‡çº§å’Œè‡ªå®šä¹‰çš„é’©å­æ¶ˆé™¤æ‚¨å‡çº§çš„ç—›è‹¦ã€‚&lt;/p&gt; &#xA; &lt;p&gt;åˆ†å‘ç®€å• â€”â€” Helm Chart å¾ˆå®¹æ˜“åœ¨å…¬å…±æˆ–ç§æœ‰åŒ–æœåŠ¡å™¨ä¸Šå‘ç‰ˆï¼Œåˆ†å‘å’Œéƒ¨ç½²ç«™ç‚¹ã€‚&lt;/p&gt; &#xA; &lt;p&gt;å›æ»š â€”â€” ä½¿ç”¨ &lt;code&gt;helm rollback&lt;/code&gt; å¯ä»¥è½»æ¾å›æ»šåˆ°ä¹‹å‰çš„å‘å¸ƒç‰ˆæœ¬ã€‚&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;æˆ‘ä»¬é€šè¿‡ brew æ¥å®‰è£… helmã€‚æ›´å¤šæ–¹å¼å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://helm.sh/zh/docs/intro/install/&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;brew install helm&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Helm çš„ä½¿ç”¨æ–¹å¼å¯ä»¥è§£é‡Šä¸ºï¼šHelm å®‰è£… &lt;em&gt;charts&lt;/em&gt; åˆ° Kubernetes é›†ç¾¤ä¸­ï¼Œæ¯æ¬¡å®‰è£…éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;em&gt;release&lt;/em&gt;ã€‚ä½ å¯ä»¥åœ¨ Helm çš„ chart &lt;em&gt;repositories&lt;/em&gt; ä¸­å¯»æ‰¾æ–°çš„ chartã€‚&lt;/p&gt; &#xA;&lt;h3&gt;å®‰è£… hellok8s chart å¿«é€Ÿå¼€å§‹(TODO)&lt;/h3&gt; &#xA;&lt;p&gt;//TODO&lt;/p&gt; &#xA;&lt;h3&gt;åˆ›å»º helm charts&lt;/h3&gt; &#xA;&lt;p&gt;æˆ‘ä»¬æ¥æ‰‹æŠŠæ‰‹åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ helm chartsï¼Œå®Œæˆæˆ‘ä»¬ä¹‹å‰çš„é‚£äº›åŠŸèƒ½ã€‚&lt;/p&gt; &#xA;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;helm create&lt;/code&gt; å‘½ä»¤é»˜è®¤ä¼šå¸®ä½ åˆ›å»ºä¸€äº› k8s èµ„æºå®šä¹‰çš„åˆå§‹æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;helm create hello-helm&#xA;&#xA;.&#xA;â”œâ”€â”€ Chart.yaml&#xA;â”œâ”€â”€ _helpers.tpl&#xA;â”œâ”€â”€ charts&#xA;â”œâ”€â”€ templates&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ hellok8s-configmaps.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ hellok8s-deployment.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ hellok8s-service.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ ingress.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ nginx-deployment.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â””â”€â”€ nginx-service.yaml&#xA;â””â”€â”€ values.yaml&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;è€Œæˆ‘ä»¬åˆ å‡ä¸€ä¸‹è¿™äº›æ–‡ä»¶ï¼Œç”¨ä¹‹å‰æ•™ç¨‹ä¸­ ingress + configmaps é‚£èŠ‚ä¸­çš„èµ„æºæ–‡ä»¶æ›¿ä»£å®ƒï¼Œæœ€ç»ˆçš„ç»“æ„é•¿è¿™æ ·ï¼š&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;.&#xA;â”œâ”€â”€ Chart.yaml&#xA;â”œâ”€â”€ _helpers.tpl&#xA;â”œâ”€â”€ charts&#xA;â”œâ”€â”€ templates&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ hellok8s-configmaps.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ hellok8s-deployment.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ hellok8s-service.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ ingress.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â”œâ”€â”€ nginx-deployment.yaml&#xA;â”‚&amp;nbsp;&amp;nbsp; â””â”€â”€ nginx-service.yaml&#xA;â””â”€â”€ values.yaml&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;å…¶ä¸­ &lt;code&gt;hellok8s-configmaps.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: ConfigMap&#xA;metadata:&#xA;  name: hellok8s-config&#xA;data:&#xA;  DB_URL: &#34;http://DB_ADDRESS_DEV&#34;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;hellok8s-deployment.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: hellok8s-deployment&#xA;spec:&#xA;  replicas: 3&#xA;  selector:&#xA;    matchLabels:&#xA;      app: hellok8s&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: hellok8s&#xA;    spec:&#xA;      containers:&#xA;        - image: guangzhengli/hellok8s:v4&#xA;          name: hellok8s-container&#xA;          env:&#xA;            - name: DB_URL&#xA;              valueFrom:&#xA;                configMapKeyRef:&#xA;                  name: hellok8s-config&#xA;                  key: DB_URL&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;hellok8s-service.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Service&#xA;metadata:&#xA;  name: service-hellok8s-clusterip&#xA;spec:&#xA;  type: ClusterIP&#xA;  selector:&#xA;    app: hellok8s&#xA;  ports:&#xA;  - port: 3000&#xA;    targetPort: 3000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;ingress.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: networking.k8s.io/v1&#xA;kind: Ingress&#xA;metadata:&#xA;  name: hello-ingress&#xA;  annotations:&#xA;    # We are defining this annotation to prevent nginx&#xA;    # from redirecting requests to `https` for now&#xA;    nginx.ingress.kubernetes.io/ssl-redirect: &#34;false&#34;&#xA;spec:&#xA;  rules:&#xA;    - http:&#xA;        paths:&#xA;          - path: /hello&#xA;            pathType: Prefix&#xA;            backend:&#xA;              service:&#xA;                name: service-hellok8s-clusterip&#xA;                port:&#xA;                  number: 3000&#xA;          - path: /&#xA;            pathType: Prefix&#xA;            backend:&#xA;              service:&#xA;                name: service-nginx-clusterip&#xA;                port:&#xA;                  number: 4000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;nginx-deployment.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: apps/v1&#xA;kind: Deployment&#xA;metadata:&#xA;  name: nginx-deployment&#xA;spec:&#xA;  replicas: 2&#xA;  selector:&#xA;    matchLabels:&#xA;      app: nginx&#xA;  template:&#xA;    metadata:&#xA;      labels:&#xA;        app: nginx&#xA;    spec:&#xA;      containers:&#xA;      - image: nginx&#xA;        name: nginx-container&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;nginx-service.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v1&#xA;kind: Service&#xA;metadata:&#xA;  name: service-nginx-clusterip&#xA;spec:&#xA;  type: ClusterIP&#xA;  selector:&#xA;    app: nginx&#xA;  ports:&#xA;  - port: 4000&#xA;    targetPort: 80&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;Chart.yaml&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;apiVersion: v2&#xA;name: hello-helm&#xA;description: A k8s tutorials in https://github.com/guangzhengli/k8s-tutorials&#xA;type: application&#xA;version: 0.1.0&#xA;appVersion: &#34;1.16.0&#34;&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;åœ¨ &lt;code&gt;hello-helm&lt;/code&gt; çš„è·Ÿè·¯å¾„ä¸‹æ‰§è¡Œå‘½ä»¤è¿›è¡Œå®‰è£… chartï¼Œæ‰§è¡Œ curl å‘½ä»¤ä¾¿èƒ½ç›´æ¥å¾—åˆ°ç»“æœï¼æŸ¥çœ‹ pod å’Œ service ç­‰èµ„æºï¼Œä¾¿ä¼šå‘ç° helm èƒ½ä¸€é”®å®‰è£…æ‰€æœ‰èµ„æºï¼&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;helm upgrade --install hello-helm --values values.yaml .&#xA;&#xA;curl http://192.168.59.100/hello&#xA;#[v4] Hello, Kubernetes! From host: hellok8s-deployment-f88f984c6-nzwg6, Get Database Connect URL: http://DB_ADDRESS_DEV&#xA;&#xA;kubectl get pods&#xA;# NAME                                  READY   STATUS    RESTARTS   AGE&#xA;# hellok8s-deployment-f88f984c6-k8hpz   1/1     Running   0          32m&#xA;# hellok8s-deployment-f88f984c6-nzwg6   1/1     Running   0          32m&#xA;# hellok8s-deployment-f88f984c6-s89s7   1/1     Running   0          32m&#xA;# nginx-deployment-d47fd7f66-6w76b      1/1     Running   0          32m&#xA;# nginx-deployment-d47fd7f66-tsqj5      1/1     Running   0          32m&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;ä¸Šä¼ å’Œä¸‹è½½å…¶å®ƒ helm chart ä½¿ç”¨ (TODO)&lt;/h3&gt; &#xA;&lt;p&gt;//TODO&lt;/p&gt; &#xA;&lt;h2&gt;Dashboard(TODO)&lt;/h2&gt; &#xA;&lt;p&gt;//TODO: ä»‹ç» kubernetes dashboard&lt;/p&gt; &#xA;&lt;h3&gt;K9s(TODO)&lt;/h3&gt; &#xA;&lt;p&gt;//TODO: ä»‹ç» k9s client&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/83ybd4.png&#34; alt=&#34;83ybd4&#34;&gt;&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>moby/buildkit</title>
    <updated>2022-09-01T01:33:09Z</updated>
    <id>tag:github.com,2022-09-01:/moby/buildkit</id>
    <link href="https://github.com/moby/buildkit" rel="alternate"></link>
    <summary type="html">&lt;p&gt;concurrent, cache-efficient, and Dockerfile-agnostic builder toolkit&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;a href=&#34;https://asciinema.org/a/gPEIEo1NzmDTUu2bEPsUboqmU&#34;&gt;&lt;img src=&#34;https://asciinema.org/a/gPEIEo1NzmDTUu2bEPsUboqmU.png&#34; alt=&#34;asciicinema example&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;BuildKit &#xA; &lt;!-- omit in toc --&gt;&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://godoc.org/github.com/moby/buildkit/client/llb&#34;&gt;&lt;img src=&#34;https://godoc.org/github.com/moby/buildkit?status.svg?sanitize=true&#34; alt=&#34;GoDoc&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/moby/buildkit/actions?query=workflow%3Abuild&#34;&gt;&lt;img src=&#34;https://github.com/moby/buildkit/workflows/build/badge.svg?sanitize=true&#34; alt=&#34;Build Status&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://goreportcard.com/report/github.com/moby/buildkit&#34;&gt;&lt;img src=&#34;https://goreportcard.com/badge/github.com/moby/buildkit&#34; alt=&#34;Go Report Card&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://codecov.io/gh/moby/buildkit&#34;&gt;&lt;img src=&#34;https://codecov.io/gh/moby/buildkit/branch/master/graph/badge.svg?sanitize=true&#34; alt=&#34;codecov&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive and repeatable manner.&lt;/p&gt; &#xA;&lt;p&gt;Key features:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Automatic garbage collection&lt;/li&gt; &#xA; &lt;li&gt;Extendable frontend formats&lt;/li&gt; &#xA; &lt;li&gt;Concurrent dependency resolution&lt;/li&gt; &#xA; &lt;li&gt;Efficient instruction caching&lt;/li&gt; &#xA; &lt;li&gt;Build cache import/export&lt;/li&gt; &#xA; &lt;li&gt;Nested build job invocations&lt;/li&gt; &#xA; &lt;li&gt;Distributable workers&lt;/li&gt; &#xA; &lt;li&gt;Multiple output formats&lt;/li&gt; &#xA; &lt;li&gt;Pluggable architecture&lt;/li&gt; &#xA; &lt;li&gt;Execution without root privileges&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Read the proposal from &lt;a href=&#34;https://github.com/moby/moby/issues/32925&#34;&gt;https://github.com/moby/moby/issues/32925&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Introductory blog post &lt;a href=&#34;https://blog.mobyproject.org/introducing-buildkit-17e056cc5317&#34;&gt;https://blog.mobyproject.org/introducing-buildkit-17e056cc5317&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Join &lt;code&gt;#buildkit&lt;/code&gt; channel on &lt;a href=&#34;http://dockr.ly/slack&#34;&gt;Docker Community Slack&lt;/a&gt;&lt;/p&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/p&gt; &#xA; &lt;p&gt;If you are visiting this repo for the usage of BuildKit-only Dockerfile features like &lt;code&gt;RUN --mount=type=(bind|cache|tmpfs|secret|ssh)&lt;/code&gt;, please refer to &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/frontend/dockerfile/docs/reference.md&#34;&gt;&lt;code&gt;frontend/dockerfile/docs/reference.md&lt;/code&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/p&gt; &#xA; &lt;p&gt;&lt;a href=&#34;https://docs.docker.com/develop/develop-images/build_enhancements/&#34;&gt;BuildKit has been integrated to &lt;code&gt;docker build&lt;/code&gt; since Docker 18.09&lt;/a&gt;. You don&#39;t need to read this document unless you want to use the full-featured standalone version of BuildKit.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;!-- START doctoc generated TOC please keep comment here to allow auto update --&gt; &#xA;&lt;!-- DON&#39;T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#used-by&#34;&gt;Used by&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#quick-start&#34;&gt;Quick start&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#starting-the-buildkitd-daemon&#34;&gt;Starting the &lt;code&gt;buildkitd&lt;/code&gt; daemon&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#exploring-llb&#34;&gt;Exploring LLB&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#exploring-dockerfiles&#34;&gt;Exploring Dockerfiles&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#building-a-dockerfile-with-buildctl&#34;&gt;Building a Dockerfile with &lt;code&gt;buildctl&lt;/code&gt;&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#building-a-dockerfile-using-external-frontend&#34;&gt;Building a Dockerfile using external frontend&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#output&#34;&gt;Output&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#imageregistry&#34;&gt;Image/Registry&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#local-directory&#34;&gt;Local directory&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#docker-tarball&#34;&gt;Docker tarball&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#oci-tarball&#34;&gt;OCI tarball&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#containerd-image-store&#34;&gt;containerd image store&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#cache&#34;&gt;Cache&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#garbage-collection&#34;&gt;Garbage collection&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#export-cache&#34;&gt;Export cache&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#inline-push-image-and-cache-together&#34;&gt;Inline (push image and cache together)&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#registry-push-image-and-cache-separately&#34;&gt;Registry (push image and cache separately)&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#local-directory-1&#34;&gt;Local directory&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#github-actions-cache-experimental&#34;&gt;GitHub Actions cache (experimental)&lt;/a&gt;&lt;/li&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#s3-cache-experimental&#34;&gt;S3 cache (experimental)&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#consistent-hashing&#34;&gt;Consistent hashing&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#metadata&#34;&gt;Metadata&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#systemd-socket-activation&#34;&gt;Systemd socket activation&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#expose-buildkit-as-a-tcp-service&#34;&gt;Expose BuildKit as a TCP service&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#load-balancing&#34;&gt;Load balancing&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#containerizing-buildkit&#34;&gt;Containerizing BuildKit&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#podman&#34;&gt;Podman&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#kubernetes&#34;&gt;Kubernetes&lt;/a&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#daemonless&#34;&gt;Daemonless&lt;/a&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#opentracing-support&#34;&gt;Opentracing support&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#running-buildkit-without-root-privileges&#34;&gt;Running BuildKit without root privileges&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#building-multi-platform-images&#34;&gt;Building multi-platform images&lt;/a&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#configuring-buildctl&#34;&gt;Configuring &lt;code&gt;buildctl&lt;/code&gt;&lt;/a&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#color-output-controls&#34;&gt;Color Output Controls&lt;/a&gt;&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#contributing&#34;&gt;Contributing&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;!-- END doctoc generated TOC please keep comment here to allow auto update --&gt; &#xA;&lt;h2&gt;Used by&lt;/h2&gt; &#xA;&lt;p&gt;BuildKit is used by the following projects:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/moby/moby/pull/37151&#34;&gt;Moby &amp;amp; Docker&lt;/a&gt; (&lt;code&gt;DOCKER_BUILDKIT=1 docker build&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/genuinetools/img&#34;&gt;img&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/openfaas/openfaas-cloud&#34;&gt;OpenFaaS Cloud&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/containerbuilding/cbi&#34;&gt;container build interface&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/tektoncd/catalog&#34;&gt;Tekton Pipelines&lt;/a&gt; (formerly &lt;a href=&#34;https://github.com/knative/build-templates&#34;&gt;Knative Build Templates&lt;/a&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/distributed-containers-inc/sanic&#34;&gt;the Sanic build tool&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/stellarproject/vab&#34;&gt;vab&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/rancher/rio&#34;&gt;Rio&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/rancher/kim&#34;&gt;kim&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/alibaba/pouch&#34;&gt;PouchContainer&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/docker/buildx&#34;&gt;Docker buildx&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://okteto.com/&#34;&gt;Okteto Cloud&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/vladaionescu/earthly&#34;&gt;Earthly earthfiles&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/gitpod-io/gitpod&#34;&gt;Gitpod&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://dagger.io&#34;&gt;Dagger&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/tensorchord/envd/&#34;&gt;envd&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Quick start&lt;/h2&gt; &#xA;&lt;p&gt;&lt;span&gt;â„¹&lt;/span&gt; For Kubernetes deployments, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/examples/kubernetes&#34;&gt;&lt;code&gt;examples/kubernetes&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;BuildKit is composed of the &lt;code&gt;buildkitd&lt;/code&gt; daemon and the &lt;code&gt;buildctl&lt;/code&gt; client. While the &lt;code&gt;buildctl&lt;/code&gt; client is available for Linux, macOS, and Windows, the &lt;code&gt;buildkitd&lt;/code&gt; daemon is only available for Linux currently.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;buildkitd&lt;/code&gt; daemon requires the following components to be installed:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/opencontainers/runc&#34;&gt;runc&lt;/a&gt; or &lt;a href=&#34;https://github.com/containers/crun&#34;&gt;crun&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/containerd/containerd&#34;&gt;containerd&lt;/a&gt; (if you want to use containerd worker)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;The latest binaries of BuildKit are available &lt;a href=&#34;https://github.com/moby/buildkit/releases&#34;&gt;here&lt;/a&gt; for Linux, macOS, and Windows.&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://formulae.brew.sh/formula/buildkit&#34;&gt;Homebrew package&lt;/a&gt; (unofficial) is available for macOS.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;$ brew install buildkit&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To build BuildKit from source, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/.github/CONTRIBUTING.md&#34;&gt;&lt;code&gt;.github/CONTRIBUTING.md&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Starting the &lt;code&gt;buildkitd&lt;/code&gt; daemon&lt;/h3&gt; &#xA;&lt;p&gt;You need to run &lt;code&gt;buildkitd&lt;/code&gt; as the root user on the host.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ sudo buildkitd&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To run &lt;code&gt;buildkitd&lt;/code&gt; as a non-root user, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/rootless.md&#34;&gt;&lt;code&gt;docs/rootless.md&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;The buildkitd daemon supports two worker backends: OCI (runc) and containerd.&lt;/p&gt; &#xA;&lt;p&gt;By default, the OCI (runc) worker is used. You can set &lt;code&gt;--oci-worker=false --containerd-worker=true&lt;/code&gt; to use the containerd worker.&lt;/p&gt; &#xA;&lt;p&gt;We are open to adding more backends.&lt;/p&gt; &#xA;&lt;p&gt;To start the buildkitd daemon using systemd socket activiation, you can install the buildkit systemd unit files. See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#systemd-socket-activation&#34;&gt;Systemd socket activation&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;The buildkitd daemon listens gRPC API on &lt;code&gt;/run/buildkit/buildkitd.sock&lt;/code&gt; by default, but you can also use TCP sockets. See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#expose-buildkit-as-a-tcp-service&#34;&gt;Expose BuildKit as a TCP service&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Exploring LLB&lt;/h3&gt; &#xA;&lt;p&gt;BuildKit builds are based on a binary intermediate format called LLB that is used for defining the dependency graph for processes running part of your build. tl;dr: LLB is to Dockerfile what LLVM IR is to C.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Marshaled as Protobuf messages&lt;/li&gt; &#xA; &lt;li&gt;Concurrently executable&lt;/li&gt; &#xA; &lt;li&gt;Efficiently cacheable&lt;/li&gt; &#xA; &lt;li&gt;Vendor-neutral (i.e. non-Dockerfile languages can be easily implemented)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/solver/pb/ops.proto&#34;&gt;&lt;code&gt;solver/pb/ops.proto&lt;/code&gt;&lt;/a&gt; for the format definition, and see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/examples/README.md&#34;&gt;&lt;code&gt;./examples/README.md&lt;/code&gt;&lt;/a&gt; for example LLB applications.&lt;/p&gt; &#xA;&lt;p&gt;Currently, the following high-level languages has been implemented for LLB:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Dockerfile (See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#exploring-dockerfiles&#34;&gt;Exploring Dockerfiles&lt;/a&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/tonistiigi/buildkit-pack&#34;&gt;Buildpacks&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://matt-rickard.com/building-a-new-dockerfile-frontend/&#34;&gt;Mockerfile&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/po3rin/gockerfile&#34;&gt;Gockerfile&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/talos-systems/bldr/&#34;&gt;bldr (Pkgfile)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/openllb/hlb&#34;&gt;HLB&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/earthly/earthly&#34;&gt;Earthfile (Earthly)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/denzp/cargo-wharf&#34;&gt;Cargo Wharf (Rust)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/AkihiroSuda/buildkit-nix&#34;&gt;Nix&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/cmdjulian/mopy&#34;&gt;mopy (Python)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/tensorchord/envd/&#34;&gt;envd (starlark)&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;(open a PR to add your own language)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Exploring Dockerfiles&lt;/h3&gt; &#xA;&lt;p&gt;Frontends are components that run inside BuildKit and convert any build definition to LLB. There is a special frontend called gateway (&lt;code&gt;gateway.v0&lt;/code&gt;) that allows using any image as a frontend.&lt;/p&gt; &#xA;&lt;p&gt;During development, Dockerfile frontend (&lt;code&gt;dockerfile.v0&lt;/code&gt;) is also part of the BuildKit repo. In the future, this will be moved out, and Dockerfiles can be built using an external image.&lt;/p&gt; &#xA;&lt;h4&gt;Building a Dockerfile with &lt;code&gt;buildctl&lt;/code&gt;&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build \&#xA;    --frontend=dockerfile.v0 \&#xA;    --local context=. \&#xA;    --local dockerfile=.&#xA;# or&#xA;buildctl build \&#xA;    --frontend=dockerfile.v0 \&#xA;    --local context=. \&#xA;    --local dockerfile=. \&#xA;    --opt target=foo \&#xA;    --opt build-arg:foo=bar&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;--local&lt;/code&gt; exposes local source files from client to the builder. &lt;code&gt;context&lt;/code&gt; and &lt;code&gt;dockerfile&lt;/code&gt; are the names Dockerfile frontend looks for build context and Dockerfile location.&lt;/p&gt; &#xA;&lt;h4&gt;Building a Dockerfile using external frontend&lt;/h4&gt; &#xA;&lt;p&gt;External versions of the Dockerfile frontend are pushed to &lt;a href=&#34;https://hub.docker.com/r/docker/dockerfile-upstream&#34;&gt;https://hub.docker.com/r/docker/dockerfile-upstream&lt;/a&gt; and &lt;a href=&#34;https://hub.docker.com/r/docker/dockerfile&#34;&gt;https://hub.docker.com/r/docker/dockerfile&lt;/a&gt; and can be used with the gateway frontend. The source for the external frontend is currently located in &lt;code&gt;./frontend/dockerfile/cmd/dockerfile-frontend&lt;/code&gt; but will move out of this repository in the future (&lt;a href=&#34;https://github.com/moby/buildkit/issues/163&#34;&gt;#163&lt;/a&gt;). For automatic build from master branch of this repository &lt;code&gt;docker/dockerfile-upstream:master&lt;/code&gt; or &lt;code&gt;docker/dockerfile-upstream:master-labs&lt;/code&gt; image can be used.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build \&#xA;    --frontend gateway.v0 \&#xA;    --opt source=docker/dockerfile \&#xA;    --local context=. \&#xA;    --local dockerfile=.&#xA;buildctl build \&#xA;    --frontend gateway.v0 \&#xA;    --opt source=docker/dockerfile \&#xA;    --opt context=https://github.com/moby/moby.git \&#xA;    --opt build-arg:APT_MIRROR=cdn-fastly.deb.debian.org&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Output&lt;/h3&gt; &#xA;&lt;p&gt;By default, the build result and intermediate cache will only remain internally in BuildKit. An output needs to be specified to retrieve the result.&lt;/p&gt; &#xA;&lt;h4&gt;Image/Registry&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --output type=image,name=docker.io/username/image,push=true&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To export the image to multiple registries:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --output type=image,\&#34;name=docker.io/username/image,docker.io/username2/image2\&#34;,push=true&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To export the cache embed with the image and pushing them to registry together, type &lt;code&gt;registry&lt;/code&gt; is required to import the cache, you should specify &lt;code&gt;--export-cache type=inline&lt;/code&gt; and &lt;code&gt;--import-cache type=registry,ref=...&lt;/code&gt;. To export the cache to a local directy, you should specify &lt;code&gt;--export-cache type=local&lt;/code&gt;. Details in &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#export-cache&#34;&gt;Export cache&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ...\&#xA;  --output type=image,name=docker.io/username/image,push=true \&#xA;  --export-cache type=inline \&#xA;  --import-cache type=registry,ref=docker.io/username/image&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Keys supported by image output:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;name=&amp;lt;value&amp;gt;&lt;/code&gt;: specify image name(s)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;push=true&lt;/code&gt;: push after creating the image&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;push-by-digest=true&lt;/code&gt;: push unnamed image&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;registry.insecure=true&lt;/code&gt;: push to insecure HTTP registry&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;oci-mediatypes=true&lt;/code&gt;: use OCI mediatypes in configuration JSON instead of Docker&#39;s&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;unpack=true&lt;/code&gt;: unpack image after creation (for use with containerd)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;dangling-name-prefix=&amp;lt;value&amp;gt;&lt;/code&gt;: name image with &lt;code&gt;prefix@&amp;lt;digest&amp;gt;&lt;/code&gt;, used for anonymous images&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;name-canonical=true&lt;/code&gt;: add additional canonical name &lt;code&gt;name@&amp;lt;digest&amp;gt;&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;compression=&amp;lt;uncompressed|gzip|estargz|zstd&amp;gt;&lt;/code&gt;: choose compression type for layers newly created and cached, gzip is default value. estargz should be used with &lt;code&gt;oci-mediatypes=true&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;compression-level=&amp;lt;value&amp;gt;&lt;/code&gt;: compression level for gzip, estargz (0-9) and zstd (0-22)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;force-compression=true&lt;/code&gt;: forcefully apply &lt;code&gt;compression&lt;/code&gt; option to all layers (including already existing layers)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;buildinfo=true&lt;/code&gt;: attach inline build info in &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/build-repro.md#image-config&#34;&gt;image config&lt;/a&gt; (default &lt;code&gt;true&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;buildinfo-attrs=true&lt;/code&gt;: attach inline build info attributes in &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/build-repro.md#image-config&#34;&gt;image config&lt;/a&gt; (default &lt;code&gt;false&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;store=true&lt;/code&gt;: store the result images to the worker&#39;s (e.g. containerd) image store as well as ensures that the image has all blobs in the content store (default &lt;code&gt;true&lt;/code&gt;). Ignored if the worker doesn&#39;t have image store (e.g. OCI worker).&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;annotation.&amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;&lt;/code&gt;: attach an annotation with the respective &lt;code&gt;key&lt;/code&gt; and &lt;code&gt;value&lt;/code&gt; to the built image &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Using the extended syntaxes, &lt;code&gt;annotation-&amp;lt;type&amp;gt;.&amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;&lt;/code&gt;, &lt;code&gt;annotation[&amp;lt;platform&amp;gt;].&amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;&lt;/code&gt; and both combined with &lt;code&gt;annotation-&amp;lt;type&amp;gt;[&amp;lt;platform&amp;gt;].&amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;&lt;/code&gt;, allows configuring exactly where to attach the annotation.&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;&amp;lt;type&amp;gt;&lt;/code&gt; specifies what object to attach to, and can be any of &lt;code&gt;manifest&lt;/code&gt; (the default), &lt;code&gt;manifest-descriptor&lt;/code&gt;, &lt;code&gt;index&lt;/code&gt; and &lt;code&gt;index-descriptor&lt;/code&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;&amp;lt;platform&amp;gt;&lt;/code&gt; specifies which objects to attach to (by default, all), and is the same key passed into the &lt;code&gt;platform&lt;/code&gt; opt, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/multi-platform.md&#34;&gt;&lt;code&gt;docs/multi-platform.md&lt;/code&gt;&lt;/a&gt;.&lt;/li&gt; &#xA;   &lt;li&gt;See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/annotations.md&#34;&gt;&lt;code&gt;docs/annotations.md&lt;/code&gt;&lt;/a&gt; for more details.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;If credentials are required, &lt;code&gt;buildctl&lt;/code&gt; will attempt to read Docker configuration file &lt;code&gt;$DOCKER_CONFIG/config.json&lt;/code&gt;. &lt;code&gt;$DOCKER_CONFIG&lt;/code&gt; defaults to &lt;code&gt;~/.docker&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h4&gt;Local directory&lt;/h4&gt; &#xA;&lt;p&gt;The local client will copy the files directly to the client. This is useful if BuildKit is being used for building something else than container images.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --output type=local,dest=path/to/output-dir&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To export specific files use multi-stage builds with a scratch stage and copy the needed files into that stage with &lt;code&gt;COPY --from&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-dockerfile&#34;&gt;...&#xA;FROM scratch as testresult&#xA;&#xA;COPY --from=builder /usr/src/app/testresult.xml .&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --opt target=testresult --output type=local,dest=path/to/output-dir&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Tar exporter is similar to local exporter but transfers the files through a tarball.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --output type=tar,dest=out.tar&#xA;buildctl build ... --output type=tar &amp;gt; out.tar&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Docker tarball&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# exported tarball is also compatible with OCI spec&#xA;buildctl build ... --output type=docker,name=myimage | docker load&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;OCI tarball&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --output type=oci,dest=path/to/output.tar&#xA;buildctl build ... --output type=oci &amp;gt; output.tar&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;containerd image store&lt;/h4&gt; &#xA;&lt;p&gt;The containerd worker needs to be used&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --output type=image,name=docker.io/username/image&#xA;ctr --namespace=buildkit images ls&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To change the containerd namespace, you need to change &lt;code&gt;worker.containerd.namespace&lt;/code&gt; in &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/buildkitd.toml.md&#34;&gt;&lt;code&gt;/etc/buildkit/buildkitd.toml&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Cache&lt;/h2&gt; &#xA;&lt;p&gt;To show local build cache (&lt;code&gt;/var/lib/buildkit&lt;/code&gt;):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl du -v&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To prune local build cache:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl prune&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Garbage collection&lt;/h3&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/buildkitd.toml.md&#34;&gt;&lt;code&gt;./docs/buildkitd.toml.md&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Export cache&lt;/h3&gt; &#xA;&lt;p&gt;BuildKit supports the following cache exporters:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;inline&lt;/code&gt;: embed the cache into the image, and push them to the registry together&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;registry&lt;/code&gt;: push the image and the cache separately&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;local&lt;/code&gt;: export to a local directory&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;gha&lt;/code&gt;: export to GitHub Actions cache&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;In most case you want to use the &lt;code&gt;inline&lt;/code&gt; cache exporter. However, note that the &lt;code&gt;inline&lt;/code&gt; cache exporter only supports &lt;code&gt;min&lt;/code&gt; cache mode. To enable &lt;code&gt;max&lt;/code&gt; cache mode, push the image and the cache separately by using &lt;code&gt;registry&lt;/code&gt; cache exporter.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;inline&lt;/code&gt; and &lt;code&gt;registry&lt;/code&gt; exporters both store the cache in the registry. For importing the cache, &lt;code&gt;type=registry&lt;/code&gt; is sufficient for both, as specifying the cache format is not necessary.&lt;/p&gt; &#xA;&lt;h4&gt;Inline (push image and cache together)&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... \&#xA;  --output type=image,name=docker.io/username/image,push=true \&#xA;  --export-cache type=inline \&#xA;  --import-cache type=registry,ref=docker.io/username/image&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Note that the inline cache is not imported unless &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#registry-push-image-and-cache-separately&#34;&gt;&lt;code&gt;--import-cache type=registry,ref=...&lt;/code&gt;&lt;/a&gt; is provided.&lt;/p&gt; &#xA;&lt;p&gt;Inline cache embeds cache metadata into the image config. The layers in the image will be left untouched compared to the image with no cache information.&lt;/p&gt; &#xA;&lt;p&gt;&lt;span&gt;â„¹&lt;/span&gt; Docker-integrated BuildKit (&lt;code&gt;DOCKER_BUILDKIT=1 docker build&lt;/code&gt;) and &lt;code&gt;docker buildx&lt;/code&gt;requires &lt;code&gt;--build-arg BUILDKIT_INLINE_CACHE=1&lt;/code&gt; to be specified to enable the &lt;code&gt;inline&lt;/code&gt; cache exporter. However, the standalone &lt;code&gt;buildctl&lt;/code&gt; does NOT require &lt;code&gt;--opt build-arg:BUILDKIT_INLINE_CACHE=1&lt;/code&gt; and the build-arg is simply ignored.&lt;/p&gt; &#xA;&lt;h4&gt;Registry (push image and cache separately)&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... \&#xA;  --output type=image,name=localhost:5000/myrepo:image,push=true \&#xA;  --export-cache type=registry,ref=localhost:5000/myrepo:buildcache \&#xA;  --import-cache type=registry,ref=localhost:5000/myrepo:buildcache&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;--export-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=registry&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;mode=&amp;lt;min|max&amp;gt;&lt;/code&gt;: specify cache layers to export (default: &lt;code&gt;min&lt;/code&gt;) &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;min&lt;/code&gt;: only export layers for the resulting image&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;max&lt;/code&gt;: export all the layers of all intermediate steps&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;ref=&amp;lt;ref&amp;gt;&lt;/code&gt;: specify repository reference to store cache, e.g. &lt;code&gt;docker.io/user/image:tag&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;oci-mediatypes=&amp;lt;true|false&amp;gt;&lt;/code&gt;: whether to use OCI mediatypes in exported manifests (default: &lt;code&gt;true&lt;/code&gt;, since BuildKit &lt;code&gt;v0.8&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;compression=&amp;lt;uncompressed|gzip|estargz|zstd&amp;gt;&lt;/code&gt;: choose compression type for layers newly created and cached, gzip is default value. estargz and zstd should be used with &lt;code&gt;oci-mediatypes=true&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;compression-level=&amp;lt;value&amp;gt;&lt;/code&gt;: choose compression level for gzip, estargz (0-9) and zstd (0-22)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;force-compression=true&lt;/code&gt;: forcibly apply &lt;code&gt;compression&lt;/code&gt; option to all layers&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;--import-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=registry&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;ref=&amp;lt;ref&amp;gt;&lt;/code&gt;: specify repository reference to retrieve cache from, e.g. &lt;code&gt;docker.io/user/image:tag&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Local directory&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --export-cache type=local,dest=path/to/output-dir&#xA;buildctl build ... --import-cache type=local,src=path/to/input-dir&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The directory layout conforms to OCI Image Spec v1.0.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;--export-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=local&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;mode=&amp;lt;min|max&amp;gt;&lt;/code&gt;: specify cache layers to export (default: &lt;code&gt;min&lt;/code&gt;) &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;min&lt;/code&gt;: only export layers for the resulting image&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;max&lt;/code&gt;: export all the layers of all intermediate steps&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;dest=&amp;lt;path&amp;gt;&lt;/code&gt;: destination directory for cache exporter&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;oci-mediatypes=&amp;lt;true|false&amp;gt;&lt;/code&gt;: whether to use OCI mediatypes in exported manifests (default &lt;code&gt;true&lt;/code&gt;, since BuildKit &lt;code&gt;v0.8&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;compression=&amp;lt;uncompressed|gzip|estargz|zstd&amp;gt;&lt;/code&gt;: choose compression type for layers newly created and cached, gzip is default value. estargz and zstd should be used with &lt;code&gt;oci-mediatypes=true&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;compression-level=&amp;lt;value&amp;gt;&lt;/code&gt;: compression level for gzip, estargz (0-9) and zstd (0-22)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;force-compression=true&lt;/code&gt;: forcibly apply &lt;code&gt;compression&lt;/code&gt; option to all layers&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;--import-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=local&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;src=&amp;lt;path&amp;gt;&lt;/code&gt;: source directory for cache importer&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;digest=sha256:&amp;lt;sha256digest&amp;gt;&lt;/code&gt;: specify explicit digest of the manifest list to import&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;tag=&amp;lt;tag&amp;gt;&lt;/code&gt;: determine custom tag of image. Defaults &#34;latest&#34; tag digest in &lt;code&gt;index.json&lt;/code&gt; is for digest, not for tag&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;GitHub Actions cache (experimental)&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... \&#xA;  --output type=image,name=docker.io/username/image,push=true \&#xA;  --export-cache type=gha \&#xA;  --import-cache type=gha&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Github Actions cache saves both cache metadata and layers to GitHub&#39;s Cache service. This cache currently has a &lt;a href=&#34;https://docs.github.com/en/actions/advanced-guides/caching-dependencies-to-speed-up-workflows#usage-limits-and-eviction-policy&#34;&gt;size limit of 10GB&lt;/a&gt; that is shared accross different caches in the repo. If you exceed this limit, GitHub will save your cache but will begin evicting caches until the total size is less than 10 GB. Recycling caches too often can result in slower runtimes overall.&lt;/p&gt; &#xA;&lt;p&gt;Similarly to using &lt;a href=&#34;https://github.com/actions/cache&#34;&gt;actions/cache&lt;/a&gt;, caches are &lt;a href=&#34;https://docs.github.com/en/actions/advanced-guides/caching-dependencies-to-speed-up-workflows#restrictions-for-accessing-a-cache&#34;&gt;scoped by branch&lt;/a&gt;, with the default and target branches being available to every branch.&lt;/p&gt; &#xA;&lt;p&gt;Following attributes are required to authenticate against the &lt;a href=&#34;https://github.com/tonistiigi/go-actions-cache/raw/master/api.md#authentication&#34;&gt;Github Actions Cache service API&lt;/a&gt;:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;url&lt;/code&gt;: Cache server URL (default &lt;code&gt;$ACTIONS_CACHE_URL&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;token&lt;/code&gt;: Access token (default &lt;code&gt;$ACTIONS_RUNTIME_TOKEN&lt;/code&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;span&gt;â„¹&lt;/span&gt; This type of cache can be used with &lt;a href=&#34;https://github.com/docker/build-push-action&#34;&gt;Docker Build Push Action&lt;/a&gt; where &lt;code&gt;url&lt;/code&gt; and &lt;code&gt;token&lt;/code&gt; will be automatically set. To use this backend in a inline &lt;code&gt;run&lt;/code&gt; step, you have to include &lt;a href=&#34;https://github.com/crazy-max/ghaction-github-runtime&#34;&gt;crazy-max/ghaction-github-runtime&lt;/a&gt; in your workflow to expose the runtime.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;--export-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=gha&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;mode=&amp;lt;min|max&amp;gt;&lt;/code&gt;: specify cache layers to export (default: &lt;code&gt;min&lt;/code&gt;) &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;min&lt;/code&gt;: only export layers for the resulting image&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;max&lt;/code&gt;: export all the layers of all intermediate steps&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;scope=&amp;lt;scope&amp;gt;&lt;/code&gt;: which scope cache object belongs to (default &lt;code&gt;buildkit&lt;/code&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;--import-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=gha&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;scope=&amp;lt;scope&amp;gt;&lt;/code&gt;: which scope cache object belongs to (default &lt;code&gt;buildkit&lt;/code&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;S3 cache (experimental)&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... \&#xA;  --output type=image,name=docker.io/username/image,push=true \&#xA;  --export-cache type=s3,region=eu-west-1,bucket=my_bucket,name=my_image \&#xA;  --import-cache type=s3,region=eu-west-1,bucket=my_bucket,name=my_image&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The following attributes are required:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;bucket&lt;/code&gt;: AWS S3 bucket (default: &lt;code&gt;$AWS_BUCKET&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;region&lt;/code&gt;: AWS region (default: &lt;code&gt;$AWS_REGION&lt;/code&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Storage locations:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;blobs: &lt;code&gt;s3://&amp;lt;bucket&amp;gt;/&amp;lt;prefix&amp;gt;&amp;lt;blobs_prefix&amp;gt;/&amp;lt;sha256&amp;gt;&lt;/code&gt;, default: &lt;code&gt;s3://&amp;lt;bucket&amp;gt;/blobs/&amp;lt;sha256&amp;gt;&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;manifests: &lt;code&gt;s3://&amp;lt;bucket&amp;gt;/&amp;lt;prefix&amp;gt;&amp;lt;manifests_prefix&amp;gt;/&amp;lt;name&amp;gt;&lt;/code&gt;, default: &lt;code&gt;s3://&amp;lt;bucket&amp;gt;/manifests/&amp;lt;name&amp;gt;&lt;/code&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;S3 configuration:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;blobs_prefix&lt;/code&gt;: global prefix to store / read blobs on s3 (default: &lt;code&gt;blobs/&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;manifests_prefix&lt;/code&gt;: global prefix to store / read blobs on s3 (default: &lt;code&gt;manifests/&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;endpoint_url&lt;/code&gt;: specify a specific S3 endpoint (default: empty)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;use_path_style&lt;/code&gt;: if set to &lt;code&gt;true&lt;/code&gt;, put the bucket name in the URL instead of in the hostname (default: &lt;code&gt;false&lt;/code&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;AWS Authentication:&lt;/p&gt; &#xA;&lt;p&gt;The simplest way is to use an IAM Instance profile. Others options are:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Any system using environment variables / config files supported by the &lt;a href=&#34;https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html&#34;&gt;AWS Go SDK&lt;/a&gt;. The configuration must be available for the buildkit daemon, not for the client.&lt;/li&gt; &#xA; &lt;li&gt;Using the following attributes: &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;access_key_id&lt;/code&gt;: Access Key ID&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;secret_access_key&lt;/code&gt;: Secret Access Key&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;session_token&lt;/code&gt;: Session Token&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;--export-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=s3&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;mode=&amp;lt;min|max&amp;gt;&lt;/code&gt;: specify cache layers to export (default: &lt;code&gt;min&lt;/code&gt;) &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;code&gt;min&lt;/code&gt;: only export layers for the resulting image&lt;/li&gt; &#xA;   &lt;li&gt;&lt;code&gt;max&lt;/code&gt;: export all the layers of all intermediate steps&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;prefix=&amp;lt;prefix&amp;gt;&lt;/code&gt;: set global prefix to store / read files on s3 (default: empty)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;name=&amp;lt;manifest&amp;gt;&lt;/code&gt;: specify name of the manifest to use (default &lt;code&gt;buildkit&lt;/code&gt;) &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Multiple manifest names can be specified at the same time, separated by &lt;code&gt;;&lt;/code&gt;. The standard use case is to use the git sha1 as name, and the branch name as duplicate, and load both with 2 &lt;code&gt;import-cache&lt;/code&gt; commands.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;--import-cache&lt;/code&gt; options:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;type=s3&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;prefix=&amp;lt;prefix&amp;gt;&lt;/code&gt;: set global prefix to store / read files on s3 (default: empty)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;blobs_prefix=&amp;lt;prefix&amp;gt;&lt;/code&gt;: set global prefix to store / read blobs on s3 (default: &lt;code&gt;blobs/&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;manifests_prefix=&amp;lt;prefix&amp;gt;&lt;/code&gt;: set global prefix to store / read manifests on s3 (default: &lt;code&gt;manifests/&lt;/code&gt;)&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;name=&amp;lt;manifest&amp;gt;&lt;/code&gt;: name of the manifest to use (default &lt;code&gt;buildkit&lt;/code&gt;)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h3&gt;Consistent hashing&lt;/h3&gt; &#xA;&lt;p&gt;If you have multiple BuildKit daemon instances but you don&#39;t want to use registry for sharing cache across the cluster, consider client-side load balancing using consistent hashing.&lt;/p&gt; &#xA;&lt;p&gt;See &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/examples/kubernetes/consistenthash&#34;&gt;&lt;code&gt;./examples/kubernetes/consistenthash&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Metadata&lt;/h2&gt; &#xA;&lt;p&gt;To output build metadata such as the image digest, pass the &lt;code&gt;--metadata-file&lt;/code&gt; flag. The metadata will be written as a JSON object to the specified file. The directory of the specified file must already exist and be writable.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl build ... --metadata-file metadata.json&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;jq &#39;.&#39; metadata.json&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;{&#xA;  &#34;containerimage.buildinfo&#34;: {&#xA;    &#34;frontend&#34;: &#34;dockerfile.v0&#34;,&#xA;    &#34;attrs&#34;: {&#xA;      &#34;context&#34;: &#34;https://github.com/crazy-max/buildkit-buildsources-test.git#master&#34;,&#xA;      &#34;filename&#34;: &#34;Dockerfile&#34;,&#xA;      &#34;source&#34;: &#34;docker/dockerfile:master&#34;&#xA;    },&#xA;    &#34;sources&#34;: [&#xA;      {&#xA;        &#34;type&#34;: &#34;docker-image&#34;,&#xA;        &#34;ref&#34;: &#34;docker.io/docker/buildx-bin:0.6.1@sha256:a652ced4a4141977c7daaed0a074dcd9844a78d7d2615465b12f433ae6dd29f0&#34;,&#xA;        &#34;pin&#34;: &#34;sha256:a652ced4a4141977c7daaed0a074dcd9844a78d7d2615465b12f433ae6dd29f0&#34;&#xA;      },&#xA;      {&#xA;        &#34;type&#34;: &#34;docker-image&#34;,&#xA;        &#34;ref&#34;: &#34;docker.io/library/alpine:3.13&#34;,&#xA;        &#34;pin&#34;: &#34;sha256:026f721af4cf2843e07bba648e158fb35ecc876d822130633cc49f707f0fc88c&#34;&#xA;      }&#xA;    ]&#xA;  },&#xA;  &#34;containerimage.config.digest&#34;: &#34;sha256:2937f66a9722f7f4a2df583de2f8cb97fc9196059a410e7f00072fc918930e66&#34;,&#xA;  &#34;containerimage.descriptor&#34;: {&#xA;    &#34;annotations&#34;: {&#xA;      &#34;config.digest&#34;: &#34;sha256:2937f66a9722f7f4a2df583de2f8cb97fc9196059a410e7f00072fc918930e66&#34;,&#xA;      &#34;org.opencontainers.image.created&#34;: &#34;2022-02-08T21:28:03Z&#34;&#xA;    },&#xA;    &#34;digest&#34;: &#34;sha256:19ffeab6f8bc9293ac2c3fdf94ebe28396254c993aea0b5a542cfb02e0883fa3&#34;,&#xA;    &#34;mediaType&#34;: &#34;application/vnd.oci.image.manifest.v1+json&#34;,&#xA;    &#34;size&#34;: 506&#xA;  },&#xA;  &#34;containerimage.digest&#34;: &#34;sha256:19ffeab6f8bc9293ac2c3fdf94ebe28396254c993aea0b5a542cfb02e0883fa3&#34;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Systemd socket activation&lt;/h2&gt; &#xA;&lt;p&gt;On Systemd based systems, you can communicate with the daemon via &lt;a href=&#34;http://0pointer.de/blog/projects/socket-activation.html&#34;&gt;Systemd socket activation&lt;/a&gt;, use &lt;code&gt;buildkitd --addr fd://&lt;/code&gt;. You can find examples of using Systemd socket activation with BuildKit and Systemd in &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/examples/systemd&#34;&gt;&lt;code&gt;./examples/systemd&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Expose BuildKit as a TCP service&lt;/h2&gt; &#xA;&lt;p&gt;The &lt;code&gt;buildkitd&lt;/code&gt; daemon can listen the gRPC API on a TCP socket.&lt;/p&gt; &#xA;&lt;p&gt;It is highly recommended to create TLS certificates for both the daemon and the client (mTLS). Enabling TCP without mTLS is dangerous because the executor containers (aka Dockerfile &lt;code&gt;RUN&lt;/code&gt; containers) can call BuildKit API as well.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildkitd \&#xA;  --addr tcp://0.0.0.0:1234 \&#xA;  --tlscacert /path/to/ca.pem \&#xA;  --tlscert /path/to/cert.pem \&#xA;  --tlskey /path/to/key.pem&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;buildctl \&#xA;  --addr tcp://example.com:1234 \&#xA;  --tlscacert /path/to/ca.pem \&#xA;  --tlscert /path/to/clientcert.pem \&#xA;  --tlskey /path/to/clientkey.pem \&#xA;  build ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Load balancing&lt;/h3&gt; &#xA;&lt;p&gt;&lt;code&gt;buildctl build&lt;/code&gt; can be called against randomly load balanced the &lt;code&gt;buildkitd&lt;/code&gt; daemon.&lt;/p&gt; &#xA;&lt;p&gt;See also &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/#consistenthashing&#34;&gt;Consistent hashing&lt;/a&gt; for client-side load balancing.&lt;/p&gt; &#xA;&lt;h2&gt;Containerizing BuildKit&lt;/h2&gt; &#xA;&lt;p&gt;BuildKit can also be used by running the &lt;code&gt;buildkitd&lt;/code&gt; daemon inside a Docker container and accessing it remotely.&lt;/p&gt; &#xA;&lt;p&gt;We provide the container images as &lt;a href=&#34;https://hub.docker.com/r/moby/buildkit/tags/&#34;&gt;&lt;code&gt;moby/buildkit&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;moby/buildkit:latest&lt;/code&gt;: built from the latest regular &lt;a href=&#34;https://github.com/moby/buildkit/releases&#34;&gt;release&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;moby/buildkit:rootless&lt;/code&gt;: same as &lt;code&gt;latest&lt;/code&gt; but runs as an unprivileged user, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/rootless.md&#34;&gt;&lt;code&gt;docs/rootless.md&lt;/code&gt;&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;moby/buildkit:master&lt;/code&gt;: built from the master branch&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;moby/buildkit:master-rootless&lt;/code&gt;: same as master but runs as an unprivileged user, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/rootless.md&#34;&gt;&lt;code&gt;docs/rootless.md&lt;/code&gt;&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;To run daemon in a container:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run -d --name buildkitd --privileged moby/buildkit:latest&#xA;export BUILDKIT_HOST=docker-container://buildkitd&#xA;buildctl build --help&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Podman&lt;/h3&gt; &#xA;&lt;p&gt;To connect to a BuildKit daemon running in a Podman container, use &lt;code&gt;podman-container://&lt;/code&gt; instead of &lt;code&gt;docker-container://&lt;/code&gt; .&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;podman run -d --name buildkitd --privileged moby/buildkit:latest&#xA;buildctl --addr=podman-container://buildkitd build --frontend dockerfile.v0 --local context=. --local dockerfile=. --output type=oci | podman load foo&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;sudo&lt;/code&gt; is not required.&lt;/p&gt; &#xA;&lt;h3&gt;Kubernetes&lt;/h3&gt; &#xA;&lt;p&gt;For Kubernetes deployments, see &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/examples/kubernetes&#34;&gt;&lt;code&gt;examples/kubernetes&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Daemonless&lt;/h3&gt; &#xA;&lt;p&gt;To run the client and an ephemeral daemon in a single container (&#34;daemonless mode&#34;):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run \&#xA;    -it \&#xA;    --rm \&#xA;    --privileged \&#xA;    -v /path/to/dir:/tmp/work \&#xA;    --entrypoint buildctl-daemonless.sh \&#xA;    moby/buildkit:master \&#xA;        build \&#xA;        --frontend dockerfile.v0 \&#xA;        --local context=/tmp/work \&#xA;        --local dockerfile=/tmp/work&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;or&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run \&#xA;    -it \&#xA;    --rm \&#xA;    --security-opt seccomp=unconfined \&#xA;    --security-opt apparmor=unconfined \&#xA;    -e BUILDKITD_FLAGS=--oci-worker-no-process-sandbox \&#xA;    -v /path/to/dir:/tmp/work \&#xA;    --entrypoint buildctl-daemonless.sh \&#xA;    moby/buildkit:master-rootless \&#xA;        build \&#xA;        --frontend \&#xA;        dockerfile.v0 \&#xA;        --local context=/tmp/work \&#xA;        --local dockerfile=/tmp/work&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Opentracing support&lt;/h2&gt; &#xA;&lt;p&gt;BuildKit supports opentracing for buildkitd gRPC API and buildctl commands. To capture the trace to &lt;a href=&#34;https://github.com/jaegertracing/jaeger&#34;&gt;Jaeger&lt;/a&gt;, set &lt;code&gt;JAEGER_TRACE&lt;/code&gt; environment variable to the collection address.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker run -d -p6831:6831/udp -p16686:16686 jaegertracing/all-in-one:latest&#xA;export JAEGER_TRACE=0.0.0.0:6831&#xA;# restart buildkitd and buildctl so they know JAEGER_TRACE&#xA;# any buildctl command should be traced to http://127.0.0.1:16686/&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Running BuildKit without root privileges&lt;/h2&gt; &#xA;&lt;p&gt;Please refer to &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/rootless.md&#34;&gt;&lt;code&gt;docs/rootless.md&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Building multi-platform images&lt;/h2&gt; &#xA;&lt;p&gt;Please refer to &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/docs/multi-platform.md&#34;&gt;&lt;code&gt;docs/multi-platform.md&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Configuring &lt;code&gt;buildctl&lt;/code&gt;&lt;/h3&gt; &#xA;&lt;h4&gt;Color Output Controls&lt;/h4&gt; &#xA;&lt;p&gt;&lt;code&gt;buildctl&lt;/code&gt; has support for modifying the colors that are used to output information to the terminal. You can set the environment variable &lt;code&gt;BUILDKIT_COLORS&lt;/code&gt; to something like &lt;code&gt;run=green:warning=yellow:error=red:cancel=255,165,0&lt;/code&gt; to set the colors that you would like to use. Setting &lt;code&gt;NO_COLOR&lt;/code&gt; to anything will disable any colorized output as recommended by &lt;a href=&#34;https://no-color.org/&#34;&gt;no-color.org&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Parsing errors will be reported but ignored. This will result in default color values being used where needed.&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://github.com/moby/buildkit/raw/master/util/progress/progressui/colors.go&#34;&gt;The list of pre-defined colors&lt;/a&gt;.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;Want to contribute to BuildKit? Awesome! You can find information about contributing to this project in the &lt;a href=&#34;https://raw.githubusercontent.com/moby/buildkit/master/.github/CONTRIBUTING.md&#34;&gt;CONTRIBUTING.md&lt;/a&gt;&lt;/p&gt;</summary>
  </entry>
</feed>