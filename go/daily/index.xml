<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Go Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2025-02-24T01:31:07Z</updated>
  <subtitle>Daily Trending of Go in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>uber/kraken</title>
    <updated>2025-02-24T01:31:07Z</updated>
    <id>tag:github.com,2025-02-24:/uber/kraken</id>
    <link href="https://github.com/uber/kraken" rel="alternate"></link>
    <summary type="html">&lt;p&gt;P2P Docker registry capable of distributing TBs of data in seconds&lt;/p&gt;&lt;hr&gt;&lt;p align=&#34;center&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/uber/kraken/master/assets/kraken-logo-color.svg?sanitize=true&#34; width=&#34;175&#34; title=&#34;Kraken Logo&#34;&gt;&lt;/p&gt; &#xA;&lt;p align=&#34;center&#34;&gt;  &lt;a href=&#34;https://travis-ci.com/uber/kraken&#34;&gt;&lt;img src=&#34;https://travis-ci.com/uber/kraken.svg?branch=master&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/uber/kraken/releases&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/release/uber/kraken.svg?sanitize=true&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://godoc.org/github.com/uber/kraken&#34;&gt;&lt;img src=&#34;https://godoc.org/github.com/uber/kraken?status.svg?sanitize=true&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://goreportcard.com/badge/github.com/uber/kraken&#34;&gt;&lt;img src=&#34;https://goreportcard.com/badge/github.com/uber/kraken&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://codecov.io/gh/uber/kraken&#34;&gt;&lt;img src=&#34;https://codecov.io/gh/uber/kraken/branch/master/graph/badge.svg?sanitize=true&#34;&gt;&lt;/a&gt; &lt;/p&gt; &#xA;&lt;p&gt;Kraken is a P2P-powered Docker registry that focuses on scalability and availability. It is designed for Docker image management, replication, and distribution in a hybrid cloud environment. With pluggable backend support, Kraken can easily integrate into existing Docker registry setups as the distribution layer.&lt;/p&gt; &#xA;&lt;p&gt;Kraken has been in production at Uber since early 2018. In our busiest cluster, Kraken distributes more than 1 million blobs per day, including 100k 1G+ blobs. At its peak production load, Kraken distributes 20K 100MB-1G blobs in under 30 sec.&lt;/p&gt; &#xA;&lt;p&gt;Below is the visualization of a small Kraken cluster at work:&lt;/p&gt; &#xA;&lt;p align=&#34;center&#34;&gt; &lt;img src=&#34;https://raw.githubusercontent.com/uber/kraken/master/assets/visualization.gif&#34; title=&#34;Visualization&#34;&gt; &lt;/p&gt; &#xA;&lt;h1&gt;Table of Contents&lt;/h1&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#features&#34;&gt;Features&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#design&#34;&gt;Design&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#architecture&#34;&gt;Architecture&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#benchmark&#34;&gt;Benchmark&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#usage&#34;&gt;Usage&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#comparison-with-other-projects&#34;&gt;Comparison With Other Projects&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#limitations&#34;&gt;Limitations&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#contributing&#34;&gt;Contributing&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/#contact&#34;&gt;Contact&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Features&lt;/h1&gt; &#xA;&lt;p&gt;Following are some highlights of Kraken:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;Highly scalable&lt;/strong&gt;. Kraken is capable of distributing Docker images at &amp;gt; 50% of max download the speed limit on every host. Cluster size and image size do not have a significant impact on download speed. &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Supports at least 15k hosts per cluster.&lt;/li&gt; &#xA;   &lt;li&gt;Supports arbitrarily large blobs/layers. We normally limit max size to 20G for the best performance.&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Highly available&lt;/strong&gt;. No component is a single point of failure.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Secure&lt;/strong&gt;. Support uploader authentication and data integrity protection through TLS.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Pluggable storage options&lt;/strong&gt;. Instead of managing data, Kraken plugs into reliable blob storage options, like S3, GCS, ECR, HDFS or another registry. The storage interface is simple and new options are easy to add.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Lossless cross-cluster replication&lt;/strong&gt;. Kraken supports rule-based async replication between clusters.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Minimal dependencies&lt;/strong&gt;. Other than pluggable storage, Kraken only has an optional dependency on DNS.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Design&lt;/h1&gt; &#xA;&lt;p&gt;The high-level idea of Kraken is to have a small number of dedicated hosts seeding content to a network of agents running on each host in the cluster.&lt;/p&gt; &#xA;&lt;p&gt;A central component, the tracker, will orchestrate all participants in the network to form a pseudo-random regular graph.&lt;/p&gt; &#xA;&lt;p&gt;Such a graph has high connectivity and a small diameter. As a result, even with only one seeder and having thousands of peers joining in the same second, all participants can reach a minimum of 80% max upload/download speed in theory (60% with current implementation), and performance doesn&#39;t degrade much as the blob size and cluster size increase. For more details, see the team&#39;s &lt;a href=&#34;https://www.youtube.com/watch?v=waVtYYSXkXU&#34;&gt;tech talk&lt;/a&gt; at KubeCon + CloudNativeCon.&lt;/p&gt; &#xA;&lt;h1&gt;Architecture&lt;/h1&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/uber/kraken/master/assets/architecture.svg?sanitize=true&#34; alt=&#34;&#34;&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Agent &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Deployed on every host&lt;/li&gt; &#xA;   &lt;li&gt;Implements Docker registry interface&lt;/li&gt; &#xA;   &lt;li&gt;Announces available content to tracker&lt;/li&gt; &#xA;   &lt;li&gt;Connects to peers returned by the tracker to download content&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Origin &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Dedicated seeders&lt;/li&gt; &#xA;   &lt;li&gt;Stores blobs as files on disk backed by pluggable storage (e.g. S3, GCS, ECR)&lt;/li&gt; &#xA;   &lt;li&gt;Forms a self-healing hash ring to distribute the load&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Tracker &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Tracks which peers have what content (both in-progress and completed)&lt;/li&gt; &#xA;   &lt;li&gt;Provides ordered lists of peers to connect to for any given blob&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Proxy &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Implements Docker registry interface&lt;/li&gt; &#xA;   &lt;li&gt;Uploads each image layer to the responsible origin (remember, origins form a hash ring)&lt;/li&gt; &#xA;   &lt;li&gt;Uploads tags to build-index&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;Build-Index &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;Mapping of the human-readable tag to blob digest&lt;/li&gt; &#xA;   &lt;li&gt;No consistency guarantees: the client should use unique tags&lt;/li&gt; &#xA;   &lt;li&gt;Powers image replication between clusters (simple duplicated queues with retry)&lt;/li&gt; &#xA;   &lt;li&gt;Stores tags as files on disk backed by pluggable storage (e.g. S3, GCS, ECR)&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Benchmark&lt;/h1&gt; &#xA;&lt;p&gt;The following data is from a test where a 3G Docker image with 2 layers is downloaded by 2600 hosts concurrently (5200 blob downloads), with 300MB/s speed limit on all agents (using 5 trackers and 5 origins):&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/uber/kraken/master/assets/benchmark.svg?sanitize=true&#34; alt=&#34;&#34;&gt;&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;p50 = 10s (at speed limit)&lt;/li&gt; &#xA; &lt;li&gt;p99 = 18s&lt;/li&gt; &#xA; &lt;li&gt;p99.9 = 22s&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Usage&lt;/h1&gt; &#xA;&lt;p&gt;All Kraken components can be deployed as Docker containers. To build the Docker images:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;$ make images&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For information about how to configure and use Kraken, please refer to the &lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/docs/CONFIGURATION.md&#34;&gt;documentation&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Kraken on Kubernetes&lt;/h2&gt; &#xA;&lt;p&gt;You can use our example Helm chart to deploy Kraken (with an example HTTP fileserver backend) on your k8s cluster:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;$ helm install --name=kraken-demo ./helm&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Once deployed, every node will have a docker registry API exposed on &lt;code&gt;localhost:30081&lt;/code&gt;. For example pod spec that pulls images from Kraken agent, see &lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/examples/k8s/demo.json&#34;&gt;example&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;For more information on k8s setup, see &lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/examples/k8s/README.md&#34;&gt;README&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Devcluster&lt;/h2&gt; &#xA;&lt;p&gt;To start a herd container (which contains origin, tracker, build-index and proxy) and two agent containers with development configuration:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;$ make devcluster&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Docker-for-Mac is required for making dev-cluster work on your laptop. For more information on devcluster, please check out devcluster &lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/examples/devcluster/README.md&#34;&gt;README&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h1&gt;Comparison With Other Projects&lt;/h1&gt; &#xA;&lt;h2&gt;Dragonfly from Alibaba&lt;/h2&gt; &#xA;&lt;p&gt;Dragonfly cluster has one or a few &#34;supernodes&#34; that coordinates the transfer of every 4MB chunk of data in the cluster.&lt;/p&gt; &#xA;&lt;p&gt;While the supernode would be able to make optimal decisions, the throughput of the whole cluster is limited by the processing power of one or a few hosts, and the performance would degrade linearly as either blob size or cluster size increases.&lt;/p&gt; &#xA;&lt;p&gt;Kraken&#39;s tracker only helps orchestrate the connection graph and leaves the negotiation of actual data transfer to individual peers, so Kraken scales better with large blobs. On top of that, Kraken is HA and supports cross-cluster replication, both are required for a reliable hybrid cloud setup.&lt;/p&gt; &#xA;&lt;h2&gt;BitTorrent&lt;/h2&gt; &#xA;&lt;p&gt;Kraken was initially built with a BitTorrent driver, however, we ended up implementing our P2P driver based on BitTorrent protocol to allow for tighter integration with storage solutions and more control over performance optimizations.&lt;/p&gt; &#xA;&lt;p&gt;Kraken&#39;s problem space is slightly different than what BitTorrent was designed for. Kraken&#39;s goal is to reduce global max download time and communication overhead in a stable environment, while BitTorrent was designed for an unpredictable and adversarial environment, so it needs to preserve more copies of scarce data and defend against malicious or bad behaving peers.&lt;/p&gt; &#xA;&lt;p&gt;Despite the differences, we re-examine Kraken&#39;s protocol from time to time, and if it&#39;s feasible, we hope to make it compatible with BitTorrent again.&lt;/p&gt; &#xA;&lt;h1&gt;Limitations&lt;/h1&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;If Docker registry throughput is not the bottleneck in your deployment workflow, switching to Kraken will not magically speed up your &lt;code&gt;docker pull&lt;/code&gt;. To speed up &lt;code&gt;docker pull&lt;/code&gt;, consider switching to &lt;a href=&#34;https://github.com/uber/makisu&#34;&gt;Makisu&lt;/a&gt; to improve layer reusability at build time, or tweak compression ratios, as &lt;code&gt;docker pull&lt;/code&gt; spends most of the time on data decompression.&lt;/li&gt; &#xA; &lt;li&gt;Mutating tags (e.g. updating a &lt;code&gt;latest&lt;/code&gt; tag) is allowed, however, a few things will not work: tag lookups immediately afterwards will still return the old value due to Nginx caching, and replication probably won&#39;t trigger. We are working on supporting this functionality better. If you need tag mutation support right now, please reduce the cache interval of the build-index component. If you also need replication in a multi-cluster setup, please consider setting up another Docker registry as Kraken&#39;s backend.&lt;/li&gt; &#xA; &lt;li&gt;Theoretically, Kraken should distribute blobs of any size without significant performance degradation, but at Uber, we enforce a 20G limit and cannot endorse the production use of ultra-large blobs (i.e. 100G+). Peers enforce connection limits on a per blob basis, and new peers might be starved for connections if no peers become seeders relatively soon. If you have ultra-large blobs you&#39;d like to distribute, we recommend breaking them into &amp;lt;10G chunks first.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Contributing&lt;/h1&gt; &#xA;&lt;p&gt;Please check out our &lt;a href=&#34;https://raw.githubusercontent.com/uber/kraken/master/docs/CONTRIBUTING.md&#34;&gt;guide&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h1&gt;Contact&lt;/h1&gt; &#xA;&lt;p&gt;To contact us, please join our &lt;a href=&#34;https://join.slack.com/t/uber-container-tools/shared_invite/enQtNTIxODAwMDEzNjM1LWIwYzIxNmUwOGY3MmVmM2MxYTczOTQ4ZDU0YjAxMTA0NDgyNzdlZTA4ZWVkZGNlMDUzZDA1ZTJiZTQ4ZDY0YTM&#34;&gt;Slack channel&lt;/a&gt;.&lt;/p&gt;</summary>
  </entry>
</feed>