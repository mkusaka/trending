<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub R Weekly Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-07-09T02:03:26Z</updated>
  <subtitle>Weekly Trending of R in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>chris-mcginnis-ucsf/DoubletFinder</title>
    <updated>2023-07-09T02:03:26Z</updated>
    <id>tag:github.com,2023-07-09:/chris-mcginnis-ucsf/DoubletFinder</id>
    <link href="https://github.com/chris-mcginnis-ucsf/DoubletFinder" rel="alternate"></link>
    <summary type="html">&lt;p&gt;R package for detecting doublets in single-cell RNA sequencing data&lt;/p&gt;&lt;hr&gt;&lt;p&gt;~~ Announcement (11/24/21) ~~ I&#39;m now a postdoc at Stanford and my UCSF email will be decommissioned soon. I also only check my github repos about once per month, so please reach out directly at cmcginni@stanford[dot]edu if you run into any issues.&lt;/p&gt; &#xA;&lt;h1&gt;DoubletFinder (code written by Chris McGinnis)&lt;/h1&gt; &#xA;&lt;p&gt;DoubletFinder is an R package that predicts doublets in single-cell RNA sequencing data.&lt;/p&gt; &#xA;&lt;p&gt;DoubletFinder is implemented to interface with Seurat &amp;gt;= 2.0 (&lt;a href=&#34;https://satijalab.org/seurat/&#34;&gt;https://satijalab.org/seurat/&lt;/a&gt;)&lt;/p&gt; &#xA;&lt;p&gt;DoubletFinder was published by Cell Systems in April, 2019: &lt;a href=&#34;https://www.cell.com/cell-systems/fulltext/S2405-4712(19)30073-0&#34;&gt;https://www.cell.com/cell-systems/fulltext/S2405-4712(19)30073-0&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Updates&lt;/h2&gt; &#xA;&lt;p&gt;(03/31/2020) Internalized functions normally in &#39;modes&#39; package to enable compatibility with R v3.6 and highger.&lt;/p&gt; &#xA;&lt;p&gt;(06/21/2019) Added parallelization to paramSweep_v3 (thanks NathanSkeen!) -- Note: progress no longer updated, but the process is much faster! Fixed bug with smaller datasets. Updated readme.&lt;/p&gt; &#xA;&lt;p&gt;(04/12/2019) Added SCTransform compatibilities to &#39;paramSweep_v3&#39; and &#39;doubletFinder_v3&#39;&lt;/p&gt; &#xA;&lt;p&gt;(04/08/2019) Added &#39;PCs&#39; argument to &#39;doubletFinder&#39;, &#39;doubletFinder_v3&#39;, &#39;paramSweep&#39;, and &#39;paramSweep_v3&#39; to avoid conflicts with dimension reduction preferences. Updated readme.&lt;/p&gt; &#xA;&lt;p&gt;(01/12/2019) Seurat V3 compatibility: &#39;doubletFinder_v3&#39; and &#39;paramSweep_v3&#39; functions added, other functions for parameter estimation remain compatible.&lt;/p&gt; &#xA;&lt;h2&gt;DoubletFinder V2.0 (11/28/2018)&lt;/h2&gt; &#xA;&lt;p&gt;New Features:&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Increased computational efficiency during pANN computation&lt;/li&gt; &#xA; &lt;li&gt;Implemented strategy for determining optimal pK values for any scRNA-seq data using pN-pK parameter sweeps and mean-variance-normalized bimodality coefficient (BCmvn)&lt;/li&gt; &#xA; &lt;li&gt;Included vignette describing &#39;best-practices&#39; for applying DoubletFinder to scRNA-seq data generated without sample multiplexing&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;Installation (in R/RStudio)&lt;/h2&gt; &#xA;&lt;p&gt;remotes::install_github(&#39;chris-mcginnis-ucsf/DoubletFinder&#39;)&lt;/p&gt; &#xA;&lt;h2&gt;Dependencies&lt;/h2&gt; &#xA;&lt;p&gt;DoubletFinder requires the following R packages:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Seurat (&amp;gt;= 2.0)&lt;/li&gt; &#xA; &lt;li&gt;Matrix (1.2.14)&lt;/li&gt; &#xA; &lt;li&gt;fields (9.6)&lt;/li&gt; &#xA; &lt;li&gt;KernSmooth (2.23-15)&lt;/li&gt; &#xA; &lt;li&gt;ROCR (1.0-7)&lt;/li&gt; &#xA; &lt;li&gt;parallel (3.5.1)&lt;/li&gt; &#xA; &lt;li&gt;NOTE: These package versions were used in the bioRxiv paper, but other versions may work, as well.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;DoubletFinder Overview&lt;/h1&gt; &#xA;&lt;p&gt;DoubletFinder can be broken up into 4 steps:&lt;/p&gt; &#xA;&lt;p&gt;(1) Generate artificial doublets from existing scRNA-seq data&lt;/p&gt; &#xA;&lt;p&gt;(2) Pre-process merged real-artificial data&lt;/p&gt; &#xA;&lt;p&gt;(3) Perform PCA and use the PC distance matrix to find each cell&#39;s proportion of artificial k nearest neighbors (pANN)&lt;/p&gt; &#xA;&lt;p&gt;(4) Rank order and threshold pANN values according to the expected number of doublets&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/DoubletFinderOverview.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;DoubletFinder takes the following arguments:&lt;/p&gt; &#xA;&lt;p&gt;seu ~ This is a fully-processed Seurat object (i.e., after NormalizeData, FindVariableGenes, ScaleData, RunPCA, and RunTSNE have all been run).&lt;/p&gt; &#xA;&lt;p&gt;PCs ~ The number of statistically-significant principal components, specified as a range (e.g., PCs = 1:10)&lt;/p&gt; &#xA;&lt;p&gt;pN ~ This defines the number of generated artificial doublets, expressed as a proportion of the merged real-artificial data. Default is set to 25%, based on observation that DoubletFinder performance is largely pN-invariant (see McGinnis, Murrow and Gartner 2019, Cell Systems).&lt;/p&gt; &#xA;&lt;p&gt;pK ~ This defines the PC neighborhood size used to compute pANN, expressed as a proportion of the merged real-artificial data. No default is set, as pK should be adjusted for each scRNA-seq dataset. Optimal pK values should be estimated using the strategy described below.&lt;/p&gt; &#xA;&lt;p&gt;nExp ~ This defines the pANN threshold used to make final doublet/singlet predictions. This value can best be estimated from cell loading densities into the 10X/Drop-Seq device, and adjusted according to the estimated proportion of homotypic doublets.&lt;/p&gt; &#xA;&lt;h2&gt;Application to Cell Hashing and Demuxlet data&lt;/h2&gt; &#xA;&lt;p&gt;DoubletFinder successfully recapitulates ground-truth doublet classifications determined using antibody-barcode sample multiplexing (Cell Hashing) and SNP deconvolution (Demuxlet). DoubletFinder identifies false-negative Demuxlet classifications caused by doublets formed from cells with identical SNP profiles. DoubletFinder is insensitive to homotypic doublets -- i.e., doublets dervied from transcriptionally-similar cell states.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/Results_Demux.png&#34; alt=&#34;alternativetext&#34;&gt; &lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/Results_Hashing.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;h1&gt;&#39;Best-Practices&#39; for scRNA-seq data generated without sample multiplexing&lt;/h1&gt; &#xA;&lt;h2&gt;Input scRNA-seq Data&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;Do not apply DoubletFinder to aggregated scRNA-seq data representing multiple &lt;em&gt;distinct&lt;/em&gt; samples (e.g., multiple 10X lanes). For example, if you run DoubletFinder on aggregated data representing WT and mutant cell lines sequenced across different 10X lanes, artificial doublets will be generated from WT and mutant cells, which cannot exist in your data. These artificial doublets will skew results. Notably, it is okay to run DoubletFinder on data generated by splitting a single sample across multiple 10X lanes.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Ensure that input data is cleared of low-quality cell clusters. There are a variety of ways to do this, but I usually use the following workflow:&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;Manually threshold raw gene expression matrices according to RNA nUMIs (especially important when dealing with super-loaded 10X data because of the way CellRanger threholds data -- See Lun et al., 2019, Genome Biology.&lt;/li&gt; &#xA; &lt;li&gt;Pre-process data using standard workflow.&lt;/li&gt; &#xA; &lt;li&gt;Identify clusters with (A) low RNA UMIs, (B) High % mitochondrial reads, and/or (C) Uninformative marker genes.&lt;/li&gt; &#xA; &lt;li&gt;Remove clusters, pre-process again, and run DoubletFinder.&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;pK Selection&lt;/h2&gt; &#xA;&lt;p&gt;ROC analysis across pN-pK parameter sweeps for Cell Hashing and Demuxlet datasets demonstrate that DoubletFinder performance is largely invariant of pN value selection:&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/ParamSweep_Schematic.png&#34; alt=&#34;alternativetext&#34;&gt; &lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/ParamSweep_HeatMap.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;ROC analysis across pN-pK parameter sweeps for simulated scRNA-seq data with (I) Variable numbers of cell states and (II) Variable magnitudes of transcriptional heterogeneity demonstrates that (I) Optimal pK value selection depends on the total number of cell states and (II) DoubletFinder performance suffers when applied to transcriptionally-homogenous data. Simulated data was generated using a strategy similar to as described in Wolock, Lopex &amp;amp; Klein 2019, Cell Systems.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/Simulation_Schematic.png&#34; alt=&#34;alternativetext&#34;&gt; &lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/Results_Simulation.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;Simulated and sample-multiplexed data are unique in that ground-truth doublet classifications can be leveraged to characterize how DoubletFinder parameters must be &#39;fit&#39; to distinct scRNA-seq datasets. However, doublets remain unknown in real-world contexts -- which is likely why you are interested in DoubletFinder, at all!&lt;/p&gt; &#xA;&lt;p&gt;To maximize the accuracy of DoubletFinder predictions, we sought a ground-truth-agnostic metric that coincides with pK values that maximize AUC in Cell Hashing and Demuxlet data. Mean-variance normalized bimodality coefficient (BCmvn) achieves this goal, featuring a single, easily-discernible maximum at pK values that optimize AUC.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/BCmvn.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;BCmvn distributions also feature a single maximum for scRNA-seq datasets generated without sample-multiplexing (e.g., Mouse pancreas, Byrnes et al., 2018, Nature Communcations; Mouse kidney, Park et al., 2018, Science), enabling pK selection.&lt;/p&gt; &#xA;&lt;h2&gt;Doublet Number Estimation&lt;/h2&gt; &#xA;&lt;p&gt;DoubletFinder is sensitive to heterotypic doublets -- i.e., doublets formed from transcriptionally-distinct cell states -- but is insensitive to homotypic doublets -- i.e., doublets formed from transcriptionally-similar cell states. In our original manuscript, we suggested using DoubletFinder to predict the number of doublets expected from Poisson statistical estimates realting to the droplet microfluidics cell loading density. However, Poisson estimates are agnostic of homotypic doublets, and will thus invariably overestimate the number of &lt;em&gt;detectable&lt;/em&gt; doublets.&lt;/p&gt; &#xA;&lt;p&gt;To address this issue, we suggest users utilize literature-supported cell type annotations to model the proportion of homotypic doublets present in their data. As an example, we present an analysis of mouse kidney scRNA-seq data (Park et al., 2018, Science):&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/HomotypicAdjustment.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;Notably, it is conceivable that literature-suppoted cell type annotations may not accurately recapitulate the magnitude of transcriptional divergence necessary for DoubletFinder sensitivity. For example, nominally-homogenous cells (e.g., CD4+ T-cells) may exist along a spectrum of gene expression states (e.g., distinct anatomical locations, disease states, naive/Tregs/Th17 cells, etc.), and doublets formed by cell sub-types may be detectable by DoubletFinder. Thus, we consider doublet number estimates based on Poisson statistics with and without homotypic doublet proportion adjustment to &#39;bookend&#39; the real detectable doublet rate.&lt;/p&gt; &#xA;&lt;h2&gt;Example code for &#39;real-world&#39; applications&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;## Pre-process Seurat object (standard) --------------------------------------------------------------------------------------&#xA;seu_kidney &amp;lt;- CreateSeuratObject(kidney.data)&#xA;seu_kidney &amp;lt;- NormalizeData(seu_kidney)&#xA;seu_kidney &amp;lt;- FindVariableFeatures(seu_kidney, selection.method = &#34;vst&#34;, nfeatures = 2000)&#xA;seu_kidney &amp;lt;- ScaleData(seu_kidney)&#xA;seu_kidney &amp;lt;- RunPCA(seu_kidney)&#xA;seu_kidney &amp;lt;- RunUMAP(seu_kidney, dims = 1:10)&#xA;&#xA;## Pre-process Seurat object (sctransform) -----------------------------------------------------------------------------------&#xA;seu_kidney &amp;lt;- CreateSeuratObject(kidney.data)&#xA;seu_kidney &amp;lt;- SCTransform(seu_kidney)&#xA;seu_kidney &amp;lt;- RunPCA(seu_kidney)&#xA;seu_kidney &amp;lt;- RunUMAP(seu_kidney, dims = 1:10)&#xA;&#xA;## pK Identification (no ground-truth) ---------------------------------------------------------------------------------------&#xA;sweep.res.list_kidney &amp;lt;- paramSweep_v3(seu_kidney, PCs = 1:10, sct = FALSE)&#xA;sweep.stats_kidney &amp;lt;- summarizeSweep(sweep.res.list_kidney, GT = FALSE)&#xA;bcmvn_kidney &amp;lt;- find.pK(sweep.stats_kidney)&#xA;&#xA;## pK Identification (ground-truth) ------------------------------------------------------------------------------------------&#xA;sweep.res.list_kidney &amp;lt;- paramSweep_v3(seu_kidney, PCs = 1:10, sct = FALSE)&#xA;gt.calls &amp;lt;- seu_kidney@meta.data[rownames(sweep.res.list_kidney[[1]]), &#34;GT&#34;].   ## GT is a vector containing &#34;Singlet&#34; and &#34;Doublet&#34; calls recorded using sample multiplexing classification and/or in silico geneotyping results &#xA;sweep.stats_kidney &amp;lt;- summarizeSweep(sweep.res.list_kidney, GT = TRUE, GT.calls = gt.calls)&#xA;bcmvn_kidney &amp;lt;- find.pK(sweep.stats_kidney)&#xA;&#xA;## Homotypic Doublet Proportion Estimate -------------------------------------------------------------------------------------&#xA;homotypic.prop &amp;lt;- modelHomotypic(annotations)           ## ex: annotations &amp;lt;- seu_kidney@meta.data$ClusteringResults&#xA;nExp_poi &amp;lt;- round(0.075*nrow(seu_kidney@meta.data))  ## Assuming 7.5% doublet formation rate - tailor for your dataset&#xA;nExp_poi.adj &amp;lt;- round(nExp_poi*(1-homotypic.prop))&#xA;&#xA;## Run DoubletFinder with varying classification stringencies ----------------------------------------------------------------&#xA;seu_kidney &amp;lt;- doubletFinder_v3(seu_kidney, PCs = 1:10, pN = 0.25, pK = 0.09, nExp = nExp_poi, reuse.pANN = FALSE, sct = FALSE)&#xA;seu_kidney &amp;lt;- doubletFinder_v3(seu_kidney, PCs = 1:10, pN = 0.25, pK = 0.09, nExp = nExp_poi.adj, reuse.pANN = &#34;pANN_0.25_0.09_913&#34;, sct = FALSE)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/chris-mcginnis-ucsf/DoubletFinder/master/DF.screenshots/DFkidney_low.vs.high.png&#34; alt=&#34;alternativetext&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Other Doublet Detection Methods&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/AllonKleinLab/scrublet&#34;&gt;Scrublet&lt;/a&gt; &lt;a href=&#34;https://github.com/EDePasquale/DoubletDecon&#34;&gt;DoubletDecon&lt;/a&gt; &lt;a href=&#34;https://github.com/JonathanShor/DoubletDetection&#34;&gt;DoubletDetection&lt;/a&gt; &lt;a href=&#34;https://github.com/calico/solo&#34;&gt;Solo&lt;/a&gt; &lt;a href=&#34;https://github.com/kostkalab/scds&#34;&gt;scds&lt;/a&gt; &lt;a href=&#34;https://github.com/plger/scDblFinder&#34;&gt;scDblFinder&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;References&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;Stoeckius M, Zheng S, Houck-Loomis B, Hao S, Yeung BZ, Smibert P, Satija R. Cell Hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics. Genome Biology. 2018. 19:224.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Kang HM, Subramaniam M, Targ S, Nguyen M, Maliskova L, McCarthy E, Wan E, Wong S, Byrnes L, Lanata CM, Gate RE, Mostafavi S, Marson A, Zaitlen N, Criswell LA, Ye JC. Multiplexed droplet single-cell RNA-sequencing using natural genetic variation. Nature Biotechnology. 2018. 36(1):89-94.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Wolock SL, Lopez R, Klein AM. Scrublet: Computational Identification of Cell Doublets in Single-Cell Transcriptomic Data. Cell Systems. 2019. 8(4):281-291.e9.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Park J, Shrestha R, Qiu C, Kondo A, Huang S, Werth M, Li M, Barasch J, Suszták K. Single-cell transcriptomics of the mouse kidney reveals potential cellular targets of kidney disease. Science. 2018. 360(6390):758-63.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Byrnes LE, Wong DM, Subramaniam M, Meyer NP, Gilchrist CL, Knox SM, Tward AD, Ye CJ, Sneddon JB. Lineage dynamics of murine pancreatic development at single-cell resolution. Nature Communications. 2018; 9:3922.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Bais AS, Kostka D. scds: computational annotation of doublets in single-cell RNA sequencing data. Bioinformatics. 2020. 36(4):1150-8.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Bernstein NJ, Fong NL, Lam I, Roy MA, Hendrickson DG, Kelley DR. Solo: Doublet Identification in Single-Cell RNA-Seq via Semi-Supervised Deep Learning. Cell Systems. 2020. S2405-4712(20)30195-2.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;DePasquale EAK, Schnell DJ, Van Camp PJ, Valiente-Alandi I, Blaxall BC, Grimes HL, Singh H, Salomonis N. DoubletDecon: Deconvoluting Doublets from Single-Cell RNA-Sequencing Data. Cell Reports. 2019. 29(6):1718-27.e8.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt;</summary>
  </entry>
  <entry>
    <title>finddx/findBiobankR</title>
    <updated>2023-07-09T02:03:26Z</updated>
    <id>tag:github.com,2023-07-09:/finddx/findBiobankR</id>
    <link href="https://github.com/finddx/findBiobankR" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;findBiobankR&lt;/h1&gt; &#xA;&lt;!-- badges: start --&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/finddx/findBiobankR/actions/workflows/R-CMD-check.yaml&#34;&gt;&lt;img src=&#34;https://github.com/finddx/findBiobankR/actions/workflows/R-CMD-check.yaml/badge.svg?sanitize=true&#34; alt=&#34;R-CMD-check&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;!-- badges: end --&gt; &#xA;&lt;p&gt;findBiobankR package is a collection of functions used by FindDx Biobank&lt;/p&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;You can install the development version of findBiobankR from &lt;a href=&#34;https://github.com/&#34;&gt;GitHub&lt;/a&gt; with:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;&#xA;# install.packages(&#34;devtools&#34;)&#xA;devtools::install_github(&#34;finddx/findBiobankR&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Convert Open Specimen Data to wide for Selection&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;The function below is used to prepare clinical and specimen data sets for sample selections&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(findBiobankR)&#xA;library(dplyr)&#xA;#&amp;gt; &#xA;#&amp;gt; Attaching package: &#39;dplyr&#39;&#xA;#&amp;gt; The following objects are masked from &#39;package:stats&#39;:&#xA;#&amp;gt; &#xA;#&amp;gt;     filter, lag&#xA;#&amp;gt; The following objects are masked from &#39;package:base&#39;:&#xA;#&amp;gt; &#xA;#&amp;gt;     intersect, setdiff, setequal, union&#xA;library(data.table)&#xA;#&amp;gt; &#xA;#&amp;gt; Attaching package: &#39;data.table&#39;&#xA;#&amp;gt; The following objects are masked from &#39;package:dplyr&#39;:&#xA;#&amp;gt; &#xA;#&amp;gt;     between, first, last&#xA;&#xA;data(&#34;tb_data&#34;, package = &#34;findBiobankR&#34;)&#xA;data(&#34;tb_specimen_df&#34;, package = &#34;findBiobankR&#34;)&#xA;&#xA;# required clinical cols&#xA;clinical_cols &amp;lt;- c(&#34;tb_group&#34;, &#34;hiv_status&#34;, &#34;sex&#34;, &#34;country&#34;) &#xA;&#xA;clin_specs  &amp;lt;- convert_os_df_to_wide(clinical_df = tb_data,&#xA;                                     specimen_df = tb_specimen_df, &#xA;                                     join_by_col = &#34;ppid&#34;,&#xA;                                     specimen_col =&#34;specimen_type&#34; ,&#xA;                                     clinical_vars = clinical_cols ,&#xA;                                     specimen_label_col = &#34;specimen_label&#34;,&#xA;                                     os_aliquot_names = c(&#34;Serum&#34;, &#34;Plasma&#34;)&#xA;)&#xA;&#xA;knitr::kable(clin_specs[1:5, ])&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;ppid&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;tb_group&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;hiv_status&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;sex&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;country&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;NP_aliqN_serum&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;NP_labels_serum&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;NP_aliqN_plasma&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;NP_labels_plasma&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Unkown&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001, TB0990100010101002, TB0990100010101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010103001, TB0990100010103002, TB0990100010103003&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010002&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV-&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001, TB0990100020101002, TB0990100020101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020103001, TB0990100020103002, TB0990100020103003&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Pos&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV-&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101001, TB0990100030101002, TB0990100030101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030103001, TB0990100030103002, TB0990100030103003&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010004&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV+&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101001, TB0990100040101002, TB0990100040101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040103001, TB0990100040103002, TB0990100040103003&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010005&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Pos&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV+&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Female&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101001, TB0990100050101002, TB0990100050101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050103001, TB0990100050103002, TB0990100050103003&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h2&gt;Select Specimen&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Using the data set above select aliquot&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;##&#xA;samples_list &amp;lt;- list(c(&#34;TB0990100010101001&#34;, &#34;TB0990100010101002&#34;, &#34;TB0990100010101003&#34;),&#xA;                     c(&#34;TB0990100020101001&#34;, &#34;TB0990100020101002&#34;, &#34;TB0990100020101003&#34;), &#xA;                     c(&#34;TB0990100030101001&#34;, &#34;TB0990100030101002&#34;, &#34;TB0990100030101003&#34;),&#xA;                     c(&#34;TB0990100040101001&#34;, &#34;TB0990100040101002&#34;, &#34;TB0990100040101003&#34;),&#xA;                     c(&#34;TB0990100050101001&#34;, &#34;TB0990100050101002&#34;, &#34;TB0990100050101003&#34;&#xA;                     ))&#xA;# here aliquot number means index or position of the aliquot &#xA;select_one_aliquot(samples_list,&#xA;                   aliquot_number = 1)&#xA;#&amp;gt; [1] &#34;TB0990100010101001&#34; &#34;TB0990100020101001&#34; &#34;TB0990100030101001&#34;&#xA;#&amp;gt; [4] &#34;TB0990100040101001&#34; &#34;TB0990100050101001&#34;&#xA;&#xA;# You can use the data table method to already append this to the data set&#xA;clin_specs[, serum_aliquot_dt := select_one_aliquot(NP_labels_serum)]&#xA;# or tidyverse way&#xA;clin_specs &amp;lt;- clin_specs %&amp;gt;%&#xA;  mutate(serum_aliquot_dp = select_one_aliquot(NP_labels_serum))&#xA;&#xA;knitr::kable(clin_specs[1:5, ])&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;ppid&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;tb_group&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;hiv_status&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;sex&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;country&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;NP_aliqN_serum&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;NP_labels_serum&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;NP_aliqN_plasma&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;NP_labels_plasma&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;serum_aliquot_dt&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;serum_aliquot_dp&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Unkown&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001, TB0990100010101002, TB0990100010101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010103001, TB0990100010103002, TB0990100010103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010002&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV-&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001, TB0990100020101002, TB0990100020101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020103001, TB0990100020103002, TB0990100020103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Pos&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV-&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101001, TB0990100030101002, TB0990100030101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030103001, TB0990100030103002, TB0990100030103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101001&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010004&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV+&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101001, TB0990100040101002, TB0990100040101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040103001, TB0990100040103002, TB0990100040103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101001&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010005&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Pos&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV+&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Female&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101001, TB0990100050101002, TB0990100050101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050103001, TB0990100050103002, TB0990100050103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101001&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;h2&gt;Select many aliquots at once&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Let’s say a requester wants 2 aliquots per patient. Using the above function it’s not convenient&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;##&#xA;clin_specs  &amp;lt;- convert_os_df_to_wide(clinical_df = tb_data,&#xA;                                     specimen_df = tb_specimen_df, &#xA;                                     join_by_col = &#34;ppid&#34;,&#xA;                                     specimen_col =&#34;specimen_type&#34; ,&#xA;                                     clinical_vars = clinical_cols ,&#xA;                                     specimen_label_col = &#34;specimen_label&#34;,&#xA;                                     os_aliquot_names = c(&#34;Serum&#34;, &#34;Plasma&#34;)&#xA;)&#xA;# here aliquots stands for number of samples per patient&#xA;# so this will select firts and second specimen for each participants&#xA;select_many_aliquots(samples_list,&#xA;                   aliquots = 2)&#xA;#&amp;gt; $aliquots1&#xA;#&amp;gt; [1] &#34;TB0990100010101001&#34; &#34;TB0990100020101001&#34; &#34;TB0990100030101001&#34;&#xA;#&amp;gt; [4] &#34;TB0990100040101001&#34; &#34;TB0990100050101001&#34;&#xA;#&amp;gt; &#xA;#&amp;gt; $aliquots2&#xA;#&amp;gt; [1] &#34;TB0990100010101002&#34; &#34;TB0990100020101002&#34; &#34;TB0990100030101002&#34;&#xA;#&amp;gt; [4] &#34;TB0990100040101002&#34; &#34;TB0990100050101002&#34;&#xA;&#xA;# You can use the data table method to already append this to the data set&#xA;col_nms &amp;lt;- paste0(&#34;aliquot&#34;, 1:2, &#34;_dt&#34;)&#xA;clin_specs[, (col_nms ) := select_many_aliquots(NP_labels_serum, &#xA;                                                aliquots = 2)]&#xA;&#xA;knitr::kable(head(clin_specs, 5))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;ppid&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;tb_group&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;hiv_status&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;sex&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;country&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;NP_aliqN_serum&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;NP_labels_serum&lt;/th&gt; &#xA;   &lt;th align=&#34;right&#34;&gt;NP_aliqN_plasma&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;NP_labels_plasma&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;aliquot1_dt&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;aliquot2_dt&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Unkown&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001, TB0990100010101002, TB0990100010101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010103001, TB0990100010103002, TB0990100010103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010002&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV-&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001, TB0990100020101002, TB0990100020101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020103001, TB0990100020103002, TB0990100020103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Pos&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV-&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101001, TB0990100030101002, TB0990100030101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030103001, TB0990100030103002, TB0990100030103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100030101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010004&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Neg&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV+&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Male&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101001, TB0990100040101002, TB0990100040101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040103001, TB0990100040103002, TB0990100040103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100040101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB099010005&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB, Pos&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;HIV+&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Female&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;Peru&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101001, TB0990100050101002, TB0990100050101003&lt;/td&gt; &#xA;   &lt;td align=&#34;right&#34;&gt;3&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050103001, TB0990100050103002, TB0990100050103003&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100050101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# unfortunately no easy for now tidyverse implementation but trying this below could work&#xA;&#xA;df &amp;lt;- select_many_aliquots(clin_specs$NP_labels_serum, aliquots = 2) %&amp;gt;% &#xA;  as.data.frame()&#xA;# You can then bind cols to the original data&#xA;knitr::kable(head(df, 2))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;aliquots1&lt;/th&gt; &#xA;   &lt;th align=&#34;left&#34;&gt;aliquots2&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100010101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101001&lt;/td&gt; &#xA;   &lt;td align=&#34;left&#34;&gt;TB0990100020101002&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt;</summary>
  </entry>
  <entry>
    <title>MRCIEU/mrc_uganda_hackathon_202306_group4</title>
    <updated>2023-07-09T02:03:26Z</updated>
    <id>tag:github.com,2023-07-09:/MRCIEU/mrc_uganda_hackathon_202306_group4</id>
    <link href="https://github.com/MRCIEU/mrc_uganda_hackathon_202306_group4" rel="alternate"></link>
    <summary type="html">&lt;p&gt;MRC Uganda MR short course Hackathon Project Group 4&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Group 4&#39;s MRC Uganda Hackathon&lt;/h1&gt; &#xA;&lt;h2&gt;Date: June 2023&lt;/h2&gt;</summary>
  </entry>
</feed>