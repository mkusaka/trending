<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub R Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-05-25T01:42:38Z</updated>
  <subtitle>Daily Trending of R in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>looker-open-source/lookr</title>
    <updated>2023-05-25T01:42:38Z</updated>
    <id>tag:github.com,2023-05-25:/looker-open-source/lookr</id>
    <link href="https://github.com/looker-open-source/lookr" rel="alternate"></link>
    <summary type="html">&lt;p&gt;An R library for the Looker API (4.0)&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/looker-open-source/lookr/actions&#34;&gt;&lt;img src=&#34;https://github.com/looker-open-source/lookr/workflows/R-CMD-check/badge.svg?sanitize=true&#34; alt=&#34;R-CMD-check&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;!-- badges: end --&gt; &#xA;&lt;h1&gt;LookR&lt;/h1&gt; &#xA;&lt;p&gt;This is an SDK for using the Looker API with the R programming language. Our priority is to add support for the endpoints that are most useful to data scientists and analysts working in R (the ones that get data from Looker) but eventually the goal is to add support for every endpoint in the Looker API.&lt;/p&gt; &#xA;&lt;p&gt;For more information about the Looker API’s capabilities and for details about what each endpoint does, see the &lt;a href=&#34;https://docs.looker.com/reference/api-and-integration/api-reference&#34;&gt;Looker API reference documentation&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Important!&lt;/h2&gt; &#xA;&lt;p&gt;&lt;em&gt;LookR used to be based on &lt;a href=&#34;https://cran.r-project.org/package=rJava&#34;&gt;&lt;code&gt;rJava&lt;/code&gt;&lt;/a&gt;, but this caused problems with reliability and many users struggled to get it to work. To fix this, we’ve rewritten a new SDK in native R. The versions have been reset as well.&lt;/em&gt;&lt;/p&gt; &#xA;&lt;p&gt;All of the old code is available on the old-lookr branch, so if you want to continue using it, you an install from that branch by setting* &lt;code&gt;ref&lt;/code&gt; &lt;em&gt;to&lt;/em&gt; &lt;code&gt;old-lookr&lt;/code&gt;*:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;devtools::install_github(&#34;looker/lookr&#34;, ref = &#34;old-lookr&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;em&gt;The code recently changed to support API 4.0 instead of 3.0. There still is not a robust testing mechanism in place. If you need to use the older version install it from the &lt;code&gt;api-3.0&lt;/code&gt; branch.&lt;/em&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;devtools::install_github(&#34;looker/lookr&#34;, ref = &#34;api-3.0&#34;)&#xA;# or&#xA;devtools::install_github(&#34;looker/lookr&#34;, ref = &#34;api-3.1&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Install&lt;/h2&gt; &#xA;&lt;p&gt;Use &lt;code&gt;devtools&lt;/code&gt; to install from this repository:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;devtools::install_github(&#34;looker/lookr&#34;, ref = &#34;api-4.0&#34;)&#xA;library(lookr)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Configure&lt;/h2&gt; &#xA;&lt;p&gt;First, make sure that you have your API credentials and the URL to your Looker host in a file called &lt;code&gt;looker.ini&lt;/code&gt;. LookR uses the information in this file to authenticate. See below for a sample of what &lt;code&gt;looker.ini&lt;/code&gt; should look like:&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;looker-sample.ini&lt;/code&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;[Looker]&#xA;# API version is required&#xA;api_version=4.0&#xA;# Base URL for API. Do not include /api/* in the url&#xA;base_url=https://&amp;lt;your-looker-endpoint&amp;gt;:19999&#xA;# API 3 client id&#xA;client_id=your_API3_client_id&#xA;# API 3 client secret&#xA;client_secret=your_API3_client_secret&#xA;# Optional embed secret for SSO embedding&#xA;embed_secret=your_embed_SSO_secret&#xA;# Optional user_id to impersonate&#xA;user_id=&#xA;# Set to false if testing locally against self-signed certs. Otherwise leave True&#xA;verify_ssl=True&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;em&gt;Make sure that this file is not checked into version control.&lt;/em&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Connect&lt;/h2&gt; &#xA;&lt;p&gt;All of the endpoints are accessed from methods contained in an instance of the &lt;code&gt;LookerSDK&lt;/code&gt; class, which is implemented in &lt;a href=&#34;https://cran.r-project.org/web/packages/R6/index.html&#34;&gt;&lt;code&gt;R6&lt;/code&gt;&lt;/a&gt;. To start using LookR, create an instance of that class:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;sdk &amp;lt;- LookerSDK$new(configFile = &#34;looker.ini&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you’re using a version of RStudio that includes the &lt;a href=&#34;https://support.rstudio.com/hc/en-us/articles/115010915687-Using-RStudio-Connections&#34;&gt;Connections Pane&lt;/a&gt;, you can also use that to create a new connection to Looker.&lt;/p&gt; &#xA;&lt;p&gt;Whether you use the Connection Pane to create the connection or not, you will be able to browse your projects, models, and explores in the Connections Pane as long as your API user has access to them.&lt;/p&gt; &#xA;&lt;h2&gt;Query&lt;/h2&gt; &#xA;&lt;p&gt;You can use LookR to fetch the results of a saved Look by calling &lt;code&gt;runLook&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data &amp;lt;- sdk$runLook(lookId = 1337)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You can also use a new query by calling &lt;code&gt;runInlineQuery&lt;/code&gt;. &lt;code&gt;model&lt;/code&gt;, &lt;code&gt;view&lt;/code&gt;, and &lt;code&gt;fields&lt;/code&gt; are mandatory arguments:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data &amp;lt;- sdk$runInlineQuery(model = &#34;model_name&#34;,&#xA;                           view = &#34;my_awesome_explore&#34;,&#xA;                           fields = c(&#34;id&#34;, &#34;count&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;and you can optionally supply &lt;code&gt;filters&lt;/code&gt;, &lt;code&gt;sorts&lt;/code&gt;, &lt;code&gt;limit&lt;/code&gt;, and &lt;code&gt;queryTimezone&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data &amp;lt;- sdk$runInlineQuery(model = &#34;model_name&#34;,&#xA;                           view = &#34;my_awesome_explore&#34;,&#xA;                           fields = c(&#34;id&#34;, &#34;count&#34;),&#xA;                           filters = list(field.name = jsonutil::unbox(&#34;filter_expression&#34;),&#xA;                                       another.field = jsonutil::unbox(&#34;filter_expression&#34;)),&#xA;                           limit = 500,&#xA;                           queryTimezone = &#34;America/Los_Angeles&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The SDK returns data as a list of lists. The inner list has named elements for one row of data. The outer list is the collection of rows. R most naturally wants to work with columns of data. The following process will reformat the data in a useful way…&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;sdk &amp;lt;- lookr::LookerSDK$new(configFile = &#34;looker.ini&#34;)&#xA;&#xA;# run a look or inline query&#xA;data &amp;lt;- sdk$runLook(lookId = 5 )&#xA;&#xA;# Verify that at least one row was returned&#xA;length(data)&#xA;[1] 5&#xA;&#xA;# get the column names from the first row&#xA;names(data[[1]])&#xA;[1] &#34;customer.first_name&#34; &#34;order.count&#34;&#xA;&#xA;# create a new list that represents each column&#xA;fname = sapply(data, &#34;[[&#34;, 1)&#xA;ocount = sapply(data, &#34;[[&#34;, 2)&#xA;&#xA;# create a data.frame object with the columns&#xA;# the list names will become the default column names&#xA;df &amp;lt;- data.frame(fname, ocount)&#xA;print(df)&#xA;     fname ocount&#xA;1    Homer      5&#xA;2     Bart      4&#xA;3   Robert      3&#xA;4  Bernard      2&#xA;5 Milhouse      1&#xA;&#xA;# If a column can have a NULL value, use I(...) to wrap the column list&#xA;ocount = list(5,4,NULL,2,1)&#xA;df &amp;lt;- data.frame(fname, I(ocount))&#xA;print(df)&#xA;     fname ocount&#xA;1    Homer      5&#xA;2     Bart      4&#xA;3   Robert&#xA;4  Bernard      2&#xA;5 Milhouse      1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Other Operations&lt;/h2&gt; &#xA;&lt;p&gt;The SDK exposes a number of the most frequently used and useful operations But the whole API is available through underlying methods. For example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;sdk$refresh()&#xA;data &amp;lt;- sdk$userSession$lookApi$look(6, config = sdk$oauthHeader)$content&#xA;print(data)&#xA;&amp;lt;LookWithQuery&amp;gt;&#xA;  Public:&#xA;    ...&#xA;    folder_id: 5&#xA;    fromJSON: function (LookWithQueryJson)&#xA;    fromJSONObject: function (LookWithQueryJsonObject)&#xA;    fromJSONString: function (LookWithQueryJson)&#xA;    ...&#xA;    id: 6&#xA;    ...&#xA;    model: LookModel, R6&#xA;    public: NULL&#xA;    public_slug: 2ytjPWrQrbxSHHZxGSYXXhgsF7Pjj6Wy&#xA;    ...&#xA;    query: Query, R6&#xA;    query_id: 124&#xA;    short_url: /looks/6&#xA;    space: SpaceBase, R6&#xA;    space_id: 5&#xA;    title: Simple Look&#xA;    ...&#xA;    user_id: 1&#xA;    view_count: 1&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The &lt;code&gt;sdk$refresh()&lt;/code&gt; call checks if the session is still authenticated and logs in again if needed.&lt;/p&gt; &#xA;&lt;p&gt;The &lt;code&gt;sdk&lt;/code&gt; object has a &lt;code&gt;userSession&lt;/code&gt; attribute. The &lt;code&gt;userSession&lt;/code&gt; has references to subsections of the API. For example, the &lt;code&gt;lookApi&lt;/code&gt; has the operations that deal with Looks. The &lt;code&gt;look&lt;/code&gt; operation gets a Look by id.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;config = sdk$oauthHeader&lt;/code&gt; has to be the &lt;strong&gt;last&lt;/strong&gt; parameter sent to any of these calls. That contains the token that needs to be sent to validate your authorization.&lt;/p&gt; &#xA;&lt;p&gt;These calls return a &lt;code&gt;responseObject&lt;/code&gt; with two attributes. &lt;code&gt;responseObject$response&lt;/code&gt; is the http response codes. Check the value of &lt;code&gt;httr::status_code(responseObject$response)&lt;/code&gt; for &lt;code&gt;200&lt;/code&gt; to verify success. The &lt;code&gt;responseObject$content&lt;/code&gt; is the data that is actually returned, assuming everything worked properly, or an error message.&lt;/p&gt; &#xA;&lt;p&gt;Currently the &lt;code&gt;UserSession&lt;/code&gt; supports several but not all the API objects.&lt;/p&gt; &#xA;&lt;p&gt;R has tab completion to help explore these:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;sdk$userSession$&amp;lt;TAB&amp;gt;&#xA;sdk$userSession$.__enclos_env__    sdk$userSession$lookmlModelApi     sdk$userSession$clientConfig       sdk$userSession$activeToken&#xA;sdk$userSession$oauthHeader        sdk$userSession$userApi            sdk$userSession$settings           sdk$userSession$me&#xA;sdk$userSession$userToken          sdk$userSession$dashboardApi       sdk$userSession$clone              sdk$userSession$isAuthenticated&#xA;sdk$userSession$token              sdk$userSession$queryApi           sdk$userSession$logout             sdk$userSession$loginUser&#xA;sdk$userSession$tokenExpiresAt     sdk$userSession$lookApi            sdk$userSession$impersonating      sdk$userSession$login&#xA;sdk$userSession$userId             sdk$userSession$authClient         sdk$userSession$setAuthExpiration  sdk$userSession$reset&#xA;sdk$userSession$projectApi         sdk$userSession$apiClient          sdk$userSession$assignApiClient    sdk$userSession$initialize&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;We can see that &lt;code&gt;UserSession&lt;/code&gt; has references to the &lt;code&gt;projectApi&lt;/code&gt;, &lt;code&gt;userApi&lt;/code&gt;, &lt;code&gt;queryApi&lt;/code&gt;, &lt;code&gt;dashboardApi&lt;/code&gt;, and &lt;code&gt;lookApi&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;If we want to access an Api that isn’t readily available, we can do it like this:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;workspaceApi &amp;lt;- lookr::WorkspaceApi$new(sdk$userSession$apiClient)&#xA;workspaceApi$ &amp;lt;TAB&amp;gt;&#xA;workspaceApi$.__enclos_env__  workspaceApi$userAgent        workspaceApi$workspace        workspaceApi$initialize&#xA;workspaceApi$apiClient        workspaceApi$clone            workspaceApi$all_workspaces&#xA;data = workspaceApi$all_workspaces(config = sdk$oauthHeader)$content&#xA;print(data)&#xA;[[1]]&#xA;&amp;lt;Workspace&amp;gt;&#xA;  Public:&#xA;    can: list&#xA;    clone: function (deep = FALSE)&#xA;    fromJSON: function (WorkspaceJson)&#xA;    fromJSONObject: function (WorkspaceJsonObject)&#xA;    fromJSONString: function (WorkspaceJson)&#xA;    id: production&#xA;    initialize: function (can, id, projects)&#xA;    projects: list&#xA;    toJSON: function ()&#xA;    toJSONString: function ()&#xA;&#xA;[[2]]&#xA;&amp;lt;Workspace&amp;gt;&#xA;  Public:&#xA;    can: list&#xA;    clone: function (deep = FALSE)&#xA;    fromJSON: function (WorkspaceJson)&#xA;    fromJSONObject: function (WorkspaceJsonObject)&#xA;    fromJSONString: function (WorkspaceJson)&#xA;    id: dev&#xA;    initialize: function (can, id, projects)&#xA;    projects: list&#xA;    toJSON: function ()&#xA;    toJSONString: function ()&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>