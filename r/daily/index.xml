<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub R Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-10-26T01:33:42Z</updated>
  <subtitle>Daily Trending of R in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>const-ae/ggupset</title>
    <updated>2024-10-26T01:33:42Z</updated>
    <id>tag:github.com,2024-10-26:/const-ae/ggupset</id>
    <link href="https://github.com/const-ae/ggupset" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Combination matrix axis for &#39;ggplot2&#39; to create &#39;UpSet&#39; plots&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;ggupset&lt;/h1&gt; &#xA;&lt;p&gt;Plot a combination matrix instead of the standard x-axis and create UpSet plots with ggplot2.&lt;/p&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-violinexample-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;You can install the released version of ggupset from &lt;a href=&#34;https://cran.r-project.org/package=ggupset&#34;&gt;CRAN&lt;/a&gt; with:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Download package from CRAN&#xA;install.packages(&#34;ggupset&#34;)&#xA;&#xA;# Or get the latest version directly from GitHub&#xA;devtools::install_github(&#34;const-ae/ggupset&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Example&lt;/h2&gt; &#xA;&lt;p&gt;This is a basic example which shows you how to solve a common problem:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Load helper packages&#xA;library(ggplot2)&#xA;library(tidyverse, warn.conflicts = FALSE)&#xA;#&amp;gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──&#xA;#&amp;gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5&#xA;#&amp;gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1&#xA;#&amp;gt; ✔ lubridate 1.9.3     ✔ tibble    3.2.1&#xA;#&amp;gt; ✔ purrr     1.0.2     ✔ tidyr     1.3.1&#xA;#&amp;gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──&#xA;#&amp;gt; ✖ dplyr::filter() masks stats::filter()&#xA;#&amp;gt; ✖ dplyr::lag()    masks stats::lag()&#xA;#&amp;gt; ℹ Use the conflicted package (&amp;lt;http://conflicted.r-lib.org/&amp;gt;) to force all conflicts to become errors&#xA;&#xA;# Load my package&#xA;library(ggupset)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In the following I will work with a tidy version of the movies dataset from ggplot. It contains a list of all movies in IMDB, their release data and other general information on the movie. It also includes a &lt;code&gt;list&lt;/code&gt; column that contains annotation to which genre a movie belongs (Action, Drama, Romance etc.)&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies&#xA;#&amp;gt; # A tibble: 50,000 × 10&#xA;#&amp;gt;    title       year length budget rating votes mpaa  Genres stars percent_rating&#xA;#&amp;gt;    &amp;lt;chr&amp;gt;      &amp;lt;int&amp;gt;  &amp;lt;int&amp;gt;  &amp;lt;int&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;list&amp;gt; &amp;lt;dbl&amp;gt;          &amp;lt;dbl&amp;gt;&#xA;#&amp;gt;  1 Ei ist ei…  1993     90   NA      8.4    15 &#34;&#34;    &amp;lt;chr&amp;gt;      1            4.5&#xA;#&amp;gt;  2 Hamos sto…  1985    109   NA      5.5    14 &#34;&#34;    &amp;lt;chr&amp;gt;      1            4.5&#xA;#&amp;gt;  3 Mind Bend…  1963     99   NA      6.4    54 &#34;&#34;    &amp;lt;chr&amp;gt;      1            0  &#xA;#&amp;gt;  4 Trop (peu…  1998    119   NA      4.5    20 &#34;&#34;    &amp;lt;chr&amp;gt;      1           24.5&#xA;#&amp;gt;  5 Crystania…  1995     85   NA      6.1    25 &#34;&#34;    &amp;lt;chr&amp;gt;      1            0  &#xA;#&amp;gt;  6 Totale!, …  1991    102   NA      6.3   210 &#34;&#34;    &amp;lt;chr&amp;gt;      1            4.5&#xA;#&amp;gt;  7 Visibleme…  1995    100   NA      4.6     7 &#34;&#34;    &amp;lt;chr&amp;gt;      1           24.5&#xA;#&amp;gt;  8 Pang shen…  1976     85   NA      7.4     8 &#34;&#34;    &amp;lt;chr&amp;gt;      1            0  &#xA;#&amp;gt;  9 Not as a …  1955    135    2e6    6.6   223 &#34;&#34;    &amp;lt;chr&amp;gt;      1            4.5&#xA;#&amp;gt; 10 Autobiogr…  1994     87   NA      7.4     5 &#34;&#34;    &amp;lt;chr&amp;gt;      1            0  &#xA;#&amp;gt; # ℹ 49,990 more rows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;ggupset&lt;/code&gt; makes it easy to get an immediate impression how many movies are in each genre and their combination. For example there are slightly more than 1200 Dramas in the set, more than 1000 which don’t belong to any genre and ~170 that are Comedy and Drama.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_upset(n_intersections = 20)&#xA;#&amp;gt; Warning: Removed 100 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_count()`).&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-2-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;Adding Numbers on top&lt;/h2&gt; &#xA;&lt;p&gt;The best feature about &lt;code&gt;ggupset&lt;/code&gt; is that it plays well with existing tricks from &lt;code&gt;ggplot2&lt;/code&gt;. For example, you can easily add the size of the counts on top of the bars with this trick from &lt;a href=&#34;https://stackoverflow.com/a/26556180/604854&#34;&gt;stackoverflow&lt;/a&gt;&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    geom_text(stat=&#39;count&#39;, aes(label=after_stat(count)), vjust=-1) +&#xA;    scale_x_upset(n_intersections = 20) +&#xA;    scale_y_continuous(breaks = NULL, lim = c(0, 1350), name = &#34;&#34;)&#xA;#&amp;gt; Warning: Removed 100 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_count()`).&#xA;#&amp;gt; Removed 100 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_count()`).&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-3-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;Reshaping quadratic data&lt;/h2&gt; &#xA;&lt;p&gt;Often enough the raw data you are starting with is not in such a neat tidy shape. But that is a prerequisite to make such &lt;code&gt;ggupset&lt;/code&gt; plots, so how can you get from wide dataset to a useful one? And how to actually create a &lt;code&gt;list&lt;/code&gt;-column, anyway?&lt;/p&gt; &#xA;&lt;p&gt;Imagine we measured for a set of genes if they are a member of certain pathway. A gene can be a member of multiple pathways and we want to see which pathways have a large overlap. Unfortunately, we didn’t record the data in a tidy format but as a simple matrix.&lt;/p&gt; &#xA;&lt;p&gt;A ficitional dataset of this type is provided as &lt;code&gt;gene_pathway_membership&lt;/code&gt; variable&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data(&#34;gene_pathway_membership&#34;)&#xA;gene_pathway_membership[, 1:7]&#xA;#&amp;gt;                                Aco1  Aco2  Aif1 Alox8   Amh Bmpr1b Cdc25a&#xA;#&amp;gt; Actin dependent Cell Motility FALSE FALSE FALSE FALSE FALSE  FALSE  FALSE&#xA;#&amp;gt; Chemokine Secretion            TRUE FALSE  TRUE  TRUE FALSE  FALSE  FALSE&#xA;#&amp;gt; Citric Acid Cycle              TRUE  TRUE FALSE FALSE FALSE  FALSE  FALSE&#xA;#&amp;gt; Mammalian Oogenesis           FALSE FALSE FALSE FALSE  TRUE   TRUE  FALSE&#xA;#&amp;gt; Meiotic Cell Cycle            FALSE FALSE FALSE FALSE FALSE  FALSE   TRUE&#xA;#&amp;gt; Neuronal Apoptosis            FALSE FALSE FALSE FALSE FALSE  FALSE  FALSE&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;We will now turn first turn this matrix into a tidy tibble and then plot it&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_pathway_member &amp;lt;- gene_pathway_membership %&amp;gt;%&#xA;  as_tibble(rownames = &#34;Pathway&#34;) %&amp;gt;%&#xA;  gather(Gene, Member, -Pathway) %&amp;gt;%&#xA;  filter(Member) %&amp;gt;%&#xA;  select(- Member)&#xA;&#xA;tidy_pathway_member&#xA;#&amp;gt; # A tibble: 44 × 2&#xA;#&amp;gt;    Pathway             Gene  &#xA;#&amp;gt;    &amp;lt;chr&amp;gt;               &amp;lt;chr&amp;gt; &#xA;#&amp;gt;  1 Chemokine Secretion Aco1  &#xA;#&amp;gt;  2 Citric Acid Cycle   Aco1  &#xA;#&amp;gt;  3 Citric Acid Cycle   Aco2  &#xA;#&amp;gt;  4 Chemokine Secretion Aif1  &#xA;#&amp;gt;  5 Chemokine Secretion Alox8 &#xA;#&amp;gt;  6 Mammalian Oogenesis Amh   &#xA;#&amp;gt;  7 Mammalian Oogenesis Bmpr1b&#xA;#&amp;gt;  8 Meiotic Cell Cycle  Cdc25a&#xA;#&amp;gt;  9 Meiotic Cell Cycle  Cdc25c&#xA;#&amp;gt; 10 Chemokine Secretion Chia1 &#xA;#&amp;gt; # ℹ 34 more rows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;code&gt;tidy_pathway_member&lt;/code&gt; is already a very good starting point for plotting with &lt;code&gt;ggplot&lt;/code&gt;. But we care about the genes that are members of multiple pathways so we will aggregate the data by &lt;code&gt;Gene&lt;/code&gt; and create a &lt;code&gt;list&lt;/code&gt;-column with the &lt;code&gt;Pathway&lt;/code&gt; information.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_pathway_member %&amp;gt;%&#xA;  group_by(Gene) %&amp;gt;%&#xA;  summarize(Pathways = list(Pathway))&#xA;#&amp;gt; # A tibble: 37 × 2&#xA;#&amp;gt;    Gene   Pathways &#xA;#&amp;gt;    &amp;lt;chr&amp;gt;  &amp;lt;list&amp;gt;   &#xA;#&amp;gt;  1 Aco1   &amp;lt;chr [2]&amp;gt;&#xA;#&amp;gt;  2 Aco2   &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  3 Aif1   &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  4 Alox8  &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  5 Amh    &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  6 Bmpr1b &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  7 Cdc25a &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  8 Cdc25c &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt;  9 Chia1  &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt; 10 Csf1r  &amp;lt;chr [1]&amp;gt;&#xA;#&amp;gt; # ℹ 27 more rows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_pathway_member %&amp;gt;%&#xA;  group_by(Gene) %&amp;gt;%&#xA;  summarize(Pathways = list(Pathway)) %&amp;gt;%&#xA;  ggplot(aes(x = Pathways)) +&#xA;    geom_bar() +&#xA;    scale_x_upset()&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-7-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;What if I need more flexibility?&lt;/h2&gt; &#xA;&lt;p&gt;The first important idea is to realize that a list column is just as good as a character vector with the list elements collapsed&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  mutate(Genres_collapsed = sapply(Genres, function(x) paste0(sort(x), collapse = &#34;-&#34;))) %&amp;gt;%&#xA;  select(title, Genres, Genres_collapsed)&#xA;#&amp;gt; # A tibble: 5,000 × 3&#xA;#&amp;gt;    title                                   Genres    Genres_collapsed  &#xA;#&amp;gt;    &amp;lt;chr&amp;gt;                                   &amp;lt;list&amp;gt;    &amp;lt;chr&amp;gt;             &#xA;#&amp;gt;  1 Ei ist eine geschissene Gottesgabe, Das &amp;lt;chr [1]&amp;gt; &#34;Documentary&#34;     &#xA;#&amp;gt;  2 Hamos sto aigaio                        &amp;lt;chr [1]&amp;gt; &#34;Comedy&#34;          &#xA;#&amp;gt;  3 Mind Benders, The                       &amp;lt;chr [0]&amp;gt; &#34;&#34;                &#xA;#&amp;gt;  4 Trop (peu) d&#39;amour                      &amp;lt;chr [0]&amp;gt; &#34;&#34;                &#xA;#&amp;gt;  5 Crystania no densetsu                   &amp;lt;chr [1]&amp;gt; &#34;Animation&#34;       &#xA;#&amp;gt;  6 Totale!, La                             &amp;lt;chr [1]&amp;gt; &#34;Comedy&#34;          &#xA;#&amp;gt;  7 Visiblement je vous aime                &amp;lt;chr [0]&amp;gt; &#34;&#34;                &#xA;#&amp;gt;  8 Pang shen feng                          &amp;lt;chr [2]&amp;gt; &#34;Action-Animation&#34;&#xA;#&amp;gt;  9 Not as a Stranger                       &amp;lt;chr [1]&amp;gt; &#34;Drama&#34;           &#xA;#&amp;gt; 10 Autobiographia Dimionit                 &amp;lt;chr [1]&amp;gt; &#34;Drama&#34;           &#xA;#&amp;gt; # ℹ 4,990 more rows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;We can easily make a plot using the strings as categorical axis labels&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  mutate(Genres_collapsed = sapply(Genres, function(x) paste0(sort(x), collapse = &#34;-&#34;))) %&amp;gt;%&#xA;  ggplot(aes(x=Genres_collapsed)) +&#xA;    geom_bar() +&#xA;    theme(axis.text.x = element_text(angle=90, hjust=1, vjust=0.5))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-9-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;p&gt;Because the process of collapsing list columns into delimited strings is fairly generic, I provide a new scale that does this automatically (&lt;code&gt;scale_x_mergelist()&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_mergelist(sep = &#34;-&#34;) +&#xA;    theme(axis.text.x = element_text(angle=90, hjust=1, vjust=0.5))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-10-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;p&gt;But the problem is that it can be difficult to read those labels. Instead I provide a third function that replaces the axis labels with a combination matrix (&lt;code&gt;axis_combmatrix()&lt;/code&gt;).&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_mergelist(sep = &#34;-&#34;) +&#xA;    axis_combmatrix(sep = &#34;-&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-11-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;p&gt;One thing that is only possible with the &lt;code&gt;scale_x_upset()&lt;/code&gt; function is to automatically order the categories and genres by &lt;code&gt;freq&lt;/code&gt; or by &lt;code&gt;degree&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_upset(order_by = &#34;degree&#34;)&#xA;#&amp;gt; Warning: Removed 1076 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_count()`).&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-12-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;Styling&lt;/h2&gt; &#xA;&lt;p&gt;To make publication ready plots, you often want to have complete control how each part of a plot looks. This is why I provide an easy way to style the combination matrix. Simply add a &lt;code&gt;theme_combmatrix()&lt;/code&gt; to the plot.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_upset(order_by = &#34;degree&#34;) +&#xA;    theme_combmatrix(combmatrix.panel.point.color.fill = &#34;green&#34;,&#xA;                     combmatrix.panel.line.size = 0,&#xA;                     combmatrix.label.make_space = FALSE)&#xA;#&amp;gt; Warning: Removed 1076 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_count()`).&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-13-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;Maximum Flexibility&lt;/h2&gt; &#xA;&lt;p&gt;Sometimes the limited styling options using &lt;code&gt;combmatrix.panel.point.color.fill&lt;/code&gt; are not enough. To fully customize the combination matrix plot, &lt;code&gt;axis_combmatrix&lt;/code&gt; has an &lt;code&gt;override_plotting_function&lt;/code&gt; parameter, that allows us to plot anything in place of the combination matrix.&lt;/p&gt; &#xA;&lt;p&gt;Let us first reproduce the standard combination plot, but use the &lt;code&gt;override_plotting_function&lt;/code&gt; parameter to see how it works:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_mergelist(sep = &#34;-&#34;) +&#xA;    axis_combmatrix(sep = &#34;-&#34;, override_plotting_function = function(df){&#xA;      ggplot(df, aes(x= at, y= single_label)) +&#xA;        geom_rect(aes(fill= index %% 2 == 0), ymin=df$index-0.5, ymax=df$index+0.5, xmin=0, xmax=1) +&#xA;        geom_point(aes(color= observed), size = 3) +&#xA;        geom_line(data= function(dat) dat[dat$observed, ,drop=FALSE], aes(group = labels), linewidth= 1.2) +&#xA;        ylab(&#34;&#34;) + xlab(&#34;&#34;) +&#xA;        scale_x_continuous(limits = c(0, 1), expand = c(0, 0)) +&#xA;        scale_fill_manual(values= c(`TRUE` = &#34;white&#34;, `FALSE` = &#34;#F7F7F7&#34;)) +&#xA;        scale_color_manual(values= c(`TRUE` = &#34;black&#34;, `FALSE` = &#34;#E0E0E0&#34;)) +&#xA;        guides(color=&#34;none&#34;, fill=&#34;none&#34;) +&#xA;        theme(&#xA;          panel.background = element_blank(),&#xA;          axis.text.x = element_blank(),&#xA;          axis.ticks.y = element_blank(),&#xA;          axis.ticks.length = unit(0, &#34;pt&#34;),&#xA;          axis.title.y = element_blank(),&#xA;          axis.title.x = element_blank(),&#xA;          axis.line = element_blank(),&#xA;          panel.border = element_blank()&#xA;        )&#xA;    })&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-14-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;p&gt;We can use the above template, to specifically highlight for example all sets that include the &lt;em&gt;Action&lt;/em&gt; category.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_mergelist(sep = &#34;-&#34;) +&#xA;    axis_combmatrix(sep = &#34;-&#34;, override_plotting_function = function(df){&#xA;      print(class(df))&#xA;      print(df)&#xA;      df %&amp;gt;%&#xA;        mutate(action_movie = case_when(&#xA;          ! observed ~ &#34;not observed&#34;,&#xA;          map_lgl(labels_split, ~ &#34;Action&#34; %in% .x) ~ &#34;Action&#34;,&#xA;          observed ~ &#34;Non-Action&#34;&#xA;        )) %&amp;gt;%&#xA;        ggplot(aes(x = at, y = single_label)) +&#xA;          geom_rect(aes(fill = index %% 2 == 0), ymin=df$index-0.5, ymax=df$index+0.5, xmin=0, xmax=1) +&#xA;          geom_point(aes(color = action_movie), size = 3) +&#xA;          geom_line(data= function(dat) dat[dat$observed, ,drop=FALSE], aes(group = labels, color = action_movie), linewidth= 1.2) +&#xA;          ylab(&#34;&#34;) + xlab(&#34;&#34;) +&#xA;          scale_x_continuous(limits = c(0, 1), expand = c(0, 0)) +&#xA;          scale_fill_manual(values= c(`TRUE` = &#34;white&#34;, `FALSE` = &#34;#F7F7F7&#34;)) +&#xA;          scale_color_manual(values= c(&#34;Action&#34; = &#34;red&#34;, &#34;Non-Action&#34; = &#34;black&#34;, &#34;not observed&#34; = &#34;lightgrey&#34;)) +&#xA;          guides(fill=&#34;none&#34;) +&#xA;          theme(&#xA;            legend.position = &#34;bottom&#34;,&#xA;            panel.background = element_blank(),&#xA;            axis.text.x = element_blank(),&#xA;            axis.ticks.y = element_blank(),&#xA;            axis.ticks.length = unit(0, &#34;pt&#34;),&#xA;            axis.title.y = element_blank(),&#xA;            axis.title.x = element_blank(),&#xA;            axis.line = element_blank(),&#xA;            panel.border = element_blank()&#xA;          )&#xA;    }) +&#xA;    theme(combmatrix.label.total_extra_spacing = unit(30, &#34;pt&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-15-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;pre&gt;&lt;code&gt;#&amp;gt; [1] &#34;tbl_df&#34;     &#34;tbl&#34;        &#34;data.frame&#34;&#xA;#&amp;gt; # A tibble: 336 × 7&#xA;#&amp;gt;    labels                  single_label    id labels_split     at observed index&#xA;#&amp;gt;    &amp;lt;ord&amp;gt;                   &amp;lt;ord&amp;gt;        &amp;lt;int&amp;gt; &amp;lt;list&amp;gt;        &amp;lt;dbl&amp;gt; &amp;lt;lgl&amp;gt;    &amp;lt;dbl&amp;gt;&#xA;#&amp;gt;  1 &#34;&#34;                      Short            1 &amp;lt;chr [0]&amp;gt;    0.0124 FALSE        1&#xA;#&amp;gt;  2 &#34;Action&#34;                Short            2 &amp;lt;chr [1]&amp;gt;    0.0332 FALSE        1&#xA;#&amp;gt;  3 &#34;Action-Animation&#34;      Short            3 &amp;lt;chr [2]&amp;gt;    0.0539 FALSE        1&#xA;#&amp;gt;  4 &#34;Action-Animation-Roma… Short            4 &amp;lt;chr [3]&amp;gt;    0.0747 FALSE        1&#xA;#&amp;gt;  5 &#34;Action-Animation-Shor… Short            5 &amp;lt;chr [3]&amp;gt;    0.0954 TRUE         1&#xA;#&amp;gt;  6 &#34;Action-Comedy&#34;         Short            6 &amp;lt;chr [2]&amp;gt;    0.116  FALSE        1&#xA;#&amp;gt;  7 &#34;Action-Comedy-Drama&#34;   Short            7 &amp;lt;chr [3]&amp;gt;    0.137  FALSE        1&#xA;#&amp;gt;  8 &#34;Action-Comedy-Romance&#34; Short            8 &amp;lt;chr [3]&amp;gt;    0.158  FALSE        1&#xA;#&amp;gt;  9 &#34;Action-Comedy-Short&#34;   Short            9 &amp;lt;chr [3]&amp;gt;    0.178  TRUE         1&#xA;#&amp;gt; 10 &#34;Action-Documentary&#34;    Short           10 &amp;lt;chr [2]&amp;gt;    0.199  FALSE        1&#xA;#&amp;gt; # ℹ 326 more rows&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The &lt;code&gt;override_plotting_function&lt;/code&gt; is incredibly powerful, but also an advanced feature that comes with pitfalls. Use at your own risk.&lt;/p&gt; &#xA;&lt;h2&gt;Alternative Packages&lt;/h2&gt; &#xA;&lt;p&gt;There is already a package called &lt;code&gt;UpSetR&lt;/code&gt; (&lt;a href=&#34;https://github.com/hms-dbmi/UpSetR&#34;&gt;GitHub&lt;/a&gt;, &lt;a href=&#34;https://cran.r-project.org/package=UpSetR&#34;&gt;CRAN&lt;/a&gt;) that provides very similar functionality and that heavily inspired me to write this package. It produces a similar plot with an additional view that shows the overall size of each genre.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;&#xA;# UpSetR&#xA;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  unnest(cols = Genres) %&amp;gt;%&#xA;  mutate(GenreMember=1) %&amp;gt;%&#xA;  pivot_wider(names_from = Genres, values_from = GenreMember, values_fill = list(GenreMember = 0)) %&amp;gt;%&#xA;  as.data.frame() %&amp;gt;%&#xA;  UpSetR::upset(sets = c(&#34;Action&#34;, &#34;Romance&#34;, &#34;Short&#34;, &#34;Comedy&#34;, &#34;Drama&#34;), keep.order = TRUE)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-16-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;&#xA;# ggupset&#xA;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_upset(order_by = &#34;degree&#34;, n_sets = 5)&#xA;#&amp;gt; Warning: Removed 1311 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_count()`).&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-16-2.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;p&gt;The &lt;code&gt;UpSetR&lt;/code&gt; package provides a lot convenient helpers around this kind of plot; the main advantage of my package is that it can be combined with any kind of ggplot that uses a categorical x-axis. This additional flexibility can be useful if you want to create non-standard plots. The following plot for example shows when movies of a certain genre were published.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres, y=year)) +&#xA;    geom_violin() +&#xA;    scale_x_upset(order_by = &#34;freq&#34;, n_intersections = 12)&#xA;#&amp;gt; Warning: Removed 513 rows containing non-finite outside the scale range&#xA;#&amp;gt; (`stat_ydensity()`).&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-violinexample-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h1&gt;Advanced examples&lt;/h1&gt; &#xA;&lt;h4&gt;1. Complex experimental design&lt;/h4&gt; &#xA;&lt;p&gt;The combination matrix axis can be used to show complex experimental designs, where each sample got a combination of different treatments.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;df_complex_conditions&#xA;#&amp;gt; # A tibble: 360 × 4&#xA;#&amp;gt;    KO    DrugA Timepoint response&#xA;#&amp;gt;    &amp;lt;lgl&amp;gt; &amp;lt;chr&amp;gt;     &amp;lt;dbl&amp;gt;    &amp;lt;dbl&amp;gt;&#xA;#&amp;gt;  1 TRUE  Yes           8     84.3&#xA;#&amp;gt;  2 TRUE  Yes           8    105. &#xA;#&amp;gt;  3 TRUE  Yes           8     79.1&#xA;#&amp;gt;  4 TRUE  Yes           8    140. &#xA;#&amp;gt;  5 TRUE  Yes           8    108. &#xA;#&amp;gt;  6 TRUE  Yes           8     79.5&#xA;#&amp;gt;  7 TRUE  Yes           8    112. &#xA;#&amp;gt;  8 TRUE  Yes           8    118. &#xA;#&amp;gt;  9 TRUE  Yes           8    114. &#xA;#&amp;gt; 10 TRUE  Yes           8     92.4&#xA;#&amp;gt; # ℹ 350 more rows&#xA;&#xA;df_complex_conditions %&amp;gt;%&#xA;  mutate(Label = pmap(list(KO, DrugA, Timepoint), function(KO, DrugA, Timepoint){&#xA;    c(if(KO) &#34;KO&#34; else &#34;WT&#34;, if(DrugA == &#34;Yes&#34;) &#34;Drug&#34;, paste0(Timepoint, &#34;h&#34;))&#xA;  })) %&amp;gt;%&#xA;  ggplot(aes(x=Label, y=response)) +&#xA;    geom_boxplot() +&#xA;    geom_jitter(aes(color=KO), width=0.1) +&#xA;    geom_smooth(method = &#34;lm&#34;, aes(group = paste0(KO, &#34;-&#34;, DrugA))) +&#xA;    scale_x_upset(order_by = &#34;degree&#34;,&#xA;                  sets = c(&#34;KO&#34;, &#34;WT&#34;, &#34;Drug&#34;, &#34;8h&#34;, &#34;24h&#34;, &#34;48h&#34;),&#xA;                  position=&#34;top&#34;, name = &#34;&#34;) +&#xA;    theme_combmatrix(combmatrix.label.text = element_text(size=12),&#xA;                     combmatrix.label.extra_spacing = 5)&#xA;#&amp;gt; `geom_smooth()` using formula = &#39;y ~ x&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-17-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h4&gt;2. Aggregation of information&lt;/h4&gt; &#xA;&lt;p&gt;&lt;code&gt;dplyr&lt;/code&gt; currently does not support list columns as grouping variables. In that case it makes sense to collapse it manually and use the &lt;code&gt;axis_combmatrix()&lt;/code&gt; function to get a good looking plot.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Percentage of votes for n stars for top 12 genres&#xA;avg_rating &amp;lt;- tidy_movies %&amp;gt;%&#xA;  mutate(Genres_collapsed = sapply(Genres, function(x) paste0(sort(x), collapse=&#34;-&#34;))) %&amp;gt;%&#xA;  mutate(Genres_collapsed = fct_lump(fct_infreq(as.factor(Genres_collapsed)), n=12)) %&amp;gt;%&#xA;  group_by(stars, Genres_collapsed) %&amp;gt;%&#xA;  summarize(percent_rating = sum(votes * percent_rating)) %&amp;gt;%&#xA;  group_by(Genres_collapsed) %&amp;gt;%&#xA;  mutate(percent_rating = percent_rating / sum(percent_rating)) %&amp;gt;%&#xA;  arrange(Genres_collapsed)&#xA;#&amp;gt; `summarise()` has grouped output by &#39;stars&#39;. You can override using the&#xA;#&amp;gt; `.groups` argument.&#xA;&#xA;avg_rating&#xA;#&amp;gt; # A tibble: 130 × 3&#xA;#&amp;gt; # Groups:   Genres_collapsed [13]&#xA;#&amp;gt;    stars Genres_collapsed percent_rating&#xA;#&amp;gt;    &amp;lt;dbl&amp;gt; &amp;lt;fct&amp;gt;                     &amp;lt;dbl&amp;gt;&#xA;#&amp;gt;  1     1 Drama                    0.0437&#xA;#&amp;gt;  2     2 Drama                    0.0411&#xA;#&amp;gt;  3     3 Drama                    0.0414&#xA;#&amp;gt;  4     4 Drama                    0.0433&#xA;#&amp;gt;  5     5 Drama                    0.0506&#xA;#&amp;gt;  6     6 Drama                    0.0717&#xA;#&amp;gt;  7     7 Drama                    0.129 &#xA;#&amp;gt;  8     8 Drama                    0.175 &#xA;#&amp;gt;  9     9 Drama                    0.170 &#xA;#&amp;gt; 10    10 Drama                    0.235 &#xA;#&amp;gt; # ℹ 120 more rows&#xA;&#xA;# Plot using the combination matrix axis&#xA;# the red lines indicate the average rating per genre&#xA;ggplot(avg_rating, aes(x=Genres_collapsed, y=stars)) +&#xA;    geom_tile(aes(fill=percent_rating)) +&#xA;    stat_summary_bin(aes(y=percent_rating * stars), fun = sum,  geom=&#34;point&#34;, &#xA;                     shape=&#34;—&#34;, color=&#34;red&#34;, size=6) +&#xA;    axis_combmatrix(sep = &#34;-&#34;, levels = c(&#34;Drama&#34;, &#34;Comedy&#34;, &#34;Short&#34;, &#xA;                    &#34;Documentary&#34;, &#34;Action&#34;, &#34;Romance&#34;, &#34;Animation&#34;, &#34;Other&#34;)) +&#xA;    scale_fill_viridis_c()&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/const-ae/ggupset/master/man/figures/README-unnamed-chunk-18-1.png&#34; width=&#34;70%&#34;&gt; &#xA;&lt;h2&gt;Saving Plots&lt;/h2&gt; &#xA;&lt;p&gt;There is an important pitfall when trying to save a plot with a combination matrix. When you use &lt;code&gt;ggsave()&lt;/code&gt;, ggplot2 automatically saves the last plot that was created. However, here &lt;code&gt;last_plot()&lt;/code&gt; refers to only the combination matrix. To store the full plot, you need to explicitly assign it to a variable and save that.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;pl &amp;lt;- tidy_movies %&amp;gt;%&#xA;  distinct(title, year, length, .keep_all=TRUE) %&amp;gt;%&#xA;  ggplot(aes(x=Genres)) +&#xA;    geom_bar() +&#xA;    scale_x_upset(n_intersections = 20)&#xA;ggsave(&#34;/tmp/movie_genre_barchart.png&#34;, plot = pl)&#xA;#&amp;gt; Saving 7 x 5 in image&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Session Info&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;sessionInfo()&#xA;#&amp;gt; R version 4.3.2 (2023-10-31)&#xA;#&amp;gt; Platform: x86_64-apple-darwin20 (64-bit)&#xA;#&amp;gt; Running under: macOS Sonoma 14.5&#xA;#&amp;gt; &#xA;#&amp;gt; Matrix products: default&#xA;#&amp;gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib &#xA;#&amp;gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0&#xA;#&amp;gt; &#xA;#&amp;gt; locale:&#xA;#&amp;gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8&#xA;#&amp;gt; &#xA;#&amp;gt; time zone: Europe/Berlin&#xA;#&amp;gt; tzcode source: internal&#xA;#&amp;gt; &#xA;#&amp;gt; attached base packages:&#xA;#&amp;gt; [1] stats     graphics  grDevices utils     datasets  methods   base     &#xA;#&amp;gt; &#xA;#&amp;gt; other attached packages:&#xA;#&amp;gt;  [1] ggupset_0.4.0   lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1  &#xA;#&amp;gt;  [5] dplyr_1.1.4     purrr_1.0.2     readr_2.1.5     tidyr_1.3.1    &#xA;#&amp;gt;  [9] tibble_3.2.1    tidyverse_2.0.0 ggplot2_3.5.1  &#xA;#&amp;gt; &#xA;#&amp;gt; loaded via a namespace (and not attached):&#xA;#&amp;gt;  [1] utf8_1.2.4        generics_0.1.3    lattice_0.22-5    stringi_1.8.3    &#xA;#&amp;gt;  [5] hms_1.1.3         digest_0.6.34     magrittr_2.0.3    evaluate_0.23    &#xA;#&amp;gt;  [9] grid_4.3.2        timechange_0.3.0  fastmap_1.1.1     Matrix_1.6-5     &#xA;#&amp;gt; [13] plyr_1.8.9        gridExtra_2.3     mgcv_1.9-1        fansi_1.0.6      &#xA;#&amp;gt; [17] viridisLite_0.4.2 scales_1.3.0      UpSetR_1.4.0      textshaping_0.3.7&#xA;#&amp;gt; [21] cli_3.6.2         rlang_1.1.3       munsell_0.5.0     splines_4.3.2    &#xA;#&amp;gt; [25] withr_3.0.0       yaml_2.3.8        tools_4.3.2       tzdb_0.4.0       &#xA;#&amp;gt; [29] colorspace_2.1-0  vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4  &#xA;#&amp;gt; [33] ragg_1.2.7        pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.4     &#xA;#&amp;gt; [37] glue_1.7.0        Rcpp_1.0.12       systemfonts_1.0.5 xfun_0.42        &#xA;#&amp;gt; [41] tidyselect_1.2.0  highr_0.10        rstudioapi_0.15.0 knitr_1.45       &#xA;#&amp;gt; [45] farver_2.1.1      nlme_3.1-164      htmltools_0.5.7   rmarkdown_2.25   &#xA;#&amp;gt; [49] labeling_0.4.3    compiler_4.3.2&#xA;&lt;/code&gt;&lt;/pre&gt;</summary>
  </entry>
</feed>