<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub R Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2022-09-08T01:41:18Z</updated>
  <subtitle>Daily Trending of R in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>showteeth/ggcoverage</title>
    <updated>2022-09-08T01:41:18Z</updated>
    <id>tag:github.com,2022-09-08:/showteeth/ggcoverage</id>
    <link href="https://github.com/showteeth/ggcoverage" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Visualize and annotate genomic coverage with ggplot2&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;ggcoverage - Visualize and annotate genome coverage with ggplot2&lt;/h1&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/ggcoverage.png&#34; align=&#34;right&#34; width=&#34;200&#34;&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://cran.r-project.org/package=ggcoverage&#34;&gt;&lt;img src=&#34;https://www.r-pkg.org/badges/version/ggcoverage?color=orange&#34; alt=&#34;CRAN&#34;&gt;&lt;/a&gt; &lt;img src=&#34;https://img.shields.io/badge/license-MIT-green&#34; alt=&#34;License&#34;&gt; &lt;a href=&#34;https://github.com/showteeth/ggcoverage&#34;&gt;&lt;img src=&#34;https://img.shields.io/github/languages/code-size/showteeth/ggcoverage.svg?sanitize=true&#34; alt=&#34;CODE_SIZE&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Introduction&lt;/h2&gt; &#xA;&lt;p&gt;The goal of &lt;code&gt;ggcoverage&lt;/code&gt; is simplify the process of visualizing genome coverage. It contains three main parts:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;Load the data&lt;/strong&gt;: &lt;code&gt;ggcoverage&lt;/code&gt; can load BAM, BigWig (.bw), BedGraph files from various NGS data, including WGS, RNA-seq, ChIP-seq, ATAC-seq, et al.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Create genome coverage plot&lt;/strong&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Add annotations&lt;/strong&gt;: &lt;code&gt;ggcoverage&lt;/code&gt; supports six different annotations: &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;strong&gt;base and amino acid annotation&lt;/strong&gt;: Visualize genome coverage at single-nucleotide level with bases and amino acids.&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;GC annotation&lt;/strong&gt;: Visualize genome coverage with GC content&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;gene annotation&lt;/strong&gt;: Visualize genome coverage across whole gene&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;transcription annotation&lt;/strong&gt;: Visualize genome coverage across different transcripts&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;ideogram annotation&lt;/strong&gt;: Visualize the region showing on whole chromosome&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;peak annotation&lt;/strong&gt;: Visualize genome coverage and peak identified&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;&lt;code&gt;ggcoverage&lt;/code&gt; utilizes &lt;code&gt;ggplot2&lt;/code&gt; plotting system, so its usage is &lt;strong&gt;ggplot2-style&lt;/strong&gt;!&lt;/p&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;&lt;code&gt;ggcoverage&lt;/code&gt; is an R package distributed as part of the &lt;a href=&#34;https://cran.r-project.org/&#34;&gt;CRAN&lt;/a&gt;. To install the package, start R and enter:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# install via CRAN&#xA;install.package(&#34;ggcoverage&#34;)&#xA;&#xA;# install via Github&#xA;# install.package(&#34;remotes&#34;)   #In case you have not installed it.&#xA;remotes::install_github(&#34;showteeth/ggcoverage&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In general, it is &lt;strong&gt;recommended&lt;/strong&gt; to install from &lt;a href=&#34;https://github.com/showteeth/ggcoverage&#34;&gt;Github repository&lt;/a&gt; (update more timely).&lt;/p&gt; &#xA;&lt;p&gt;Once &lt;code&gt;ggcoverage&lt;/code&gt; is installed, it can be loaded by the following command.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(&#34;rtracklayer&#34;)&#xA;library(&#34;ggcoverage&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;RNA-seq data&lt;/h2&gt; &#xA;&lt;h3&gt;Load the data&lt;/h3&gt; &#xA;&lt;p&gt;The RNA-seq data used here are from &lt;a href=&#34;https://bioconductor.org/packages/release/data/experiment/html/RNAseqData.HNRNPC.bam.chr14.html&#34;&gt;Transcription profiling by high throughput sequencing of HNRNPC knockdown and control HeLa cells&lt;/a&gt;, we select four sample to use as example: ERR127307_chr14, ERR127306_chr14, ERR127303_chr14, ERR127302_chr14, and all bam files are converted to bigwig file with &lt;a href=&#34;https://deeptools.readthedocs.io/en/develop/&#34;&gt;deeptools&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Load metadata:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# load metadata&#xA;meta.file &amp;lt;- system.file(&#34;extdata&#34;, &#34;RNA-seq&#34;, &#34;meta_info.csv&#34;, package = &#34;ggcoverage&#34;)&#xA;sample.meta = read.csv(meta.file)&#xA;sample.meta&#xA;#&amp;gt;        SampleName    Type Group&#xA;#&amp;gt; 1 ERR127302_chr14 KO_rep1    KO&#xA;#&amp;gt; 2 ERR127303_chr14 KO_rep2    KO&#xA;#&amp;gt; 3 ERR127306_chr14 WT_rep1    WT&#xA;#&amp;gt; 4 ERR127307_chr14 WT_rep2    WT&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Load track files:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# track folder&#xA;track.folder = system.file(&#34;extdata&#34;, &#34;RNA-seq&#34;, package = &#34;ggcoverage&#34;)&#xA;# load bigwig file&#xA;track.df = LoadTrackFile(track.folder = track.folder, format = &#34;bw&#34;,&#xA;                         meta.info = sample.meta)&#xA;# check data&#xA;head(track.df)&#xA;#&amp;gt;   seqnames    start      end score    Type Group&#xA;#&amp;gt; 1    chr14 21572751 21630650     0 KO_rep1    KO&#xA;#&amp;gt; 2    chr14 21630651 21630700     1 KO_rep1    KO&#xA;#&amp;gt; 3    chr14 21630701 21630800     4 KO_rep1    KO&#xA;#&amp;gt; 4    chr14 21630801 21657350     0 KO_rep1    KO&#xA;#&amp;gt; 5    chr14 21657351 21657450     1 KO_rep1    KO&#xA;#&amp;gt; 6    chr14 21657451 21663550     0 KO_rep1    KO&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Prepare mark region:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# create mark region&#xA;mark.region=data.frame(start=c(21678900,21732001,21737590),&#xA;                       end=c(21679900,21732400,21737650),&#xA;                       label=c(&#34;M1&#34;, &#34;M2&#34;, &#34;M3&#34;))&#xA;# check data&#xA;mark.region&#xA;#&amp;gt;      start      end label&#xA;#&amp;gt; 1 21678900 21679900    M1&#xA;#&amp;gt; 2 21732001 21732400    M2&#xA;#&amp;gt; 3 21737590 21737650    M3&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Load GTF file:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;gtf.file = system.file(&#34;extdata&#34;, &#34;used_hg19.gtf&#34;, package = &#34;ggcoverage&#34;)&#xA;gtf.gr = rtracklayer::import.gff(con = gtf.file, format = &#39;gtf&#39;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Basic coverage&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage = ggcoverage(data = track.df, color = &#34;auto&#34;, &#xA;                            mark.region = mark.region, range.position = &#34;out&#34;)&#xA;basic.coverage&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-basic_coverage-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;p&gt;You can also change Y axis style:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage = ggcoverage(data = track.df, color = &#34;auto&#34;, &#xA;                            mark.region = mark.region, range.position = &#34;in&#34;)&#xA;basic.coverage&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-basic_coverage_2-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h3&gt;Add gene annotation&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage + &#xA;  geom_gene(gtf.gr=gtf.gr)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-gene_coverage-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h3&gt;Add transcript annotation&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage + &#xA;  geom_transcript(gtf.gr=gtf.gr,label.vjust = 1.5)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-transcript_coverage-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h3&gt;Add ideogram&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage +&#xA;  geom_gene(gtf.gr=gtf.gr) +&#xA;  geom_ideogram(genome = &#34;hg19&#34;,plot.space = 0)&#xA;#&amp;gt; Loading ideogram...&#xA;#&amp;gt; Loading ranges...&#xA;#&amp;gt; Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will&#xA;#&amp;gt; replace the existing scale.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-ideogram_coverage_1-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage +&#xA;  geom_transcript(gtf.gr=gtf.gr,label.vjust = 1.5) +&#xA;  geom_ideogram(genome = &#34;hg19&#34;,plot.space = 0)&#xA;#&amp;gt; Loading ideogram...&#xA;#&amp;gt; Loading ranges...&#xA;#&amp;gt; Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will&#xA;#&amp;gt; replace the existing scale.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-ideogram_coverage_2-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h2&gt;DNA-seq data&lt;/h2&gt; &#xA;&lt;h3&gt;CNV&lt;/h3&gt; &#xA;&lt;h4&gt;Load the data&lt;/h4&gt; &#xA;&lt;p&gt;The DNA-seq data used here are from &lt;a href=&#34;http://bioconductor.org/help/course-materials/2014/SeattleOct2014/B02.2.3_CopyNumber.html&#34;&gt;Copy number work flow&lt;/a&gt;, we select tumor sample, and get bin counts with &lt;code&gt;cn.mops::getReadCountsFromBAM&lt;/code&gt; with &lt;code&gt;WL&lt;/code&gt; 1000.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# track file&#xA;track.file = system.file(&#34;extdata&#34;, &#34;DNA-seq&#34;, &#34;CNV_example.txt&#34;, package = &#34;ggcoverage&#34;)&#xA;track.df = read.table(track.file, header = TRUE)&#xA;# check data&#xA;head(track.df)&#xA;#&amp;gt;   seqnames    start      end score  Type Group&#xA;#&amp;gt; 1     chr4 61743001 61744000    17 tumor tumor&#xA;#&amp;gt; 2     chr4 61744001 61745000    14 tumor tumor&#xA;#&amp;gt; 3     chr4 61745001 61746000    13 tumor tumor&#xA;#&amp;gt; 4     chr4 61746001 61747000    16 tumor tumor&#xA;#&amp;gt; 5     chr4 61747001 61748000    25 tumor tumor&#xA;#&amp;gt; 6     chr4 61748001 61749000    24 tumor tumor&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Basic coverage&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage = ggcoverage(data = track.df,color = NULL, mark.region = NULL,&#xA;                            region = &#39;chr4:61750000-62,700,000&#39;, range.position = &#34;out&#34;)&#xA;basic.coverage&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-basic_coverage_dna-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h4&gt;Add GC annotations&lt;/h4&gt; &#xA;&lt;p&gt;Add &lt;strong&gt;GC&lt;/strong&gt;, &lt;strong&gt;ideogram&lt;/strong&gt; and &lt;strong&gt;gene&lt;/strong&gt; annotaions.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# load genome data&#xA;library(&#34;BSgenome.Hsapiens.UCSC.hg19&#34;)&#xA;#&amp;gt; Loading required package: BSgenome&#xA;#&amp;gt; Loading required package: Biostrings&#xA;#&amp;gt; Loading required package: XVector&#xA;#&amp;gt; &#xA;#&amp;gt; Attaching package: &#39;Biostrings&#39;&#xA;#&amp;gt; The following object is masked from &#39;package:base&#39;:&#xA;#&amp;gt; &#xA;#&amp;gt;     strsplit&#xA;# create plot&#xA;basic.coverage +&#xA;  geom_gc(bs.fa.seq=BSgenome.Hsapiens.UCSC.hg19) +&#xA;  geom_gene(gtf.gr=gtf.gr) +&#xA;  geom_ideogram(genome = &#34;hg19&#34;)&#xA;#&amp;gt; Loading ideogram...&#xA;#&amp;gt; Loading ranges...&#xA;#&amp;gt; Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will&#xA;#&amp;gt; replace the existing scale.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-gc_coverage-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h3&gt;Single-nucleotide level&lt;/h3&gt; &#xA;&lt;h4&gt;Load the data&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# prepare sample metadata&#xA;sample.meta &amp;lt;- data.frame(&#xA;  SampleName = c(&#34;tumorA.chr4.selected&#34;),&#xA;  Type = c(&#34;tumorA&#34;),&#xA;  Group = c(&#34;tumorA&#34;)&#xA;)&#xA;# load bam file&#xA;bam.file = system.file(&#34;extdata&#34;, &#34;DNA-seq&#34;, &#34;tumorA.chr4.selected.bam&#34;, package = &#34;ggcoverage&#34;)&#xA;track.df &amp;lt;- LoadTrackFile(&#xA;  track.file = bam.file,&#xA;  meta.info = sample.meta,&#xA;  single.nuc=TRUE, single.nuc.region=&#34;chr4:62474235-62474295&#34;&#xA;)&#xA;head(track.df)&#xA;#&amp;gt;   seqnames    start      end score   Type  Group&#xA;#&amp;gt; 1     chr4 62474235 62474236     5 tumorA tumorA&#xA;#&amp;gt; 2     chr4 62474236 62474237     5 tumorA tumorA&#xA;#&amp;gt; 3     chr4 62474237 62474238     5 tumorA tumorA&#xA;#&amp;gt; 4     chr4 62474238 62474239     6 tumorA tumorA&#xA;#&amp;gt; 5     chr4 62474239 62474240     6 tumorA tumorA&#xA;#&amp;gt; 6     chr4 62474240 62474241     6 tumorA tumorA&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h4&gt;Default color scheme&lt;/h4&gt; &#xA;&lt;p&gt;For base and amino acid annotation, we have following default color schemes, you can change with &lt;code&gt;nuc.color&lt;/code&gt; and &lt;code&gt;aa.color&lt;/code&gt; parameters.&lt;/p&gt; &#xA;&lt;p&gt;Default color scheme for base annotation is &lt;code&gt;Clustal-style&lt;/code&gt;, more popular color schemes is available &lt;a href=&#34;https://www.biostars.org/p/171056/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# color scheme&#xA;nuc.color = c(&#34;A&#34; = &#34;#ff2b08&#34;, &#34;C&#34; = &#34;#009aff&#34;, &#34;G&#34; = &#34;#ffb507&#34;, &#34;T&#34; = &#34;#00bc0d&#34;)&#xA;# create plot&#xA;graphics::par(mar = c(1, 5, 1, 1))&#xA;graphics::image(&#xA;  1:length(nuc.color), 1, as.matrix(1:length(nuc.color)),&#xA;  col = nuc.color,&#xA;  xlab = &#34;&#34;, ylab = &#34;&#34;, xaxt = &#34;n&#34;, yaxt = &#34;n&#34;, bty = &#34;n&#34;&#xA;)&#xA;graphics::text(1:length(nuc.color), 1, names(nuc.color))&#xA;graphics::mtext(&#xA;  text = &#34;Base&#34;, adj = 1, las = 1,&#xA;  side = 2&#xA;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-base_color_scheme-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;p&gt;Default color scheme for amino acid annotation is from &lt;a href=&#34;https://academic.oup.com/peds/article/10/7/743/1593029?login=false&#34;&gt;Residual colours: a proposal for aminochromography&lt;/a&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;aa.color = c(&#xA;  &#34;D&#34; = &#34;#FF0000&#34;, &#34;S&#34; = &#34;#FF2400&#34;, &#34;T&#34; = &#34;#E34234&#34;, &#34;G&#34; = &#34;#FF8000&#34;, &#34;P&#34; = &#34;#F28500&#34;,&#xA;  &#34;C&#34; = &#34;#FFFF00&#34;, &#34;A&#34; = &#34;#FDFF00&#34;, &#34;V&#34; = &#34;#E3FF00&#34;, &#34;I&#34; = &#34;#C0FF00&#34;, &#34;L&#34; = &#34;#89318C&#34;,&#xA;  &#34;M&#34; = &#34;#00FF00&#34;, &#34;F&#34; = &#34;#50C878&#34;, &#34;Y&#34; = &#34;#30D5C8&#34;, &#34;W&#34; = &#34;#00FFFF&#34;, &#34;H&#34; = &#34;#0F2CB3&#34;,&#xA;  &#34;R&#34; = &#34;#0000FF&#34;, &#34;K&#34; = &#34;#4b0082&#34;, &#34;N&#34; = &#34;#800080&#34;, &#34;Q&#34; = &#34;#FF00FF&#34;, &#34;E&#34; = &#34;#8F00FF&#34;,&#xA;  &#34;*&#34; = &#34;#FFC0CB&#34;, &#34; &#34; = &#34;#FFFFFF&#34;, &#34; &#34; = &#34;#FFFFFF&#34;, &#34; &#34; = &#34;#FFFFFF&#34;, &#34; &#34; = &#34;#FFFFFF&#34;&#xA;)&#xA;&#xA;graphics::par(mar = c(1, 5, 1, 1))&#xA;graphics::image(&#xA;  1:5, 1:5, matrix(1:length(aa.color),nrow=5),&#xA;  col = rev(aa.color),&#xA;  xlab = &#34;&#34;, ylab = &#34;&#34;, xaxt = &#34;n&#34;, yaxt = &#34;n&#34;, bty = &#34;n&#34;&#xA;)&#xA;graphics::text(expand.grid(1:5,1:5), names(rev(aa.color)))&#xA;graphics::mtext(&#xA;  text = &#34;Amino acids&#34;, adj = 1, las = 1,&#xA;  side = 2&#xA;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-aa_color_scheme-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h4&gt;Add base and amino acid annotation&lt;/h4&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggcoverage(data = track.df, color = &#34;grey&#34;, range.position = &#34;out&#34;, single.nuc=T, rect.color = &#34;white&#34;) +&#xA;  geom_base(bam.file = bam.file,&#xA;            bs.fa.seq = BSgenome.Hsapiens.UCSC.hg19) +&#xA;  geom_ideogram(genome = &#34;hg19&#34;,plot.space = 0)&#xA;#&amp;gt; Loading ideogram...&#xA;#&amp;gt; Loading ranges...&#xA;#&amp;gt; Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will&#xA;#&amp;gt; replace the existing scale.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-base_aa_coverage-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h2&gt;ChIP-seq data&lt;/h2&gt; &#xA;&lt;p&gt;The ChIP-seq data used here are from &lt;a href=&#34;https://bioconductor.org/packages/release/bioc/html/DiffBind.html&#34;&gt;DiffBind&lt;/a&gt;, I select four sample to use as example: Chr18_MCF7_input, Chr18_MCF7_ER_1, Chr18_MCF7_ER_3, Chr18_MCF7_ER_2, and all bam files are converted to bigwig file with &lt;a href=&#34;https://deeptools.readthedocs.io/en/develop/&#34;&gt;deeptools&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Create metadata:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# load metadata&#xA;sample.meta = data.frame(SampleName=c(&#39;Chr18_MCF7_ER_1&#39;,&#39;Chr18_MCF7_ER_2&#39;,&#39;Chr18_MCF7_ER_3&#39;,&#39;Chr18_MCF7_input&#39;),&#xA;                         Type = c(&#34;MCF7_ER_1&#34;,&#34;MCF7_ER_2&#34;,&#34;MCF7_ER_3&#34;,&#34;MCF7_input&#34;),&#xA;                         Group = c(&#34;IP&#34;, &#34;IP&#34;, &#34;IP&#34;, &#34;Input&#34;))&#xA;sample.meta&#xA;#&amp;gt;         SampleName       Type Group&#xA;#&amp;gt; 1  Chr18_MCF7_ER_1  MCF7_ER_1    IP&#xA;#&amp;gt; 2  Chr18_MCF7_ER_2  MCF7_ER_2    IP&#xA;#&amp;gt; 3  Chr18_MCF7_ER_3  MCF7_ER_3    IP&#xA;#&amp;gt; 4 Chr18_MCF7_input MCF7_input Input&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Load track files:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# track folder&#xA;track.folder = system.file(&#34;extdata&#34;, &#34;ChIP-seq&#34;, package = &#34;ggcoverage&#34;)&#xA;# load bigwig file&#xA;track.df = LoadTrackFile(track.folder = track.folder, format = &#34;bw&#34;,&#xA;                         meta.info = sample.meta)&#xA;# check data&#xA;head(track.df)&#xA;#&amp;gt;   seqnames    start      end   score      Type Group&#xA;#&amp;gt; 1    chr18 76799701 76800000 439.316 MCF7_ER_1    IP&#xA;#&amp;gt; 2    chr18 76800001 76800300 658.974 MCF7_ER_1    IP&#xA;#&amp;gt; 3    chr18 76800301 76800600 219.658 MCF7_ER_1    IP&#xA;#&amp;gt; 4    chr18 76800601 76800900 658.974 MCF7_ER_1    IP&#xA;#&amp;gt; 5    chr18 76800901 76801200   0.000 MCF7_ER_1    IP&#xA;#&amp;gt; 6    chr18 76801201 76801500 219.658 MCF7_ER_1    IP&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Prepare mark region:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# create mark region&#xA;mark.region=data.frame(start=c(76822533),&#xA;                       end=c(76823743),&#xA;                       label=c(&#34;Promoter&#34;))&#xA;# check data&#xA;mark.region&#xA;#&amp;gt;      start      end    label&#xA;#&amp;gt; 1 76822533 76823743 Promoter&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Basic coverage&lt;/h3&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;basic.coverage = ggcoverage(data = track.df, color = &#34;auto&#34;, region = &#34;chr18:76822285-76900000&#34;, &#xA;                            mark.region=mark.region, show.mark.label = FALSE)&#xA;basic.coverage&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-basic_coverage_chip-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h3&gt;Add annotations&lt;/h3&gt; &#xA;&lt;p&gt;Add &lt;strong&gt;gene&lt;/strong&gt;, &lt;strong&gt;ideogram&lt;/strong&gt; and &lt;strong&gt;peak&lt;/strong&gt; annotations. To create peak annotation, we first &lt;strong&gt;get consensus peaks&lt;/strong&gt; with &lt;a href=&#34;https://github.com/Genometric/MSPC&#34;&gt;MSPC&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# get consensus peak file&#xA;peak.file = system.file(&#34;extdata&#34;, &#34;ChIP-seq&#34;, &#34;consensus.peak&#34;, package = &#34;ggcoverage&#34;)&#xA;&#xA;basic.coverage +&#xA;  geom_gene(gtf.gr=gtf.gr) +&#xA;  geom_peak(bed.file = peak.file) +&#xA;  geom_ideogram(genome = &#34;hg19&#34;,plot.space = 0)&#xA;#&amp;gt; Loading ideogram...&#xA;#&amp;gt; Loading ranges...&#xA;#&amp;gt; Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will&#xA;#&amp;gt; replace the existing scale.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/showteeth/ggcoverage/main/man/figures/README-peak_coverage-1.png&#34; width=&#34;100%&#34; style=&#34;display: block; margin: auto;&#34;&gt; &#xA;&lt;h2&gt;Code of Conduct&lt;/h2&gt; &#xA;&lt;p&gt;Please note that the &lt;code&gt;ggcoverage&lt;/code&gt; project is released with a &lt;a href=&#34;https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html&#34;&gt;Contributor Code of Conduct&lt;/a&gt;. By contributing to this project, you agree to abide by its terms.&lt;/p&gt;</summary>
  </entry>
</feed>