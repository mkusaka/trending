<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub R Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-05-20T01:43:18Z</updated>
  <subtitle>Daily Trending of R in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>liuhong-jia/scAnno</title>
    <updated>2023-05-20T01:43:18Z</updated>
    <id>tag:github.com,2023-05-20:/liuhong-jia/scAnno</id>
    <link href="https://github.com/liuhong-jia/scAnno" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;scAnno(&lt;strong&gt;sc&lt;/strong&gt;RNA-seq data &lt;strong&gt;A&lt;/strong&gt;nnotation)&lt;/h1&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;scAnno is an automated annotation tool for single-cell RNA sequencing datasets primarily based on the single cell cluster levels, using a joint deconvolution strategy and logistic regression. We explicitly created complete human reference atlas (30 cell types from the Human Cell Landscape covering more than 50 human tissues) and mouse reference atlas (26 cell types from Mouse Cell Atlas covering nearly 50 mouse tissues) to support this novel methodology (scAnno). scAnno offers a possibility to obtain genes with high expression and specificity in a given cell type as cell type-specific genes (marker genes) by combining co-expression genes with seed genes as a core. Of importance, scAnno can accurately identify cell type-specific genes based on cell type reference expression profiles without prior information. &lt;img src=&#34;https://user-images.githubusercontent.com/115637576/228169307-ba62a544-6808-4cd8-909f-335ad78f6d38.png&#34; alt=&#34;1679990437506&#34;&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Installing the package&lt;/h1&gt; &#xA;&lt;hr&gt; &#xA;&lt;p&gt;To install scAnno,we recommed using devtools:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;#install.packages(&#34;devtools&#34;)  &#xA;devtools::install_github(&#34;liuhong-jia/scAnno&#34;)  &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;hr&gt; &#xA;&lt;h1&gt;Dependencies&lt;/h1&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;R version &amp;gt;= 3.5.0.&lt;/li&gt; &#xA; &lt;li&gt;R packages: Seurat, dplyr, reticulate, MASS, irlba, future, progress, parallel, glmnet, knitr, rmarkdown, devtools&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h1&gt;Guided Tutorials&lt;/h1&gt; &#xA;&lt;p&gt;The human single cell reference profile (hcl.sc.rda) and the mouse single cell reference profile (mca.sc.rda) are built into scAnno.Users can import appropriate reference expression profile according to species. For this tutorial, we apply the human single cell reference profile(hcl.sc.rda) to predict a scRNA-seq dataset(GSE136103) derived from human liver tissue that has been processed by the standard Seurat process and entered as a query object.&lt;/p&gt; &#xA;&lt;h1&gt;Prepare input data&lt;/h1&gt; &#xA;&lt;pre&gt;&lt;code&gt;library(scAnno)&#xA;&#xA;#Import human single cell reference profile.&#xA;data(hcl.sc)&#xA;&#xA;#Import protein coding gene(19814 genes) to filter reference expression profile.&#xA;data(gene.anno)&#xA;&#xA;#Import TCGA bulk data in pan-cancer.&#xA;data(tcga.data.u)&#xA;&#xA;#A liver tissue data set to be annotated.&#xA;data(GSE136103)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Set parameters&lt;/h1&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;&lt;strong&gt;Parameters&lt;/strong&gt;&lt;/th&gt; &#xA;   &lt;th&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;query&lt;/td&gt; &#xA;   &lt;td&gt;Seurat object, which need to be annotated&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;ref.expr&lt;/td&gt; &#xA;   &lt;td&gt;Reference gene expression profile.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;ref.anno&lt;/td&gt; &#xA;   &lt;td&gt;Cell type information of reference profile, corresponding to the above &lt;code&gt;ref.expr&lt;/code&gt;.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;save.markers&lt;/td&gt; &#xA;   &lt;td&gt;Specified the filename of makers need to be saved.Default: markers.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;cluster.col&lt;/td&gt; &#xA;   &lt;td&gt;Column name of clusters to be annotated in meta.data slot of query Seurat object. Default: seurat_clusters.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;factor.size&lt;/td&gt; &#xA;   &lt;td&gt;Factor size for scaling the weight of gene expression. Default: 0.1.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;pvalue.cut&lt;/td&gt; &#xA;   &lt;td&gt;Threshold for filtering cell type-specific markers. Default: 0.01&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;seed.num&lt;/td&gt; &#xA;   &lt;td&gt;Number of seed genes of each cell type for recognizing candidate markers, only used when method = &#39;co.exp&#39;. Default: 10.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;redo.markers&lt;/td&gt; &#xA;   &lt;td&gt;Re-search candidate markers or not. Default: FALSE.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;gene.anno&lt;/td&gt; &#xA;   &lt;td&gt;Gene annotation data.frame. Default: gene.anno.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;permut.num&lt;/td&gt; &#xA;   &lt;td&gt;Number of permutations for estimating p-values of annotations. Default: 100.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;permut.p&lt;/td&gt; &#xA;   &lt;td&gt;Threshold for significance of predicted scores. Default: 0.01.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;show.plot&lt;/td&gt; &#xA;   &lt;td&gt;Show annotated results or not. Default: TRUE.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;verbose&lt;/td&gt; &#xA;   &lt;td&gt;Show running messages or not. Default: TRUE.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;tcga.data.u&lt;/td&gt; &#xA;   &lt;td&gt;bulk RNA-seq data of pan-cancer in TCGA.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: The parameter save.markers means that the marker genes will be stored in a temporary file, so that the next time the same reference expression is used, it will not have to be run again.&lt;/p&gt; &#xA;&lt;h1&gt;single cell annotation&lt;/h1&gt; &#xA;&lt;pre&gt;&lt;code&gt;# Seurat object, which need to be annotated.&#xA;obj.seu &amp;lt;- GSE136103&#xA;&#xA;#Seurat object of reference gene expression profile.&#xA;ref.obj &amp;lt;- hcl.sc&#xA;&#xA;#Reference gene expression profile.&#xA;ref.expr &amp;lt;- GetAssayData(ref.obj, slot = &#39;data&#39;) %&amp;gt;% as.data.frame&#xA;&#xA;#Cell type information of reference profile, corresponding to the above `ref.expr`.&#xA;ref.anno &amp;lt;- Idents(ref.obj) %&amp;gt;% as.character&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Run scAnno to annotate cell&lt;/h1&gt; &#xA;&lt;p&gt;Details of the results is described in the table below.&lt;/p&gt; &#xA;&lt;table&gt; &#xA; &lt;thead&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;th&gt;&lt;strong&gt;output&lt;/strong&gt;&lt;/th&gt; &#xA;   &lt;th&gt;&lt;strong&gt;details&lt;/strong&gt;&lt;/th&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/thead&gt; &#xA; &lt;tbody&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;query&lt;/td&gt; &#xA;   &lt;td&gt;Seurat object, which need to be annotated.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;reference&lt;/td&gt; &#xA;   &lt;td&gt;Seurat object of reference gene expression profile.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;pred.label&lt;/td&gt; &#xA;   &lt;td&gt;Cell types corresponding to each cluster.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA;  &lt;tr&gt; &#xA;   &lt;td&gt;pred.score&lt;/td&gt; &#xA;   &lt;td&gt;The prediction score for each cluster,corresponding to &lt;code&gt;pred.label&lt;/code&gt;.&lt;/td&gt; &#xA;  &lt;/tr&gt; &#xA; &lt;/tbody&gt; &#xA;&lt;/table&gt; &#xA;&lt;pre&gt;&lt;code&gt;results = scAnno(query = obj.seu,&#xA;&#x9;ref.expr = ref.expr,&#xA;&#x9;ref.anno = ref.anno,&#xA;&#x9;save.markers = &#34;markers&#34;,&#xA;&#x9;cluster.col = &#34;seurat_clusters&#34;,&#xA;&#x9;factor.size = 0.1,&#xA;&#x9;pvalue.cut = 0.01,&#xA;&#x9;seed.num = 10,&#xA;&#x9;redo.markers = FALSE,&#xA;&#x9;gene.anno = gene.anno,&#xA;&#x9;permut.num = 100,&#xA;&#x9;permut.p = 0.01,&#xA;&#x9;show.plot = TRUE,&#xA;&#x9;verbose = TRUE,&#xA;&#x9;tcga.data.u = tcga.data.u&#xA;&#x9;)&#xA;[INFO] Checking the legality of parameters&#xA;[INFO] 30 cell types in reference, 35 clusters in query objects&#xA;[INFO] Deconvolution by using RLM method&#xA;[INFO] Logistic regression for cell-type predictions, waiting...&#xA;[INFO] Merging the scores of both models, and assign annotations to clusters&#xA;[INFO] Estimating p-values for annotations...&#xA;[INFO] Finish!&#xA;&#xA;results$query&#xA;An object of class Seurat&#xA;21898 features across 3181 samples within 1 assay&#xA;Active assay: RNA (21898 features, 2830 variable features)&#xA;2 dimensional reductions calculated: pca, umap&#xA;&#xA;&#xA;results$reference&#xA;An object of class Seurat&#xA;17020 features across 5561 samples within 1 assay&#xA;Active assay: RNA (17020 features, 0 variable features)&#xA;&#xA;results$pred.label&#xA;               C0                    C1                    C2&#xA;         &#34;T cell&#34;              &#34;T cell&#34;              &#34;T cell&#34;&#xA;               C3                    C4                    C5&#xA;         &#34;T cell&#34;              &#34;T cell&#34;      &#34;Dendritic cell&#34;&#xA;               C6                    C7                    C8&#xA;         &#34;T cell&#34;              &#34;T cell&#34;              &#34;T cell&#34;&#xA;               C9                   C10                   C11&#xA;       &#34;Monocyte&#34;     &#34;Epithelial cell&#34;          &#34;Macrophage&#34;&#xA;              C12                   C13                   C14&#xA;         &#34;T cell&#34;    &#34;Endothelial cell&#34;            &#34;Monocyte&#34;&#xA;              C15                   C16                   C17&#xA;&#34;Endothelial cell&#34;    &#34;Endothelial cell&#34;             &#34;T cell&#34;&#xA;              C18                   C19                   C20&#xA;     &#34;Macrophage&#34;  &#34;Smooth muscle cell&#34;               &#34;T cell&#34;&#xA;              C21                   C22                   C23&#xA;&#34;Smooth muscle cell&#34;             &#34;B cell&#34;          &#34;Monocyte&#34;&#xA;              C24                   C25                   C26&#xA;         &#34;T cell&#34;              &#34;T cell&#34;  &#34;B cell (Plasmocyte)&#34;&#xA;              C27                   C28                   C29&#xA; &#34;Dendritic cell&#34;    &#34;Endothelial cell&#34;    &#34;Endothelial cell&#34;&#xA;              C30                   C31                   C32&#xA;         &#34;B cell&#34;        &#34;Stromal cell&#34;    &#34;Endothelial cell&#34;&#xA;              C33                   C34&#xA; &#34;Dendritic cell&#34;      &#34;Epithelial cell&#34;&#xA;&#xA;results$pred.score&#xA;[1] 1.0000000 0.9990845 0.9929087 1.0000000 1.0000000&#xA;[6] 0.9935441 1.0000000 0.9908909 0.9992693 1.0000000&#xA;[11] 0.8695469 1.0000000 1.0000000 0.9961219 0.9811003&#xA;[16] 0.9612824 0.9976510 1.0000000 0.9895831 0.9997264&#xA;[21] 1.0000000 0.9998904 1.0000000 0.6339462 1.0000000&#xA;[26] 0.9998541 0.9987952 1.0000000 0.9986113 0.9993699&#xA;[31] 0.9852378 0.6264032 0.9825261 1.0000000 1.0000000&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Visualization&lt;/h1&gt; &#xA;&lt;p&gt;Show annotation results...The left graph represents the UMAP plot of cluster of query datasetï¼Œand the right graph represents the annotation of scAnno.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;DimPlot(results$query, group.by = &#34;seurat_clusters&#34;, label = TRUE, label.size = 6) | DimPlot(results$query, group.by = &#39;scAnno&#39;, label = TRUE , label.size = 6)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/115637576/227700141-f5d7339f-f50f-4e31-8605-0bdb759629c1.png&#34; alt=&#34;1679724660477&#34;&gt;&lt;/p&gt;</summary>
  </entry>
</feed>