<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub C++ Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2025-03-11T01:29:31Z</updated>
  <subtitle>Daily Trending of C++ in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>thomasxm/BOAZ_beta</title>
    <updated>2025-03-11T01:29:31Z</updated>
    <id>tag:github.com,2025-03-11:/thomasxm/BOAZ_beta</id>
    <link href="https://github.com/thomasxm/BOAZ_beta" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Multilayered AV/EDR Evasion Framework&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/cc32c6d6-c7d5-40da-abda-dbb3d62d77de&#34; alt=&#34;image&#34;&gt;&lt;img width=&#34;423&#34; alt=&#34;loglo&#34; src=&#34;https://github.com/thomasxm/Boaz_beta/assets/44269971/a5427ccc-e2ed-4cc3-ab81-084de691b23f&#34;&gt;&lt;/p&gt; &#xA;&lt;img width=&#34;352&#34; alt=&#34;small_logo&#34; src=&#34;https://github.com/thomasxm/Boaz_beta/assets/44269971/99abcf82-7084-47e5-a993-2a712b4ca664&#34;&gt; &#xA;&lt;h1&gt;BOAZ Evasion and Antivirus Testing Tool (for educational purpose)&lt;/h1&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://img.shields.io/badge/C-00599C?style=for-the-badge&amp;amp;logo=c&amp;amp;logoColor=white&#34; alt=&#34;c&#34;&gt; &lt;img src=&#34;https://img.shields.io/badge/Python-00599C?style=for-the-badge&amp;amp;logo=python&amp;amp;logoColor=red&#34; alt=&#34;python&#34;&gt; &lt;img src=&#34;https://img.shields.io/badge/ASSEMBLY-ED8B00?style=for-the-badge&amp;amp;logo=Assembly&amp;amp;logoColor=white&#34; alt=&#34;assembly&#34;&gt; &lt;img src=&#34;https://img.shields.io/badge/Windows-0078D6?style=for-the-badge&amp;amp;logo=windows&amp;amp;logoColor=white&#34; alt=&#34;windows&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/thomasxm/BOAZ_beta/main/#Features&#34;&gt;Features&lt;/a&gt; | &lt;a href=&#34;https://raw.githubusercontent.com/thomasxm/BOAZ_beta/main/#installation&#34;&gt;Installation&lt;/a&gt; | &lt;a href=&#34;https://raw.githubusercontent.com/thomasxm/BOAZ_beta/main/#Usage&#34;&gt;Usage&lt;/a&gt; | &lt;a href=&#34;https://raw.githubusercontent.com/thomasxm/BOAZ_beta/main/#evasion-modules&#34;&gt;Evasion Module&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Presentation&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://www.blackhat.com/us-24/arsenal/schedule/index.html#boaz-yet-another-layered-evasion-tool-evasion-tool-evaluations-and-av-testing-38960&#34;&gt;BlackHat USA, 2024 - Arsenal&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://redteamvillage.io/schedule.html&#34;&gt;DEF CON Red Team Village - Haven Track 1&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;Special thanks to Professor Rich Macfarlane &lt;a href=&#34;https://x.com/rjmacfarlane?lang=en&#34;&gt;@rjmacfarlane&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Description&lt;/h2&gt; &#xA;&lt;p&gt;BOAZ (Bypass, Obfuscate, Adapt, Zero-trace) evasion was inspired by the concept of multi-layered approach which is the evasive version of defence-in-depth first mentioned in “One packer to rule them all” at BH USA14 (&lt;a href=&#34;https://www.blackhat.com/docs/us-14/materials/us-14-Mesbahi-One-Packer-To-Rule-Them-All.pdf&#34;&gt;Swinnen &amp;amp; Mesbahi, 2014&lt;/a&gt;). BOAZ was developed to provide greater control over combinations of evasion methods, enabling more granular evaluations against antivirus and EDR [39].&lt;/p&gt; &#xA;&lt;p&gt;BOAZ aims to bypass the before and during execution phases that span signature, heuristic and behavioural-based detection methods. BOAZ supports x64 binary (PE) or raw playload (.bin) as input. It has been tested on separated Window-11 Enterprise, Windows-10 and windows Server 2022 VMs (version: 22H2, 22621.1992) with 14 Desktop AVs and 7 EDRs installed include Windows Defender, Norton, BitDefender, Sophos and ESET. BOAZ’s modular design facilitates user customisation, enabling researchers to integrate their own toolsets or techniques. BOAZ is written in C++ and C and uses Python3 as the main linker to integrate all modules.&lt;/p&gt; &#xA;&lt;p&gt;For students and researchers in offensive security, no advanced programming or scripting knowledge or skills are required to use BOAZ to generate undetectable polymorphic samples.&lt;/p&gt; &#xA;&lt;p&gt;This tool has an alternative use: it can function as a packer or obfuscator.&lt;/p&gt; &#xA;&lt;h2&gt;Features&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Modular Design&lt;/strong&gt;: Easily extendable with new tactics and techniques by adding scripts.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; &lt;p&gt;&lt;strong&gt;Signature Evasion&lt;/strong&gt;:&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;strong&gt;LLVM IR level Obfuscation&lt;/strong&gt;: Pluto and Akira LLVM-based obfuscation including string encryption and control flow flattening.&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;CodeBase obfuscation&lt;/strong&gt;: &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Function name and string obfuscated from chars: [0-9a-zA-Z_] by 3 randomly selected algorithms: Mt19937, MinstdRand and ranlux48_base.&lt;/li&gt; &#xA;     &lt;li&gt;Shikata Ga Nai (SGN) encoding.&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Payload encoding (T1132)&lt;/strong&gt;: &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;UUID (Universally Unique Identifier)&lt;/li&gt; &#xA;     &lt;li&gt;XOR&lt;/li&gt; &#xA;     &lt;li&gt;MAC&lt;/li&gt; &#xA;     &lt;li&gt;IP4 format&lt;/li&gt; &#xA;     &lt;li&gt;base-64&lt;/li&gt; &#xA;     &lt;li&gt;base-45&lt;/li&gt; &#xA;     &lt;li&gt;base-58&lt;/li&gt; &#xA;     &lt;li&gt;Chacha20&lt;/li&gt; &#xA;     &lt;li&gt;RC4 (SystemFunction32/33)&lt;/li&gt; &#xA;     &lt;li&gt;AES&lt;/li&gt; &#xA;     &lt;li&gt;AES with divide and conquer to bypass logical path hijacking&lt;/li&gt; &#xA;     &lt;li&gt;DES (SystemFunction002)&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Compilation time obfuscation (LLVM, T1140, T1027)&lt;/strong&gt;: &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;&lt;strong&gt;Pluto&lt;/strong&gt;: &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;&lt;code&gt;bcf&lt;/code&gt;: Bogus Control Flow&lt;/li&gt; &#xA;       &lt;li&gt;&lt;code&gt;fla&lt;/code&gt;: Control Flow Flattening&lt;/li&gt; &#xA;       &lt;li&gt;&lt;code&gt;gle&lt;/code&gt;: Global Variable Encryption&lt;/li&gt; &#xA;       &lt;li&gt;&lt;code&gt;mba&lt;/code&gt;: Mixed-Boolean Arithmetic expressions (&lt;a href=&#34;https://theses.hal.science/tel-01623849/file/75068_EYROLLES_2017_archivage.pdf&#34;&gt;MBA&lt;/a&gt;)&lt;/li&gt; &#xA;       &lt;li&gt;&lt;code&gt;sub&lt;/code&gt;: Instruction Substitutions&lt;/li&gt; &#xA;       &lt;li&gt;&lt;code&gt;idc&lt;/code&gt;: Indirect Call Promotion&lt;/li&gt; &#xA;       &lt;li&gt;&lt;code&gt;hlw&lt;/code&gt;: Hide LLVM IR Level Warnings&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;     &lt;li&gt;&lt;strong&gt;Akira&lt;/strong&gt;: &#xA;      &lt;ul&gt; &#xA;       &lt;li&gt;Indirect jumps and encrypted jump targets&lt;/li&gt; &#xA;       &lt;li&gt;Encrypted indirect function calls&lt;/li&gt; &#xA;       &lt;li&gt;Encrypted indirect global variable references&lt;/li&gt; &#xA;       &lt;li&gt;String encryption&lt;/li&gt; &#xA;       &lt;li&gt;Procedure-related control flow flattening&lt;/li&gt; &#xA;      &lt;/ul&gt; &lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Stripped binary (T1027.008)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Two methods to reduce entropy to below threshold by padding Pokémon names or null bytes&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Signed certificate (T1036.001)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Metadata copied from window binary (T1036)&lt;/strong&gt;&lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; &lt;p&gt;&lt;strong&gt;Heuristic Evasion&lt;/strong&gt;:&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Anti-Emulation (T1497)&lt;/strong&gt;: checks based on file system operation, process and network information and “offer you have to refuse” [15, 38]. A simple heuristic that if 2 or more checks are failed, execution will stop.&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Junk API instructions (“no-op” calls, or mimicry attack)&lt;/strong&gt;: 5 benign API functions to vary the API call sequences&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;API Unhooking&lt;/strong&gt;: &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt; &#xA;      &lt;ol&gt; &#xA;       &lt;li&gt;Read the syscall stub from the original ntdll and rewrite the loaded ntdll’s stub&lt;/li&gt; &#xA;      &lt;/ol&gt; &lt;/li&gt; &#xA;     &lt;li&gt; &#xA;      &lt;ol start=&#34;2&#34;&gt; &#xA;       &lt;li&gt;Custom Peruns’ Fart unhooking&lt;/li&gt; &#xA;      &lt;/ol&gt; &lt;/li&gt; &#xA;     &lt;li&gt; &#xA;      &lt;ol start=&#34;3&#34;&gt; &#xA;       &lt;li&gt;Halo’s gate (TartarusGate)&lt;/li&gt; &#xA;      &lt;/ol&gt; &lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Sifu Memory Guard&lt;/strong&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;New memory guard inspired by hardware breakpoints hooking techniques (Loader 48, 49, 51, 52, 57)&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Sleep obfuscation: Custom Ekko (CreateTimerQueueTimer) with arbitrary sleep time invoked at run time&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Stack encryption sleep&lt;/strong&gt;: Local variables and shellcode were being stored on stack. This part of memory is available for scanning both in emulator pre-execution and post-execution.&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;PIC convertor (T1027.009, T1027.002, T1620)&lt;/strong&gt;: &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;The donut (The Wover)&lt;/li&gt; &#xA;     &lt;li&gt;PE2SH (hasherezade)&lt;/li&gt; &#xA;     &lt;li&gt;RC4 custom encrypted converter&lt;/li&gt; &#xA;     &lt;li&gt;Amber (by Ege Balcı)&lt;/li&gt; &#xA;     &lt;li&gt;Shoggoth (by frkngksl)&lt;/li&gt; &#xA;     &lt;li&gt;Stardust (by 5pider)&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA; &lt;li&gt;&lt;input type=&#34;checkbox&#34; disabled&gt; &lt;p&gt;&lt;strong&gt;Behavioral Evasion&lt;/strong&gt;:&lt;/p&gt; &#xA;  &lt;ul&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Various code execution and process injection loaders (T1055, T1106, T1027.007)&lt;/strong&gt;: A variety of loaders for different evasion scenarios&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Two LLVM-obfuscation compilers (T1027)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Output DLL/CPL (side-loading) (T1574.002, T1218.011/002)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Event tracing for windows (ETW) patching (hot patch NtTraceEvent with “xor rax, rax; ret”) (T1562.006)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Patchless ETW bypass:&lt;/strong&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;The patchless method can avoid detection on patching instructions.&lt;/li&gt; &#xA;     &lt;li&gt;EtwEventWrite and EtwEventWriteFull are wrappers call NtTraceEvent, which is a syscall. We can set up a Vectored Exception Handler (VEH) and configure a hardware breakpoint (HWBP) using RtlCaptureContext to capture the thread&#39;s context, then use NtContinue to update it. Inside the VEH handler, when NtTraceEvent is called, we can redirect RIP to the Ret instruction after the Syscall instruction, which is six instructions after the function start address. we also set Rax = 0, thereby bypassing the ETW event completely.&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;API name spoofing via IAT, using CallObfuscator by d35ha&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Parent PID Spoofing (T1134.004)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Process code injection and execution mitigation policy (M1038) (e.g. CFG, XFG, module tampering prevention, Structured Exception Handler Overwrite Protection (SEHOP), etc)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Post-execution self-deletion: output binary can be marked as self-delete upon execution (T1070.004)&lt;/strong&gt;&lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;Post-execution anti-forensic techniques: delete execution traces from various locations that do not require an admin privilege. For example:&lt;/strong&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Modify arbitrary reg key last write time with NtSetInformationKey.&lt;/li&gt; &#xA;     &lt;li&gt;Delete AmCache and ShimCache&lt;/li&gt; &#xA;     &lt;li&gt;Copy $STANDARD_INFORMATION timestamp and zone identifier.&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;New memory scanner evasion techniques:&lt;/strong&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Conventional VEH memory guard&lt;/li&gt; &#xA;     &lt;li&gt;PG (page guard) --&amp;gt; VEH (vectored exception handler)&lt;/li&gt; &#xA;     &lt;li&gt;PG --&amp;gt; VEH --&amp;gt; VCH (vectored continued handler) stealth guard&lt;/li&gt; &#xA;     &lt;li&gt;Virtual table hooking execution guard&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;   &lt;li&gt;&lt;strong&gt;A new code execution and process injection primitive&lt;/strong&gt; &#xA;    &lt;ul&gt; &#xA;     &lt;li&gt;Threadless execution primitive 9S (Manual VEH to VCH execution)&lt;/li&gt; &#xA;     &lt;li&gt;Threadless execution primitive 2B (Threadless virtual table pointer spoofing)&lt;/li&gt; &#xA;    &lt;/ul&gt; &lt;/li&gt; &#xA;  &lt;/ul&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Prerequisites&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Linux environment with Wine configured. Kali Linux or other Debian prefered.&lt;/li&gt; &#xA; &lt;li&gt;CMake, Git, GCC, G++, MingW, LLVM and other build essentials installed.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;strong&gt;Install required packages:&lt;/strong&gt;:&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;git clone https://github.com/thomasxm/Boaz_beta/&#xA;cd Boaz_beta&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;bash requirements.sh&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;ol start=&#34;2&#34;&gt; &#xA; &lt;li&gt;&lt;strong&gt;Cavets&lt;/strong&gt;:&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;p&gt;It should be noted that SGN encoder sometimes can generate bad characters, use with caution. requirements.sh will install LLVM, which takes a while to complete. BOAZ can be run without the -llvm handle; however, it is not optimised without the latter.&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;Example usage:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;python3 Boaz.py -f ~/testing_payloads/notepad_64.exe -o ./alice_notepad.exe -t donut -obf -l 1 -c pluto -e uuid &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Use a built ELF executable in Linux environment:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;./Boaz -f ~/testing_payloads/notepad_64.exe -o ./alice_notepad.exe -t donut -obf -l 1 -c akira -e des -a &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Refer to the help command for more details on usage:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;python3 Boaz.py -h &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-console&#34;&gt;./Boaz -h &#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;usage: Boaz.py [-h] -f INPUT_FILE [-o OUTPUT_FILE] [-divide] [-l LOADER] [-dll] [-cpl] [-sleep]&#xA;               [-a] [-cfg] [-etw] [-j] [-dream [DREAM]] [-u] [-g]&#xA;               [-t {donut,pe2sh,rc4,amber,shoggoth}] [-sd] [-sgn]&#xA;               [-e {uuid,xor,mac,ipv4,base45,base64,base58,aes,des,chacha,rc4,aes2,ascon}]&#xA;               [-c {mingw,pluto,akira}] [-mllvm MLLVM] [-obf] [-obf_api] [-w [SYSWHISPER]]&#xA;               [-entropy {1,2}] [-b [BINDER]] [-wm [WATERMARK]] [-d] [-af] [-icon]&#xA;               [-s [SIGN_CERTIFICATE]]&#xA;&#xA;Process loader and shellcode.&#xA;&#xA;options:&#xA;  -h, --help            show this help message and exit&#xA;  -f INPUT_FILE, --input-file INPUT_FILE&#xA;                        Path to binary.exe&#xA;  -o OUTPUT_FILE, --output-file OUTPUT_FILE&#xA;                        Optional: Specify the output file path and name. If not provided, a&#xA;                        random file name will be used in the ./output directory.&#xA;  -divide               Divide flag (True or False)&#xA;  -l LOADER, --loader LOADER&#xA;                        Loader number (must be a non-negative integer)&#xA;  -dll                  Compile the output as a DLL instead of an executable, can be run with&#xA;                        rundll32.exe&#xA;  -cpl                  Compile the output as a CPL instead of an executable, can be run with&#xA;                        control.exe&#xA;  -sleep                Obfuscation Sleep flag with random sleep time (True or False)&#xA;  -a, --anti-emulation  Anti-emulation flag (True or False)&#xA;  -cfg, --control-flow-guard&#xA;                        Disable Control Flow Guard (CFG) for the loader template.&#xA;  -etw                  Enable ETW patching functionality&#xA;  -j, --junk-api        Insert junk API function call at a random location in the main function&#xA;                        (5 API functions)&#xA;  -dream [DREAM]        Optional: Sleep with encrypted stacks for specified time in&#xA;                        milliseconds. Defaults to 1500ms if not provided.&#xA;  -u, --api-unhooking   Enable API unhooking functionality&#xA;  -g, --god-speed       Enable advanced unhooking technique Peruns Fart (God Speed)&#xA;  -t {donut,pe2sh,rc4,amber,shoggoth}, --shellcode-type {donut,pe2sh,rc4,amber,shoggoth}&#xA;                        Shellcode generation tool: donut (default), pe2sh, rc4, amber or&#xA;                        shoggoth&#xA;  -sd, --star_dust      Enable Stardust PIC generator, input should be .bin&#xA;  -sgn, --encode-sgn    Encode the generated shellcode using sgn tool.&#xA;  -e {uuid,xor,mac,ipv4,base45,base64,base58,aes,des,chacha,rc4,aes2,ascon}, --encoding {uuid,xor,mac,ipv4,base45,base64,base58,aes,des,chacha,rc4,aes2,ascon}&#xA;                        Encoding type: uuid, xor, mac, ip4, base45, base64, base58, AES, DES,&#xA;                        chacha, RC4 and aes2. aes2 is a devide and conquer AES decryption to&#xA;                        bypass logical path hijacking. Other encoders are under development.&#xA;  -c {mingw,pluto,akira}, --compiler {mingw,pluto,akira}&#xA;                        Compiler choice: mingw (default), pluto, or akira&#xA;  -mllvm MLLVM          LLVM passes for Pluto or Akira compiler&#xA;  -obf, --obfuscate     Enable obfuscation of codebase (source code)&#xA;  -obf_api, --obfuscate-api&#xA;                        Enable obfuscation of API calls in ntdll and kernel32.&#xA;  -w [SYSWHISPER], --syswhisper [SYSWHISPER]&#xA;                        Optional: Use SysWhisper for direct syscalls. 1 for random syscall jumps&#xA;                        (default), 2 for compiling with MingW and NASM.&#xA;  -entropy {1,2}        Entropy level for post-processing the output binary. 1 for null_byte.py,&#xA;                        2 for pokemon.py&#xA;  -b [BINDER], --binder [BINDER]&#xA;                        Optional: Path to a utility for binding. Defaults to binder/calc.exe if&#xA;                        not provided.&#xA;  -wm [WATERMARK], --watermark [WATERMARK]&#xA;                        Add watermark to the binary (0 for False, 1 or no value for True)&#xA;  -d, --self-deletion   Enable self-deletion of the binary after execution&#xA;  -af, --anti-forensic  Enable anti-forensic functions to clean the execution traces.&#xA;  -icon                 Enable icon for the output binary.&#xA;  -s [SIGN_CERTIFICATE], --sign-certificate [SIGN_CERTIFICATE]&#xA;                        Optional: Sign the output binary and copy metadata from another binary&#xA;                        to your output. If a website or filepath is provided, use it. Defaults&#xA;                        to interactive mode if no argument is provided.&#xA;&#xA;    loader modules:&#xA;    1.  Custom Stack syscalls with threadless execution (local injection)&#xA;    2.  APC test alert&#xA;    3.  Sifu syscall&#xA;    4.  UUID manual injection&#xA;    5.  Remote mockingJay&#xA;    6.  Local thread hijacking &#xA;    7.  Function pointer invoke local injection&#xA;    8.  Ninja_syscall2 &#xA;    9.  RW local mockingJay&#xA;    10. Ninja syscall 1&#xA;    11. Sifu Divide and Conquer syscall&#xA;    12. [Your custom loader here]&#xA;    14. Exit the process without executing the injected shellcode&#xA;    15. Syswhispers2 classic native API calls&#xA;    16. Classic userland API calls (VirtualAllcEx --&amp;gt; WriteProcessMemory --&amp;gt; CreateRemoteThread)&#xA;    17. Sifu Syscall with Divide and Conquer&#xA;    18. Classic userland API calls with WriteProcessMemoryAPC&#xA;    19. DLL overloading &#xA;    20. Stealth new Injection (WriteProcessMemoryAPC + DLL overloading)&#xA;    21.&#xA;    22.&#xA;    23.&#xA;    24.&#xA;    25.&#xA;    26. Stealth new Injection (3 WriteProcessMemoryAPC variants + custom DLL overloading + custom dynamic API-hashing)&#xA;    27. Stealth new Injection (3 Custom WriteProcessMemoryAPC variants + custom DLL overloading + custom dynamic API-hashing + Halo&#39;s gate patching)&#xA;    28. Halo&#39;s gate patching syscall injection + Custom write code to Process Memory by either MAC or UUID convertor + invisible dynamic loading (no loadModuleHandle, loadLibrary, GetProcessAddress)&#xA;    31. MAC address injection&#xA;    32. Stealth new injection (Advanced)&#xA;    33. Indirect Syscall + Halo gate + Custom Call Stack&#xA;    37. Stealth new loader (Advanced, evade memory scan)&#xA;    38. A novel PI with APC write method and phantom DLL overloading execution (CreateThread pointed to a memory address of UNMODIFIED DLL.)&#xA;    39. Custom Stack PI (remote) with threadless execution&#xA;    40. Custom Stack PI (remote) Threadless DLL Notification Execution&#xA;    41. Custom Stack PI (remote) with Decoy code execution&#xA;    48. Stealth new loader + Syscall breakpoints handler with memory guard AKA Sifu breakpoint handler (hook on NtResumeThread)&#xA;    49. Stealth new loader + Syscall breakpoints handler with memory guard evasion AKA Sifu breakpoint handler (hook on NtCreateThreadEx, with Decoy address, PAGE_NOACCESS and XOR)&#xA;    51. Stealth new loader + Syscall breakpoints handler with memory guard evasion AKA Sifu breakpoint handler (hook on ntdll!RtlUserThreadStart and kernel32!BaseThreadInitThunk, with Decoy address, PAGE_NOACCESS and XOR)&#xA;    52. RoP gadgets as the trampoline code to execute the magic code. &#xA;    53.&#xA;    54. Stealth new loader + Exception handler + Syscall breakpoints handler with memory guard evasion AKA Sifu breakpoint handler (hook on ntdll!RtlUserThreadStart and kernel32!BaseThreadInitThunk, with Decoy address, PAGE_NOACCESS and XOR)&#xA;    56. This is a fork of Loader 37 with additional features. If -ldr flag is not provided, loader will add module (contains the shellcode) to the PEB module lists manually using code from Dark library. &#xA;    57. A fork of loader 51 with XOR replaced with RC4 encryption offered by SystemFunction032/033.&#xA;    58. VEH add hanlder. Add ROP Trampoliine to the kernel32!BaseThreadInitThunk for additional complexity to analyse. &#xA;    59. SEH add hanlder. Add ROP Trampoliine to the kernel32!BaseThreadInitThunk for additional complexity to analyse.&#xA;    60. Use Page guard to trigger first exception to set debug registers without using NtGetContextThread --&amp;gt; NtSetContextThread&#xA;    61. Use Page guard to trigger first exception to set debug registers without using NtGetContextThread --&amp;gt; NtSetContextThread + Use VEH to set up breakpoints Dr0~Dr3, Dr7. Then use VCH to execute the code. So, no registers and stack pointer and instruction pointer changed in VEH. &#xA;    62. New loader in progress.&#xA;    63. Remote version of custom module loading loader 37. Remote module injection.&#xA;    64.&#xA;    65. Advanced VMT hooking with custom module loader 37. &#xA;    66. A fork of L-65, with additional features such as optional PPID spoofing, multiple shellcode and DLL injection mitigation policies enabled on remote process.&#xA;    67. A fork of L-65, with strange trampoline code to execute the magic code in both local and remote process. &#xA;    68. New loader in progress.&#xA;    69. A fork of L-61, manually set VEH and VCH and clean ups by remove the CrossProcessFlags from TEB-&amp;gt;PEB.&#xA;    ...&#xA;    73. VT Pointer threadless process injection, can be invoked with decoy address to any function or triggered by injected application (e.g. explorer). Memory guard available with RC4 entryption and PAGE_NOACCESS.&#xA;    74. VT Pointer threadless process injection, can be invoked with decoy address to any function or triggered by injected application (e.g. explorer). Memory guard available with RC4 entryption and PAGE_NOACCESS. The VirtualProtect is being called within pretext.&#xA;    75. Dotnet JIT threadless process injection. (coming soon)&#xA;    76. Module List PEB Entrypoint threadless process injection.  (coming soon)&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;Evasion Modules&lt;/h2&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/thomasxm/Boaz_beta/assets/44269971/e5fd38a1-fd95-47f9-a7b0-e85710596902&#34; alt=&#34;Evasion101 (1)&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/b42a7ab9-7a14-4b16-8538-df20a334e234&#34; alt=&#34;layered&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Process Injection Loaders&lt;/h2&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/277a53f9-cfaa-4315-88f7-80b0360fee41&#34; alt=&#34;Picture 1&#34;&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Threadless Code Execution Primitives and Memory Scanner Evasion&lt;/h2&gt; &#xA;&lt;p&gt;White paper link: Coming soon...&lt;/p&gt; &#xA;&lt;img width=&#34;400&#34; alt=&#34;Sifu&#34; src=&#34;https://github.com/user-attachments/assets/935ee41b-02cd-46dc-8d29-2fd67d365b7f&#34;&gt; &#xA;&lt;h3&gt;x86-64 Calling Convention&lt;/h3&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;First four arguments of a callee function: &lt;code&gt;Rcx&lt;/code&gt;, &lt;code&gt;Rdx&lt;/code&gt;, &lt;code&gt;R8&lt;/code&gt;, and &lt;code&gt;R9&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;Additional arguments stored on the stack starting from &lt;code&gt;(Rsp + 0x28)&lt;/code&gt;.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Example:&lt;/h2&gt; &#xA;&lt;p&gt;Boaz evasion wrapped Mimikatz.exe x64 release. The detection rate for wrapped Mimikatz is zero on Jotti:&lt;/p&gt; &#xA;&lt;img width=&#34;1197&#34; alt=&#34;Screenshot 2024-02-28 at 14 46 17&#34; src=&#34;https://github.com/user-attachments/assets/312fdffe-7024-4e21-8830-07bcea3004c9&#34;&gt; &#xA;&lt;p&gt;&lt;strong&gt;Figure: Jotti scan results of boaz_mimi&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/88d5d56a-c6cb-4cd4-ab7a-6347674c90a6&#34; alt=&#34;Screenshot 2025-03-09 at 21 22 36&#34;&gt; &lt;strong&gt;Figure: Kaspersky EDR versus Mimikatz packed by Boaz&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/9247374b-2148-4aaf-80a6-1bc8fdac04f7&#34; alt=&#34;Screenshot 2025-03-08 at 19 05 30&#34;&gt; &lt;strong&gt;Figure: Kaspersky EDR versus Meterpreter reverse shell packed by Boaz&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/ce9844c6-16fa-4b9e-bd80-5defd755d9a8&#34; alt=&#34;Screenshot 2025-03-08 at 18 31 38&#34;&gt; &lt;strong&gt;Figure: Sophos EDR versus Mimikatz packed by Boaz&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Roadmap&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;strong&gt;Docker&lt;/strong&gt;: Make it available with Docker without installation&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Add a GUI for users&lt;/strong&gt;: Web UI or Python UI.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Loaders&lt;/strong&gt;: Implement more loader templates (process injection and code execution methods) with a divide and conquer option available.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Rust&lt;/strong&gt;: Loader should be language agnostic. Rust loader would be a good alternative.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;COFF loaders&lt;/strong&gt;: Implement COFF loader suppport.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Obfuscation&lt;/strong&gt;: Enhancing obfuscation methods and integrating new LLVM passes.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Shellcode Generation&lt;/strong&gt;: Expand to include more techniques, e.g., PIC generated from arbitrary command, and offer users the choice of shellcode generation technique.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;PIC Chain Reactions&lt;/strong&gt;: ....&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Sleep Techniques&lt;/strong&gt;: Implementing additional anti-emulation and sleep techniques, like encrypting heap and stack while sleeping during pre-shellcode-execution phase.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Syscall&lt;/strong&gt;: Improving Syswhisper2 integration for signature reduction. (e.g. on detecting virtual machine introspection and dynamic binary instrumentation)&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Compilation&lt;/strong&gt;: Integrate additional compiler options like Cosmopolitan compiler.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;File format&lt;/strong&gt;: Extend more file format supports, so that user can execute sample with signed utilities and more options.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;modularised modules&lt;/strong&gt;: Although Boaz has all its implementations modularised in concept, it is not &#39;actually&#39; modularised in its current beta version. Owing to the fact that this tool is a side project for my dissertation, I need to find time to separate each function into an actual module and ensure that each is presented with a template so that users can add a new technique and integrate it into the main program without the need to change the main program or other modules.&lt;/li&gt; &#xA; &lt;li&gt;&lt;strong&gt;Templates&lt;/strong&gt;: using YAML and JSON files to configure and modularise the program.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;We welcome contributions to improve the Boaz Evasion Tool. Please review &lt;code&gt;CONTRIBUTING.md&lt;/code&gt; for guidelines on how to submit contributions.&lt;/p&gt; &#xA;&lt;p&gt;We welcome submissions to &lt;a href=&#34;https://github.com/thomasxm/Boaz_beta/pulls&#34;&gt;pull requests&lt;/a&gt; and &lt;a href=&#34;https://github.com/thomasxm/Boaz_beta/issues&#34;&gt;issues&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This is in development, please feel free to reach out to me @thomasmeeeee on X for any suggestions!&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;This project is licensed under the MIT License - see the &lt;code&gt;LICENSE&lt;/code&gt; file for details.&lt;/p&gt; &#xA;&lt;h2&gt;Acknowledgments&lt;/h2&gt; &#xA;&lt;p&gt;A special thanks to the researchers and developers whose work has inspired, contributed to, and made this tool possible. All credit goes to the original authors of the techniques and tools:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/klezVirus/inceptor/raw/main/slides/Inceptor%20-%20Bypass%20AV-EDR%20solutions%20combining%20well%20known%20techniques.pdf&#34;&gt;Inceptor - Bypass AV-EDR solutions combining well known techniques&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/TheWover/donut&#34;&gt;The donut&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/scrt/avcleaner&#34;&gt;avcleaner&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/bluesadi/Pluto&#34;&gt;Pluto&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/KomiMoe/Arkari&#34;&gt;Arkari&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/hasherezade/pe_to_shellcode&#34;&gt;pe_to_shellcode&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/SaadAhla/Shellcode-Hide&#34;&gt;Shellcode-Hide&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/r00tkiter/PE2Shellcode&#34;&gt;PE2Shellcode&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/thomasxm/amber&#34;&gt;Amber&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/frkngksl/Shoggoth&#34;&gt;Shoggoth&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/optiv/Mangle&#34;&gt;Mangle&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/d35ha/CallObfuscator&#34;&gt;CallObfuscator&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/Cracked5pider/Stardust/tree/main&#34;&gt;Stardust&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/paranoidninja/CarbonCopy&#34;&gt;Carbon Copy&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/EgeBalci/sgn&#34;&gt;Shikata ga nai&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://www.x86matthew.com/&#34;&gt;x86matthew&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://github.com/bats3c/DarkLoadLibrary&#34;&gt;DarkLoadLibrary&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;&lt;a href=&#34;https://www.ired.team/&#34;&gt;Red Team Notes&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;And many more blogs and articles. Please feel free to add more...&lt;/p&gt; &#xA;&lt;h2&gt;Contact&lt;/h2&gt; &#xA;&lt;p&gt;For any queries or contributions, please contact the repository owner.&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://github.com/thomasxm/Boaz_beta/assets/44269971/0118a0cf-9cd9-48df-8f20-37a059e4bf6a&#34; alt=&#34;Boaz_logo3&#34;&gt;&lt;/p&gt;</summary>
  </entry>
</feed>