<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub C++ Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-04-16T01:31:26Z</updated>
  <subtitle>Daily Trending of C++ in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>st4ckh0und/AntiOreans-CodeDevirtualizer</title>
    <updated>2023-04-16T01:31:26Z</updated>
    <id>tag:github.com,2023-04-16:/st4ckh0und/AntiOreans-CodeDevirtualizer</id>
    <link href="https://github.com/st4ckh0und/AntiOreans-CodeDevirtualizer" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A proof-of-concept devirtualization engine for Themida.&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;AntiOreans-CodeDevirtualizer&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/st4ckh0und/AntiOreans-CodeDevirtualizer/LICENSE.md&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/License-MIT-green.svg?sanitize=true&#34; alt=&#34;MIT License&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://www.oreans.com/ThemidaAllWhatsNew.php&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/Themida-2%2e2%2e5%2e0%20%2f%202%2e2%2e6%2e0%20%2f%202%2e2%2e7%2e0-red.svg?sanitize=true&#34; alt=&#34;Themida Version&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://raw.githubusercontent.com/st4ckh0und/AntiOreans-CodeDevirtualizer/main/#&#34;&gt;&lt;img src=&#34;https://img.shields.io/badge/Machine-FISH-007bb8.svg?sanitize=true&#34; alt=&#34;Themida Machine&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Introduction&lt;/h2&gt; &#xA;&lt;p&gt;A proof-of-concept devirtualization engine for Themida, written as part of my Master&#39;s Thesis.&lt;/p&gt; &#xA;&lt;p&gt;The engine is written as a plugin for IDA 6.8, and only supports early versions of the FISH virtual machine architecture (2.2.5.0, 2.2.6.0, 2.2.7.0).&lt;/p&gt; &#xA;&lt;p&gt;The source code is provided exclusively for educational purposes, and I take no responsibility for what you do with it.&lt;/p&gt; &#xA;&lt;p&gt;My Master&#39;s Thesis is further included as a &lt;a href=&#34;https://raw.githubusercontent.com/st4ckh0und/AntiOreans-CodeDevirtualizer/Masters%20Thesis.pdf&#34;&gt;PDF&lt;/a&gt;, which you may read to better understand the subject and project.&lt;/p&gt; &#xA;&lt;h2&gt;Dependencies&lt;/h2&gt; &#xA;&lt;p&gt;The project has been developed using &lt;a href=&#34;https://github.com/vmt/udis86&#34;&gt;udis86&lt;/a&gt; for disassembling, albeit with a few fixes.&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>v8/v8</title>
    <updated>2023-04-16T01:31:26Z</updated>
    <id>tag:github.com,2023-04-16:/v8/v8</id>
    <link href="https://github.com/v8/v8" rel="alternate"></link>
    <summary type="html">&lt;p&gt;The official mirror of the V8 Git repository&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;V8 JavaScript Engine&lt;/h1&gt; &#xA;&lt;p&gt;V8 is Google&#39;s open source JavaScript engine.&lt;/p&gt; &#xA;&lt;p&gt;V8 implements ECMAScript as specified in ECMA-262.&lt;/p&gt; &#xA;&lt;p&gt;V8 is written in C++ and is used in Google Chrome, the open source browser from Google.&lt;/p&gt; &#xA;&lt;p&gt;V8 can run standalone, or can be embedded into any C++ application.&lt;/p&gt; &#xA;&lt;p&gt;V8 Project page: &lt;a href=&#34;https://v8.dev/docs&#34;&gt;https://v8.dev/docs&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h1&gt;Getting the Code&lt;/h1&gt; &#xA;&lt;p&gt;Checkout &lt;a href=&#34;http://www.chromium.org/developers/how-tos/install-depot-tools&#34;&gt;depot tools&lt;/a&gt;, and run&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;    fetch v8&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This will checkout V8 into the directory &lt;code&gt;v8&lt;/code&gt; and fetch all of its dependencies. To stay up to date, run&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;    git pull origin&#xA;    gclient sync&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;For fetching all branches, add the following into your remote configuration in &lt;code&gt;.git/config&lt;/code&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;    fetch = +refs/branch-heads/*:refs/remotes/branch-heads/*&#xA;    fetch = +refs/tags/*:refs/tags/*&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h1&gt;Contributing&lt;/h1&gt; &#xA;&lt;p&gt;Please follow the instructions mentioned at &lt;a href=&#34;https://v8.dev/docs/contribute&#34;&gt;v8.dev/docs/contribute&lt;/a&gt;.&lt;/p&gt;</summary>
  </entry>
  <entry>
    <title>GANGE666/xVMP</title>
    <updated>2023-04-16T01:31:26Z</updated>
    <id>tag:github.com,2023-04-16:/GANGE666/xVMP</id>
    <link href="https://github.com/GANGE666/xVMP" rel="alternate"></link>
    <summary type="html">&lt;p&gt;&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;xVMP&lt;/h1&gt; &#xA;&lt;p&gt;xVMP is an LLVM IR-based code virtualization tool, which fulfilled a scalable and virtualized instruction-hardened obfuscation. It supports multiple programming languages, and architectures. It is also compatible with existing LLVM IR-based obfuscation schemes (such as Obfuscator-LLVM).&lt;/p&gt; &#xA;&lt;p&gt;xVMP is developer friendly. You only need to add annotations to the to-be-protected function in the source code, and xVMP can perform virtualization protection on the function during compilation.&lt;/p&gt; &#xA;&lt;p&gt;The website &lt;a href=&#34;http://xvmp.homes/&#34;&gt;http://xvmp.homes/&lt;/a&gt; which contains the detailed usage document and video is also available.&lt;/p&gt; &#xA;&lt;h2&gt;Table of Contents&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#background&#34;&gt;Background&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#install&#34;&gt;Install&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#usage&#34;&gt;Usage&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#examples&#34;&gt;Examples&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#Precautions&#34;&gt;Precautions&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#maintainers&#34;&gt;Maintainers&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#contributing&#34;&gt;Contributing&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Background&lt;/h2&gt; &#xA;&lt;p&gt;Virtualization-based software protection schemes protect the logic and data in the program by converting the original code into a new bytecode based on the custom instruction set architecture (ISA). The new bytecode is emulated via an embedded virtual machine (i.e. interpreter) at runtime. Since a lot of reverse engineering is required for attackers to learn the custom ISA, virtualization obfuscation could hide valuable assets in software.&lt;/p&gt; &#xA;&lt;p&gt;To meet the requirements in real-world software development, the virtualization obfuscator should achieve the following three goals:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;i) Strong protection, which means that virtualized code should resist various de-virtualization techniques such as symbolic execution, frequency analysis, etc.&lt;/li&gt; &#xA; &lt;li&gt;ii) Compatibility, which means the virtualization obfuscator should support different source code types, platforms, instruction sets, and various code obfuscation schemes.&lt;/li&gt; &#xA; &lt;li&gt;iii) Ease of use, i.e., developers only need to make simple marks to complete the obfuscation.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;Unfortunately, the state-of-the-art virtualization obfuscators cannot fulfill the above requirements. On the one hand, they lack effective protection for virtualization instructions (Tigress only xors a constant for all instructions) and many works in recent years have broken through them by using frequency analysis and symbolic execution. On the other hand, VMProtect and Themida only support virtualize executables on X86 and X64 architectures, and they are not open source. The most advanced academic virtualization scheme Tigress can only support C language source code, and since its input must be a single file containing the full program source code, it is difficult to blend in the software development cycle.&lt;/p&gt; &#xA;&lt;p&gt;Therefore, we present xVMP, an LLVM-based code virtualization obfuscator fulfills these goals. It incorporates the obfuscation process of code virtualization into the compilation to mask the effects of different architectures and program languages. xVMP generates virtualized code based on LLVM IR and embeds the interpreter of virtualized code into the IR and compiles to an executable. To enhance the security, xVMP encrypts virtualized instructions in each basic block and decrypts them at runtime to enhance the security of obfuscation. In addition, it supports specified function obfuscation. xVMP identifies the function annotations marked by the developer in the source code to locate the function to protect.&lt;/p&gt; &#xA;&lt;h2&gt;Install&lt;/h2&gt; &#xA;&lt;h3&gt;Prebuilt Binaries&lt;/h3&gt; &#xA;&lt;p&gt;Please download the latest prebuilt binaries from &lt;a href=&#34;https://github.com/GANGE666/xVMP/releases&#34;&gt;Release&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Building from source with Obfuscator-LLVM&lt;/h3&gt; &#xA;&lt;p&gt;The code in the master branch is xVMP mixed with obfuscator-llvm based on LLLVM 8.0.&lt;/p&gt; &#xA;&lt;ol start=&#34;0&#34;&gt; &#xA; &lt;li&gt; &lt;p&gt;Prerequisites. Same as &lt;a href=&#34;https://llvm.org/docs/GettingStarted.html#requirements&#34;&gt;LLVM building requirements&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;Use the building script. It will build xVMP and compatible obfuscator-llvm in the &lt;code&gt;build&lt;/code&gt; directory.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ bash ./build.sh&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Building as a plugin for LLVM&lt;/h3&gt; &#xA;&lt;p&gt;TBD&lt;/p&gt; &#xA;&lt;h3&gt;Docker&lt;/h3&gt; &#xA;&lt;p&gt;TBD&lt;/p&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;p&gt;You only need to add the annotation before the definition of the to-be-protected function. As shown in the following code.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;__attribute((__annotate__(&#34;vmp&#34;))) &#x9;// add this annotation&#xA;void gen_deckey (unsigned char *decrypt_key, char *passwd) {&#xA;  // generate decrypt key from the password&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then compile the source code using the LLVM toolchain with xVMP.&lt;/p&gt; &#xA;&lt;p&gt;But please heed these &lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/#Precautions&#34;&gt;precautions&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Examples&lt;/h2&gt; &#xA;&lt;p&gt;We have prepared three examples in the &lt;a href=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/examples/&#34;&gt;examples&lt;/a&gt; directory to show how to use xVMP. In these examples, you can use xVMP alone or use xVMP with ollvm to protect specific functions easily, and you can also see the advantages of xVMP over Tigress.&lt;/p&gt; &#xA;&lt;p&gt;We use &lt;code&gt;/examples/test/test2&lt;/code&gt; as an example. Part of the source code is shown below.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#ifdef ENABLE_OLLVM&#xA;__attribute((__annotate__((&#34;fla&#34;))))&#xA;__attribute((__annotate__((&#34;bcf&#34;))))&#xA;#endif&#xA;#ifdef ENABLE_XVMP&#xA;__attribute((__annotate__((&#34;vmp&#34;))))&#xA;#endif&#xA;uint32_t tea_decrypt (uint32_t* v) {&#xA;    uint32_t v0=v[0], v1=v[1], sum=0xC6EF3720, i;  /* set up */&#xA;    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */&#xA;    uint32_t k0=0x94C36D33, k1=0x164512A3, k2=0xFEEEDA59, k3=0x87BD19BD;   /* cache key */&#xA;    for (i=0; i&amp;lt;32; i++) {                         /* basic cycle start */&#xA;        v1 -= ((v0&amp;lt;&amp;lt;4) + k2) ^ (v0 + sum) ^ ((v0&amp;gt;&amp;gt;5) + k3);&#xA;        v0 -= ((v1&amp;lt;&amp;lt;4) + k0) ^ (v1 + sum) ^ ((v1&amp;gt;&amp;gt;5) + k1);&#xA;        sum -= delta;&#xA;    }                                              /* end cycle */&#xA;    v[0]=v0; v[1]=v1;&#xA;    return v[0];&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;We will show the protection effects after four compilation schemes:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Original build&lt;/li&gt; &#xA; &lt;li&gt;Tigress protection&lt;/li&gt; &#xA; &lt;li&gt;xVMP protection&lt;/li&gt; &#xA; &lt;li&gt;xVMP combined with Obfuscator-LLVM protection&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h4&gt;Original build&lt;/h4&gt; &#xA;&lt;p&gt;Use &lt;code&gt;clang test2.c -o test2&lt;/code&gt; to build an unprotected program. The unprotected programs can be easily analyzed for original logic using reverse engineering tools, like IDA Pro.&lt;/p&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/imgs/image-20230212154152017.png&#34; alt=&#34;image-20230212154152017&#34; style=&#34;zoom:50%;&#34;&gt; &#xA;&lt;h4&gt;Tigress Protection&lt;/h4&gt; &#xA;&lt;p&gt;Use &lt;code&gt;tigress --Environment=x86_64:Linux:Gcc:4.6 --Seed=0 --Transform=Virtualize --VirtualizeDispatch=interpolation --Functions=tea_decrypt --VirtualizeEncodeByteArray=true test2.c --out=test2_tigress.c&lt;/code&gt; to protect the &lt;code&gt;test2&lt;/code&gt; with Tigress.&lt;/p&gt; &#xA;&lt;p&gt;In IDA, we can clearly see that the virtualized code only XORs a constant for protection, which is very easy to be broken. The length of virtualized function is 0x7CA.&lt;/p&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/imgs/image-20230212154624109.png&#34; alt=&#34;image-20230212154624109&#34; style=&#34;zoom:50%;&#34;&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/imgs/image-20230212154747677.png&#34; alt=&#34;image-20230212154747677&#34; style=&#34;zoom:50%;&#34;&gt; &#xA;&lt;h4&gt;xVMP Protection&lt;/h4&gt; &#xA;&lt;p&gt;Use &lt;code&gt;clang -DENABLE_XVMP test2.c -o test2_xvmp &lt;/code&gt; to protect the &lt;code&gt;test2&lt;/code&gt; with xVMP.&lt;/p&gt; &#xA;&lt;p&gt;The virtualization code of program protected by xVMP is more hardened and protected, and the interpreter is more complicated.&lt;/p&gt; &#xA;&lt;p&gt;The length of function &lt;code&gt;vm_interpreter_tea_decrypt&lt;/code&gt; is 0x5A71.&lt;/p&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/imgs/image-20230212155037488.png&#34; alt=&#34;image-20230212155037488&#34; style=&#34;zoom:50%;&#34;&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/imgs/image-20230212155055490.png&#34; alt=&#34;image-20230212155055490&#34; style=&#34;zoom:50%;&#34;&gt; &#xA;&lt;h4&gt;xVMP+Obfuscator-LLVM&lt;/h4&gt; &#xA;&lt;p&gt;Use &lt;code&gt;clang -DENABLE_XVMP -DENABLE_OLLVM test2.c -o test2_xvmp_ollvm&lt;/code&gt; to protect the &lt;code&gt;test2&lt;/code&gt; with xVMP and obfuscator-LLVM.&lt;/p&gt; &#xA;&lt;p&gt;The protection of xVMP+oLLVM makes it more difficult for attackers to be reversed.&lt;/p&gt; &#xA;&lt;p&gt;The length of function &lt;code&gt;vm_interpreter_tea_decrypt&lt;/code&gt; is 0x149F2.&lt;/p&gt; &#xA;&lt;img src=&#34;https://raw.githubusercontent.com/GANGE666/xVMP/master/imgs/image-20230212155110480.png&#34; alt=&#34;image-20230212155110480&#34; style=&#34;zoom:50%;&#34;&gt; &#xA;&lt;h2&gt;Precautions&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Code optimization. Virtualization is unsound because code optimization may introduces instructions that xVMP cannot handle. So please compile with the &lt;code&gt;-O0&lt;/code&gt; option, or optimize after xVMP virtualization is complete. Please do not use the &lt;code&gt;-O3&lt;/code&gt;, &lt;code&gt;-O2&lt;/code&gt; option.&lt;/li&gt; &#xA; &lt;li&gt;Please do not use the &lt;code&gt;-g&lt;/code&gt; option. Because it will introduce instructions such as &lt;code&gt;@llvm.dbg.declare&lt;/code&gt;.&lt;/li&gt; &#xA; &lt;li&gt;If you want to modify the interpreter, please run the &lt;code&gt;scripts/rebuild-with-interpreter.sh&lt;/code&gt; script after installing python2 to update the hard-coded interpreter. The interpreter source code is in the &lt;code&gt;src/xVMPInterpreter&lt;/code&gt; directory.&lt;/li&gt; &#xA; &lt;li&gt;SWITCH, PHI statement is not support yet.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Maintainers&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/GANGE666&#34;&gt;@G6&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;Feel free to dive in! &lt;a href=&#34;https://github.com/GANGE666/xVMP/issues/new&#34;&gt;Open an issue&lt;/a&gt; or submit PRs.&lt;/p&gt;</summary>
  </entry>
</feed>