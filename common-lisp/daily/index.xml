<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Common Lisp Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-12-24T01:30:44Z</updated>
  <subtitle>Daily Trending of Common Lisp in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>rotatef/gettext</title>
    <updated>2023-12-24T01:30:44Z</updated>
    <id>tag:github.com,2023-12-24:/rotatef/gettext</id>
    <link href="https://github.com/rotatef/gettext" rel="alternate"></link>
    <summary type="html">&lt;p&gt;A port of gettext runtime to Common Lisp&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;gettext for Common Lisp&lt;/h1&gt; &#xA;&lt;p&gt;This is a port of the GNU gettext runtime to Common Lisp. For more information about GNU gettext see &lt;a href=&#34;http://www.gnu.org/software/gettext/&#34;&gt;http://www.gnu.org/software/gettext/&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Highlights&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Implemented in Common Lisp. No need for any C libraries.&lt;/li&gt; &#xA; &lt;li&gt;Use GNU gettext tools during development.&lt;/li&gt; &#xA; &lt;li&gt;Supports multithreaded applications with different langauge in each thread.&lt;/li&gt; &#xA; &lt;li&gt;Translations can be embedded into compiled applications.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Download and installation&lt;/h2&gt; &#xA;&lt;p&gt;The libarary has some dependencies, so the easiest way is to use Quicklisp, see &lt;a href=&#34;http://www.quicklisp.org/&#34;&gt;http://www.quicklisp.org/&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Get the gettext sources from GitHub:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;cd quicklisp/local-projects&#xA;git clone git://github.com/copyleft/gettext.git&#xA;ln -s gettext/gettext-example .&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Then load it:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(ql:quickload &#34;gettext&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Eventually gettext will become part of quicklisp, and only the last step will be neccary (unless you need the latest version).&lt;/p&gt; &#xA;&lt;h2&gt;How to use&lt;/h2&gt; &#xA;&lt;p&gt;This library reimplements only the runtime part of GNU gettext in Common Lisp. In order to successfully use this library you need to install the GNU gettext tools. No GNU gettext tools or library are needed at runtime.&lt;/p&gt; &#xA;&lt;p&gt;The easiest way to get started is to look at the sample application located in the subdirectory gettext-example.&lt;/p&gt; &#xA;&lt;p&gt;Step 1: Add gettext as a dependency to your system definition (gettext-example.asd):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;:depends-on (:gettext)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Step 2: Add the GETTEXT package to the use list of you applications package. Setup gettext in your applications package (package.lisp):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(gettext:setup-gettext #:example &#34;gettext-example&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The first parameter is the name of the package. The second parameter is the textdomain. Textdomains are namespaces for the translated text. For most application a single textdomain (with the same name as the asdf system) will suffice.&lt;/p&gt; &#xA;&lt;p&gt;Step 3: Load the translated messages (example.lisp):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(preload-catalogs #.(asdf:system-relative-pathname :gettext-example &#34;locale/&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;This macro takes a single parameter, the pathname of a directory tree containing translation catalogs in MO format. The texts are loaded at compile time and become part of the compiled file, thus the the MO files are not need at runtime. An alternative approch is to load the MO files at runtime, see the section &#34;Loading catalogs at runtime&#34;.&lt;/p&gt; &#xA;&lt;p&gt;Step 4: Make sure the current locale is set by binding the special variable GETTEXT:&lt;em&gt;CURRENT-LOCALE&lt;/em&gt;:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(setf *current-locale* &#34;nn&#34;)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Here the locale is hardcoded to &#34;nn&#34;. In a real world application it would be set to the current users preferred language. If the application is a multithreaded multiuser application (like most web applications), dynamically bind GETTEXT:&lt;em&gt;CURRENT-LOCALE&lt;/em&gt; to the logged in users preferred language.&lt;/p&gt; &#xA;&lt;p&gt;Step 5: Mark texts for translation, e.g.:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(write-line (_ &#34;This is an example gettext program.&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Extract the texts for translations using the xgettext program from GNU gettext. This step will have to be repeated whenver the texts are updated in the source code. See update-translations.sh for a script that automates this job.&lt;/p&gt; &#xA;&lt;p&gt;Step 6: Translate the texts. First create a PO file for the langauge, using the msginit tool. Then you edit this file using e.g. Emacs with po-mode. The PO file can easly be updated with new texts with the help of the msgmerge tool. See update-translations.sh.&lt;/p&gt; &#xA;&lt;p&gt;Step 7: Finally convert the PO files into MO files using msgfmt. See update-translations.sh for details.&lt;/p&gt; &#xA;&lt;h2&gt;Loading catalogs at runtime&lt;/h2&gt; &#xA;&lt;p&gt;Replace GETTEXT:PRELOAD-CATALOGS with a SETF of the place GETTEXT:TEXTDOMAINDIR:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(setf (textdomaindir &#34;gettext-example&#34;)&#xA;      (asdf:system-relative-pathname :gettext-example &#34;locale/&#34;))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The catalogs will be loaded as needed and cached until the appliciatons quits.&lt;/p&gt; &#xA;&lt;h2&gt;Reference&lt;/h2&gt; &#xA;&lt;p&gt;Special variable GETTEXT:&lt;em&gt;CURRENT-LOCALE&lt;/em&gt;&lt;/p&gt; &#xA;&lt;p&gt;This variable must be bound to a string denoting the current locale. The library does not try to decode this string any way, it simply uses it to look for message catalogs in the file system. It&#39;s recommended to use the two letter language codes defined in ISO 639-1. A list can be found here: &lt;a href=&#34;http://www.gnu.org/software/gettext/manual/gettext.html#Language-Codes&#34;&gt;http://www.gnu.org/software/gettext/manual/gettext.html#Language-Codes&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;Macro GETTEXT:SETUP-GETTEXT package default-domain&lt;/p&gt; &#xA;&lt;p&gt;Defines gettext lookup functions in the provided package. _ and GETTEXT is as shortcut for GETTEXT:GETTEXT* and NGETTEXT is a shortcut for GETTEXT:NGETTEXT*, but with default-domain as the default domain. N_ is simply a shortcut for GETTEXT:GETTEXT-NOOP.&lt;/p&gt; &#xA;&lt;p&gt;Place GETTEXT:TEXTDOMAINDIR domain (SETF (GETTEXT:TEXTDOMAINDIR domain) directory)&lt;/p&gt; &#xA;&lt;p&gt;Specifies where to find translation catalogs for the given domain. The directory is the base directory used for lookup. The actual name of message catalog will be TEXTDOMAINDIR/l/LC_MESSAGES/domain.mo, where TEXTDOMAINDIR is the directory given setf to GETTEXT:TEXTDOMAINDIR, l is the current locale, LC_MESSAGES is the category and domain is the text domain.&lt;/p&gt; &#xA;&lt;p&gt;Place GETTEXT:TEXTDOMAIN (SETF (GETTEXT:TEXTDOMAIN) domain)&lt;/p&gt; &#xA;&lt;p&gt;Returns or sets the default text domain used by GETTEXT:GETTEXT* and GETTEXT:NGETTEXT*. Shortcut lookup functions defined by GETTEXT:SETUP-GETTEXT ignores this place.&lt;/p&gt; &#xA;&lt;p&gt;Function GETTEXT:GETTEXT* msgid &amp;amp;optional domain category locale&lt;/p&gt; &#xA;&lt;p&gt;Lookup a translated using the provided msgid. Domain defaults to (GETTEXT:TEXTDOMAIN). Category defaults to :LC_MESSAGES, and locale defaults to GETTEXT:&lt;em&gt;CURRENT-LOCALE&lt;/em&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Function GETTEXT:NGETTEXT* msgid1 msgid2 n &amp;amp;optional domain category locale&lt;/p&gt; &#xA;&lt;p&gt;Lookup a plural translated text. msgid1 is the singular form, msgid2 is the plural form and n is the number used to decide which plural form to use. See GETTEXT:GETTEXT* for description of the optional parameters.&lt;/p&gt; &#xA;&lt;p&gt;Function GETTEXT:GETTEXT-NOOP msgid&lt;/p&gt; &#xA;&lt;p&gt;This function simply returns its msgid parameter untranslated. It&#39;s only used to mark texts that shall be translated, but where the text occurs in an expression that will be executed at compile time. Example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;(defparameter *greeting* (gettext-noop &#34;Hello world&#34;))&#xA;;; In some function:&#xA;   (write-line (gettext* *greeting*))&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Macro GETTEXT:PRELOAD-CATALOGS textdomaindir&lt;/p&gt; &#xA;&lt;p&gt;Loads all message catalogs (in every category, in every locale and every domain) in the textdomaindir directory tree. This loading is done at macro expantion time. The effects is as if the translated text where part of the source code. Thus, the message catalogs are not needed at runtime.&lt;/p&gt; &#xA;&lt;p&gt;Type GETTEXT:LC-CATEGORY&lt;/p&gt; &#xA;&lt;p&gt;The allowed type of the locale parameter. One of the keyword symbols L:LC_ADDRESS, :LC_ALL, :LC_COLLATE, :LC_CTYPE, :LC_IDENTIFICATION, :LC_MEASUREMENT, :LC_MESSAGES, :LC_MONETARY, :LC_NAME, :LC_NUMERIC, :LC_PAPER, :LC_TELEPHONE and :LC_TIME.&lt;/p&gt; &#xA;&lt;p&gt;Function GETTEXT:CATALOG-META* &amp;amp;optional domain category locale&lt;/p&gt; &#xA;&lt;p&gt;Returns meta data about catalog as an assoc list. See &lt;a href=&#34;https://www.gnu.org/software/gettext/manual/gettext.html#Header-Entry&#34;&gt;https://www.gnu.org/software/gettext/manual/gettext.html#Header-Entry&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;TODO&lt;/h2&gt; &#xA;&lt;p&gt;The pgettext function of GNU gettext is not implemented. Implementing this should be fairly stright forward, but apparently the xgettext tool doesn&#39;t support this function when extracting texts form Lisp code.&lt;/p&gt; &#xA;&lt;p&gt;Encoding in MO files is hardcoded to UTF-8. Is this really a problem? Is there really a good reason for using anything else these days?&lt;/p&gt;</summary>
  </entry>
</feed>