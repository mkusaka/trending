<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Perl Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2023-08-29T01:37:12Z</updated>
  <subtitle>Daily Trending of Perl in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>pmqs/Fix-OneDrive-Zip</title>
    <updated>2023-08-29T01:37:12Z</updated>
    <id>tag:github.com,2023-08-29:/pmqs/Fix-OneDrive-Zip</id>
    <link href="https://github.com/pmqs/Fix-OneDrive-Zip" rel="alternate"></link>
    <summary type="html">&lt;p&gt;Fix OneDrive Zip files &gt;4Gig&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;Fix-OneDrive-Zip&lt;/h1&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/actions&#34;&gt;&lt;img src=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/workflows/Linux%20build/badge.svg?sanitize=true&#34; alt=&#34;Linux build&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/actions&#34;&gt;&lt;img src=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/workflows/Macos%20build/badge.svg?sanitize=true&#34; alt=&#34;Macos build&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/actions&#34;&gt;&lt;img src=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/workflows/Windows%20build/badge.svg?sanitize=true&#34; alt=&#34;Windows build&#34;&gt;&lt;/a&gt; &lt;a href=&#34;https://cirrus-ci.com/github/pmqs/Fix-OneDrive-Zip?task=FreeBSD&#34;&gt;&lt;img src=&#34;https://api.cirrus-ci.com/github/pmqs/Fix-OneDrive-Zip.svg?task=FreeBSD&#34; alt=&#34;FreeBSD&#34;&gt;&lt;/a&gt;&lt;/p&gt; &#xA;&lt;p&gt;This program fixes an issue with Zip files larger than 4 Gig created by either &lt;code&gt;OneDrive&lt;/code&gt; or the Windows 10 right-click action &#34;&lt;code&gt;Send-To/Compressed (zip) folder&lt;/code&gt;&#34;. At the time of writing these Zip files cannot be unzipped using some of the well-know Zip archivers.&lt;/p&gt; &#xA;&lt;p&gt;For a really detailed summary of the issue, see &lt;a href=&#34;https://www.bitsgalore.org/2020/03/11/does-microsoft-onedrive-export-large-ZIP-files-that-are-corrupt&#34;&gt;Does Microsoft OneDrive export large ZIP files that are corrupt?&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This program automates the manual process described in the referenced page.&lt;/p&gt; &#xA;&lt;p&gt;&lt;strong&gt;Notes&lt;/strong&gt;&lt;/p&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt; &lt;p&gt;It may be possible to work around this issue by updating the archiving program you are using to the latest version.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;This program will modify your Zip file, so it is good practice to take a backup copy of the original file just in case.&lt;/p&gt; &lt;/li&gt; &#xA; &lt;li&gt; &lt;p&gt;You need a 64-bit build of &lt;code&gt;perl&lt;/code&gt; installed on your system to run this program.&lt;/p&gt; &lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;Usage&lt;/h2&gt; &#xA;&lt;pre&gt;&lt;code&gt;perl fix-onedrive-zip [--dry-run] file1.zip [file2.zip...]&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;The &lt;code&gt;--dry-run&lt;/code&gt; option will simulate running of the program without making any changes to the Zip file.&lt;/p&gt; &#xA;&lt;h2&gt;Notes for Windows users&lt;/h2&gt; &#xA;&lt;p&gt;If you are running Windows and don&#39;t know what a perl script is, or how to run one, this section will walk you through the process.&lt;/p&gt; &#xA;&lt;h3&gt;Step 1: Check if you have perl already installed&lt;/h3&gt; &#xA;&lt;p&gt;The &lt;code&gt;fix-onedrive-zip&lt;/code&gt; script is written in &lt;code&gt;perl&lt;/code&gt;. To run it on your PC you need the &lt;code&gt;perl&lt;/code&gt; executable.&lt;/p&gt; &#xA;&lt;p&gt;To check if it is already installed, create a terminal window by typing &lt;code&gt;Windows+R&lt;/code&gt;. In the pop-up window type &lt;code&gt;cmd&lt;/code&gt;. You should now have a terminal window open.&lt;/p&gt; &#xA;&lt;p&gt;Type &lt;code&gt;perl -v&lt;/code&gt;. If &lt;code&gt;perl&lt;/code&gt; is installed you should see text like this. The Perl version doesn&#39;t matter.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;C:\Users\me&amp;gt;perl -v&#xA;&#xA;This is perl 5, version 32, subversion 1 (v5.32.1) built for MSWin32-x64-multi-thread&#xA;&#xA;Copyright 1987-2021, Larry Wall&#xA;&#xA;Perl may be copied only under the terms of either the Artistic License or the&#xA;GNU General Public License, which may be found in the Perl 5 source kit.&#xA;&#xA;Complete documentation for Perl, including FAQ lists, should be found on&#xA;this system using &#34;man perl&#34; or &#34;perldoc perl&#34;.  If you have access to the&#xA;Internet, point your browser at http://www.perl.org/, the Perl Home Page.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you don&#39;t have &lt;code&gt;perl&lt;/code&gt;, the output will look like this&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;&#39;perl&#39; is not recognized as an internal or external command,&#xA;operable program or batch file.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Step 2: Install Perl if you don&#39;t already have it&lt;/h3&gt; &#xA;&lt;p&gt;There are a number of perl executables available for Windows. For this tutorial I&#39;ve used &lt;a href=&#34;https://strawberryperl.com/&#34;&gt;Strawberry Perl&lt;/a&gt;, but there are others available.&lt;/p&gt; &#xA;&lt;p&gt;Use the instructions &lt;a href=&#34;https://www.perltutorial.org/setting-up-perl-development-environment/&#34;&gt;here&lt;/a&gt; to install the 64-bit &#34;&lt;em&gt;Recommended version&lt;/em&gt;&#34; of &lt;code&gt;perl&lt;/code&gt; from the &lt;a href=&#34;https://strawberryperl.com/&#34;&gt;Strawberry Perl&lt;/a&gt; site.&lt;/p&gt; &#xA;&lt;p&gt;Once the installation is complete, run &lt;code&gt;Step 1&lt;/code&gt;, above, to check that the perl works ok from the command-line in a terminal window.&lt;/p&gt; &#xA;&lt;h3&gt;Step 3: Download the script&lt;/h3&gt; &#xA;&lt;p&gt;You now need to get the script &lt;code&gt;fix-onedrive-zip&lt;/code&gt; downloaded from GitHub and stored on your PC. In a browser navigate to &lt;a href=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/raw/master/fix-onedrive-zip&#34;&gt;here&lt;/a&gt; and select the &#34;&lt;code&gt;Download raw file&lt;/code&gt;&#34; icon, as highlighted below&lt;/p&gt; &#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/pmqs/Fix-OneDrive-Zip/master/assets/download.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt; &#xA;&lt;p&gt;That should download the file &lt;code&gt;fix-onedrive-zip&lt;/code&gt; into your &lt;code&gt;Downloads&lt;/code&gt; directory.&lt;/p&gt; &#xA;&lt;h3&gt;Step 4: Running the script&lt;/h3&gt; &#xA;&lt;p&gt;The easiest approach to running this script if you are not confortable with running from the command-line is to put the &lt;code&gt;fix-onedrive-zip&lt;/code&gt; script and the zip file you want to fix in the same folder. Lets assume you have both stored in the folder &lt;code&gt;C:\fixzip&lt;/code&gt; and the name of the OneDrive zip file you want to fix is &lt;code&gt;myfile.zip&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;Start by creating a terminal window by typing &lt;code&gt;Windows+R&lt;/code&gt; and typing &lt;code&gt;cmd&lt;/code&gt; in the pop-up window.&lt;/p&gt; &#xA;&lt;p&gt;Now run the command below in the terminal window to move to the folder where your zip file is stored, replacing &lt;code&gt;C:\fixzip&lt;/code&gt; with the name of the folder you are using&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;cd C:\fixzip&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;You can now run the &lt;code&gt;fix-onedrive-zip&lt;/code&gt; script by typing this in the terminal window. Remember to change &lt;code&gt;myfile.zip&lt;/code&gt; to the name of the zip file you want fixed.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;perl fix-onedrive-zip myfile.zip&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;What if this program doesn&#39;t fix the issue?&lt;/h2&gt; &#xA;&lt;p&gt;The most common issue reported with this script is the following error message:&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;Error: Cannot find Zip signature at end of &#39;somefile.zip&#39;&lt;/code&gt;&lt;/p&gt; &#xA;&lt;p&gt;To understand what this message means you first need to know a little bit about the structure of the metadata in a zip file.&lt;/p&gt; &#xA;&lt;p&gt;At the start of a zip file there are 4 bytes called the &#34;&lt;code&gt;local file header signature&lt;/code&gt;&#34;. The majority of metedata values in a zip file are stored in little-endian byte order, so these 4 bytes are unpacked as the litte-endian value &lt;code&gt;0x04034b50&lt;/code&gt;. For this error case these 4 signature bytes &lt;em&gt;will&lt;/em&gt; be present, so the script knows it likely dealing with a zip file.&lt;/p&gt; &#xA;&lt;p&gt;Once that initial test is done, the script moves to 22 bytes before the end of the file and checks that the 4 bytes of the &#34;&lt;code&gt;end of central dir signature&lt;/code&gt;&#34; (little-endian value &lt;code&gt;0x06054b50&lt;/code&gt;) are present. In this case it &lt;em&gt;doesn&#39;t&lt;/em&gt; find these signature bytes.&lt;/p&gt; &#xA;&lt;p&gt;This program can only work with a well-formed zip file, so it now terminates immediately with the error message shown above.&lt;/p&gt; &#xA;&lt;p&gt;The root-cause for this error is typically a zip file that has either been truncated or partially corrupted (i.e. the end the file has been overwritten with random data).&lt;/p&gt; &#xA;&lt;h3&gt;Strategies for recovering data&lt;/h3&gt; &#xA;&lt;p&gt;The most straightforward way to deal with a truncated/corrupt zip file is to download a fresh copy of the zip file.&lt;/p&gt; &#xA;&lt;p&gt;If downloading is not an option it may be possible to recover some/all of the zip file payload data. It just depends on how badly damaged the file is. Be aware - if payload data has been overwritten or is absent there is no way that to retrieve this data from the zip file.&lt;/p&gt; &#xA;&lt;p&gt;There are plenty of articles available online that discuss recovering data from corrupt zip files, so I&#39;ll only mention that the &lt;a href=&#34;https://infozip.sourceforge.net/&#34;&gt;Info-ZIP&lt;/a&gt; implementaion of &lt;code&gt;zip&lt;/code&gt; (most Unix/Mac systems ship with this program) has two commandline options, &lt;code&gt;-F&lt;/code&gt; and &lt;code&gt;-FF&lt;/code&gt;, that can be used to attempt to fix zip files.&lt;/p&gt; &#xA;&lt;h2&gt;Technical Details&lt;/h2&gt; &#xA;&lt;p&gt;If you want to understand more about the internal structure of Zip files, the primary reference is &lt;a href=&#34;https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT&#34;&gt;APPNOTE.TXT&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;The issue with the &lt;code&gt;OneNote&lt;/code&gt;/&lt;code&gt;Windows&lt;/code&gt; Zip files larger than 4 Gig is they have an invalid &lt;code&gt;Total Number of Disks&lt;/code&gt; field in the &lt;code&gt;ZIP64 End Central Directory Locator&lt;/code&gt; record (see &lt;a href=&#34;https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT&#34;&gt;APPNOTE.TXT&lt;/a&gt; version 6.3.9, section 4.3.15). The value in this field should be &lt;code&gt;1&lt;/code&gt;, but &lt;code&gt;OneDrive&lt;/code&gt;/&lt;code&gt;Windows&lt;/code&gt; sets it to &lt;code&gt;0&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This program simply changes the &lt;code&gt;Total Number of Disks&lt;/code&gt; field value to &lt;code&gt;1&lt;/code&gt; if it finds it set to &lt;code&gt;0&lt;/code&gt; in the Zip file.&lt;/p&gt; &#xA;&lt;h2&gt;Support&lt;/h2&gt; &#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/pmqs/Fix-OneDrive-Zip/issues&#34;&gt;https://github.com/pmqs/Fix-OneDrive-Zip/issues&lt;/a&gt;&lt;/p&gt; &#xA;&lt;h2&gt;Copyright&lt;/h2&gt; &#xA;&lt;p&gt;Copyright (c) 2020-2023 Paul Marquess (&lt;a href=&#34;mailto:pmqs@cpan.org&#34;&gt;pmqs@cpan.org&lt;/a&gt;). All rights reserved.&lt;/p&gt; &#xA;&lt;p&gt;This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.&lt;/p&gt;</summary>
  </entry>
</feed>