<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Perl Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2025-01-24T01:36:01Z</updated>
  <subtitle>Daily Trending of Perl in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>BaldMansMojo/check_vmware_esx</title>
    <updated>2025-01-24T01:36:01Z</updated>
    <id>tag:github.com,2025-01-24:/BaldMansMojo/check_vmware_esx</id>
    <link href="https://github.com/BaldMansMojo/check_vmware_esx" rel="alternate"></link>
    <summary type="html">&lt;p&gt;chech_vmware_esx Fork of check_vmware_api.pl&lt;/p&gt;&lt;hr&gt;&lt;h1&gt;check_vmware_esx for VMware Monitoring&lt;/h1&gt; &#xA;&lt;h4&gt;Table of Contents&lt;/h4&gt; &#xA;&lt;ol&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#about&#34;&gt;About&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#license&#34;&gt;License&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#support&#34;&gt;Support&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#requirements&#34;&gt;Requirements&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#installation&#34;&gt;Installation&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#configuration&#34;&gt;Configuration&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#faq&#34;&gt;FAQ&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#thanks&#34;&gt;Thanks&lt;/a&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#contributing&#34;&gt;Contributing&lt;/a&gt;&lt;/li&gt; &#xA;&lt;/ol&gt; &#xA;&lt;h2&gt;About&lt;/h2&gt; &#xA;&lt;p&gt;Check VMware ESX is a plugin to monitor VMware ESX and vSphere servers. You can monitor either a single ESX(i)/vSphere server or a VMware VirtualCenter/vCenter Server and individual virtual machines. If you have a VMware cluster you should monitor the data center (VMware VirtualCenter/vCenter Server) and not the individual ESX/vSphere servers.&lt;/p&gt; &#xA;&lt;p&gt;Supports check status of ESX(i) server, vSphere 5.1 up to vSphere 6.5.&lt;/p&gt; &#xA;&lt;p&gt;chech_vmware_esx is a fork of &lt;a href=&#34;https://github.com/op5/check_vmware_api&#34;&gt;check_vmware_api&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;License&lt;/h2&gt; &#xA;&lt;p&gt;This plugin is licensed under the terms of the GNU General Public License Version 2, you will find a copy of this license in the LICENSE file included in the source package.&lt;/p&gt; &#xA;&lt;h2&gt;Support&lt;/h2&gt; &#xA;&lt;p&gt;Join the community channels from Icinga, Nagios, Naemon for questions. A common place to kindly ask and discuss can be joined at &lt;a href=&#34;https://monitoring-portal.org&#34;&gt;monitoring-portal.org&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;Requirements&lt;/h2&gt; &#xA;&lt;h3&gt;VMware Perl SDK&lt;/h3&gt; &#xA;&lt;p&gt;Download the &lt;a href=&#34;https://developer.vmware.com/web/sdk/6.5/vsphere-perl&#34;&gt;vSphere Perl SDK&lt;/a&gt; (requires a free account that you sign up for at the same page).&lt;/p&gt; &#xA;&lt;p&gt;Do not use SDK 6.0 because it contains some bugs and incompatibilities. Use SDK 5.5 or 6.5. Both work well.&lt;/p&gt; &#xA;&lt;p&gt;Install the SDK. An installation guide can be found &lt;a href=&#34;https://developer.vmware.com/docs/4166/vsphere-sdk-for-perl-installation-guide&#34;&gt;here&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Perl Modules&lt;/h3&gt; &#xA;&lt;p&gt;Please ensure that the following Perl modules are installed on your system:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;&lt;code&gt;File::Basename&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;HTTP::Date&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Getopt::Long&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Time::Duration&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;Time::HiRes&lt;/code&gt;&lt;/li&gt; &#xA; &lt;li&gt;&lt;code&gt;VMware::VIRuntime&lt;/code&gt; (see above)&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Installation&lt;/h2&gt; &#xA;&lt;p&gt;Best practice is to keep your own plugins separated from the official Monitoring Plugins. You can adopt the paths in the following sections to your own needs. For simplicity, the documentation refers to the existing Monitoring Plugins directory where Monitoring Cores would expect them.&lt;/p&gt; &#xA;&lt;h3&gt;Single File Installation&lt;/h3&gt; &#xA;&lt;p&gt;Similar to how &lt;code&gt;check_mysql_health&lt;/code&gt; and variants are compiled into a single Perl plugin script, Sven Nierlein contributed a Makefile which generates a single file to install.&lt;/p&gt; &#xA;&lt;p&gt;Example on Debian/Ubuntu:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;make all&#xA;cp check_vmware_esx /usr/lib/nagios/plugins/&#xA;chmod 755 /usr/lib/nagios/plugins/check_vmware_esx&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;blockquote&gt; &#xA; &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/p&gt; &#xA; &lt;p&gt;This is recommended if you are having trouble with missing Perl modules, e.g. &lt;code&gt;help.pm&lt;/code&gt; is not found.&lt;/p&gt; &#xA;&lt;/blockquote&gt; &#xA;&lt;p&gt;Now proceed with the &lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#configuration&#34;&gt;configuration&lt;/a&gt; chapter.&lt;/p&gt; &#xA;&lt;h3&gt;Modular Installation&lt;/h3&gt; &#xA;&lt;p&gt;The plugin script requires the &lt;code&gt;modules&lt;/code&gt; directory being copied into an upgrade safe location. Best is to put them outside of the system&#39;s Perl path. The default settings expects them in the same directory where the plugin is copied to, e.g. &lt;code&gt;/usr/lib/nagios/plugins&lt;/code&gt; on Debian/Ubuntu/SUSE or &lt;code&gt;/usr/lib64/nagios/plugins&lt;/code&gt; on RHEL/CentOS.&lt;/p&gt; &#xA;&lt;p&gt;Example on Debian/Ubuntu:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;cp -r modules /usr/lib/nagios/plugins/&#xA;cp check_vmware_esx.pl /usr/lib/nagios/plugins/check_vmware_esx&#xA;chmod 755 /usr/lib/nagios/plugins/check_vmware_esx&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;In case you want to put &lt;code&gt;modules&lt;/code&gt; into a different location, you need to edit the plugin script and add your own modules path, e.g. &lt;code&gt;/usr/lib/nagios/vmware/modules&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;vim /usr/lib/nagios/plugins/check_vmware_esx&#xA;&#xA;#use lib &#34;modules&#34;;&#xA;use lib &#34;/usr/lib/nagios/vmware/modules&#34;;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Now proceed with the &lt;a href=&#34;https://raw.githubusercontent.com/BaldMansMojo/check_vmware_esx/master/#configuration&#34;&gt;configuration&lt;/a&gt; chapter.&lt;/p&gt; &#xA;&lt;h2&gt;Configuration&lt;/h2&gt; &#xA;&lt;p&gt;Evaluate the required parameters and modules by testing the plugin as nagios/icinga user on the shell. Invoke &lt;code&gt;--help&lt;/code&gt; to find out more about possible modes and parameters.&lt;/p&gt; &#xA;&lt;h3&gt;Monitoring Configuration&lt;/h3&gt; &#xA;&lt;p&gt;Icinga 2 provides &lt;a href=&#34;https://www.icinga.com/docs/icinga2/latest/doc/10-icinga-template-library/#vmware&#34;&gt;VMware CheckCommand definitions&lt;/a&gt; in its template library already. Icinga 1.x/Nagios require you to create command definitions beforehand.&lt;/p&gt; &#xA;&lt;p&gt;Example for Icinga 2 and DC volumes:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;apply Service &#34;vcenter-volumes&#34; {&#xA;  check_command = &#34;vmware-esx-dc-volumes&#34;&#xA;  vars.vmware_datacenter = &#34;vcenter.yourdomain.local&#34;&#xA;  vars.vmware_username = &#34;icinga@yourdomain.local&#34;&#xA;  vars.vmware_password = &#34;password&#34;&#xA;&#xA;  assign where &#34;VMware&#34; in host.groups&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Authentication&lt;/h3&gt; &#xA;&lt;p&gt;In order to avoid credentials in your service definition, you can also use an authorization file and pass it as argument to the plugin.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;mkdir -p /etc/icinga2/authfiles/vcenter-auth&#xA;cat &amp;gt;/etc/icinga2/authfiles/vcenter-auth &amp;lt;&amp;lt;EOF&#xA;username=username@yourdomain.com&#xA;password=mypassword&#xA;EOF&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example for Icinga 2 and DC volumes:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;apply Service &#34;vcenter-volumes&#34; {&#xA;  check_command = &#34;vmware-esx-dc-volumes&#34;&#xA;  vars.vmware_datacenter = &#34;vcenter.yourdomain.local&#34;&#xA;  vars.vmware_authfile = &#34;/etc/icinga2/authfiles/vcenter-auth&#34;&#xA;&#xA;  assign where &#34;VMware&#34; in host.groups&#xA;}&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h3&gt;Session File&lt;/h3&gt; &#xA;&lt;p&gt;Adjust the path for &lt;code&gt;$sessionfile_dir_def&lt;/code&gt; inside the script if required. This defaults to &lt;code&gt;/tmp&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h2&gt;FAQ&lt;/h2&gt; &#xA;&lt;h3&gt;Timeouts&lt;/h3&gt; &#xA;&lt;p&gt;If you are encountering timeouts using the VMware Perl SDK, check &lt;a href=&#34;https://www.claudiokuenzler.com/blog/650/slow-vmware-perl-sdk-soap-request-error-libwww-version&#34;&gt;this blog entry&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;You then need to downgrade the &lt;code&gt;libwww-perl&lt;/code&gt; package.&lt;/p&gt; &#xA;&lt;h3&gt;Compatibility with Plugin Developer Guidelines&lt;/h3&gt; &#xA;&lt;p&gt;According to the guidelines every plugin should start it&#39;s output with&lt;/p&gt; &#xA;&lt;p&gt;SERVICE STATUS: First line of output | First part of performance data&lt;/p&gt; &#xA;&lt;p&gt;The service status part wasn&#39;t implemented in output in the past because from a technically view it is not necessary. For notifications this string is available as a macro ($SERVICESTATE$) together with the state ID ($SERVICESTATEID$). If the macro is used for notifications you will have a doubled string (for example CRITICAL CRITICAL). While this is only cosmetics for email and in the webgui (if a check is red you need the extra string CRITICAL only when you are clour-blind) it can have side effects using SMS because the string length in SMS is limited. So you have to filter the message (sed) before you send it.&lt;/p&gt; &#xA;&lt;p&gt;To fulfill the rules of the Plugin Developer Guidelines an extra option --statelabels=&amp;lt;y/n&amp;gt; was added. The default is set in the plugin in the variable $statelabels_def which is set to &#34;y&#34; by default.&lt;/p&gt; &#xA;&lt;p&gt;Simon Meggle proposed --nostatelabels (thanks Simon - it was a good idea to add it) but I preferred it the other way round first. Caused by some feedback I decided to offer all options. If you don&#39;t like statelabels (like me) just set the variable to &#34;n&#34;.&lt;/p&gt; &#xA;&lt;h3&gt;HTML in Output&lt;/h3&gt; &#xA;&lt;p&gt;HTML in output is caused by the option --multiline or in some situtations where you need a multiline output in the service overview window. So here a &lt;br&gt; tag is used to have a line break. Using --multiline will always cause a &lt;br&gt; instead of \n. (Remember - having a standard multiline output from a plugin only the first line will be displayed in the overwiew window. The rest is with the details view).&lt;/p&gt; &#xA;&lt;p&gt;The HTML tags must be filtered out before using the output in notifications like an email. sed will do the job:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;sed &#39;s/&amp;lt;[Bb][Rr]&amp;gt;/&amp;amp;\n/g&#39; | sed &#39;s/&amp;lt;[^&amp;lt;&amp;gt;]*&amp;gt;//g&#39;&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example for Nagios/Icinga 1.x:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;# &#39;notify-by-email&#39; command definition&#xA;define command{&#xA;&#x9;command_name&#x9;notify-by-email&#xA;&#x9;command_line&#x9;/usr/bin/printf &#34;%b&#34; &#34;Message from Nagios:\n\nNotification Type: $NOTIFICATIONTYPE$\n\nService: $SERVICEDESC$\nHost: $HOSTNAME$\nHostalias: $HOSTALIAS$\nAddress: $HOSTADDRESS$\nState: $SERVICESTATE$\n\nDate/Time: $SHORTDATETIME$\n\nAdditional Info:\n\n$SERVICEOUTPUT$\n$LONGSERVICEOUTPUT$&#34; | sed &#39;s/&amp;lt;[Bb][Rr]&amp;gt;/&amp;amp;\n/g&#39; | sed &#39;s/&amp;lt;[^&amp;lt;&amp;gt;]*&amp;gt;//g&#39; | /bin/mail -s &#34;** $NOTIFICATIONTYPE$ alert - $HOSTNAME$/$SERVICEDESC$ is $SERVICESTATE$ **&#34; $CONTACTEMAIL$&#xA;&#x9;}&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you are using Icinga 2, you need to adjust the notification scripts.&lt;/p&gt; &#xA;&lt;h3&gt;Using Open VM Tools&lt;/h3&gt; &#xA;&lt;p&gt;VMware recommends using the Open VM Tools (&lt;a href=&#34;https://github.com/vmware/open-vm-tools&#34;&gt;https://github.com/vmware/open-vm-tools&lt;/a&gt;) instead of host deployed tools. According to pkgs.org (&lt;a href=&#34;http://pkgs.org/download/open-vm-tools&#34;&gt;http://pkgs.org/download/open-vm-tools&lt;/a&gt;) these tools are available for most Linux systems. For SLES you find them via &lt;a href=&#34;https://www.suse.com/communities/conversations/free_tools/installing-vmware-tools-easy-way-osp/&#34;&gt;https://www.suse.com/communities/conversations/free_tools/installing-vmware-tools-easy-way-osp/&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;&#34;VMware Tools is installed, but it is not managed by VMware&#34; is now quite ok for package based Linux installation, but for all other systems (like MS Windows) this will cause a warning because it&#39;s not ok.&lt;/p&gt; &#xA;&lt;p&gt;Therefore I implemented a new option --open-vm-tools.&lt;/p&gt; &#xA;&lt;p&gt;But how to handle it in a command definition? Two defintions (one for Linux, one for the rest?&lt;/p&gt; &#xA;&lt;p&gt;No - we handle this option over to the command as an argument:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;define command{&#xA;        command_name    check_vshpere_tools_state&#xA;        command_line    /MyPluginPath/check_vmware_esx.pl -D $DATACENTER_HOSTADDRESS$ -u $ARG1$ -p $ARG2$ -S runtime -s tools $ARG3$&#xA;        }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Service check for Linux:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;define service{&#xA;       ....&#xA;       .&#xA;       .&#xA;       .&#xA;       .....&#xA;       check_command                   check_vsphere_tools_state!Nagios!MyMonitorPassword!&#34;--open-vm-tools&#34;&#xA;       }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Service check for the rest:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;define service{&#xA;       ....&#xA;       .&#xA;       .&#xA;       .&#xA;       .....&#xA;       check_command                   check_vsphere_tools_state!Nagios!MyMonitorPassword&#xA;       }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;So you can see in the second definition $ARG3$ is empty and therefore the option ist not set.&lt;/p&gt; &#xA;&lt;h3&gt;Using a session file&lt;/h3&gt; &#xA;&lt;p&gt;To reduce amounts of login/logout events in the vShpere logfiles or a lot of open sessions using sessionfiles the login part has been totally rewritten with version 0.9.8.&lt;/p&gt; &#xA;&lt;p&gt;Using session files is now the default. Only one session file per host or vCenter is used as default. The sessionfile name is automatically set to the vSphere host or the vCenter (IP or name - whatever is used in the check). The file will only update if the session get invalidated at some point.&lt;/p&gt; &#xA;&lt;p&gt;Multiple sessions are possible using different session file names. To form different session file names the default name is enhanced by the value you set with &lt;code&gt;--sessionfile&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;p&gt;&lt;code&gt;--sessionfile&lt;/code&gt; is now optional and only used to enhance the sessionfile name to have multiple sessions.&lt;/p&gt; &#xA;&lt;p&gt;Example command and service check definition:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;define command{&#xA;       command_name    check_vsphere_health&#xA;       command_line    /MyPluginPath/check_vmware_esx.pl -H $HOSTADDRESS$ -u $ARG1$ -p $ARG2$ -S runtime -s health&#xA;       }&#xA;&#xA;&#xA;define service{&#xA;       active_checks_enabled           1&#xA;       passive_checks_enabled          1&#xA;       parallelize_check               1&#xA;       obsess_over_service             1&#xA;       check_freshness                 0&#xA;       notifications_enabled           1&#xA;       event_handler_enabled           1&#xA;       flap_detection_enabled          1&#xA;       process_perf_data               0&#xA;       retain_status_information       1&#xA;       retain_nonstatus_information    1&#xA;       &#xA;       host_name                       vmsrv1&#xA;       service_description             Health&#xA;       is_volatile                     0&#xA;       check_period                    24x7&#xA;       max_check_attempts              5&#xA;       normal_check_interval           5&#xA;       retry_check_interval            1&#xA;       contact_groups                  sysadmins&#xA;       notification_interval           1440&#xA;       notification_period             24x7&#xA;       notification_options            c,w,r&#xA;       check_command                   check_vsphere_health!Nagios!MyMonitorPassword&#xA;       }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example for session file name and lock file name:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;192.168.10.12_session (default)&#xA;192.168.10.12_session_locked (default)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example caommand and service check definition (enhenced):&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;define command{&#xA;       command_name    check_vsphere_health&#xA;       command_line    /MyPluginPath/check_vmware_esx.pl -H $HOSTADDRESS$ -u $ARG1$ -p $ARG2$ -S runtime -s health --sessionfile=$ARG3$&#xA;       }&#xA;&#xA;&#xA;define service{&#xA;       active_checks_enabled           1&#xA;       passive_checks_enabled          1&#xA;       parallelize_check               1&#xA;       obsess_over_service             1&#xA;       check_freshness                 0&#xA;       notifications_enabled           1&#xA;       event_handler_enabled           1&#xA;       flap_detection_enabled          1&#xA;       process_perf_data               0&#xA;       retain_status_information       1&#xA;       retain_nonstatus_information    1&#xA;       &#xA;       host_name                       vmsrv1&#xA;       service_description             Health&#xA;       is_volatile                     0&#xA;       check_period                    24x7&#xA;       max_check_attempts              5&#xA;       normal_check_interval           5&#xA;       retry_check_interval            1&#xA;       contact_groups                  sysadmins&#xA;       notification_interval           1440&#xA;       notification_period             24x7&#xA;       notification_options            c,w,r&#xA;       check_command                   check_vsphere_health!Nagios!MyMonitorPassword!healthchecks&#xA;       }&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example for session file name and lock file name:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;192.168.10.12_healthchecks_session (enhenced)&#xA;192.168.10.12_healthchecks_session_locked (enhenced)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Optional a path different from the default one can be set with &lt;code&gt;--sessionfilename=&amp;lt;directory&amp;gt;&lt;/code&gt;.&lt;/p&gt; &#xA;&lt;h3&gt;Storage&lt;/h3&gt; &#xA;&lt;p&gt;The module host_storage_info.pm (contains host_storage_info()) is a extensive rewrite. Most of the code was rewritten. It now tested with iSCSI by customers and it is reported to run without problems.&lt;/p&gt; &#xA;&lt;h4&gt;Multipath:&lt;/h4&gt; &#xA;&lt;p&gt;The original version was as buggy and misleading as a piece of code can be. A threshold here was absolute nonsense. Why? At top level is a LUN which has a SCSI-ID. This LUN is connected to the storage in a SAN with a virtual path called a multipath because it consists of several physical connections(physical paths). I f you break down the data deliverd by VMware you will see that in the section for each physical path the associated multipath with it&#39;s state was also listed. check_vmware_api.pl (and check_esx3.pl) counted all those multipath entry. For example if you had 4 physical paths for one multipath the counted 4 multipaths and checked the multipath state. This was absolute nonsense because (under normal conditions) a multipath state is is only dead if all physical paths (4 in the example) are dead.&lt;/p&gt; &#xA;&lt;p&gt;The new check checks the state of the multipath AND the state of the physical paths. So for example if you have two parallel FC switches in a multipath environment and one is dead the multipath state is still ok but you will get an alarm now for the broken connection regardless if a switch, a line or a controller is broken.&lt;/p&gt; &#xA;&lt;p&gt;This is much more detailed then counting lines.&lt;/p&gt; &#xA;&lt;h3&gt;History&lt;/h3&gt; &#xA;&lt;p&gt;Why a fork? According to my personal unterstanding of Nagios, Icinga, etc. are tools for&lt;/p&gt; &#xA;&lt;p&gt;a) Monitoring and alarming. That means checking values against thresholds (internal or handed over) b) Collecting performance data. These data, collected with the checks, like network traffic, cpu usage or so should be interpretable without a lot of other data.&lt;/p&gt; &#xA;&lt;p&gt;Athough check_vmware_api.pl is a great plugin it suffers from various things. a) It acts as a monitoring plugin for Nagios etc. b) It acts a more comfortable commandline interfacescript. c) It collects all a lot of historical data to have all informations in one interface.&lt;/p&gt; &#xA;&lt;p&gt;While a) is ok b) and c) needs to be discussed. b) was necessary when you had only the Windows GUI and working on Linux meant &#34;No interface&#34;. this is obsolete now with the new webgui.&lt;/p&gt; &#xA;&lt;p&gt;c) will be better used by using the webgui because historical data (in most situations) means adjusted data. Most of these collected data is not feasible for alerting but for analysing performance gaps.&lt;/p&gt; &#xA;&lt;p&gt;So as a conclusion collecting historic performance data collected by a monitored system should not be done using Nagios, pnp4nagios etc.. It should be interpreted with the approriate admin tools of the relevant system. For vmware it means use the (web)client for this and not Nagios. Same for performance counters not self explaining.&lt;/p&gt; &#xA;&lt;p&gt;Example: Monitoring swapped memory of a vmware guest system seems to makes sense. But on the second look it doesn&#39;t because on Nagios you do not have the surrounding conditions in one view like&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;the number of the running guest systems on the vmware server.&lt;/li&gt; &#xA; &lt;li&gt;the swap every guest system needs&lt;/li&gt; &#xA; &lt;li&gt;the total space allocated for all systems&lt;/li&gt; &#xA; &lt;li&gt;swap/memory usage of the hostcheck_vmware_esx.pl&lt;/li&gt; &#xA; &lt;li&gt;and a lot more&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;So monitoring memory of a host makes sense but the same for the guest via vmtools makes only a limited sense.&lt;/p&gt; &#xA;&lt;p&gt;But this were only a few problems. Furthermore we had&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;misleading descriptions&lt;/li&gt; &#xA; &lt;li&gt;things monitored for hosts but not for vmware servers&lt;/li&gt; &#xA; &lt;li&gt;a lot of absolutely unnesseary performance data (who needs a performane graph for uptime?)&lt;/li&gt; &#xA; &lt;li&gt;unnessessary output (CPU usage in Mhz for example)&lt;/li&gt; &#xA; &lt;li&gt;and a lot more.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;p&gt;This plugin is old and big and cluttered like the room of my little son. So it was time for some house cleaning. I try to clean up the code of every routine, change things and will try to ease maintenance of the code.&lt;/p&gt; &#xA;&lt;p&gt;The plugin is not really ready but working. Due to the mass of options the help module needs work.&lt;/p&gt; &#xA;&lt;p&gt;See history for changes&lt;/p&gt; &#xA;&lt;p&gt;One last notice for technical issues. For better maintenance (and partly improved runtime) I have decided to modularize the plugin. It makes patching a lot easier. Modules which must be there every time are included with use, the others are include using require at runtime. This ensures that only that part of code is loaded which is needed.&lt;/p&gt; &#xA;&lt;h2&gt;Thanks&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;op5 for the original plugin&lt;/li&gt; &#xA; &lt;li&gt;Sven Nierlein&lt;/li&gt; &#xA; &lt;li&gt;Simon Meggle&lt;/li&gt; &#xA; &lt;li&gt;Riccardo Bartels for additional work and creating a &#34;monster&#34; pull request merging a lot of others&lt;/li&gt; &#xA; &lt;li&gt;Everyone contributing their time for feedback, patches and issue reports&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;Contributing&lt;/h2&gt; &#xA;&lt;p&gt;There are many ways to contribute to check_vmware_esx -- whether it be sending patches, testing, reporting bugs, or reviewing and updating the documentation. Every contribution is appreciated!&lt;/p&gt;</summary>
  </entry>
</feed>