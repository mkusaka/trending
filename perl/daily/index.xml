<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>GitHub Perl Daily Trending</title>
  <id>http://mshibanami.github.io/GitHubTrendingRSS</id>
  <updated>2024-04-26T01:29:37Z</updated>
  <subtitle>Daily Trending of Perl in GitHub</subtitle>
  <link href="http://mshibanami.github.io/GitHubTrendingRSS"></link>
  <entry>
    <title>HexaCluster/pgdsat</title>
    <updated>2024-04-26T01:29:37Z</updated>
    <id>tag:github.com,2024-04-26:/HexaCluster/pgdsat</id>
    <link href="https://github.com/HexaCluster/pgdsat" rel="alternate"></link>
    <summary type="html">&lt;p&gt;PostgreSQL Database Security Assessment Tool&lt;/p&gt;&lt;hr&gt;&lt;h2&gt;NAME&lt;/h2&gt; &#xA;&lt;p&gt;pgdsat - PostgreSQL Database Security Assessment Tool&lt;/p&gt; &#xA;&lt;h2&gt;DESCRIPTION&lt;/h2&gt; &#xA;&lt;p&gt;PGDSAT is a security assessment tool that checks around 70 PostgreSQL security controls of your PostgreSQL clusters including all recommendations from the &lt;a href=&#34;https://www.cisecurity.org/cis-benchmarks/&#34;&gt;CIS compliance benchmark&lt;/a&gt; but not only.&lt;/p&gt; &#xA;&lt;p&gt;This tool is a single command that must be run on the PostgreSQL server to collect all necessaries system and PostgreSQL information to compute a security assessment report. A report consist in a summary of all tests status and a second part with all detailed information. See &lt;a href=&#34;https://www.darold.net/sample_pgdsat/report.html&#34;&gt;sample report&lt;/a&gt;.&lt;/p&gt; &#xA;&lt;p&gt;This PostgreSQL Security Assessment Tool allow assessments to be carried out in an automated manner to verify the security policies established inside the company. It also gives understanding of the security issued that your cluster can be faced.&lt;/p&gt; &#xA;&lt;p&gt;Although the default text output format can be read directly from a terminal the use of the HTML output format is recommended for better reading as you can see in the sample report above.&lt;/p&gt; &#xA;&lt;h2&gt;SECURITY CHECKS&lt;/h2&gt; &#xA;&lt;p&gt;All checks recommended by the CIS Benchmark for PostgreSQL 16 are implemented but not only. Some additional tests not part of the CIS document are marked with the &#34;(*)&#34; mention in the description.&lt;/p&gt; &#xA;&lt;p&gt;Here is the list all checks performed on a PostgreSQL cluster. Some must be checked manually but most of them are check automatically by the tool.&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;    1 - Installation and Patches&#xA;      1.1 - Ensure packages are obtained from authorized repositories =&amp;gt; SUCCESS&#xA;        1.1.1 - PostgreSQL packages installed. (Manual)&#xA;        1.1.2 - Ensure packages are obtained from PGDG =&amp;gt; SUCCESS&#xA;      1.2 - Ensure systemd Service Files Are Enabled =&amp;gt; SUCCESS&#xA;      1.3 - Ensure Data Cluster Initialized Successfully =&amp;gt; SUCCESS&#xA;        1.3.1 - Check initialization of the PGDATA =&amp;gt; SUCCESS&#xA;        1.3.2 - Check version in PGDATA =&amp;gt; SUCCESS&#xA;        1.3.3 - Ensure Data Cluster have checksum enabled =&amp;gt; FAILURE&#xA;        1.3.4 - Ensure WALs and temporary files are not on the same partition as the PGDATA =&amp;gt; FAILURE&#xA;        1.3.5 - Ensure that the PGDATA partition is encrypted (Manual)&#xA;      1.4 - Ensure PostgreSQL versions are up-to-date =&amp;gt; FAILURE&#xA;      1.5 - Ensure unused PostgreSQL extensions are removed (Manual)&#xA;    2 - Directory and File Permissions&#xA;      2.1 - Ensure the file permissions mask is correct =&amp;gt; FAILURE&#xA;      2.2 - Check permissions of PGDATA =&amp;gt; SUCCESS&#xA;      2.3 - List content of PGDATA to check unwanted files and symlinks (Manual)&#xA;      2.4 - Check permissions of pg_hba.conf =&amp;gt; SUCCESS&#xA;      2.5 - Check permissions on Unix Socket =&amp;gt; FAILURE&#xA;    3 - Logging And Auditing&#xA;      3.1 - PostgreSQL Logging =&amp;gt; SUCCESS&#xA;        3.1.1 - Logging Rationale =&amp;gt; SUCCESS&#xA;        3.1.2 - Ensure the log destinations are set correctly =&amp;gt; SUCCESS&#xA;        3.1.3 - Ensure the logging collector is enabled =&amp;gt; FAILURE&#xA;        3.1.4 - Ensure the log file destination directory is set correctly =&amp;gt; SUCCESS&#xA;        3.1.5 - Ensure the filename pattern for log files is set correctly (Manual)&#xA;        3.1.6 - Ensure the log file permissions are set correctly =&amp;gt; SUCCESS&#xA;        3.1.7 - Ensure &#39;log_truncate_on_rotation&#39; is enabled =&amp;gt; SUCCESS&#xA;        3.1.8 - Ensure the maximum log file lifetime is set correctly (Manual)&#xA;        3.1.9 - Ensure the maximum log file size is set correctly (Manual)&#xA;        3.1.10 - Ensure the correct syslog facility is selected (Manual)&#xA;        3.1.11 - Ensure syslog messages are not suppressed =&amp;gt; SUCCESS&#xA;        3.1.12 - Ensure syslog messages are not lost due to size =&amp;gt; SUCCESS&#xA;        3.1.13 - Ensure the program name for PostgreSQL syslog messages is correct (Manual)&#xA;        3.1.14 - Ensure the correct messages are written to the server log =&amp;gt; SUCCESS&#xA;        3.1.15 - Ensure the correct SQL statements generating errors are recorded =&amp;gt; SUCCESS&#xA;        3.1.16 - Ensure &#39;debug_print_parse&#39; is disabled =&amp;gt; SUCCESS&#xA;        3.1.17 - Ensure &#39;debug_print_rewritten&#39; is disabled =&amp;gt; SUCCESS&#xA;        3.1.18 - Ensure &#39;debug_print_plan&#39; is disabled =&amp;gt; SUCCESS&#xA;        3.1.19 - Ensure &#39;debug_pretty_print&#39; is enabled =&amp;gt; SUCCESS&#xA;        3.1.20 - Ensure &#39;log_connections&#39; is enabled =&amp;gt; FAILURE&#xA;        3.1.21 - Ensure &#39;log_disconnections&#39; is enabled =&amp;gt; FAILURE&#xA;        3.1.22 - Ensure &#39;log_error_verbosity&#39; is set correctly =&amp;gt; FAILURE&#xA;        3.1.23 - Ensure &#39;log_hostname&#39; is set correctly =&amp;gt; SUCCESS&#xA;        3.1.24 - Ensure &#39;log_line_prefix&#39; is set correctly =&amp;gt; FAILURE&#xA;        3.1.25 - Ensure &#39;log_statement&#39; is set correctly =&amp;gt; FAILURE&#xA;        3.1.26 - Ensure &#39;log_timezone&#39; is set correctly =&amp;gt; FAILURE&#xA;        3.1.27 - Ensure that log_directory is outside the PGDATA =&amp;gt; SUCCESS&#xA;      3.2 - Ensure the PostgreSQL Audit Extension (pgAudit) is enabled =&amp;gt; SUCCESS&#xA;    4 - User Access and Authorization&#xA;      4.1 - Ensure sudo is configured correctly (Manual)&#xA;      4.2 - Ensure excessive administrative privileges are revoked =&amp;gt; FAILURE&#xA;      4.3 - Ensure excessive function privileges are revoked (Manual)&#xA;      4.4 - Ensure excessive DML privileges are revoked (Manual)&#xA;      4.5 - Ensure Row Level Security (RLS) is configured correctly (Manual)&#xA;      4.6 - Ensure the set_user extension is installed (Manual) =&amp;gt; FAILURE&#xA;      4.7 - Make use of predefined roles (Manual)&#xA;      4.8 - Ensuse the public schema is protected&#xA;    5 - Connection and Login&#xA;      5.1 - Ensure login via &#34;local&#34; UNIX Domain Socket is configured correctly =&amp;gt; FAILURE&#xA;      5.2 - Ensure login via &#34;host&#34; TCP/IP Socket is configured correctly =&amp;gt; SUCCESS&#xA;      5.3 - Ensure Password Complexity is configured =&amp;gt; SUCCESS&#xA;      5.4 - Ensure authentication timeout and delay are well configured =&amp;gt; FAILURE&#xA;      5.5 - Ensure SSL is used for client connection =&amp;gt; FAILURE&#xA;      5.6 - Ensure authorized Ip addresses ranges are not too large =&amp;gt; SUCCESS&#xA;      5.7 - Ensure specific database and users are used =&amp;gt; FAILURE&#xA;      5.8 - Ensure superusers are not allowed to connect remotely =&amp;gt; SUCCESS&#xA;      5.9 - Ensure that &#39;password_encryption&#39; is correctly set =&amp;gt; SUCCESS&#xA;    6 - PostgreSQL Settings&#xA;      6.1 - Understanding attack vectors and runtime parameters&#xA;      6.2 - Ensure &#39;backend&#39; runtime parameters are configured correctly =&amp;gt; FAILURE&#xA;      6.3 - Ensure &#39;Postmaster&#39; runtime parameters are configured correctly (Manual)&#xA;      6.4 - Ensure &#39;SIGHUP&#39; runtime parameters are configured correctly (Manual)&#xA;      6.5 - Ensure &#39;Superuser&#39; runtime parameters are configured correctly (Manual)&#xA;      6.6 - Ensure &#39;User&#39; runtime parameters are configured correctly (Manual)&#xA;      6.7 - Ensure FIPS 140-2 OpenSSL cryptography is used =&amp;gt; FAILURE&#xA;      6.8 - Ensure TLS is enabled and configured correctly =&amp;gt; FAILURE&#xA;      6.9 - Ensure a cryptographic extension is installed =&amp;gt; SUCCESS&#xA;    7 - Replication&#xA;      7.1 - Ensure a replication-only user is created and used for streaming replication =&amp;gt; FAILURE&#xA;      7.2 - Ensure logging of replication commands is configured =&amp;gt; FAILURE&#xA;      7.3 - Ensure base backups are configured and functional =&amp;gt; SUCCESS&#xA;      7.4 - Ensure WAL archiving is configured and functional =&amp;gt; FAILURE&#xA;      7.5 - Ensure streaming replication parameters are configured correctly =&amp;gt; FAILURE&#xA;    8 - Special Configuration Considerations&#xA;      8.1 - Ensure PostgreSQL subdirectory locations are outside the data cluster =&amp;gt; SUCCESS&#xA;      8.2 - Ensure the backup and restore tool, &#39;pgBackRest&#39;, is installed and configured =&amp;gt; FAILURE&#xA;      8.3 - Ensure miscellaneous configuration settings are correct (Manual)&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;REQUIREMENT&lt;/h2&gt; &#xA;&lt;p&gt;PGDSAT is a standalone program that can be run on any Linux server, it doesn&#39;t require any additional package installation except if your system do not have the following requirements:&lt;/p&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Ensure that PostgreSQL binaries are reachable from the &#39;$PATH&#39; environment variable.&lt;/li&gt; &#xA; &lt;li&gt;Ensure PostgreSQL &amp;gt;= 10.&lt;/li&gt; &#xA; &lt;li&gt;Ensure that &#39;PGHOST&#39;, &#39;PGUSER&#39;, &#39;PGPASSWORD&#39; and &#39;PGDATA&#39; environment variables are defined or use the dedicated command line options (except for &#39;PGPASSWORD&#39;). Or set a &#39;.pgpass&#39; file in the postgres system account.&lt;/li&gt; &#xA; &lt;li&gt;Ensure &#39;sudo apt install crypto-policies&#39; have been run for the FIPS test.&lt;/li&gt; &#xA; &lt;li&gt;Ensure the Perl bignum module is installed &#39;perl -e &#34;use bignum&#34;&#39;, if the command fail, install it using &#39;dnf install perl-bignum perl-Math-BigRat&#39;.&lt;/li&gt; &#xA; &lt;li&gt;Ensure the &#39;curl&#39; command is available and the server have access to Internet. It is used to check the PostgreSQL version online. If this is not possible, use command line option --no-pg-version-check to disable this check.&lt;/li&gt; &#xA; &lt;li&gt;To view the HTML report you also need an Internet access to obtain the FontAwesome icons used in the Summary Table of security checks.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;INSTALLATION&lt;/h2&gt; &#xA;&lt;p&gt;The PostgreSQL command psql is used to query the PostgreSQL cluster.&lt;/p&gt; &#xA;&lt;p&gt;To install PGDSAT:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;    perl Makefile.PL&#xA;    make&#xA;    sudo make install&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;If you don&#39;t want to install PGDSAT on your system but just want to execute it from the source directory, follow the instruction at end of next chapter.&lt;/p&gt; &#xA;&lt;p&gt;Some Linux RPM based distributions do not provide the bignum Perl module by default, you will need to install it:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;    dnf install perl-bignum perl-Math-BigRat&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;USAGE&lt;/h2&gt; &#xA;&lt;p&gt;PGSAT use commands to look at the system and especially to the PostgreSQL installation. It means that it requires the privilege of owner of these repository to be executed. Run it as postgres system user.&lt;/p&gt; &#xA;&lt;p&gt;Usage: pgdsat [options]&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;PostgreSQL Database Security Assessment Tool.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Options:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;-a | --allow   : database to include into the report in parts 4.3 to 4.5.&#xA;                 Can be used multiple time and regexp are supported.&#xA;-d | --database: name of the database to connect to PostgreSQL.&#xA;-D | --pgdata  : path to the PostgreSQL cluster PGDATA to analyze.&#xA;-e | --exclude : database to exclude from the report in parts 4.3 to 4.5.&#xA;                 Can be used multiple time and regexp are supported.&#xA;-f | --format  : output format, can be: text or html. Default: html.&#xA;-h | --host    : PostgreSQL serveur ip address if not listening on localhost&#xA;-l | --lang    : language used for the output (en_US, fr_FR). Default: en_US&#xA;-o | --output  : output file where to write the report. Default stdout.&#xA;-p | --port    : port where PostgreSQL is listening, default: 5432.&#xA;-P | --psql    : full path to the psql command if not found in PATH.&#xA;-T | --title   : set title to use to differentiate the reports. Default is&#xA;                 to use &#34;on `hostname`&#34;.&#xA;-U | --user    : PostgreSQL user to use with the psql command.&#xA;-v | --version : show version of pgdsat and exist.&#xA;-V | --cluster : PostgreSQL Cluster version, ex: 15.4.&#xA;--help         : show usage and exit.&#xA;&#xA;--no-pg-version-check : disable check for PostgreSQL minor versions. Useful&#xA;                 when connecting to Internet is not permitted.&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;Example:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;pgdsat -U postgres -h localhost -d postgres -o report.html&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;or pgdsat -U postgres -h localhost -d postgres -f html &amp;gt; report.html&lt;/p&gt; &#xA;&lt;p&gt;If you have several PostgreSQL cluster installed you must give the running version that you want to test:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;pgdsat -U postgres -h localhost -d postgres -f html -V 15.4 &amp;gt; report.html&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;p&gt;To execute the pgdsat command locally without installation, use:&lt;/p&gt; &#xA;&lt;pre&gt;&lt;code&gt;sudo perl -I ./lib ./pgdsat ...&#xA;&lt;/code&gt;&lt;/pre&gt; &#xA;&lt;h2&gt;AUTHORS&lt;/h2&gt; &#xA;&lt;ul&gt; &#xA; &lt;li&gt;Gilles Darold.&lt;/li&gt; &#xA;&lt;/ul&gt; &#xA;&lt;h2&gt;LICENSE&lt;/h2&gt; &#xA;&lt;p&gt;pgdsat is free software distributed under the GPLv3 license. See LICENCE file for more information.&lt;/p&gt; &#xA;&lt;p&gt;Copyright (c) 2024 HexaCluster Corp&lt;/p&gt; &#xA;&lt;p&gt;Some parts are copied from the &lt;a href=&#34;https://www.cisecurity.org/cis-benchmarks&#34;&gt;CIS Benchmark&lt;/a&gt; licensed under the &lt;a href=&#34;https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode&#34;&gt;Creative Common Version 4.0&lt;/a&gt; terms of use.&lt;/p&gt;</summary>
  </entry>
</feed>